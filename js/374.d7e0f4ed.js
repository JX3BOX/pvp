"use strict";(self["webpackChunkpvp"]=self["webpackChunkpvp"]||[]).push([[374],{25386:function(t,e,i){i.d(e,{Jq:function(){return n},Sx:function(){return l},VC:function(){return s},xl:function(){return o}});var a=i(18371);function n(t){return(0,a.nj)().get("/api/cms/posts/pvp",{params:t})}function o(t){return(0,a.nj)().get(`/api/cms/post/${t}`)}function l(t){return(0,a.nj)().get("/api/cms/pve/skill/changelog",{params:t})}function s(t){return(0,a.nj)().get("/api/cms/post/meta",{params:t})}},1474:function(t,e,i){i.d(e,{H:function(){return l},m:function(){return o}});var a=i(27484),n=i.n(a);const o=function(t){return n()(t).format("YYYY-MM-DD hh:mm:ss")};function l(t){if("[object Object]"===Object.prototype.toString.call(t)){for(const e in t)[void 0,null,""].includes(t[e])&&delete t[e];return t}return t}},40994:function(t,e,i){i.r(e),i.d(e,{default:function(){return Yt}});var a=i(66252);function n(t,e,i,n,o,l){const s=(0,a.up)("CompetitiveTrick"),r=(0,a.up)("ListLayout");return(0,a.wg)(),(0,a.j4)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s)])),_:1})}var o=i(78304),l=i(90607);const s={class:"m-competitive-trick"},r={key:0,class:"m-competitive-trick"};function d(t,e,i,n,o,l){const d=(0,a.up)("TrickNotice"),u=(0,a.up)("TrickHeader"),c=(0,a.up)("CompetitiveTrickItemVue"),p=(0,a.up)("el-alert"),m=(0,a.up)("design-task"),h=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(d),(0,a.Wm)(u,{onFilterImperceptibly:l.filterImperceptibly,onFilterMeta:l.filterMeta,onSearch:l.onSearch,onFilterWujie:l.filterWujie,client:o.client},null,8,["onFilterImperceptibly","onFilterMeta","onSearch","onFilterWujie","client"]),o.data.length?(0,a.wy)(((0,a.wg)(),(0,a.iD)("div",r,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.data,(t=>((0,a.wg)(),(0,a.j4)(c,{key:t.id,data:t,preset:o.presetConfig},null,8,["data","preset"])))),128))])),[[h,o.loading]]):((0,a.wg)(),(0,a.j4)(p,{key:1,class:"m-strategy-null",title:"没有找到相关条目",type:"info",center:"","show-icon":""})),(0,a.Wm)(m,{modelValue:o.showDesignTask,"onUpdate:modelValue":e[0]||(e[0]=t=>o.showDesignTask=t),post:o.currentPost},null,8,["modelValue","post"])])}i(57658);var u=i(25386),c=i(3577),p=i(49963),m=i.p+"img/video.d285c52a.svg";const h={key:0,class:"m-trick-item"},f={class:"m-trick-item__header"},v={class:"m-trick-item__title"},_={key:0,class:"u-label u-zlp"},g={key:1,class:"u-label u-wujie"},w=["href"],k={key:2,class:"u-marks"},y={key:3,class:"u-tv"},b={class:"m-trick-item__thx"},D={key:0,class:"u-push"},x={class:"m-trick-item__content"},C={class:"m-trick-item__left"},I=["href"],T={class:"u-name"},j={class:"m-trick-item__right"},W={key:0,class:"m-header"},V=["innerHTML"],q={class:"m-content"},B={key:0,class:"m-talent"},U={class:"m-talent__title"},z=["src"],S={key:0,class:"u-desc"},Z=["innerHTML"],R={class:"m-skills"},M={class:"u-title"},$=["src"],L={key:0,class:"u-skills"},F=["src","alt","title"],H=["title"],P={class:"u-gcd-icon",title:"无GCD技能"},A={key:1,class:"u-desc"},Y={class:"u-updated"};function O(t,e,i,n,o,l){var s,r,d,u,O,N,E,K,J,G,Q,X,tt,et;const it=(0,a.up)("el-button"),at=(0,a.up)("SimpleThx"),nt=(0,a.up)("el-tooltip"),ot=(0,a.up)("Avatar"),lt=(0,a.up)("Clock"),st=(0,a.up)("el-icon"),rt=(0,a.up)("Comment"),dt=(0,a.up)("el-drawer");return l.hasData?((0,a.wg)(),(0,a.iD)("div",h,[(0,a._)("div",f,[(0,a._)("div",v,[i.data.zlp?((0,a.wg)(),(0,a.iD)("span",_,(0,c.zw)(i.data.zlp),1)):(0,a.kq)("",!0),i.data.is_wujie?((0,a.wg)(),(0,a.iD)("span",g,"无界")):(0,a.kq)("",!0),(0,a._)("a",{class:"u-link",href:`/pvp/${null===(s=i.data)||void 0===s?void 0:s.ID}`,target:"_blank"},(0,c.zw)(i.data.post_title||"未知流派"),9,w),i.data.mark&&i.data.mark.length?((0,a.wg)(),(0,a.iD)("span",k,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(i.data.mark,(t=>((0,a.wg)(),(0,a.iD)("i",{class:"u-mark",key:t},(0,c.zw)(l.showMark(t)),1)))),128))])):(0,a.kq)("",!0),i.data.include_video?((0,a.wg)(),(0,a.iD)("span",y,e[2]||(e[2]=[(0,a._)("img",{class:"u-tv-icon",src:m},null,-1)]))):(0,a.kq)("",!0)]),(0,a._)("div",b,[l.hasPermission?((0,a.wg)(),(0,a.iD)("span",D,[l.showPushDate?((0,a.wg)(),(0,a.iD)("time",{key:0,class:(0,c.C_)(["u-push__time",{"is-recent":l.isRecent()}])},(0,c.zw)(l.pushDate)+" 已推送",3)):(0,a.kq)("",!0),(0,a.Wm)(it,{class:"u-push__btn",size:"small",type:"warning",onClick:l.onPush,icon:"Promotion"},{default:(0,a.w5)((()=>e[3]||(e[3]=[(0,a.Uk)("推送")]))),_:1},8,["onClick"])])):(0,a.kq)("",!0),(0,a.Wm)(at,{postType:"pvp",postTitle:null===(r=i.data)||void 0===r?void 0:r.post_title,userId:null===(d=i.data)||void 0===d?void 0:d.post_author,adminBoxcoinEnable:!0,userBoxcoinEnable:!0,postId:null===(u=i.data)||void 0===u?void 0:u.ID,presetConfig:i.preset},null,8,["postTitle","userId","postId","presetConfig"]),(0,a.Wm)(nt,{content:"评论",placement:"top-start"},{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.iD)("svg",{class:(0,c.C_)(["icon","u-icon"]),viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200","svg-inline":"",onClick:e[0]||(e[0]=t=>o.showComment=!0),role:"presentation",focusable:"false",tabindex:"-1"},e[4]||(e[4]=[(0,a._)("path",{d:"M655.36 0H368.64C165.888 0 0 165.888 0 368.64V921.6C0 977.92 46.08 1024 102.4 1024h552.96C859.136 1024 1024 859.136 1024 655.36V368.64C1024 165.888 858.112 0 655.36 0zM366.08 344.064c28.16 0 51.2 23.04 51.2 51.2s-23.04 51.2-51.2 51.2-51.2-23.04-51.2-51.2 23.04-51.2 51.2-51.2zM697.344 606.72c0 90.112-86.528 163.328-176.128 163.328h-18.432c-90.112 0-176.128-73.216-176.128-163.328 0-29.184 24.064-53.248 53.248-53.248H645.12c28.672 0 52.224 23.552 52.224 53.248zM657.92 446.464c-28.16 0-51.2-23.04-51.2-51.2s23.04-51.2 51.2-51.2 51.2 23.04 51.2 51.2-23.04 51.2-51.2 51.2z",fill:"#DD6572"},null,-1)])))])),_:1})])]),(0,a._)("div",x,[(0,a._)("div",C,[(0,a._)("a",{class:"m-author",href:l.authorLink(null===(O=i.data)||void 0===O?void 0:O.post_author)},[(0,a.Wm)(ot,{class:"u-avatar",uid:null===(N=i.data)||void 0===N?void 0:N.post_author,size:"s",url:null===(E=i.data.author_info)||void 0===E?void 0:E.user_avatar,frame:null===(K=i.data.author_info)||void 0===K?void 0:K.user_avatar_frame},null,8,["uid","url","frame"]),(0,a._)("span",T,(0,c.zw)(null===(J=i.data.author_info)||void 0===J?void 0:J.display_name),1)],8,I)]),(0,a._)("div",j,[null!==(G=i.data)&&void 0!==G&&null!==(G=G.post_meta)&&void 0!==G&&G.content?((0,a.wg)(),(0,a.iD)("div",W,[(0,a._)("div",{innerHTML:l.nl2br(null===(Q=i.data)||void 0===Q||null===(Q=Q.post_meta)||void 0===Q?void 0:Q.content)},null,8,V)])):(0,a.kq)("",!0),(0,a._)("div",q,[Object.keys(l.talent).length?((0,a.wg)(),(0,a.iD)("div",B,[(0,a._)("div",U,[(0,a._)("img",{class:"u-icon",src:l.getAppIcon("talent"),alt:""},null,8,z),e[5]||(e[5]=(0,a.Uk)(" 奇穴 "))]),(0,a._)("div",{class:(0,c.C_)(["m-talent-box",`m-qx-container-${null===(X=i.data)||void 0===X?void 0:X.ID}`])},null,2),null!==(tt=i.data)&&void 0!==tt&&null!==(tt=tt.post_meta)&&void 0!==tt&&tt.talent_desc?((0,a.wg)(),(0,a.iD)("div",S,[e[6]||(e[6]=(0,a.Uk)(" 奇穴讲解：")),(0,a._)("span",{innerHTML:l.nl2br(null===(et=i.data)||void 0===et||null===(et=et.post_meta)||void 0===et?void 0:et.talent_desc)},null,8,Z)])):(0,a.kq)("",!0)])):(0,a.kq)("",!0),(0,a._)("div",R,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.skills,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{class:"m-skill-item",key:e},[(0,a._)("div",M,[(0,a._)("img",{class:"u-icon",src:l.getAppIcon("pvp"),alt:""},null,8,$),(0,a.Uk)(" 连招："+(0,c.zw)(t.name),1)]),t.sq?((0,a.wg)(),(0,a.iD)("div",L,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.sq,((t,e)=>((0,a.wg)(),(0,a.iD)("span",{key:t.SkillID+""+e,class:"u-skill"},[(0,a._)("img",{class:"u-skill-icon",src:l.iconLink(t.IconID),alt:t.IconID,title:t.Name},null,8,F),(0,a._)("span",{class:"u-skill-name",title:t.Name},(0,c.zw)(t.Name),9,H),(0,a.wy)((0,a._)("i",P,[(0,a.Wm)(st,null,{default:(0,a.w5)((()=>[(0,a.Wm)(lt)])),_:1})],512),[[p.F8,t.WithoutGcd]])])))),128))])):(0,a.kq)("",!0),t.desc?((0,a.wg)(),(0,a.iD)("div",A,"连招说明："+(0,c.zw)(t.desc),1)):(0,a.kq)("",!0)])))),128))]),(0,a._)("div",Y,(0,c.zw)(l.formatTime(i.data.post_modified)),1)])])]),(0,a.Wm)(dt,{title:"评论",modelValue:o.showComment,"onUpdate:modelValue":e[1]||(e[1]=t=>o.showComment=t),"destroy-on-close":"",class:"m-trick-drawer"},{default:(0,a.w5)((()=>{var t;return[(0,a.Wm)(rt,{category:"post",id:null===(t=i.data)||void 0===t?void 0:t.ID},null,8,["id"])]})),_:1},8,["modelValue"])])):(0,a.kq)("",!0)}var N=i(43806),E=i(47518),K=i(94150),J=i(84618),G=i(31046),Q=i(23910),X=i(26060),tt=i(49e3),et=i(65113),it=i(27484),at=i.n(it),nt=i(1474),ot={name:"CompetitiveTrickItem",components:{SimpleThx:K.Z,Comment:J.Z,Avatar:G.Z},props:{preset:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}}},data(){return{talentDriver:null,showComment:!1}},computed:{talent(){try{var t;return JSON.parse(null===(t=this.data)||void 0===t||null===(t=t.post_meta)||void 0===t?void 0:t.talent)}catch(e){return{}}},hasData(){var t;return!(null===(t=this.data)||void 0===t||!t.ID)},skills(){var t;return null===(t=this.data)||void 0===t?void 0:t.post_meta.data},hasPermission(){return tt.Z.hasPermission("push_banner")},pushDate({data:t}){var e;const i=null===t||void 0===t||null===(e=t.log)||void 0===e?void 0:e.push_at;return(0,X.s2)(new Date(i))},showPushDate(){var t;return Boolean(null===(t=this.data)||void 0===t?void 0:t.log)}},watch:{data:{deep:!0,immediate:!0,handler(){this.talentDriver||this.$nextTick((()=>{this.installTalent()}))}},talent:{deep:!0,handler(){this.reloadTalent()}}},methods:{formatTime:nt.m,authorLink:N.authorLink,iconLink:N.iconLink,getAppIcon:N.getAppIcon,handleSq(t,e){var i;return"wujie"==e&&(null===t||void 0===t||null===(i=t.split(","))||void 0===i?void 0:i.length)>4?"1,1,1,1":t},installTalent(){var t,e,i;this.talentDriver=new E.Z({container:`.m-qx-container-${null===(t=this.data)||void 0===t?void 0:t.ID}`,version:this.talent.version,xf:this.talent.xf,editable:!1,sq:this.handleSq(this.talent.sq,null!==(e=this.data)&&void 0!==e&&e.is_wujie?"wujie":"std"),client:null!==(i=this.data)&&void 0!==i&&i.is_wujie?"wujie":"std"})},reloadTalent(){this.$nextTick((()=>{var t;this.talentDriver&&(null===(t=this.talentDriver)||void 0===t||t.then((t=>{var e,i;t.load({container:`.m-qx-container-${null===(e=this.data)||void 0===e?void 0:e.ID}`,version:this.talent.version,xf:this.talent.xf,editable:!1,sq:this.talent.sq,client:null!==(i=this.data)&&void 0!==i&&i.is_wujie?"wujie":"std"})})))}))},nl2br(t){return t.replace(/\n/g,"<br/>")},showMark:function(t){return Q.cms[t]||t},showDate:X.s2,isRecent:function(){var t;const e=null===(t=this.data)||void 0===t||null===(t=t.log)||void 0===t?void 0:t.push_at;return at()().diff(at()(e),"day")<30},onPush(){et.Z.emit("design-task",this.data)}}},lt=i(83744);const st=(0,lt.Z)(ot,[["render",O]]);var rt=st;const dt={class:"m-notice-top"},ut={class:"m-notice-top__content"},ct={class:"m-item_left"},pt=["innerHTML"];function mt(t,e,i,n,o,l){return(0,a.wg)(),(0,a.iD)("div",dt,[e[0]||(e[0]=(0,a._)("div",{class:"m-notice-top__header"},[(0,a._)("h3",{class:"u-title"},[(0,a._)("i",{class:"el-icon-news"}),(0,a.Uk)("公告")])],-1)),(0,a._)("div",ut,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.data,(t=>((0,a.wg)(),(0,a.iD)("div",{class:"m-notice-top__item",key:t.id},[(0,a._)("div",ct,[(0,a._)("span",{class:"u-title",innerHTML:t},null,8,pt)])])))),128))])])}var ht=i(2950),ft=i(25108),vt={data(){return{data:[]}},mounted(){this.getBreadcrumb()},methods:{getBreadcrumb(){try{const t=sessionStorage.getItem("pvp_ac");t?this.data=JSON.parse(t):(0,ht.k)("pvp_ac").then((t=>{var e;ft.log(t);const i=(null===(e=t.data)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.html)||"";this.data=i.split("\n"),sessionStorage.setItem("pvp_ac",JSON.stringify(this.data))}))}catch(t){this.data=[]}}}};const _t=(0,lt.Z)(vt,[["render",mt]]);var gt=_t;const wt={class:"c-macro__header"},kt={class:"m-archive-search"},yt=["href"],bt={key:0,class:"m-archive-filter"},Dt={class:"m-filter--left"},xt={class:"m-filter--right"};function Ct(t,e,i,n,o,l){const s=(0,a.up)("Search"),r=(0,a.up)("el-icon"),d=(0,a.up)("el-button"),u=(0,a.up)("el-input"),c=(0,a.up)("clientBy"),m=(0,a.up)("markBy"),h=(0,a.up)("zlpBy"),f=(0,a.up)("versionBy"),v=(0,a.up)("orderBy");return(0,a.wg)(),(0,a.iD)("div",wt,[(0,a._)("div",kt,[(0,a._)("a",{href:l.publish_link,class:"u-publish el-button el-button--primary el-button--large"},"+ 发布作品",8,yt),(0,a.Wm)(u,{placeholder:"请输入搜索内容",modelValue:o.search,"onUpdate:modelValue":e[0]||(e[0]=t=>o.search=t),modelModifiers:{trim:!0,lazy:!0},clearable:"",onClear:l.onSearch,onKeydown:(0,p.D2)(l.onSearch,["enter"]),size:"large"},{prepend:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(s)])),_:1}),e[1]||(e[1]=(0,a._)("span",{class:"u-search"}," 关键词",-1))])),append:(0,a.w5)((()=>[(0,a.Wm)(d,{icon:"Position",class:"u-btn",onClick:l.onSearch},null,8,["onClick"])])),_:1},8,["modelValue","onClear","onKeydown"])]),i.canFilter?((0,a.wg)(),(0,a.iD)("div",bt,[(0,a._)("div",Dt,[(0,a.Wm)(c,{onFilter:l.filterImperceptibly,type:i.client,showWujie:!1},null,8,["onFilter","type"]),(0,a.Wm)(m,{onFilter:l.filterMeta},null,8,["onFilter"]),(0,a.Wm)(h,{onFilter:l.filterMeta,type:"zlp",client:i.client},null,8,["onFilter","client"]),"std"==i.client?((0,a.wg)(),(0,a.j4)(f,{key:0,value:o.is_wujie,onFilter:l.filterWujie},null,8,["value","onFilter"])):(0,a.kq)("",!0)]),(0,a._)("div",xt,[(0,a.Wm)(v,{onFilter:l.filterMeta},null,8,["onFilter"])])])):(0,a.kq)("",!0)])}var It=i(60063);const Tt={class:"w-filter-client"},jt=["onClick"];function Wt(t,e,i,n,o,l){return(0,a.wg)(),(0,a.iD)("div",Tt,[(0,a._)("ul",null,[(0,a._)("li",{class:(0,c.C_)(["u-client",{on:""==t.version}]),onClick:e[0]||(e[0]=t=>l.filter(""))}," 双端 ",2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.versions,((e,i)=>((0,a.wg)(),(0,a.iD)("li",{class:(0,c.C_)(["u-client",{on:t.version==i}]),key:i,onClick:t=>l.filter(i)},(0,c.zw)(e),11,jt)))),128))])])}var Vt={name:"versionBy",props:["value"],emits:["filter"],data:function(){return{version:this.value||""}},computed:{versions:function(){const t={0:"旗舰",1:"无界"};return t}},methods:{filter:function(t){this.version=t,this.$emit("filter",{type:"version",val:t}),this.$forceUpdate()}}};const qt=(0,lt.Z)(Vt,[["render",Wt]]);var Bt=qt,Ut={name:"TrickHeader",components:{versionBy:Bt},props:{canFilter:{type:Boolean,default:!0},client:{type:String,default:"std"}},data(){return{search:"",is_wujie:""}},computed:{publish_link:function(){return(0,N.publishLink)(It.mx)}},watch:{"$route.query":{handler:function(t){this.is_wujie=t.is_wujie},immediate:!0,deep:!0}},methods:{filterImperceptibly(t){this.$emit("filterImperceptibly",t)},filterMeta(t){this.$emit("filterMeta",t)},onSearch(){this.$emit("search",this.search)},filterWujie(t){this.$emit("filterWujie",t.val)}}};const zt=(0,lt.Z)(Ut,[["render",Ct]]);var St=zt,Zt=i(96486),Rt=i(18371);const Mt=t=>(0,Rt.nj)().get("/api/cms/design/task/log",{params:t});var $t=i(20963),Lt={name:"CompetitiveTrick",components:{CompetitiveTrickItemVue:rt,TrickNotice:gt,TrickHeader:St,DesignTask:$t.Z},data(){return{data:[],search:"",client:"",presetConfig:{},loading:!1,currentPost:null,showDesignTask:!1}},computed:{subtype(){var t;return(null===(t=this.$route.query)||void 0===t?void 0:t.subtype)||"冰心诀"},mark(){var t;return(null===(t=this.$route.query)||void 0===t?void 0:t.mark)||""},order(){var t;return(null===(t=this.$route.query)||void 0===t?void 0:t.order)||""},zlp(){var t;return(null===(t=this.$route.query)||void 0===t?void 0:t.zlp)||""},is_wujie(){var t;return null===(t=this.$route.query)||void 0===t?void 0:t.is_wujie},query:function(){return{sticky:1,subtype:this.subtype,order:this.order,mark:this.mark,client:this.client,search:this.search,zlp:this.zlp,is_wujie:this.is_wujie}}},watch:{query:{immediate:!0,deep:!0,handler(){this.loadData()}}},mounted(){et.Z.on("design-task",(t=>{this.currentPost=t,this.showDesignTask=!0})),this.client=(0,o.o)().client},beforeUnmount(){et.Z.off("design-task")},methods:{publishLink:N.publishLink,loadData(){this.loading=!0;const t=(0,nt.H)((0,Zt.cloneDeep)(this.query));(0,u.Jq)(t).then((async t=>{if(this.data=t.data.data.list||[],tt.Z.hasPermission("push_banner")&&!this.isPhone){const t=this.data.map((t=>t.ID)),e=await Mt({source_type:"pvp",ids:t.join(",")}).then((t=>t.data.data));this.data=this.data.map((t=>{const i=e.find((e=>e.source_id==t.ID))||null;return t.log=i,t}))}})).finally((()=>{this.loading=!1}))},onSearch:function(t){this.search=t},filterImperceptibly:function(t){this[t["type"]]=t["val"]},filterMeta:function(t){this.replaceRoute({[t["type"]]:t["val"]})},filterWujie:function(t){this.replaceRoute({is_wujie:t})},replaceRoute:function(t){return this.$router.push({name:this.$route.name,query:Object.assign({},this.$route.query,t)}).then((()=>{window.scrollTo(0,0)})).catch((()=>{}))}}};const Ft=(0,lt.Z)(Lt,[["render",d]]);var Ht=Ft,Pt={name:"PostView",components:{ListLayout:l.Z,CompetitiveTrick:Ht},props:[],data:function(){return{}},computed:{client(){return(0,o.o)().client}}};const At=(0,lt.Z)(Pt,[["render",n]]);var Yt=At},31046:function(t,e,i){i.d(e,{Z:function(){return v}});var a=i(66252),n=i(3577);const o=["href"],l=["src"],s={key:0,class:"c-avatar-frame"},r=["src"];function d(t,e,i,d,u,c){return(0,a.wg)(),(0,a.iD)("a",{class:(0,n.C_)(["c-avatar",i.size]),href:c.authorLink(i.uid)},[(0,a._)("img",{src:c.showAvatar(i.url),class:"c-avatar-pic"},null,8,l),i.frame?((0,a.wg)(),(0,a.iD)("i",s,[(0,a._)("img",{src:c.frameUrl},null,8,r)])):(0,a.kq)("",!0),(0,a.WI)(t.$slots,"default")],10,o)}var u=i(89847),c=i(43806);const{__imgPath:p}=u;var m={name:"AvatarComp",props:{uid:{type:[Number,String],default:0},url:{type:String,default:""},frame:{type:String,default:""},size:{type:[Number,String],default:"m"}},components:{},data:function(){return{frames:[],styles:{xxs:36,xs:48,s:68,m:88,l:120,xl:150}}},computed:{frameUrl:function(){return p+`avatar/images/${this.frame}/${this.frame}.svg`}},methods:{showAvatar:function(t){return(0,c.showAvatar)(t,3*this.styles[this.size])},authorLink:c.authorLink}},h=i(83744);const f=(0,h.Z)(m,[["render",d]]);var v=f},20963:function(t,e,i){i.d(e,{Z:function(){return _}});var a=i(66252),n=i(3577);function o(t,e,i,o,l,s){const r=(0,a.up)("el-input"),d=(0,a.up)("el-form-item"),u=(0,a.up)("el-option"),c=(0,a.up)("el-select"),p=(0,a.up)("el-radio-button"),m=(0,a.up)("el-radio-group"),h=(0,a.up)("el-rate"),f=(0,a.up)("el-form"),v=(0,a.up)("el-divider"),_=(0,a.up)("el-table-column"),g=(0,a.up)("el-table"),w=(0,a.up)("el-alert"),k=(0,a.up)("el-button"),y=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(y,{class:"m-design-task",width:l.isPhone?"95%":"600px","model-value":i.modelValue,onClose:s.close,title:"快捷推送","append-to-body":""},{footer:(0,a.w5)((()=>[(0,a.Wm)(k,{onClick:s.close},{default:(0,a.w5)((()=>e[6]||(e[6]=[(0,a.Uk)("取 消")]))),_:1},8,["onClick"]),(0,a.Wm)(k,{type:"primary",onClick:s.onConfirm},{default:(0,a.w5)((()=>e[7]||(e[7]=[(0,a.Uk)("确 定")]))),_:1},8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)(f,{model:l.form,ref:"form","label-position":l.isPhone?"top":"left","label-width":"80px"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{label:"标题"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:l.form.title,"onUpdate:modelValue":e[0]||(e[0]=t=>l.form.title=t),placeholder:"请输入标题"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"类型"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{modelValue:l.form.type,"onUpdate:modelValue":e[1]||(e[1]=t=>l.form.type=t),placeholder:"请选择类型",style:{width:"100%"},filterable:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.config,(t=>((0,a.wg)(),(0,a.j4)(u,{key:t.id,label:t.label,value:t.name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"版本"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{modelValue:l.form.version,"onUpdate:modelValue":e[2]||(e[2]=t=>l.form.version=t)},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.versions,((t,e)=>((0,a.wg)(),(0,a.j4)(p,{key:e,label:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(t),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"备注"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{modelValue:l.form.remark,"onUpdate:modelValue":e[3]||(e[3]=t=>l.form.remark=t),placeholder:"请输入备注"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(d,{label:"星级",class:"m-star-line"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{modelValue:l.form.star,"onUpdate:modelValue":e[4]||(e[4]=t=>l.form.star=t),colors:l.colors},null,8,["modelValue","colors"])])),_:1})])),_:1},8,["model","label-position"]),(0,a.Wm)(v,{"content-position":"left"},{default:(0,a.w5)((()=>e[5]||(e[5]=[(0,a.Uk)(" 近期推送 ")]))),_:1}),l.logs&&l.logs.length?((0,a.wg)(),(0,a.j4)(g,{key:0,data:l.logs,border:"",size:"small","max-height":"300px"},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{label:"推送时间",prop:"push_at",align:"center"},{default:(0,a.w5)((({row:t})=>[(0,a.Uk)((0,n.zw)(s.formatTime(t.push_at)),1)])),_:1}),(0,a.Wm)(_,{label:"推送人",prop:"pusher.display_name",align:"center"}),(0,a.Wm)(_,{label:"星级",prop:"star",align:"center"},{default:(0,a.w5)((({row:t})=>[(0,a.Wm)(h,{modelValue:t.star,"onUpdate:modelValue":e=>t.star=e,disabled:"",colors:l.colors},null,8,["modelValue","onUpdate:modelValue","colors"])])),_:1}),(0,a.Wm)(_,{label:"备注",prop:"remark",align:"center"})])),_:1},8,["data"])):((0,a.wg)(),(0,a.j4)(w,{key:1,title:"当前文章暂无历史推送",type:"info","show-icon":"",closable:!1}))])),_:1},8,["width","model-value","onClose"])}var l=i(18371);const s=t=>(0,l.nj)().post("/api/cms/design/task",t),r=t=>(0,l.nj)().get("/api/cms/design/task/log",{params:t}),d=t=>(0,l.nj)().get("/api/cms/config/banner/types",{params:t});var u=i(96486),c=i(27484),p=i.n(c),m=i(49e3),h={name:"DesignTask",props:{modelValue:{type:Boolean,default:!1},post:{type:Object,default:()=>{}}},model:{prop:"modelValue",event:"update:modelValue"},emits:["update:modelValue"],data(){return{form:{title:"",remark:"",star:0,subtype:"",version:"std"},colors:["#99A9BF","#F7BA2A","#FF9900"],logs:[],config:[],isPhone:window.innerWidth<768,isEditor:m.Z.isEditor(),versions:{std:"剑三",origin:"缘起",wujie:"无界",test:"体服"}}},watch:{modelValue(t){t&&(this.post&&(this.form.title=this.post.post_title),this.loadLogs(),m.Z.isTeammate()&&this.loadConfig())}},methods:{close(){this.$emit("update:modelValue",!1)},clearForm(){this.form={title:"",remark:"",star:0,subtype:"",version:"std"},this.$refs?.form?.clearValidate()},onConfirm(){if(!this.post?.ID)return;const t=(0,u.pick)(this.post,["client","author"]);t.title=this.form.title,t.remark=this.form.remark,t.star=this.form.star,t.subtype=this.form.type,t.version=this.form.version,t.source_type=this.post?.post_type,t.source_id=String(this.post?.ID),t.link=`/${this.post?.post_type}/${this.post?.ID}`,t.flow=0,s(t).then((()=>{this.$message.success("提交成功"),this.close()}))},onCancel(){this.close(),this.clearForm()},loadLogs(){this.post?.ID&&r({source_id:this.post?.ID}).then((t=>{this.logs=t.data.data||[]}))},loadConfig(){d({_no_page:1}).then((t=>{this.config=t.data.data||[],this.config=this.config.filter((t=>1==t.parent_id))}))},formatTime(t){return p()(t).format("YYYY-MM-DD HH:mm:ss")}}},f=i(83744);const v=(0,f.Z)(h,[["render",o]]);var _=v},94150:function(t,e,i){i.d(e,{Z:function(){return g}});var a=i(66252),n=i(3577);const o={class:"w-thx"},l={class:"w-thx-panel"};function s(t,e,i,s,r,d){const u=(0,a.up)("boxcoin-admin"),c=(0,a.up)("Like"),p=(0,a.up)("fav"),m=(0,a.up)("boxcoin-user"),h=(0,a.up)("el-tooltip"),f=(0,a.up)("BoxcoinRecords"),v=(0,a.up)("el-drawer");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",l,[t.hasRight&&i.adminBoxcoinEnable&&t.boxcoin_enable?((0,a.wg)(),(0,a.j4)(u,{key:0,postId:i.postId,postType:i.postType,userId:i.userId,max:t.admin_max,min:t.admin_min,own:t.admin_left,total:t.admin_total,points:t.admin_points,authors:i.authors,onUpdateRecord:d.updateRecord,client:i.client},null,8,["postId","postType","userId","max","min","own","total","points","authors","onUpdateRecord","client"])):(0,a.kq)("",!0),(0,a.Wm)(c,{postId:i.postId,postType:i.postType},null,8,["postId","postType"]),(0,a.Wm)(p,{postId:i.postId,postType:i.postType,postTitle:i.postTitle},null,8,["postId","postType","postTitle"]),i.userBoxcoinEnable&&t.boxcoin_enable&&i.allowGift?((0,a.wg)(),(0,a.j4)(m,{key:1,postId:i.postId,postType:i.postType,boxcoin:t.boxcoin,userId:i.userId,own:t.user_left,points:t.user_points,authors:i.authors,onUpdateRecord:d.updateRecord,client:i.client},null,8,["postId","postType","boxcoin","userId","own","points","authors","onUpdateRecord","client"])):(0,a.kq)("",!0),(0,a.Wm)(h,{effect:"dark",content:"打赏记录",placement:"top-start"},{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.iD)("svg",{class:(0,n.C_)(["icon","u-record-icon"]),viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200","svg-inline":"",onClick:e[0]||(e[0]=(...t)=>d.onRecord&&d.onRecord(...t)),role:"presentation",focusable:"false",tabindex:"-1"},e[2]||(e[2]=[(0,a._)("path",{d:"M309.9 140.6h402.9c21.1 0 38.2-17.1 38.2-38.2s-17.1-38.2-38.2-38.2H309.9c-21.1 0-38.2 17.1-38.2 38.2s17.1 38.2 38.2 38.2z",fill:"#61D0ED"},null,-1),(0,a._)("path",{d:"M776.3 112.1c-4.7 30.5-30.8 54-62.7 54H309.1c-31.8 0-58-23.5-62.7-54-46.2 19.1-78.7 64.5-78.7 117.6v602.7c0 70.3 57 127.3 127.3 127.3h432.7c70.3 0 127.3-57 127.3-127.3V229.7c0-53.1-32.5-98.6-78.7-117.6zm-47.9 572.1h-434c-21.1 0-38.2-17.1-38.2-38.2s17.1-38.2 38.2-38.2h433.9c21.1 0 38.2 17.1 38.2 38.2s-17.1 38.2-38.1 38.2zm0-173h-434c-21.1 0-38.2-17.1-38.2-38.2s17.1-38.2 38.2-38.2h433.9c21.1 0 38.2 17.1 38.2 38.2s-17.1 38.2-38.1 38.2zm0-173h-434c-21.1 0-38.2-17.1-38.2-38.2s17.1-38.2 38.2-38.2h433.9c21.1 0 38.2 17.1 38.2 38.2s-17.1 38.2-38.1 38.2z",fill:"#61D0ED"},null,-1)])))])),_:1})]),(0,a.Wm)(v,{modelValue:t.showDrawer,"onUpdate:modelValue":e[1]||(e[1]=e=>t.showDrawer=e),title:"打赏记录","append-to-body":""},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{postId:i.postId,postType:i.postType,postClient:i.client,cacheRecord:t.cacheRecord,mode:i.mode,"onUpdate:boxcoin":d.updateBoxcoin},null,8,["postId","postType","postClient","cacheRecord","mode","onUpdate:boxcoin"])])),_:1},8,["modelValue"])])}var r=i(54430),d=i(62781),u=i(37723),c=i(49997),p=i(25129),m=i(49e3),h=i(50855),f={name:"SimpleThx",components:{Like:r.Z,Fav:d.Z,BoxcoinAdmin:u.Z,BoxcoinUser:c.Z,BoxcoinRecords:p.Z},props:{type:{type:String,default:"normal"},postId:{type:Number,default:0},postType:{type:String,default:""},postTitle:{type:String,default:""},userId:{type:Number,default:0},authors:{type:Array,default:()=>[]},mode:{type:String,default:"normal"},client:{type:String,default:"std"},allowGift:{type:[Number,Boolean],default:1},adminBoxcoinEnable:{type:Boolean,default:!1},userBoxcoinEnable:{type:Boolean,default:!1},presetConfig:{type:Object,default:()=>({})}},data:function(){return{boxcoin:0,hasRight:m.Z.getInfo().group>=32,user:m.Z.getInfo(),admin_max:0,admin_min:0,admin_left:0,admin_total:0,admin_points:[100],user_left:0,user_points:[100],cacheRecord:null,boxcoin_enable:0,showDrawer:!1}},computed:{post_keys:function(){return[this.postId,this.postType]}},watch:{post_keys:{immediate:!0,deep:!0,handler:function(){this.postType&&this.postId&&this.loadBoxcoinConfig()}}},methods:{loadBoxcoinConfig:function(){if(Object.keys(this.presetConfig)?.length)return this.admin_max=this.presetConfig.admin_max||0,this.admin_min=this.presetConfig.admin_min||0,this.admin_points=this.presetConfig.admin_points||[10,1e3],this.admin_left=this.presetConfig.admin_left||0,this.admin_total=this.presetConfig.admin_total||0,this.user_points=this.presetConfig.user_points||[10,1e3],this.user_left=this.presetConfig.user_left||0,void(this.boxcoin_enable=this.presetConfig.boxcoin_enable||0);m.Z.isLogin()&&(0,h.PD)(this.postType).then((t=>{this.admin_max=t.data.data.limit.admin_max||0,this.admin_min=t.data.data.limit.admin_min||0,this.admin_points=t.data.data.limit.admin_points||[10,1e3],this.admin_left=t.data.data.asManagerBoxCoinRemain||0,this.admin_total=t.data.data.asManagerBoxCoinTotal||0,this.user_points=t.data.data.limit.user_points||[10,1e3],"origin"==this.client?this.user_left=t.data.data.asUserBoxCoinRemainOrigin+t.data.data.asUserBoxCoinRemainAll:"std"==this.client?this.user_left=t.data.data.asUserBoxCoinRemainStd+t.data.data.asUserBoxCoinRemainAll:this.user_left=t.data.data.asUserBoxCoinRemainAll+t.data.data.asUserBoxCoinRemainStd+t.data.data.asUserBoxCoinRemainOrigin})),(0,h.hq)().then((t=>{this.boxcoin_enable=!!~~t.data?.data?.val}))},updateRecord:function(t){this.cacheRecord=t},onRecord:function(){this.showDrawer=!0},updateBoxcoin:function(t){this.boxcoin=t}}},v=i(83744);const _=(0,v.Z)(f,[["render",s]]);var g=_},60063:function(t){t.exports={mx:"pvp"}}}]);
//# sourceMappingURL=374.d7e0f4ed.js.map