"use strict";(self["webpackChunkpvp"]=self["webpackChunkpvp"]||[]).push([[912],{85117:function(e,t,i){var n=i(66330),l=TypeError;e.exports=function(e,t){if(!delete e[t])throw l("Cannot delete property "+n(t)+" of "+n(e))}},30541:function(e,t,i){var n=i(82109),l=i(47908),a=i(26244),s=i(83658),o=i(85117),r=i(7207),u=1!==[].unshift(0),d=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}},c=u||!d();n({target:"Array",proto:!0,arity:1,forced:c},{unshift:function(e){var t=l(this),i=a(t),n=arguments.length;if(n){r(i+n);var u=i;while(u--){var d=u+n;u in t?t[d]=t[u]:o(t,d)}for(var c=0;c<n;c++)t[c]=arguments[c]}return s(t,i+n)}})},1703:function(e,t,i){i.r(t),i.d(t,{default:function(){return _i}});var n=i(66252);const l=e=>((0,n.dD)("data-v-a893537e"),e=e(),(0,n.Cn)(),e),a=l((()=>(0,n._)("h1",{class:"u-header"},"绝境战场",-1))),s={class:"m-cj-content"};function o(e,t,i,l,o,r){const u=(0,n.up)("CJIndex"),d=(0,n.up)("CJExtra"),c=(0,n.up)("MapLayout");return(0,n.wg)(),(0,n.j4)(c,null,{default:(0,n.w5)((()=>[a,(0,n._)("div",s,[(0,n.Wm)(u),(0,n.Wm)(d)])])),_:1})}const r={class:"m-main"};function u(e,t,i,l,a,s){const o=(0,n.up)("Header"),u=(0,n.up)("el-button"),d=(0,n.up)("Info"),c=(0,n.up)("Breadcrumb"),p=(0,n.up)("Nav"),m=(0,n.up)("LeftSidebar"),g=(0,n.up)("Footer"),h=(0,n.up)("Main");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(o),(0,n.Wm)(c,{name:"绝境战场",slug:"pvp",root:"/pvp",publishEnable:!0,adminEnable:!1,feedbackEnable:!0,crumbEnable:!0},(0,n.Nv)({default:(0,n.w5)((()=>[(0,n.Wm)(d)])),_:2},[s.isEditor?{name:"op-append",fn:(0,n.w5)((()=>[(0,n.Wm)(u,{class:"u-admin-btn",type:"primary",icon:"Setting",onClick:s.toggleReview},{default:(0,n.w5)((()=>[(0,n.Uk)("管理")])),_:1},8,["onClick"])])),key:"0"}:void 0]),1024),(0,n.Wm)(m,null,{default:(0,n.w5)((()=>[(0,n.Wm)(p,{class:"m-nav"})])),_:1}),(0,n.Wm)(h,{withoutRight:!i.hasRight},{default:(0,n.w5)((()=>[(0,n._)("div",r,[(0,n.WI)(e.$slots,"default",{},void 0,!0)]),(0,n.Wm)(g)])),_:3},8,["withoutRight"])])}var d=i(20062),c=i(21118),p=i(24239),m=i(49e3);const g=(0,p.o)();var h={name:"App",props:{hasRight:{type:Boolean,default:!0}},data:function(){return{}},computed:{client(){return(0,p.o)().client},isEditor(){return m.Z.isEditor()}},methods:{onQQClick(e){navigator.clipboard.writeText(e).then((()=>{this.$notify({title:"复制成功",message:"内容："+e,type:"success"})}))},toggleReview(){g.reviewVisible=!g.reviewVisible}},components:{Info:d.Z,Nav:c.Z}},y=i(83744);const v=(0,y.Z)(h,[["render",u],["__scopeId","data-v-2fb11a95"]]);var k=v,_=i(3577),w=i(49963);const f={class:"m-map-op"},b={class:"m-select"},x={class:"m-legends"},C=(0,n._)("label",{class:"u-label"},"全部",-1),P=[C],D=["onClick"],M=["src","alt"],I={class:"u-op"},V=["src"],z=(0,n._)("span",null,"新增",-1),W=(0,n._)("span",null,"编辑",-1),S=(0,n._)("span",null,"评论",-1),L=(0,n._)("span",{class:"u-success"},"通过",-1),j=(0,n._)("span",{class:"u-danger"},"拒绝",-1),R=(0,n._)("span",{class:"u-danger"},"删除",-1),q=(0,n._)("span",{class:"u-danger"},"弃用",-1),T=["src"],U={class:"m-points"},$=["src","alt","custom-data","onClick"],N={class:"u-header"},Z={class:"u-info"},E=["src","alt"],F={class:"u-content"},H={key:0,class:"u-footer"},J={key:1,class:"u-footer u-footer-info"},O={class:"u-user"},Y=["src","alt"],B=["href"],K={class:"u-time"},A=["src","alt","custom-data","onClick"],Q={key:3,class:"m-paths"},X=["src"],G={class:"m-footer"};function ee(e,t,i,l,a,s){const o=(0,n.up)("el-option"),r=(0,n.up)("el-select"),u=(0,n.up)("el-tooltip"),d=(0,n.up)("el-checkbox"),c=(0,n.up)("CirclePlus"),p=(0,n.up)("el-icon"),m=(0,n.up)("Edit"),g=(0,n.up)("ChatDotRound"),h=(0,n.up)("CircleCheck"),y=(0,n.up)("CircleClose"),v=(0,n.up)("Delete"),k=(0,n.up)("Remove"),C=(0,n.up)("el-tag"),ee=(0,n.up)("el-button"),te=(0,n.up)("el-popover"),ie=(0,n.up)("el-form-item"),ne=(0,n.up)("el-input"),le=(0,n.up)("el-form"),ae=(0,n.up)("el-dialog"),se=(0,n.up)("review-point"),oe=(0,n.up)("PointComment"),re=(0,n.Q2)("loading");return(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",{class:"m-map-index",onClick:t[19]||(t[19]=(...e)=>s.cancelRightMenu&&s.cancelRightMenu(...e))},[(0,n._)("div",f,[(0,n._)("div",b,[(0,n.Wm)(r,{style:{width:"120px"},modelValue:a.map,"onUpdate:modelValue":t[0]||(t[0]=e=>a.map=e),onChange:s.mapChange},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.maps,(e=>((0,n.wg)(),(0,n.j4)(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])]),(0,n._)("div",x,[(0,n._)("div",{class:(0,_.C_)(["u-legend",!this.legend&&"is-active"]),onClick:t[1]||(t[1]=e=>a.legend="")},P,2),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.legends,(e=>((0,n.wg)(),(0,n.iD)("div",{class:(0,_.C_)(["u-legend",e.value===this.legend&&"is-active"]),key:e.value,onClick:t=>s.setLegend(e)},[(0,n.Wm)(u,{effect:"light",content:e.label,placement:"top"},{default:(0,n.w5)((()=>[(0,n._)("img",{class:"u-legend__img",src:e.src,"svg-inline":"",alt:e.label},null,8,M)])),_:2},1032,["content"])],10,D)))),128))]),(0,n._)("div",I,[(0,n.Wm)(d,{class:"u-mode",modelValue:a.isEditMode,"onUpdate:modelValue":t[2]||(t[2]=e=>a.isEditMode=e),disabled:!s.isLogin,border:"",label:"编辑模式"},null,8,["modelValue","disabled"])])]),a.map?((0,n.wg)(),(0,n.iD)("div",{key:0,ref:"map",class:(0,_.C_)(["m-map",a.isEditMode&&"is-point"]),onContextmenu:t[13]||(t[13]=(0,w.iM)(((...e)=>s.showMenu&&s.showMenu(...e)),["prevent"]))},[(0,n._)("img",{class:"u-map",src:s.getMapImage(a.map)},null,8,V),a.contextMenuVisible?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"u-context-menu",style:(0,_.j5)({top:a.contextMenuPosition.y+"px",left:a.contextMenuPosition.x+"px"})},[(0,n._)("ul",null,[(0,n._)("li",{onClick:t[3]||(t[3]=e=>s.menuItemClicked("add"))},[(0,n.Wm)(p,{size:"16"},{default:(0,n.w5)((()=>[(0,n.Wm)(c)])),_:1}),z])])],4)):(0,n.kq)("",!0),a.pointMenuVisible?((0,n.wg)(),(0,n.iD)("div",{key:1,class:"u-context-menu",style:(0,_.j5)({top:a.contextMenuPosition.y+"px",left:a.contextMenuPosition.x+"px"})},[(0,n._)("ul",null,[a.currentRightClickPoint.id&&a.currentRightClickPoint.belongToMe?((0,n.wg)(),(0,n.iD)("li",{key:0,onClick:t[4]||(t[4]=e=>s.toEdit(null))},[(0,n.Wm)(p,{size:"16"},{default:(0,n.w5)((()=>[(0,n.Wm)(m)])),_:1}),W])):(0,n.kq)("",!0),a.currentRightClickPoint.id&&1===a.currentRightClickPoint.status?((0,n.wg)(),(0,n.iD)("li",{key:1,onClick:t[5]||(t[5]=e=>s.toOpenComment(null))},[(0,n.Wm)(p,{size:"16"},{default:(0,n.w5)((()=>[(0,n.Wm)(g)])),_:1}),S])):(0,n.kq)("",!0),s.isEditor&&a.currentRightClickPoint.id&&1!==a.currentRightClickPoint.status?((0,n.wg)(),(0,n.iD)("li",{key:2,onClick:t[6]||(t[6]=e=>s.toReview(1))},[(0,n.Wm)(p,{size:"16"},{default:(0,n.w5)((()=>[(0,n.Wm)(h)])),_:1}),L])):(0,n.kq)("",!0),s.isEditor&&a.currentRightClickPoint.id&&0===a.currentRightClickPoint.status?((0,n.wg)(),(0,n.iD)("li",{key:3,onClick:t[7]||(t[7]=e=>s.toReview(2))},[(0,n.Wm)(p,{size:"16"},{default:(0,n.w5)((()=>[(0,n.Wm)(y)])),_:1}),j])):(0,n.kq)("",!0),a.currentRightClickPoint.id&&a.currentRightClickPoint.belongToMe?((0,n.wg)(),(0,n.iD)("li",{key:4,onClick:t[8]||(t[8]=e=>s.toDel(a.currentRightClickPoint.id))},[(0,n.Wm)(p,{size:"16"},{default:(0,n.w5)((()=>[(0,n.Wm)(v)])),_:1}),R])):(0,n.kq)("",!0),s.isEditor&&a.currentRightClickPoint.id&&1===a.currentRightClickPoint.status?((0,n.wg)(),(0,n.iD)("li",{key:5,onClick:t[9]||(t[9]=e=>s.toReview(0))},[(0,n.Wm)(p,{size:"16"},{default:(0,n.w5)((()=>[(0,n.Wm)(k)])),_:1}),q])):(0,n.kq)("",!0)])],4)):(0,n.kq)("",!0),!a.pointForm.id&&a.legend&&(!a.pointMenuVisible&&a.contextMenuVisible||a.showDialog)?((0,n.wg)(),(0,n.iD)("img",{key:2,class:"u-point__0",src:s.getPointInfo(a.legend),style:(0,_.j5)({top:a.contextMenuPosition.y-a.legendSize+"px",left:a.contextMenuPosition.x-a.legendSize/2+"px"})},null,12,T)):(0,n.kq)("",!0),(0,n._)("div",U,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.showPoints,(e=>((0,n.wg)(),(0,n.iD)("div",{class:(0,_.C_)(["u-point",[e.belongToMe?"is-my-point":"",e.isMark?"is-mark":""]]),key:e.id,style:(0,_.j5)({width:a.legendSize+"px",height:a.legendSize+"px",top:e.point.y-a.legendSize+"px",left:e.point.x-a.legendSize/2+"px"})},[e.id===a.visiblePopId?((0,n.wg)(),(0,n.j4)(te,{key:0,placement:"top",width:210,trigger:"manual",content:e.desc,visible:s.visiblePop,"onUpdate:visible":t[11]||(t[11]=e=>s.visiblePop=e),"popper-class":"u-point-pop"},{reference:(0,n.w5)((()=>[(0,n._)("img",{class:"u-point__img",style:(0,_.j5)({width:a.legendSize+"px",height:a.legendSize+"px"}),src:e.pointImg,alt:e.pointName,"custom-data":JSON.stringify({id:e.id,status:e.status,belongToMe:e.belongToMe}),onClick:t=>s.handlerPop(e.id),onContextmenu:t[10]||(t[10]=(0,w.iM)(((...e)=>s.showMenu&&s.showMenu(...e)),["prevent","stop"]))},null,44,$)])),default:(0,n.w5)((()=>[(0,n._)("div",N,[(0,n._)("div",Z,[(0,n._)("img",{src:e.pointImg,alt:e.pointName},null,8,E),(0,n._)("span",{class:(0,_.C_)(["u-title",`u-legend__${e.meta.type}`])},(0,_.zw)(e.pointName),3)]),e.belongToMe?((0,n.wg)(),(0,n.j4)(C,{key:0,size:"small",type:1===e.status?"success":2===e.status?"danger":""},{default:(0,n.w5)((()=>[(0,n.Uk)((0,_.zw)(a.statusMap[e.status]),1)])),_:2},1032,["type"])):((0,n.wg)(),(0,n.j4)(ee,{key:1,size:"small",plain:"",icon:"ChatDotRound",onClick:t=>s.toOpenComment(e)},{default:(0,n.w5)((()=>[(0,n.Uk)("评论")])),_:2},1032,["onClick"]))]),(0,n._)("div",F,(0,_.zw)(e.desc),1),e.belongToMe?((0,n.wg)(),(0,n.iD)("div",H,[(0,n.Wm)(ee,{size:"small",type:"primary",onClick:t=>s.toEdit(e)},{default:(0,n.w5)((()=>[(0,n.Uk)("编辑")])),_:2},1032,["onClick"]),(0,n.Wm)(ee,{size:"small",type:"danger",onClick:t=>s.toDel(e.id)},{default:(0,n.w5)((()=>[(0,n.Uk)("删除")])),_:2},1032,["onClick"]),1===e.status?((0,n.wg)(),(0,n.j4)(ee,{key:0,size:"small",plain:"",icon:"ChatDotRound",onClick:t=>s.toOpenComment(e)},{default:(0,n.w5)((()=>[(0,n.Uk)("评论")])),_:2},1032,["onClick"])):(0,n.kq)("",!0)])):((0,n.wg)(),(0,n.iD)("div",J,[(0,n._)("div",O,[(0,n._)("img",{class:"u-avatar",src:e.avatar,alt:e.name},null,8,Y),(0,n._)("a",{href:s.authorLink(e.post_author),target:"_blank"},(0,_.zw)(e.name),9,B)]),(0,n._)("div",K,(0,_.zw)(s.formatTime(e.updated_at)),1)]))])),_:2},1032,["content","visible"])):((0,n.wg)(),(0,n.iD)("img",{key:1,class:"u-point__img",style:(0,_.j5)({width:a.legendSize+"px",height:a.legendSize+"px"}),src:e.pointImg,alt:e.pointName,"custom-data":JSON.stringify({id:e.id,status:e.status,belongToMe:e.belongToMe}),onClick:t=>s.handlerPop(e.id),onContextmenu:t[12]||(t[12]=(0,w.iM)(((...e)=>s.showMenu&&s.showMenu(...e)),["prevent","stop"]))},null,44,A))],6)))),128))]),a.map&&s.paths.length?((0,n.wg)(),(0,n.iD)("div",Q,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.paths,(e=>((0,n.wg)(),(0,n.iD)("img",{class:(0,_.C_)(["u-path",`u-path__${e.key}`]),style:(0,_.j5)({left:e.x+70+"px",top:e.y+40+"px"}),key:e.key,src:e.url},null,14,X)))),128))])):(0,n.kq)("",!0)],34)):(0,n.kq)("",!0),a.showDialog?((0,n.wg)(),(0,n.j4)(ae,{key:1,modelValue:a.showDialog,"onUpdate:modelValue":t[16]||(t[16]=e=>a.showDialog=e),title:s.dialogTitle,"append-to-body":"",width:"560",class:"m-desert-point-pop"},{footer:(0,n.w5)((()=>[(0,n._)("div",G,[(0,n.Wm)(ee,{onClick:s.onCancel},{default:(0,n.w5)((()=>[(0,n.Uk)("取消")])),_:1},8,["onClick"]),(0,n.Wm)(ee,{type:"primary",loading:a.btnLoading,onClick:s.onConfirm},{default:(0,n.w5)((()=>[(0,n.Uk)("保存")])),_:1},8,["loading","onClick"])])])),default:(0,n.w5)((()=>[(0,n.Wm)(le,{ref:"pointForm",class:"m-desert-form",model:a.pointForm,rules:a.rules,"label-position":"right","label-width":"60"},{default:(0,n.w5)((()=>[(0,n.Wm)(ie,{label:"类型",prop:"type"},{default:(0,n.w5)((()=>[(0,n.Wm)(r,{modelValue:a.pointForm.type,"onUpdate:modelValue":t[14]||(t[14]=e=>a.pointForm.type=e),style:{width:"100%"},onChange:s.legendChange},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.legends,(e=>((0,n.wg)(),(0,n.j4)(o,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,n.Wm)(ie,{label:"短评",prop:"desc"},{default:(0,n.w5)((()=>[(0,n.Wm)(ne,{type:"textarea",modelValue:a.pointForm.desc,"onUpdate:modelValue":t[15]||(t[15]=e=>a.pointForm.desc=e),rows:4,maxlength:"50","show-word-limit":""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])):(0,n.kq)("",!0),a.map?((0,n.wg)(),(0,n.j4)(se,{key:2,visible:s.reviewVisible,"onUpdate:visible":t[17]||(t[17]=e=>s.reviewVisible=e),map:a.map,onInit:s.initData,onMark:s.toMark},null,8,["visible","map","onInit","onMark"])):(0,n.kq)("",!0),a.commentVisible&&a.commentPoint.id?((0,n.wg)(),(0,n.j4)(oe,{key:3,point:a.commentPoint,visible:a.commentVisible,"onUpdate:visible":t[18]||(t[18]=e=>a.commentVisible=e)},null,8,["point","visible"])):(0,n.kq)("",!0)])),[[re,a.loading]])}i(57658),i(30541);var te=i(2262);const ie={class:"m-review-points"},ne={class:"u-header"},le={class:"u-title"},ae=["src","alt"],se={class:"u-op"},oe={class:"u-content"},re={class:"u-user"},ue=["src","alt"],de={class:"u-time"},ce={class:"m-footer"};function pe(e,t,i,l,a,s){const o=(0,n.up)("el-tag"),r=(0,n.up)("el-button"),u=(0,n.up)("el-popconfirm"),d=(0,n.up)("map-location"),c=(0,n.up)("el-icon"),p=(0,n.up)("el-pagination"),m=(0,n.up)("el-drawer");return(0,n.wg)(),(0,n.j4)(m,{title:"标点审核",modelValue:s.drawer,"onUpdate:modelValue":t[1]||(t[1]=e=>s.drawer=e),"append-to-body":"","destroy-on-close":"","modal-class":"m-review-drawer"},{footer:(0,n.w5)((()=>[(0,n._)("div",ce,[(0,n.Wm)(r,{onClick:s.onClose},{default:(0,n.w5)((()=>[(0,n.Uk)("取消")])),_:1},8,["onClick"])])])),default:(0,n.w5)((()=>[(0,n._)("div",ie,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.list,(e=>((0,n.wg)(),(0,n.iD)("div",{class:"u-point-item",key:e.id},[(0,n._)("div",ne,[(0,n._)("div",le,[(0,n._)("img",{src:e.pointImg,alt:e.pointName},null,8,ae),(0,n._)("span",null,(0,_.zw)(e.pointName),1),(0,n.Wm)(o,{size:"small"},{default:(0,n.w5)((()=>[(0,n.Uk)("待审核")])),_:1})]),(0,n._)("div",se,[(0,n.Wm)(r,{size:"small",icon:"MapLocation",onClick:t=>s.toMark(e)},{default:(0,n.w5)((()=>[(0,n.Uk)("标记")])),_:2},1032,["onClick"]),(0,n.Wm)(u,{title:"确定通过该短评吗？",hideIcon:"",onConfirm:t=>s.toReview(e.id,1)},{reference:(0,n.w5)((()=>[(0,n.Wm)(r,{type:"success",size:"small"},{default:(0,n.w5)((()=>[(0,n.Uk)("通过")])),_:1})])),_:2},1032,["onConfirm"]),(0,n.Wm)(u,{title:"确定拒绝该短评吗？",hideIcon:"",onConfirm:t=>s.toReview(e.id,2)},{reference:(0,n.w5)((()=>[(0,n.Wm)(r,{type:"danger",size:"small"},{default:(0,n.w5)((()=>[(0,n.Uk)("拒绝")])),_:1})])),_:2},1032,["onConfirm"])])]),(0,n._)("div",oe,[(0,n.Uk)((0,_.zw)(e.desc)+" ",1),(0,n._)("span",null,[(0,n.Wm)(c,null,{default:(0,n.w5)((()=>[(0,n.Wm)(d)])),_:1}),(0,n._)("b",null,"("+(0,_.zw)(e.point.x)+","+(0,_.zw)(e.point.y)+")",1)])]),(0,n._)("div",re,[(0,n.Uk)(" By: "),(0,n._)("img",{class:"u-avatar",src:e.avatar,alt:e.name},null,8,ue),(0,n._)("span",null,(0,_.zw)(e.name),1)]),(0,n._)("div",de,"UpdatedAt: "+(0,_.zw)(s.formatTime(e.updated_at)),1)])))),128))]),(0,n.Wm)(p,{class:"m-pagination",background:"","page-size":a.per,layout:"prev, pager, next",total:a.total,"current-page":a.page,"onUpdate:currentPage":t[0]||(t[0]=e=>a.page=e),small:"","hide-on-single-page":"",onCurrentChange:s.load},null,8,["page-size","total","current-page","onCurrentChange"])])),_:1},8,["modelValue"])}var me=i(69876),ge=i(18371),he=i(89847),ye=i(6154);function ve(){return ye.Z.get(he.__imgPath+"map/data/map_index.json")}function ke(e){let t={type:"bps",tag:"PVP",topic:"吃鸡"};return e&&(t=Object.assign(t,e)),(0,ge.nj)().get("/api/cms/posts",{params:t})}function _e(e){return(0,ge.qT)().get("/desert/list",{params:e})}function we(e){return(0,ge.nj)().get("/api/cms/app/desert/point",{params:e})}function fe(e){return(0,ge.nj)().get("/api/cms/app/desert/point/my",{params:e})}function be(e){return(0,ge.nj)().get("/api/cms/app/desert/point/unaudited",{params:e})}function xe(e){return(0,ge.nj)().post("/api/cms/app/desert/point",e)}function Ce(e){return(0,ge.nj)().delete(`/api/cms/app/desert/point/${e}`)}function Pe(e,t){return(0,ge.nj)().put(`/api/cms/app/desert/point/${t}`,e)}function De(e,t=1){return(0,ge.nj)().put(`/api/cms/app/desert/point/${e}/admin`,{status:t})}var Me=i(27484),Ie=i.n(Me);const Ve=function(e){return Ie()(e).format("YYYY-MM-DD hh:mm:ss")},ze=[{label:"路线建议",value:"path",src:i(83723)},{label:"大量物资",value:"goods",src:i(93565)},{label:"少量物资",value:"small_goods",src:i(47614)},{label:"马匪刷新",value:"monster",src:i(42406)},{label:"洞穴入口",value:"cave",src:i(77324)}],We={0:"待审核",1:"已通过",2:"已拒绝"};function Se(e,t="src"){var n;const l=e?null===(n=ze.find((t=>t.value===e)))||void 0===n?void 0:n[t]:"";let a=i(83723);return"value"===t&&(a="path"),"label"===t&&(a="路线建议"),l||a}var Le={name:"ReviewPoint",props:{visible:{type:Boolean,default:!1},map:{type:Number,required:!0}},emits:["update:visible","init","mark"],data(){return{loading:!1,list:[],per:6,page:1,total:0,legends:(0,te.Xl)(ze)}},computed:{...(0,me.rn)(p.o,["client"]),drawer:{get(){return this.visible},set(e){this.$emit("update:visible",e)}}},watch:{drawer:{immediate:!0,handler(e){e&&this.load()}}},methods:{formatTime:Ve,getPointInfo:Se,toReview(e,t){this.loading=!0,De(e,t).then((()=>{this.$message({type:"success",message:(1===t?"审核通过":"审核拒绝")+"成功"}),this.load(),this.$emit("init")})).finally((()=>{this.loading=!1}))},toMark(e){this.$emit("mark",{...e,isMark:!0})},load(){const e={client:this.client,map:this.map,per:this.per,page:this.page};this.loading=!0,be(e).then((e=>{var t,i,n,l;const a=(null===(t=e.data)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.list)||[];this.list=a.map((e=>{var t,i;return{...e,avatar:e.point_author_info.user_avatar||m.Z.anonymous.avatar_origin,name:e.point_author_info.display_name,pointImg:this.getPointInfo(null===(t=e.meta)||void 0===t?void 0:t.type),pointName:this.getPointInfo(null===(i=e.meta)||void 0===i?void 0:i.type,"label")}})),this.total=(null===(n=e.data)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.total)||0}))},onClose(){this.drawer=!1}}};const je=(0,y.Z)(Le,[["render",pe]]);var Re=je;const qe={class:"m-point-content"},Te={class:"u-header"},Ue={class:"u-info"},$e=["src","alt"],Ne={class:"u-title"},Ze={class:"u-content"},Ee={class:"dialog-footer"};function Fe(e,t,i,l,a,s){const o=(0,n.up)("el-divider"),r=(0,n.up)("Comment"),u=(0,n.up)("el-button"),d=(0,n.up)("el-dialog");return(0,n.wg)(),(0,n.j4)(d,{title:s.title,class:"m-point-comment__dialog",width:"90%","destroy-on-close":"","close-on-click-modal":!1,modelValue:s.dialogVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>s.dialogVisible=e),"before-close":s.handleClose},{footer:(0,n.w5)((()=>[(0,n._)("span",Ee,[(0,n.Wm)(u,{onClick:t[0]||(t[0]=e=>s.dialogVisible=!1)},{default:(0,n.w5)((()=>[(0,n.Uk)("取 消")])),_:1})])])),default:(0,n.w5)((()=>[(0,n._)("div",qe,[(0,n._)("div",Te,[(0,n._)("div",Ue,[(0,n._)("img",{src:i.point.pointImg,alt:i.point.pointName},null,8,$e),(0,n._)("span",Ne,(0,_.zw)(i.point.pointName),1)])]),(0,n._)("div",Ze,(0,_.zw)(i.point.desc),1)]),(0,n.Wm)(o,{"content-position":"left"},{default:(0,n.w5)((()=>[(0,n.Uk)("评论")])),_:1}),(0,n.Wm)(r,{id:s.id,category:"desert"},null,8,["id"])])),_:1},8,["title","modelValue","before-close"])}var He=i(13815),Je={name:"PointComment",props:{visible:{type:Boolean,default:!1},point:{type:Object,required:!0}},emits:["update:visible"],components:{Comment:He.Z},computed:{...(0,me.rn)(p.o,["client"]),title(){return"评论"},id(){return~~this.point.id},dialogVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}}},methods:{handleClose(){this.dialogVisible=!1}}};const Oe=(0,y.Z)(Je,[["render",Fe]]);var Ye=Oe,Be=JSON.parse('[{"mapId":296,"name":"龙门绝境","paths":[{"key":"1_x653_y140","x":653,"y":140},{"key":"2_x150_y92","x":150,"y":92},{"key":"3_x139_y214","x":139,"y":214},{"key":"4_x162_y550","x":162,"y":550},{"key":"5_x176_y542","x":176,"y":542},{"key":"6_x247_y79","x":247,"y":79},{"key":"7_x151_y365","x":151,"y":365},{"key":"8_x390_y77","x":390,"y":77},{"key":"9_x217_y79","x":217,"y":79},{"key":"10_x113_y224","x":113,"y":224}]},{"mapId":297,"name":"龙门绝境·夜","paths":[{"key":"1_x653_y140","x":653,"y":140},{"key":"2_x150_y92","x":150,"y":92},{"key":"3_x139_y214","x":139,"y":214},{"key":"4_x162_y550","x":162,"y":550},{"key":"5_x176_y542","x":176,"y":542},{"key":"6_x247_y79","x":247,"y":79},{"key":"7_x151_y365","x":151,"y":365},{"key":"8_x390_y77","x":390,"y":77},{"key":"9_x217_y79","x":217,"y":79},{"key":"10_x113_y224","x":113,"y":224}]},{"mapId":410,"name":"沧溟绝境","paths":[{"key":"a1_x144_y81","x":144,"y":81},{"key":"a2_x153_y206","x":153,"y":206},{"key":"a3_x216_y293","x":216,"y":293},{"key":"a4_x393_y143","x":393,"y":143},{"key":"a5_x502_y69","x":502,"y":69},{"key":"a6_x171_y471 ","x":171,"y":471},{"key":"a7_x151_y264","x":151,"y":264},{"key":"a8_x401_y135","x":401,"y":135},{"key":"a9_x138_y445","x":138,"y":445},{"key":"a10_x188_y118","x":188,"y":118}]},{"mapId":512,"name":"白龙绝境","paths":[{"key":"b1","x":150,"y":92},{"key":"b2","x":462,"y":97},{"key":"b3","x":145,"y":130},{"key":"b4","x":115,"y":420},{"key":"b5","x":530,"y":90},{"key":"b6","x":145,"y":125}]},{"mapId":532,"name":"天原绝境","paths":[{"key":"c1","x":120,"y":75},{"key":"c2","x":70,"y":275},{"key":"c3","x":-30,"y":20}]},{"mapId":645,"name":"天原绝境","paths":[{"key":"cr1","x":258,"y":204},{"key":"cr2","x":238,"y":258},{"key":"cr3","x":164,"y":488},{"key":"cr4","x":220,"y":395},{"key":"cr5","x":320,"y":320},{"key":"cr6","x":235,"y":280}]}]'),Ke=i(96486),Ae=i(17233);const Qe=(0,p.o)();var Xe={name:"CJIndex",components:{ReviewPoint:Re,PointComment:Ye},data(){return{loading:!1,maps:[],map:null,mapPath:(0,te.Xl)(Be),imgRoot:he.__imgPath+"pve/desert/",pointMenuVisible:!1,contextMenuVisible:!1,contextMenuPosition:{x:0,y:0},showDialog:!1,originMyPoints:[],myPoints:[],points:[],legend:"",legendSize:30,legends:(0,te.Xl)(ze),statusMap:(0,te.Xl)(We),pointForm:{point:{},type:"",desc:"",client:(0,p.o)().client},rules:{type:[{required:!0,message:"请选择类型",trigger:"change"}],desc:[{required:!0,message:"请输入短评",trigger:"blur"}]},btnLoading:!1,visiblePopId:null,statusFilter:"",markPoints:[],currentRightClickPoint:{},commentVisible:!1,commentPoint:{},isEditMode:!1}},computed:{reviewVisible:{get(){return Qe.reviewVisible},set(e){Qe.reviewVisible=e}},isLogin(){return m.Z.isLogin()},isEditor(){return m.Z.isEditor()},dialogTitle(){var e;return null!==(e=this.pointForm)&&void 0!==e&&e.id?"编辑标点":"新增标点"},visiblePop:{get(){return!!this.visiblePopId},set(e){this.visiblePopId=e}},paths(){var e;const t=(null===(e=this.mapPath.find((e=>e.mapId===this.map)))||void 0===e?void 0:e.paths)||[];return t.length?t.map((e=>({...e,url:`${this.imgRoot}${297===this.map?296:this.map}/${e.key}.png`}))):t},showPoints(){const e=this.myPoints.filter((e=>1!==e.status)).concat(this.points,this.markPoints).filter((e=>!this.legend||e.meta.type===this.legend)).map((e=>{var t,i,n;return{...e,avatar:e.point_author_info.user_avatar||m.Z.anonymous.avatar_origin,name:e.point_author_info.display_name,belongToMe:~~(null===m.Z||void 0===m.Z||null===(t=m.Z.profile)||void 0===t?void 0:t.uid)===e.user_id,pointImg:this.getPointInfo(null===(i=e.meta)||void 0===i?void 0:i.type),pointName:this.getPointInfo(null===(n=e.meta)||void 0===n?void 0:n.type,"label"),post_author:e.user_id}}));return e}},watch:{reviewVisible(e){e||(this.markPoints=[],this.myPoints=this.myPoints.map((e=>(e.isMark=!1,e))))},isEditMode(e){e||this.cancelRightMenu()}},methods:{authorLink:Ae.authorLink,getLegendSrc(){var e;return this.legend&&(null===(e=this.legends.find((e=>e.value===this.legend)))||void 0===e?void 0:e.src)||""},toReview(e){const{id:t}=this.currentRightClickPoint;let i="通过";2===e&&(i="拒绝"),0===e&&(i="弃用"),this.$confirm(`确定要${i}该短评吗？`,"温馨提示",{confirmButtonText:`立即${void 0!==e?i:"删除"}`,cancelButtonText:"取消",type:"warning"}).then((()=>{this.loading=!0,De(t,e).then((()=>{this.$message({type:"success",message:i+"成功"}),this.initData()})).finally((()=>{this.loading=!1}))})).catch((()=>{}))},cancelRightMenu(){this.pointMenuVisible=!1,this.contextMenuVisible=!1},toOpenComment(e){if(e)this.commentPoint=e;else{const e=this.currentRightClickPoint;if(1!==e.status)return this.$message({type:"warning",message:"当前标点尚未审核通过"});this.commentPoint=this.showPoints.find((t=>t.id===e.id))}this.commentVisible=!0},toMark(e){const t=this.myPoints.findIndex((t=>t.id===e.id));var i;if(-1!==t)return void(this.myPoints[t].isMark=!(null!==(i=this.myPoints[t])&&void 0!==i&&i.isMark));const n=this.markPoints.findIndex((t=>t.id===e.id));-1===n?this.markPoints.push(e):this.markPoints.splice(n,1)},formatTime:Ve,mapChange(){this.statusFilter="",this.initData()},statusChange(e){this.myPoints=e?this.originMyPoints.filter((t=>t.status===~~e)):this.originMyPoints},handlerPop(e){this.visiblePopId===e?this.visiblePopId=null:this.visiblePopId=e},getPointInfo:Se,setLegend(e){this.legend===e.value?this.legend="":this.legend=e.value},legendChange(e){this.pointForm.id||(this.legend=e)},showMenu(e){e.preventDefault();const t=this.$refs.map.getBoundingClientRect();if(this.contextMenuPosition={x:e.clientX-t.left,y:e.clientY-t.top},"u-point__img"===e.target.className){const t=e.target.getAttribute("custom-data")?JSON.parse(e.target.getAttribute("custom-data")):{};return this.currentRightClickPoint=t,this.pointMenuVisible=!0,!1}this.pointMenuVisible=!1,this.isEditMode&&(this.contextMenuVisible=!0)},menuItemClicked(e){if("add"===e){if(!m.Z.isLogin())return this.$message({type:"warning",message:"请先登录"});this.pointForm.type=this.legend,this.showDialog=!0}this.cancelRightMenu()},async getMapList(){const e=sessionStorage.getItem("cj_maps");if(e){var t;const i=JSON.parse(e);this.maps=i,this.map=(null===i||void 0===i||null===(t=i[0])||void 0===t?void 0:t.value)||null}else{var i;const e=await ve(),{data:t}=e,n=[];for(let i in t)t[i].indexOf("绝境")>-1&&n.push({label:t[i],value:~~i});sessionStorage.setItem("cj_maps",JSON.stringify(n)),this.maps=n,this.map=(null===n||void 0===n||null===(i=n[0])||void 0===i?void 0:i.value)||null}},getMapImage(e){return`${he.__imgPath}map/maps/map_${e}_0.png`},getPoints(){const e={client:(0,p.o)().client,map:this.map};we(e).then((e=>{var t;this.points=(null===(t=e.data)||void 0===t?void 0:t.data)||[]}))},getMyPoints(e){if(!m.Z.isLogin())return;const t={client:(0,p.o)().client,map:this.map};void 0===e&&null===e||(t.status=e),fe(t).then((e=>{var t;const i=(null===(t=e.data)||void 0===t?void 0:t.data)||[];this.myPoints=i.map((e=>{var t,i;return{...e,pointImg:this.getPointInfo(null===(t=e.meta)||void 0===t?void 0:t.type),pointName:this.getPointInfo(null===(i=e.meta)||void 0===i?void 0:i.type,"label")}})),this.originMyPoints=(0,Ke.cloneDeep)(this.myPoints)}))},savePoint(){let e=(0,Ke.cloneDeep)(this.pointForm);e.meta={type:e.type},delete e.type;const t=this.pointForm.id;t?(e=(0,Ke.pick)(e,["map","point","meta","desc","client","status"]),e.status=0):(e.map=this.map,e.point=this.contextMenuPosition),this.btnLoading=!0;const i=t?Pe(e,t):xe(e);i.then((i=>{this.handlerPoint(t?{...e,id:t}:i.data.data,t)})).finally((()=>{this.btnLoading=!1}))},handlerPoint(e,t){var i,n;this.$notify({title:"成功",message:(t?"修改":"添加")+"成功，等待审核中...",type:"success"});const l={...e,pointImg:this.getPointInfo(null===(i=e.meta)||void 0===i?void 0:i.type),pointName:this.getPointInfo(null===(n=e.meta)||void 0===n?void 0:n.type,"label"),point_author_info:{user_avatar:m.Z.profile.avatar_origin,display_name:m.Z.profile.name}};if(t){const e=this.myPoints.findIndex((e=>e.id===t));this.myPoints.splice(e,1,l)}else this.myPoints.unshift(l);this.originMyPoints=(0,Ke.cloneDeep)(this.myPoints),this.legend="",this.onClose()},toEdit(e){e||(e=this.myPoints.find((e=>e.id===this.currentRightClickPoint.id))),this.visiblePopId=null,this.legend="",this.pointForm={...(0,Ke.cloneDeep)(e),type:e.meta.type},this.showDialog=!0},toDel(e){this.visiblePopId=null,this.$confirm("确定要删除该短评吗？删除后不可恢复。","温馨提示",{confirmButtonText:"立即删除",cancelButtonText:"取消",type:"warning"}).then((()=>{Ce(e).then((()=>{this.myPoints=this.myPoints.filter((t=>t.id!==e)),this.originMyPoints=(0,Ke.cloneDeep)(this.myPoints),this.$notify({title:"成功",message:"删除成功",type:"success"})}))})).catch((()=>{}))},onCancel(){this.onClose()},onClose(){this.$refs.pointForm.clearValidate(),this.pointForm={point:{},meta:{type:"path"},desc:"",client:(0,p.o)().client},this.showDialog=!1},onConfirm(){this.$refs.pointForm.validate(((e,t)=>{e?this.savePoint():console.log("error submit!",t)}))},initData(){this.getPoints(),this.getMyPoints()}},mounted(){console.log(m.Z),this.getMapList(),this.initData()}};const Ge=(0,y.Z)(Xe,[["render",ee]]);var et=Ge;const tt={class:"m-cj-extra"},it=(0,n._)("b",null,"技能查询",-1),nt=(0,n._)("b",null,"吃鸡攻略",-1);function lt(e,t,i,l,a,s){const o=(0,n.up)("Files"),r=(0,n.up)("el-icon"),u=(0,n.up)("CJSkill"),d=(0,n.up)("el-tab-pane"),c=(0,n.up)("Collection"),p=(0,n.up)("CJStrategy"),m=(0,n.up)("el-tabs");return(0,n.wg)(),(0,n.iD)("div",tt,[(0,n.Wm)(m,{class:"m-tabs m-extra-tabs",modelValue:a.view,"onUpdate:modelValue":t[0]||(t[0]=e=>a.view=e),onTabClick:s.handleClick},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{label:"技能查询",name:"skill"},{label:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(o)])),_:1}),it])),default:(0,n.w5)((()=>["skill"===a.view?((0,n.wg)(),(0,n.j4)(u,{key:0})):(0,n.kq)("",!0)])),_:1}),(0,n.Wm)(d,{label:"攻略",name:"strategy"},{label:(0,n.w5)((()=>[(0,n.Wm)(r,null,{default:(0,n.w5)((()=>[(0,n.Wm)(c)])),_:1}),nt])),default:(0,n.w5)((()=>["strategy"===a.view?((0,n.wg)(),(0,n.j4)(p,{key:0})):(0,n.kq)("",!0)])),_:1})])),_:1},8,["modelValue","onTabClick"])])}const at={class:"m-cj-strategy"},st={key:0,class:"m-strategy-list"};function ot(e,t,i,l,a,s){const o=(0,n.up)("ListItem"),r=(0,n.up)("el-alert"),u=(0,n.up)("el-button"),d=(0,n.up)("el-pagination"),c=(0,n.Q2)("loading");return(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",at,[a.list.length?((0,n.wg)(),(0,n.iD)("div",st,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.list,(e=>((0,n.wg)(),(0,n.j4)(o,{key:e.post_id,item:e,order:s.params.order},null,8,["item","order"])))),128))])):((0,n.wg)(),(0,n.j4)(r,{key:1,class:"m-strategy-null",title:"没有找到相关条目",type:"info",center:"","show-icon":""})),(0,n.wy)((0,n.Wm)(u,{class:"m-strategy-more",type:"primary",onClick:s.appendPage,loading:a.loading,icon:"el-icon-arrow-down"},{default:(0,n.w5)((()=>[(0,n.Uk)("加载更多")])),_:1},8,["onClick","loading"]),[[w.F8,s.hasNextPage]]),(0,n.Wm)(d,{class:"m-strategy-pages",background:"",layout:"total, prev, pager, next","hide-on-single-page":!0,total:a.total,"current-page":a.page,onCurrentChange:s.changePage},null,8,["total","current-page","onCurrentChange"])])),[[c,a.loading]])}const rt={class:"u-item"},ut=["href","target"],dt=["src"],ct={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 12 16",width:"12",height:"16","aria-hidden":"true",fill:"#555",class:(0,_.C_)("u-icon"),"svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"},pt=(0,n._)("path",{"fill-rule":"evenodd",d:"M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"},null,-1),mt=[pt],gt=["href","target"],ht={key:0,class:"u-marks"},yt={class:"u-content u-desc"},vt={key:0,class:"u-metalist u-boss-list"},kt=(0,n._)("strong",null,"首领",-1),_t=["onClick"],wt={key:1,class:"u-metalist u-mode-list c-jx3fb-mode"},ft=(0,n._)("strong",null,"模式",-1),bt={class:"u-misc"},xt=["src","alt"],Ct=["href"],Pt={class:"u-date"},Dt={key:0},Mt={key:1};function It(e,t,i,l,a,s){return(0,n.wg)(),(0,n.iD)("div",rt,[(0,n._)("a",{class:"u-banner",href:s.postLink(i.item.ID),target:e.target},[((0,n.wg)(),(0,n.iD)("img",{src:s.getBanner(i.item),key:i.item.ID},null,8,dt))],8,ut),(0,n._)("h2",{class:(0,_.C_)(["u-post",{isSticky:i.item.sticky}])},[((0,n.wg)(),(0,n.iD)("svg",ct,mt)),(0,n._)("a",{class:"u-title",style:(0,_.j5)(s.showHighlight(i.item.color)),href:s.postLink(i.item.ID),target:e.target},(0,_.zw)(i.item.post_title||"无标题"),13,gt),i.item.mark&&i.item.mark.length?((0,n.wg)(),(0,n.iD)("span",ht,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.item.mark,(e=>((0,n.wg)(),(0,n.iD)("i",{class:"u-mark",key:e},(0,_.zw)(s.showMark(e)),1)))),128))])):(0,n.kq)("",!0)],2),(0,n._)("div",yt,[i.item.post_meta&&i.item.post_meta.fb_boss?((0,n.wg)(),(0,n.iD)("div",vt,[kt,(0,n._)("em",null,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(s.format(i.item,"fb_boss"),((e,t)=>((0,n.wg)(),(0,n.iD)("b",{key:t,onClick:t=>s.addTopic(e)},(0,_.zw)(e),9,_t)))),128))])])):(0,n.kq)("",!0),i.item.post_meta&&i.item.post_meta.fb_level?((0,n.wg)(),(0,n.iD)("div",wt,[ft,(0,n._)("em",null,(0,_.zw)(s.format(i.item,"fb_level").join("、")),1)])):(0,n.kq)("",!0)]),(0,n._)("div",bt,[(0,n._)("img",{class:"u-author-avatar",src:s.showAvatar(i.item.author_info),alt:s.showNickname(i.item.author_info)},null,8,xt),(0,n._)("a",{class:"u-author-name",href:s.authorLink(i.item.post_author),target:"_blank"},(0,_.zw)(s.showNickname(i.item.author_info)),9,Ct),(0,n._)("span",Pt,[(0,n.Uk)(" Updated on "),"update"==i.order?((0,n.wg)(),(0,n.iD)("time",Dt,(0,_.zw)(s.dateFormat(i.item.post_modified)),1)):((0,n.wg)(),(0,n.iD)("time",Mt,(0,_.zw)(s.dateFormat(i.item.post_date)),1))])])])}var Vt=i(23910),zt=i(26060),Wt={name:"ListItem",props:["item","order","caller"],components:{},data:function(){return{target:(0,Ae.buildTarget)()}},computed:{client(){var e;return null===(e=this.item)||void 0===e?void 0:e.client},rootLink(){return"std"!==this.client?he.__OriginRoot:he.__Root}},watch:{},methods:{getBanner:function(e){return e.post_banner?(0,Ae.showBanner)(e.post_banner):he.__imgPath+"image/fb_map_thumbnail/null.png"},format:function(e,t){var i;let n=null===e||void 0===e||null===(i=e.post_meta)||void 0===i?void 0:i[t];return n&&n.length?n:["-"]},addTopic(e){this.$router.push({query:{topic:e}})},postLink(e){return`${this.rootLink}bps/${e}`},authorLink:Ae.authorLink,showHighlight(e){return e?`color:${e};font-weight:600;`:""},showMark:function(e){return Vt.I[e]||e},showAvatar:function(e){return(0,Ae.showAvatar)(null===e||void 0===e?void 0:e.user_avatar)},showNickname:function(e){return(null===e||void 0===e?void 0:e.display_name)||"匿名"},dateFormat:function(e){return(0,zt.s2)(new Date(e))}}};const St=(0,y.Z)(Wt,[["render",It]]);var Lt=St,jt={name:"CJStrategy",components:{ListItem:Lt},data(){return{page:1,pages:1,per:10,total:0,loading:!1,list:[]}},computed:{hasNextPage:function(){return this.pages>1&&this.page<this.pages},params(){return{page:this.page,per:this.per}},query(){return{subtype:this.$route.query.subtype,client:(0,p.o)().client,order:"update"}}},watch:{query:{deep:!0,handler:function(){this.page=1,this.load()}}},methods:{load(e=!1){const t={...(0,Ke.cloneDeep)(this.params),...(0,Ke.cloneDeep)(this.query)};t.subtype?t.sticky=1:delete t.subtype,this.loading=!0,ke(t).then((t=>{var i,n,l,a,s,o,r,u;e?this.list=this.list.concat(null===(s=t.data)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.list):this.list=null===(r=t.data)||void 0===r||null===(u=r.data)||void 0===u?void 0:u.list;this.total=null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.total,this.pages=null===(l=t.data)||void 0===l||null===(a=l.data)||void 0===a?void 0:a.pages})).finally((()=>{this.loading=!1}))},changePage(e){this.page=e,this.load()},appendPage(){this.page++,this.load(!0)}},mounted(){this.load()}};const Rt=(0,y.Z)(jt,[["render",ot]]);var qt=Rt;const Tt={class:"m-cj-skill"},Ut={class:"m-search"},$t={key:0,class:"m-skill-list"},Nt=(0,n._)("div",{class:"u-skill-item"},[(0,n._)("div",{class:"u-td"},"技能名称"),(0,n._)("div",{class:"u-td"},"品质"),(0,n._)("div",{class:"u-td"},"效果")],-1),Zt={key:1,class:"u-no-data"};function Et(e,t,i,l,a,s){const o=(0,n.up)("el-option"),r=(0,n.up)("el-select"),u=(0,n.up)("el-input"),d=(0,n.up)("SkillItem"),c=(0,n.Q2)("loading");return(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",Tt,[(0,n._)("div",Ut,[(0,n.Wm)(r,{modelValue:a.quality,"onUpdate:modelValue":t[0]||(t[0]=e=>a.quality=e)},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.qualities,(e=>((0,n.wg)(),(0,n.j4)(o,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,n.Wm)(r,{modelValue:a.skillType,"onUpdate:modelValue":t[1]||(t[1]=e=>a.skillType=e)},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.types,(e=>((0,n.wg)(),(0,n.j4)(o,{key:e.value,value:e.value,label:e.label},null,8,["value","label"])))),128))])),_:1},8,["modelValue"]),(0,n.Wm)(u,{modelValue:a.search,"onUpdate:modelValue":t[2]||(t[2]=e=>a.search=e),placeholder:"请输入 技能名称 查询",clearable:""},null,8,["modelValue"])]),a.list.length?((0,n.wg)(),(0,n.iD)("div",$t,[Nt,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.list,((e,t)=>((0,n.wg)(),(0,n.j4)(d,{source:e,key:e.dwSkillID+t},null,8,["source"])))),128))])):((0,n.wg)(),(0,n.iD)("div",Zt,"暂无技能"))])),[[c,a.loading]])}const Ft={class:"u-skill-item"},Ht={class:"u-td"},Jt={class:"u-skill-icon"},Ot=["src"],Yt={key:0,class:"u-item-name"},Bt={class:"u-td"},Kt={class:"u-td"};function At(e,t,i,l,a,s){var o,r;const u=(0,n.up)("jx3-skill"),d=(0,n.up)("el-popover");return(0,n.wg)(),(0,n.iD)("div",Ft,[(0,n._)("div",Ht,[(0,n.Wm)(d,{class:"u-skill-popover",placement:"right-start",trigger:"hover","visible-arrow":!1,width:350},{reference:(0,n.w5)((()=>[(0,n._)("div",Jt,[(0,n._)("img",{src:s.iconLink(s.iconId||a.data.IconID,a.client),onClick:t[0]||(t[0]=(0,w.iM)((e=>s.getUrl(a.data.SkillID)),["stop"]))},null,8,Ot)])])),default:(0,n.w5)((()=>[(0,n.Wm)(u,{data:a.data},null,8,["data"])])),_:1}),null!==(o=i.source)&&void 0!==o&&null!==(r=o.Skill)&&void 0!==r&&r.Name?((0,n.wg)(),(0,n.iD)("div",Yt,(0,_.zw)(i.source.Skill.Name),1)):(0,n.kq)("",!0)]),(0,n._)("div",Bt,(0,_.zw)(i.source.szQualityDesc),1),(0,n._)("div",Kt,(0,_.zw)(i.source.szSkillTypeDesc),1)])}const Qt={key:0,class:"w-skill"},Xt={class:"w-skill-wrapper"},Gt=["src","alt"],ei={class:"w-skill-content"},ti={class:"w-skill-name"},ii={class:"w-skill-desc"},ni={class:"w-skill-meta"};function li(e,t,i,l,a,s){return i.data?((0,n.wg)(),(0,n.iD)("div",Qt,[(0,n._)("div",Xt,[(0,n._)("img",{class:"w-skill-icon",src:s.iconLink(i.data.IconID||13),alt:i.data.Name},null,8,Gt),(0,n._)("div",ei,[(0,n._)("span",ti,(0,_.zw)(i.data.Name),1),(0,n._)("span",ii,(0,_.zw)(i.data.Desc),1),(0,n._)("span",ni,"ID : "+(0,_.zw)(i.data.SkillID),1)])])])):(0,n.kq)("",!0)}var ai={name:"SkillInfo",props:["data"],computed:{},watch:{},methods:{iconLink:function(e){return(0,Ae.iconLink)(e,"std")}}};const si=(0,y.Z)(ai,[["render",li]]);var oi=si,ri={name:"SkillItem",props:{source:{type:Object,required:!0}},components:{Jx3Skill:oi},watch:{source:{immediate:!0,deep:!0,handler(e){this.data=e.Skill}}},computed:{iconId(){var e,t;return~~(null===(e=this.source)||void 0===e||null===(t=e.Skill)||void 0===t?void 0:t.IconID)||0},id(){var e,t;return~~(null===(e=this.source)||void 0===e||null===(t=e.Skill)||void 0===t?void 0:t.SkillID)||0}},data(){return{client:"origin",data:{}}},methods:{iconLink:Ae.iconLink,getUrl(e){const t=location.origin+"/",i=t+`app/database/?type=skill&client=${this.client}&query=${e}`;window.open(i,"_blank")}}};const ui=(0,y.Z)(ri,[["render",At]]);var di=ui,ci={name:"CJSkill",components:{SkillItem:di},data(){return{loading:!1,originList:[],list:[],allList:[],qualities:[],types:[],skillType:0,quality:0,search:""}},computed:{client(){return"origin"},params(){return{skillType:this.skillType,quality:this.quality,search:this.search}}},watch:{params:{deep:!0,handler(){this.quality||this.skillType||this.search?this.list=this.originList.filter((e=>(!this.quality||e.nQuality===this.quality)&&(!this.skillType||e.nSkillType===this.skillType)&&(!this.search||e.Skill.Name.indexOf(this.search)>-1))):this.list=this.originList}}},methods:{getTypes(){const e=this.allList,t=Array.from(new Set(e.map((e=>e.nSkillType)))),i=Array.from(new Set(e.map((e=>e.nQuality))));this.types=t.map((t=>{var i;return{label:null===(i=e.find((e=>e.nSkillType===t)))||void 0===i?void 0:i.szSkillTypeDesc,value:t}})),this.qualities=i.map((t=>{var i;return{label:null===(i=e.find((e=>e.nQuality===t)))||void 0===i?void 0:i.szQualityDesc,value:t}}))},async load(){this.loading=!0;const e=sessionStorage.getItem(`deserts_${this.client}`);e?(this.allList=JSON.parse(e),this.getTypes(),this.list=this.allList.filter((e=>e.dwSkillID)),this.loading=!1):await _e().then((e=>{this.allList=e.data.data,this.getTypes(),this.list=this.allList.filter((e=>e.dwSkillID)),sessionStorage.setItem(`deserts_${this.client}`,JSON.stringify(this.allList))})).finally((()=>{this.loading=!1})),this.originList=this.list}},mounted(){this.load()}};const pi=(0,y.Z)(ci,[["render",Et]]);var mi=pi,gi={name:"CJExtra",components:{CJStrategy:qt,CJSkill:mi},data(){return{view:"strategy"}},computed:{client(){return(0,p.o)().client}},methods:{handleClick(){}},mounted(){"origin"===this.client&&(this.view="skill")}};const hi=(0,y.Z)(gi,[["render",lt]]);var yi=hi,vi={name:"CJ",components:{MapLayout:k,CJIndex:et,CJExtra:yi},data:function(){return{}},computed:{},methods:{},mounted(){}};const ki=(0,y.Z)(vi,[["render",o],["__scopeId","data-v-a893537e"]]);var _i=ki},77324:function(e,t,i){e.exports=i.p+"img/cave.e8beb1ac.svg"},93565:function(e,t,i){e.exports=i.p+"img/goods.790b4798.svg"},42406:function(e,t,i){e.exports=i.p+"img/monster.a6192413.svg"},83723:function(e,t,i){e.exports=i.p+"img/path.f3250ff1.svg"},47614:function(e,t,i){e.exports=i.p+"img/small_goods.4201fc8a.svg"}}]);
//# sourceMappingURL=912.64d4504f.js.map