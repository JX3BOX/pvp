{"version":3,"file":"js/812.b80490f7.js","mappings":"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CA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,KAEJC,SAAU,CACN,IAAK,CAAC,KAAM,OAAQ,SAAU,SAAU,SAAU,SAAU,MAC5D,IAAK,CAAC,KAAM,OAAQ,SAAU,SAAU,SAAU,SAAU,MAC5D,IAAK,CAAC,KAAM,KAAM,KAAM,MACxB,IAAK,CAAC,KAAM,KAAM,KAAM,MACxB,IAAK,CAAC,KAAM,KAAM,OAClB,IAAK,CAAC,KAAM,KAAM,OAClB,IAAK,CAAC,KAAM,KAAM,MAClB,IAAK,CAAC,KAAM,KAAM,MAClB,IAAK,CAAC,KAAM,KAAM,MAAO,MAAO,KAAM,YAAa,YAAa,KAAM,MACtE,IAAK,CACD,KACA,KACA,MACA,MACA,KACA,YACA,YACA,KACA,KACA,QACA,QACA,OACA,OACA,QAEJ,IAAK,CACD,KACA,KACA,MACA,MACA,KACA,YACA,YACA,KACA,KACA,QACA,QACA,OACA,OACA,OACA,OACA,YACA,UAEJ,IAAK,CAAC,MAAO,MAAO,OAAQ,OAAQ,MACpC,IAAK,CAAC,MAAO,MAAO,OAAQ,OAAQ,MACpC,IAAK,CACD,KACA,KACA,MACA,KACA,QACA,MACA,MACA,KACA,cACA,MAEJ,IAAK,CACD,KACA,KACA,MACA,QACA,OACA,KACA,QACA,MACA,MACA,KACA,cACA,MAEJ,IAAK,CACD,KACA,KACA,MACA,QACA,OACA,KACA,QACA,MACA,MACA,KACA,cACA,KACA,QAEJ,IAAK,CAAC,KAAM,MAAO,MAAO,KAAM,MAChC,IAAK,CAAC,KAAM,MAAO,MAAO,KAAM,MAChC,IAAK,CACD,QACA,KACA,KACA,OACA,KACA,OACA,QACA,OACA,OACA,OACA,MACA,QACA,KACA,MACA,OACA,SAEJ,IAAK,CACD,QACA,KACA,KACA,OACA,KACA,OACA,QACA,OACA,OACA,OACA,MACA,QACA,KACA,MACA,OACA,KACA,QACA,SAEJ,IAAK,CACD,QACA,KACA,KACA,OACA,KACA,OACA,QACA,OACA,OACA,OACA,MACA,QACA,KACA,MACA,OACA,KACA,QACA,OACA,SAEJ,IAAK,CAAC,MAA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","sources":["webpack://pvp/./node_modules/core-js/internals/delete-property-or-throw.js","webpack://pvp/./node_modules/core-js/modules/es.array.unshift.js","webpack://pvp/./node_modules/fabric/dist/fabric.js","webpack://pvp/./node_modules/file-saver/dist/FileSaver.min.js","webpack://pvp/./node_modules/moment/moment.js","webpack://pvp/./src/components/jcl/common/jcl_header.vue","webpack://pvp/./src/components/jcl/common/jcl_header.vue?c89c","webpack://pvp/./src/assets/data/jcl/raid_constant.js","webpack://pvp/./src/utils/jcl/worker.js","webpack://pvp/./src/components/jcl/pve/header_tabs.vue","webpack://pvp/./src/components/jcl/pve/header_tabs.vue?d5ee","webpack://pvp/./src/components/jcl/pve/overview_info.vue","webpack://pvp/./src/components/jcl/pve/overview_info.vue?e42c","webpack://pvp/./node_modules/vue-echarts/node_modules/vue-demi/lib/index.mjs","webpack://pvp/./node_modules/vue-echarts/dist/index.js","webpack://pvp/./src/utils/jcl/common.js","webpack://pvp/./src/components/jcl/pve/overview_chart.vue","webpack://pvp/./src/components/jcl/pve/overview_chart.vue?e146","webpack://pvp/./src/utils/jcl/uses/usePaginate.js","webpack://pvp/./src/components/jcl/pve/overview_entity_list.vue","webpack://pvp/./src/components/jcl/pve/overview_entity_list.vue?7b2f","webpack://pvp/./src/components/jcl/common/empty_guide.vue","webpack://pvp/./src/components/jcl/common/empty_guide.vue?7ac5","webpack://pvp/./src/components/jcl/pve/overview_focus_list.vue","webpack://pvp/./src/components/jcl/pve/overview_focus_list.vue?630a","webpack://pvp/./src/components/jcl/pve/pve_overview.vue","webpack://pvp/./src/components/jcl/pve/header_bar.vue","webpack://pvp/./src/components/jcl/pve/header_bar.vue?4998","webpack://pvp/./node_modules/echarts/lib/component/title/install.js","webpack://pvp/./node_modules/echarts/lib/component/title.js","webpack://pvp/./node_modules/echarts/lib/chart/pie/pieLayout.js","webpack://pvp/./node_modules/echarts/lib/processor/dataFilter.js","webpack://pvp/./node_modules/echarts/lib/label/labelGuideHelper.js","webpack://pvp/./node_modules/echarts/lib/chart/pie/labelLayout.js","webpack://pvp/./node_modules/echarts/lib/chart/pie/PieView.js","webpack://pvp/./node_modules/echarts/lib/chart/helper/createSeriesDataSimply.js","webpack://pvp/./node_modules/echarts/lib/visual/LegendVisualProvider.js","webpack://pvp/./node_modules/echarts/lib/chart/pie/PieSeries.js","webpack://pvp/./node_modules/echarts/lib/processor/negativeDataFilter.js","webpack://pvp/./node_modules/echarts/lib/chart/pie/install.js","webpack://pvp/./src/components/jcl/pve/entity_card_chart.vue","webpack://pvp/./src/components/jcl/pve/entity_card_chart.vue?8750","webpack://pvp/./src/components/jcl/pve/detail_info.vue","webpack://pvp/./src/components/jcl/pve/detail_info.vue?29d2","webpack://pvp/./src/components/jcl/pve/entity_view_log.vue","webpack://pvp/./src/components/jcl/pve/entity_view_log.vue?d1db","webpack://pvp/./src/components/jcl/pve/entity_view_log_detail.vue","webpack://pvp/./src/components/jcl/pve/entity_view_log_detail.vue?029a","webpack://pvp/./src/components/jcl/pve/entity_view_effect.vue","webpack://pvp/./src/components/jcl/pve/entity_view_effect.vue?93f9","webpack://pvp/./src/components/jcl/pve/entity_skill_pie.vue","webpack://pvp/./src/components/jcl/pve/entity_skill_pie.vue?b69f","webpack://pvp/./src/components/jcl/common/canvas_timeline.vue","webpack://pvp/./src/components/jcl/common/canvas_timeline.vue?0c03","webpack://pvp/./src/components/jcl/pve/entity_skill_timeline.vue","webpack://pvp/./src/components/jcl/pve/entity_skill_timeline.vue?b0ef","webpack://pvp/./src/components/jcl/pve/entity_view_skill.vue","webpack://pvp/./src/components/jcl/pve/entity_view_skill.vue?5ce7","webpack://pvp/./src/components/jcl/pve/entity_buff_chart.vue","webpack://pvp/./src/components/jcl/pve/entity_buff_chart.vue?426b","webpack://pvp/./node_modules/lodash-es/_baseSortBy.js","webpack://pvp/./node_modules/lodash-es/_compareAscending.js","webpack://pvp/./node_modules/lodash-es/_compareMultiple.js","webpack://pvp/./node_modules/lodash-es/_baseOrderBy.js","webpack://pvp/./node_modules/lodash-es/sortBy.js","webpack://pvp/./src/components/jcl/pve/entity_buff_table.vue","webpack://pvp/./src/components/jcl/pve/entity_buff_table.vue?67cf","webpack://pvp/./src/components/jcl/pve/entity_view_buff.vue","webpack://pvp/./src/service/jcl/resource.js","webpack://pvp/./src/utils/jcl/format.js","webpack://pvp/./node_modules/js-base64/base64.mjs","webpack://pvp/./src/components/jcl/pve/player_qixue.vue","webpack://pvp/./src/components/jcl/pve/player_qixue.vue?a7b7","webpack://pvp/./src/components/jcl/pve/entity_view_chart.vue","webpack://pvp/./src/components/jcl/pve/entity_view_chart.vue?426d","webpack://pvp/./src/components/jcl/pve/detail_chart.vue","webpack://pvp/./src/components/jcl/pve/detail_chart.vue?7d0e","webpack://pvp/./src/components/jcl/pve/entity_select.vue","webpack://pvp/./src/components/jcl/pve/entity_select.vue?62e9","webpack://pvp/./src/components/jcl/pve/pve_detail.vue","webpack://pvp/./src/components/jcl/pve/pve_detail.vue?af02","webpack://pvp/./src/components/jcl/pve/compare_option.vue","webpack://pvp/./src/components/jcl/pve/compare_option.vue?0844","webpack://pvp/./src/components/jcl/pve/compare_card_chart.vue","webpack://pvp/./src/components/jcl/pve/compare_card_chart.vue?ecdd","webpack://pvp/./src/components/jcl/pve/compare_player_list.vue","webpack://pvp/./src/components/jcl/pve/compare_player_list.vue?c439","webpack://pvp/./src/components/jcl/pve/compare_effect_list.vue","webpack://pvp/./src/components/jcl/pve/compare_effect_list.vue?dead","webpack://pvp/./src/components/jcl/pve/pve_compare.vue","webpack://pvp/./src/components/jcl/pve/pve_compare.vue?dd9f","webpack://pvp/./src/components/jcl/common/jcl_entity.vue","webpack://pvp/./src/components/jcl/common/jcl_entity.vue?705a","webpack://pvp/./src/components/jcl/pve/blame_filters.vue","webpack://pvp/./src/components/jcl/pve/blame_filters.vue?64b4","webpack://pvp/./src/components/jcl/common/jcl_effect.vue","webpack://pvp/./src/components/jcl/common/jcl_effect.vue?21bc","webpack://pvp/./src/components/jcl/pve/blame_list.vue","webpack://pvp/./src/components/jcl/pve/blame_list.vue?455f","webpack://pvp/./src/components/jcl/pve/blame_index.vue","webpack://pvp/./src/components/jcl/pve/blame_index.vue?f85b","webpack://pvp/./src/components/jcl/pve/timeline_selector.vue","webpack://pvp/./src/components/jcl/pve/timeline_selector.vue?ad1f","webpack://pvp/./src/components/jcl/pve/boss_timeline_selector.vue","webpack://pvp/./src/components/jcl/pve/boss_timeline_selector.vue?481f","webpack://pvp/./src/components/jcl/export_dialog.vue","webpack://pvp/./src/components/jcl/export_dialog.vue?11a5","webpack://pvp/./src/components/jcl/pve/logs_filter.vue","webpack://pvp/./src/components/jcl/pve/logs_filter.vue?2361","webpack://pvp/./src/components/jcl/pve/logs_list.vue","webpack://pvp/./src/components/jcl/pve/logs_list.vue?7276","webpack://pvp/./src/components/jcl/pve/pve_logs.vue","webpack://pvp/./src/components/jcl/pve/pve_logs.vue?c842","webpack://pvp/./src/assets/data/jcl/buff_coverage_constant.js","webpack://pvp/./src/components/jcl/pve/team_buff_coverage.vue","webpack://pvp/./src/components/jcl/pve/team_buff_coverage.vue?ee58","webpack://pvp/./src/components/jcl/pve/individual_buff_coverage.vue","webpack://pvp/./src/components/jcl/pve/individual_buff_coverage.vue?d841","webpack://pvp/./src/components/jcl/pve/individual_buff_coverage_log.vue","webpack://pvp/./src/components/jcl/pve/individual_buff_coverage_log.vue?d42b","webpack://pvp/./src/components/jcl/pve/buff_coverage_main.vue","webpack://pvp/./src/views/jcl/Pve.vue","webpack://pvp/./src/views/jcl/Pve.vue?268d"],"sourcesContent":["'use strict';\nvar tryToString = require('../internals/try-to-string');\n\nvar $TypeError = TypeError;\n\nmodule.exports = function (O, P) {\n  if (!delete O[P]) throw $TypeError('Cannot delete property ' + tryToString(P) + ' of ' + tryToString(O));\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar setArrayLength = require('../internals/array-set-length');\nvar deletePropertyOrThrow = require('../internals/delete-property-or-throw');\nvar doesNotExceedSafeInteger = require('../internals/does-not-exceed-safe-integer');\n\n// IE8-\nvar INCORRECT_RESULT = [].unshift(0) !== 1;\n\n// V8 ~ Chrome < 71 and Safari <= 15.4, FF < 23 throws InternalError\nvar properErrorOnNonWritableLength = function () {\n  try {\n    // eslint-disable-next-line es/no-object-defineproperty -- safe\n    Object.defineProperty([], 'length', { writable: false }).unshift();\n  } catch (error) {\n    return error instanceof TypeError;\n  }\n};\n\nvar FORCED = INCORRECT_RESULT || !properErrorOnNonWritableLength();\n\n// `Array.prototype.unshift` method\n// https://tc39.es/ecma262/#sec-array.prototype.unshift\n$({ target: 'Array', proto: true, arity: 1, forced: FORCED }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  unshift: function unshift(item) {\n    var O = toObject(this);\n    var len = lengthOfArrayLike(O);\n    var argCount = arguments.length;\n    if (argCount) {\n      doesNotExceedSafeInteger(len + argCount);\n      var k = len;\n      while (k--) {\n        var to = k + argCount;\n        if (k in O) O[to] = O[k];\n        else deletePropertyOrThrow(O, to);\n      }\n      for (var j = 0; j < argCount; j++) {\n        O[j] = arguments[j];\n      }\n    } return setArrayLength(O, len + argCount);\n  }\n});\n","/* build: `node build.js modules=ALL exclude=gestures,accessors,erasing requirejs minifier=uglifyjs` */\n/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */\n\nvar fabric = fabric || { version: '5.4.2' };\nif (typeof exports !== 'undefined') {\n  exports.fabric = fabric;\n}\n/* _AMD_START_ */\nelse if (typeof define === 'function' && define.amd) {\n  define([], function() { return fabric; });\n}\n/* _AMD_END_ */\nif (typeof document !== 'undefined' && typeof window !== 'undefined') {\n  if (document instanceof (typeof HTMLDocument !== 'undefined' ? HTMLDocument : Document)) {\n    fabric.document = document;\n  }\n  else {\n    fabric.document = document.implementation.createHTMLDocument('');\n  }\n  fabric.window = window;\n}\nelse {\n  // assume we're running under node.js when document/window are not present\n  var jsdom = require('jsdom');\n  var virtualWindow = new jsdom.JSDOM(\n    decodeURIComponent('%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E'),\n    {\n      features: {\n        FetchExternalResources: ['img']\n      },\n      resources: 'usable'\n    }).window;\n  fabric.document = virtualWindow.document;\n  fabric.jsdomImplForWrapper = require('jsdom/lib/jsdom/living/generated/utils').implForWrapper;\n  fabric.nodeCanvas = require('jsdom/lib/jsdom/utils').Canvas;\n  fabric.window = virtualWindow;\n  DOMParser = fabric.window.DOMParser;\n}\n\n/**\n * True when in environment that supports touch events\n * @type boolean\n */\nfabric.isTouchSupported = 'ontouchstart' in fabric.window || 'ontouchstart' in fabric.document ||\n  (fabric.window && fabric.window.navigator && fabric.window.navigator.maxTouchPoints > 0);\n\n/**\n * True when in environment that's probably Node.js\n * @type boolean\n */\nfabric.isLikelyNode = typeof Buffer !== 'undefined' &&\n                      typeof window === 'undefined';\n\n/* _FROM_SVG_START_ */\n/**\n * Attributes parsed from all SVG elements\n * @type array\n */\nfabric.SHARED_ATTRIBUTES = [\n  'display',\n  'transform',\n  'fill', 'fill-opacity', 'fill-rule',\n  'opacity',\n  'stroke', 'stroke-dasharray', 'stroke-linecap', 'stroke-dashoffset',\n  'stroke-linejoin', 'stroke-miterlimit',\n  'stroke-opacity', 'stroke-width',\n  'id', 'paint-order', 'vector-effect',\n  'instantiated_by_use', 'clip-path',\n];\n/* _FROM_SVG_END_ */\n\n/**\n * Pixel per Inch as a default value set to 96. Can be changed for more realistic conversion.\n */\nfabric.DPI = 96;\nfabric.reNum = '(?:[-+]?(?:\\\\d+|\\\\d*\\\\.\\\\d+)(?:[eE][-+]?\\\\d+)?)';\nfabric.commaWsp = '(?:\\\\s+,?\\\\s*|,\\\\s*)';\nfabric.rePathCommand = /([-+]?((\\d+\\.\\d+)|((\\d+)|(\\.\\d+)))(?:[eE][-+]?\\d+)?)/ig;\nfabric.reNonWord = /[ \\n\\.,;!\\?\\-]/;\nfabric.fontPaths = { };\nfabric.iMatrix = [1, 0, 0, 1, 0, 0];\nfabric.svgNS = 'http://www.w3.org/2000/svg';\n\n/**\n * Pixel limit for cache canvases. 1Mpx , 4Mpx should be fine.\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.perfLimitSizeTotal = 2097152;\n\n/**\n * Pixel limit for cache canvases width or height. IE fixes the maximum at 5000\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.maxCacheSideLimit = 4096;\n\n/**\n * Lowest pixel limit for cache canvases, set at 256PX\n * @since 1.7.14\n * @type Number\n * @default\n */\nfabric.minCacheSideLimit = 256;\n\n/**\n * Cache Object for widths of chars in text rendering.\n */\nfabric.charWidthsCache = { };\n\n/**\n * if webgl is enabled and available, textureSize will determine the size\n * of the canvas backend\n * @since 2.0.0\n * @type Number\n * @default\n */\nfabric.textureSize = 2048;\n\n/**\n * When 'true', style information is not retained when copy/pasting text, making\n * pasted text use destination style.\n * Defaults to 'false'.\n * @type Boolean\n * @default\n */\nfabric.disableStyleCopyPaste = false;\n\n/**\n * Enable webgl for filtering picture is available\n * A filtering backend will be initialized, this will both take memory and\n * time since a default 2048x2048 canvas will be created for the gl context\n * @since 2.0.0\n * @type Boolean\n * @default\n */\nfabric.enableGLFiltering = true;\n\n/**\n * Device Pixel Ratio\n * @see https://developer.apple.com/library/safari/documentation/AudioVideo/Conceptual/HTML-canvas-guide/SettingUptheCanvas/SettingUptheCanvas.html\n */\nfabric.devicePixelRatio = fabric.window.devicePixelRatio ||\n                          fabric.window.webkitDevicePixelRatio ||\n                          fabric.window.mozDevicePixelRatio ||\n                          1;\n/**\n * Browser-specific constant to adjust CanvasRenderingContext2D.shadowBlur value,\n * which is unitless and not rendered equally across browsers.\n *\n * Values that work quite well (as of October 2017) are:\n * - Chrome: 1.5\n * - Edge: 1.75\n * - Firefox: 0.9\n * - Safari: 0.95\n *\n * @since 2.0.0\n * @type Number\n * @default 1\n */\nfabric.browserShadowBlurConstant = 1;\n\n/**\n * This object contains the result of arc to bezier conversion for faster retrieving if the same arc needs to be converted again.\n * It was an internal variable, is accessible since version 2.3.4\n */\nfabric.arcToSegmentsCache = { };\n\n/**\n * This object keeps the results of the boundsOfCurve calculation mapped by the joined arguments necessary to calculate it.\n * It does speed up calculation, if you parse and add always the same paths, but in case of heavy usage of freedrawing\n * you do not get any speed benefit and you get a big object in memory.\n * The object was a private variable before, while now is appended to the lib so that you have access to it and you\n * can eventually clear it.\n * It was an internal variable, is accessible since version 2.3.4\n */\nfabric.boundsOfCurveCache = { };\n\n/**\n * If disabled boundsOfCurveCache is not used. For apps that make heavy usage of pencil drawing probably disabling it is better\n * @default true\n */\nfabric.cachesBoundsOfCurve = true;\n\n/**\n * Skip performance testing of setupGLContext and force the use of putImageData that seems to be the one that works best on\n * Chrome + old hardware. if your users are experiencing empty images after filtering you may try to force this to true\n * this has to be set before instantiating the filtering backend ( before filtering the first image )\n * @type Boolean\n * @default false\n */\nfabric.forceGLPutImageData = false;\n\nfabric.initFilterBackend = function() {\n  if (fabric.enableGLFiltering && fabric.isWebglSupported && fabric.isWebglSupported(fabric.textureSize)) {\n    console.log('max texture size: ' + fabric.maxTextureSize);\n    return (new fabric.WebglFilterBackend({ tileSize: fabric.textureSize }));\n  }\n  else if (fabric.Canvas2dFilterBackend) {\n    return (new fabric.Canvas2dFilterBackend());\n  }\n};\n\n\nif (typeof document !== 'undefined' && typeof window !== 'undefined') {\n  // ensure globality even if entire library were function wrapped (as in Meteor.js packaging system)\n  window.fabric = fabric;\n}\n\n\n(function() {\n\n  /**\n   * @private\n   * @param {String} eventName\n   * @param {Function} handler\n   */\n  function _removeEventListener(eventName, handler) {\n    if (!this.__eventListeners[eventName]) {\n      return;\n    }\n    var eventListener = this.__eventListeners[eventName];\n    if (handler) {\n      eventListener[eventListener.indexOf(handler)] = false;\n    }\n    else {\n      fabric.util.array.fill(eventListener, false);\n    }\n  }\n\n  /**\n   * Observes specified event\n   * @memberOf fabric.Observable\n   * @alias on\n   * @param {String|Object} eventName Event name (eg. 'after:render') or object with key/value pairs (eg. {'after:render': handler, 'selection:cleared': handler})\n   * @param {Function} handler Function that receives a notification when an event of the specified type occurs\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function on(eventName, handler) {\n    if (!this.__eventListeners) {\n      this.__eventListeners = { };\n    }\n    // one object with key/value pairs was passed\n    if (arguments.length === 1) {\n      for (var prop in eventName) {\n        this.on(prop, eventName[prop]);\n      }\n    }\n    else {\n      if (!this.__eventListeners[eventName]) {\n        this.__eventListeners[eventName] = [];\n      }\n      this.__eventListeners[eventName].push(handler);\n    }\n    return this;\n  }\n\n  function _once(eventName, handler) {\n    var _handler = function () {\n      handler.apply(this, arguments);\n      this.off(eventName, _handler);\n    }.bind(this);\n    this.on(eventName, _handler);\n  }\n\n  function once(eventName, handler) {\n    // one object with key/value pairs was passed\n    if (arguments.length === 1) {\n      for (var prop in eventName) {\n        _once.call(this, prop, eventName[prop]);\n      }\n    }\n    else {\n      _once.call(this, eventName, handler);\n    }\n    return this;\n  }\n\n  /**\n   * Stops event observing for a particular event handler. Calling this method\n   * without arguments removes all handlers for all events\n   * @memberOf fabric.Observable\n   * @alias off\n   * @param {String|Object} eventName Event name (eg. 'after:render') or object with key/value pairs (eg. {'after:render': handler, 'selection:cleared': handler})\n   * @param {Function} handler Function to be deleted from EventListeners\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function off(eventName, handler) {\n    if (!this.__eventListeners) {\n      return this;\n    }\n\n    // remove all key/value pairs (event name -> event handler)\n    if (arguments.length === 0) {\n      for (eventName in this.__eventListeners) {\n        _removeEventListener.call(this, eventName);\n      }\n    }\n    // one object with key/value pairs was passed\n    else if (arguments.length === 1 && typeof arguments[0] === 'object') {\n      for (var prop in eventName) {\n        _removeEventListener.call(this, prop, eventName[prop]);\n      }\n    }\n    else {\n      _removeEventListener.call(this, eventName, handler);\n    }\n    return this;\n  }\n\n  /**\n   * Fires event with an optional options object\n   * @memberOf fabric.Observable\n   * @param {String} eventName Event name to fire\n   * @param {Object} [options] Options object\n   * @return {Self} thisArg\n   * @chainable\n   */\n  function fire(eventName, options) {\n    if (!this.__eventListeners) {\n      return this;\n    }\n\n    var listenersForEvent = this.__eventListeners[eventName];\n    if (!listenersForEvent) {\n      return this;\n    }\n\n    for (var i = 0, len = listenersForEvent.length; i < len; i++) {\n      listenersForEvent[i] && listenersForEvent[i].call(this, options || { });\n    }\n    this.__eventListeners[eventName] = listenersForEvent.filter(function(value) {\n      return value !== false;\n    });\n    return this;\n  }\n\n  /**\n   * @namespace fabric.Observable\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#events}\n   * @see {@link http://fabricjs.com/events|Events demo}\n   */\n  fabric.Observable = {\n    fire: fire,\n    on: on,\n    once: once,\n    off: off,\n  };\n})();\n\n\n/**\n * @namespace fabric.Collection\n */\nfabric.Collection = {\n\n  _objects: [],\n\n  /**\n   * Adds objects to collection, Canvas or Group, then renders canvas\n   * (if `renderOnAddRemove` is not `false`).\n   * in case of Group no changes to bounding box are made.\n   * Objects should be instances of (or inherit from) fabric.Object\n   * Use of this function is highly discouraged for groups.\n   * you can add a bunch of objects with the add method but then you NEED\n   * to run a addWithUpdate call for the Group class or position/bbox will be wrong.\n   * @param {...fabric.Object} object Zero or more fabric instances\n   * @return {Self} thisArg\n   * @chainable\n   */\n  add: function () {\n    this._objects.push.apply(this._objects, arguments);\n    if (this._onObjectAdded) {\n      for (var i = 0, length = arguments.length; i < length; i++) {\n        this._onObjectAdded(arguments[i]);\n      }\n    }\n    this.renderOnAddRemove && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Inserts an object into collection at specified index, then renders canvas (if `renderOnAddRemove` is not `false`)\n   * An object should be an instance of (or inherit from) fabric.Object\n   * Use of this function is highly discouraged for groups.\n   * you can add a bunch of objects with the insertAt method but then you NEED\n   * to run a addWithUpdate call for the Group class or position/bbox will be wrong.\n   * @param {Object} object Object to insert\n   * @param {Number} index Index to insert object at\n   * @param {Boolean} nonSplicing When `true`, no splicing (shifting) of objects occurs\n   * @return {Self} thisArg\n   * @chainable\n   */\n  insertAt: function (object, index, nonSplicing) {\n    var objects = this._objects;\n    if (nonSplicing) {\n      objects[index] = object;\n    }\n    else {\n      objects.splice(index, 0, object);\n    }\n    this._onObjectAdded && this._onObjectAdded(object);\n    this.renderOnAddRemove && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Removes objects from a collection, then renders canvas (if `renderOnAddRemove` is not `false`)\n   * @param {...fabric.Object} object Zero or more fabric instances\n   * @return {Self} thisArg\n   * @chainable\n   */\n  remove: function() {\n    var objects = this._objects,\n        index, somethingRemoved = false;\n\n    for (var i = 0, length = arguments.length; i < length; i++) {\n      index = objects.indexOf(arguments[i]);\n\n      // only call onObjectRemoved if an object was actually removed\n      if (index !== -1) {\n        somethingRemoved = true;\n        objects.splice(index, 1);\n        this._onObjectRemoved && this._onObjectRemoved(arguments[i]);\n      }\n    }\n\n    this.renderOnAddRemove && somethingRemoved && this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Executes given function for each object in this group\n   * @param {Function} callback\n   *                   Callback invoked with current object as first argument,\n   *                   index - as second and an array of all objects - as third.\n   *                   Callback is invoked in a context of Global Object (e.g. `window`)\n   *                   when no `context` argument is given\n   *\n   * @param {Object} context Context (aka thisObject)\n   * @return {Self} thisArg\n   * @chainable\n   */\n  forEachObject: function(callback, context) {\n    var objects = this.getObjects();\n    for (var i = 0, len = objects.length; i < len; i++) {\n      callback.call(context, objects[i], i, objects);\n    }\n    return this;\n  },\n\n  /**\n   * Returns an array of children objects of this instance\n   * Type parameter introduced in 1.3.10\n   * since 2.3.5 this method return always a COPY of the array;\n   * @param {String} [type] When specified, only objects of this type are returned\n   * @return {Array}\n   */\n  getObjects: function(type) {\n    if (typeof type === 'undefined') {\n      return this._objects.concat();\n    }\n    return this._objects.filter(function(o) {\n      return o.type === type;\n    });\n  },\n\n  /**\n   * Returns object at specified index\n   * @param {Number} index\n   * @return {Self} thisArg\n   */\n  item: function (index) {\n    return this._objects[index];\n  },\n\n  /**\n   * Returns true if collection contains no objects\n   * @return {Boolean} true if collection is empty\n   */\n  isEmpty: function () {\n    return this._objects.length === 0;\n  },\n\n  /**\n   * Returns a size of a collection (i.e: length of an array containing its objects)\n   * @return {Number} Collection size\n   */\n  size: function() {\n    return this._objects.length;\n  },\n\n  /**\n   * Returns true if collection contains an object\n   * @param {Object} object Object to check against\n   * @param {Boolean} [deep=false] `true` to check all descendants, `false` to check only `_objects`\n   * @return {Boolean} `true` if collection contains an object\n   */\n  contains: function (object, deep) {\n    if (this._objects.indexOf(object) > -1) {\n      return true;\n    }\n    else if (deep) {\n      return this._objects.some(function (obj) {\n        return typeof obj.contains === 'function' && obj.contains(object, true);\n      });\n    }\n    return false;\n  },\n\n  /**\n   * Returns number representation of a collection complexity\n   * @return {Number} complexity\n   */\n  complexity: function () {\n    return this._objects.reduce(function (memo, current) {\n      memo += current.complexity ? current.complexity() : 0;\n      return memo;\n    }, 0);\n  }\n};\n\n\n/**\n * @namespace fabric.CommonMethods\n */\nfabric.CommonMethods = {\n\n  /**\n   * Sets object's properties from options\n   * @param {Object} [options] Options object\n   */\n  _setOptions: function(options) {\n    for (var prop in options) {\n      this.set(prop, options[prop]);\n    }\n  },\n\n  /**\n   * @private\n   * @param {Object} [filler] Options object\n   * @param {String} [property] property to set the Gradient to\n   */\n  _initGradient: function(filler, property) {\n    if (filler && filler.colorStops && !(filler instanceof fabric.Gradient)) {\n      this.set(property, new fabric.Gradient(filler));\n    }\n  },\n\n  /**\n   * @private\n   * @param {Object} [filler] Options object\n   * @param {String} [property] property to set the Pattern to\n   * @param {Function} [callback] callback to invoke after pattern load\n   */\n  _initPattern: function(filler, property, callback) {\n    if (filler && filler.source && !(filler instanceof fabric.Pattern)) {\n      this.set(property, new fabric.Pattern(filler, callback));\n    }\n    else {\n      callback && callback();\n    }\n  },\n\n  /**\n   * @private\n   */\n  _setObject: function(obj) {\n    for (var prop in obj) {\n      this._set(prop, obj[prop]);\n    }\n  },\n\n  /**\n   * Sets property to a given value. When changing position/dimension -related properties (left, top, scale, angle, etc.) `set` does not update position of object's borders/controls. If you need to update those, call `setCoords()`.\n   * @param {String|Object} key Property name or object (if object, iterate over the object properties)\n   * @param {Object|Function} value Property value (if function, the value is passed into it and its return value is used as a new one)\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  set: function(key, value) {\n    if (typeof key === 'object') {\n      this._setObject(key);\n    }\n    else {\n      this._set(key, value);\n    }\n    return this;\n  },\n\n  _set: function(key, value) {\n    this[key] = value;\n  },\n\n  /**\n   * Toggles specified property from `true` to `false` or from `false` to `true`\n   * @param {String} property Property to toggle\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  toggle: function(property) {\n    var value = this.get(property);\n    if (typeof value === 'boolean') {\n      this.set(property, !value);\n    }\n    return this;\n  },\n\n  /**\n   * Basic getter\n   * @param {String} property Property name\n   * @return {*} value of a property\n   */\n  get: function(property) {\n    return this[property];\n  }\n};\n\n\n(function(global) {\n\n  var sqrt = Math.sqrt,\n      atan2 = Math.atan2,\n      pow = Math.pow,\n      PiBy180 = Math.PI / 180,\n      PiBy2 = Math.PI / 2;\n\n  /**\n   * @namespace fabric.util\n   */\n  fabric.util = {\n\n    /**\n     * Calculate the cos of an angle, avoiding returning floats for known results\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} angle the angle in radians or in degree\n     * @return {Number}\n     */\n    cos: function(angle) {\n      if (angle === 0) { return 1; }\n      if (angle < 0) {\n        // cos(a) = cos(-a)\n        angle = -angle;\n      }\n      var angleSlice = angle / PiBy2;\n      switch (angleSlice) {\n        case 1: case 3: return 0;\n        case 2: return -1;\n      }\n      return Math.cos(angle);\n    },\n\n    /**\n     * Calculate the sin of an angle, avoiding returning floats for known results\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} angle the angle in radians or in degree\n     * @return {Number}\n     */\n    sin: function(angle) {\n      if (angle === 0) { return 0; }\n      var angleSlice = angle / PiBy2, sign = 1;\n      if (angle < 0) {\n        // sin(-a) = -sin(a)\n        sign = -1;\n      }\n      switch (angleSlice) {\n        case 1: return sign;\n        case 2: return 0;\n        case 3: return -sign;\n      }\n      return Math.sin(angle);\n    },\n\n    /**\n     * Removes value from an array.\n     * Presence of value (and its position in an array) is determined via `Array.prototype.indexOf`\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} array\n     * @param {*} value\n     * @return {Array} original array\n     */\n    removeFromArray: function(array, value) {\n      var idx = array.indexOf(value);\n      if (idx !== -1) {\n        array.splice(idx, 1);\n      }\n      return array;\n    },\n\n    /**\n     * Returns random number between 2 specified ones.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} min lower limit\n     * @param {Number} max upper limit\n     * @return {Number} random value (between min and max)\n     */\n    getRandomInt: function(min, max) {\n      return Math.floor(Math.random() * (max - min + 1)) + min;\n    },\n\n    /**\n     * Transforms degrees to radians.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} degrees value in degrees\n     * @return {Number} value in radians\n     */\n    degreesToRadians: function(degrees) {\n      return degrees * PiBy180;\n    },\n\n    /**\n     * Transforms radians to degrees.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number} radians value in radians\n     * @return {Number} value in degrees\n     */\n    radiansToDegrees: function(radians) {\n      return radians / PiBy180;\n    },\n\n    /**\n     * Rotates `point` around `origin` with `radians`\n     * @static\n     * @memberOf fabric.util\n     * @param {fabric.Point} point The point to rotate\n     * @param {fabric.Point} origin The origin of the rotation\n     * @param {Number} radians The radians of the angle for the rotation\n     * @return {fabric.Point} The new rotated point\n     */\n    rotatePoint: function(point, origin, radians) {\n      var newPoint = new fabric.Point(point.x - origin.x, point.y - origin.y),\n          v = fabric.util.rotateVector(newPoint, radians);\n      return new fabric.Point(v.x, v.y).addEquals(origin);\n    },\n\n    /**\n     * Rotates `vector` with `radians`\n     * @static\n     * @memberOf fabric.util\n     * @param {Object} vector The vector to rotate (x and y)\n     * @param {Number} radians The radians of the angle for the rotation\n     * @return {Object} The new rotated point\n     */\n    rotateVector: function(vector, radians) {\n      var sin = fabric.util.sin(radians),\n          cos = fabric.util.cos(radians),\n          rx = vector.x * cos - vector.y * sin,\n          ry = vector.x * sin + vector.y * cos;\n      return {\n        x: rx,\n        y: ry\n      };\n    },\n\n    /**\n     * Creates a vetor from points represented as a point\n     * @static\n     * @memberOf fabric.util\n     *\n     * @typedef {Object} Point\n     * @property {number} x\n     * @property {number} y\n     *\n     * @param {Point} from\n     * @param {Point} to\n     * @returns {Point} vector\n     */\n    createVector: function (from, to) {\n      return new fabric.Point(to.x - from.x, to.y - from.y);\n    },\n\n    /**\n     * Calculates angle between 2 vectors using dot product\n     * @static\n     * @memberOf fabric.util\n     * @param {Point} a\n     * @param {Point} b\n     * @returns the angle in radian between the vectors\n     */\n    calcAngleBetweenVectors: function (a, b) {\n      return Math.acos((a.x * b.x + a.y * b.y) / (Math.hypot(a.x, a.y) * Math.hypot(b.x, b.y)));\n    },\n\n    /**\n     * @static\n     * @memberOf fabric.util\n     * @param {Point} v\n     * @returns {Point} vector representing the unit vector of pointing to the direction of `v`\n     */\n    getHatVector: function (v) {\n      return new fabric.Point(v.x, v.y).multiply(1 / Math.hypot(v.x, v.y));\n    },\n\n    /**\n     * @static\n     * @memberOf fabric.util\n     * @param {Point} A\n     * @param {Point} B\n     * @param {Point} C\n     * @returns {{ vector: Point, angle: number }} vector representing the bisector of A and A's angle\n     */\n    getBisector: function (A, B, C) {\n      var AB = fabric.util.createVector(A, B), AC = fabric.util.createVector(A, C);\n      var alpha = fabric.util.calcAngleBetweenVectors(AB, AC);\n      //  check if alpha is relative to AB->BC\n      var ro = fabric.util.calcAngleBetweenVectors(fabric.util.rotateVector(AB, alpha), AC);\n      var phi = alpha * (ro === 0 ? 1 : -1) / 2;\n      return {\n        vector: fabric.util.getHatVector(fabric.util.rotateVector(AB, phi)),\n        angle: alpha\n      };\n    },\n\n    /**\n     * Project stroke width on points returning 2 projections for each point as follows:\n     * - `miter`: 2 points corresponding to the outer boundary and the inner boundary of stroke.\n     * - `bevel`: 2 points corresponding to the bevel boundaries, tangent to the bisector.\n     * - `round`: same as `bevel`\n     * Used to calculate object's bounding box\n     * @static\n     * @memberOf fabric.util\n     * @param {Point[]} points\n     * @param {Object} options\n     * @param {number} options.strokeWidth\n     * @param {'miter'|'bevel'|'round'} options.strokeLineJoin\n     * @param {number} options.strokeMiterLimit https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-miterlimit\n     * @param {boolean} options.strokeUniform\n     * @param {number} options.scaleX\n     * @param {number} options.scaleY\n     * @param {boolean} [openPath] whether the shape is open or not, affects the calculations of the first and last points\n     * @returns {fabric.Point[]} array of size 2n/4n of all suspected points\n     */\n    projectStrokeOnPoints: function (points, options, openPath) {\n      var coords = [], s = options.strokeWidth / 2,\n          strokeUniformScalar = options.strokeUniform ?\n            new fabric.Point(1 / options.scaleX, 1 / options.scaleY) : new fabric.Point(1, 1),\n          getStrokeHatVector = function (v) {\n            var scalar = s / (Math.hypot(v.x, v.y));\n            return new fabric.Point(v.x * scalar * strokeUniformScalar.x, v.y * scalar * strokeUniformScalar.y);\n          };\n      if (points.length <= 1) {return coords;}\n      points.forEach(function (p, index) {\n        var A = new fabric.Point(p.x, p.y), B, C;\n        if (index === 0) {\n          C = points[index + 1];\n          B = openPath ? getStrokeHatVector(fabric.util.createVector(C, A)).addEquals(A) : points[points.length - 1];\n        }\n        else if (index === points.length - 1) {\n          B = points[index - 1];\n          C = openPath ? getStrokeHatVector(fabric.util.createVector(B, A)).addEquals(A) : points[0];\n        }\n        else {\n          B = points[index - 1];\n          C = points[index + 1];\n        }\n        var bisector = fabric.util.getBisector(A, B, C),\n            bisectorVector = bisector.vector,\n            alpha = bisector.angle,\n            scalar,\n            miterVector;\n        if (options.strokeLineJoin === 'miter') {\n          scalar = -s / Math.sin(alpha / 2);\n          miterVector = new fabric.Point(\n            bisectorVector.x * scalar * strokeUniformScalar.x,\n            bisectorVector.y * scalar * strokeUniformScalar.y\n          );\n          if (Math.hypot(miterVector.x, miterVector.y) / s <= options.strokeMiterLimit) {\n            coords.push(A.add(miterVector));\n            coords.push(A.subtract(miterVector));\n            return;\n          }\n        }\n        scalar = -s * Math.SQRT2;\n        miterVector = new fabric.Point(\n          bisectorVector.x * scalar * strokeUniformScalar.x,\n          bisectorVector.y * scalar * strokeUniformScalar.y\n        );\n        coords.push(A.add(miterVector));\n        coords.push(A.subtract(miterVector));\n      });\n      return coords;\n    },\n\n    /**\n     * Apply transform t to point p\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Point} p The point to transform\n     * @param  {Array} t The transform\n     * @param  {Boolean} [ignoreOffset] Indicates that the offset should not be applied\n     * @return {fabric.Point} The transformed point\n     */\n    transformPoint: function(p, t, ignoreOffset) {\n      if (ignoreOffset) {\n        return new fabric.Point(\n          t[0] * p.x + t[2] * p.y,\n          t[1] * p.x + t[3] * p.y\n        );\n      }\n      return new fabric.Point(\n        t[0] * p.x + t[2] * p.y + t[4],\n        t[1] * p.x + t[3] * p.y + t[5]\n      );\n    },\n\n    /**\n     * Returns coordinates of points's bounding rectangle (left, top, width, height)\n     * @param {Array} points 4 points array\n     * @param {Array} [transform] an array of 6 numbers representing a 2x3 transform matrix\n     * @return {Object} Object with left, top, width, height properties\n     */\n    makeBoundingBoxFromPoints: function(points, transform) {\n      if (transform) {\n        for (var i = 0; i < points.length; i++) {\n          points[i] = fabric.util.transformPoint(points[i], transform);\n        }\n      }\n      var xPoints = [points[0].x, points[1].x, points[2].x, points[3].x],\n          minX = fabric.util.array.min(xPoints),\n          maxX = fabric.util.array.max(xPoints),\n          width = maxX - minX,\n          yPoints = [points[0].y, points[1].y, points[2].y, points[3].y],\n          minY = fabric.util.array.min(yPoints),\n          maxY = fabric.util.array.max(yPoints),\n          height = maxY - minY;\n\n      return {\n        left: minX,\n        top: minY,\n        width: width,\n        height: height\n      };\n    },\n\n    /**\n     * Invert transformation t\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} t The transform\n     * @return {Array} The inverted transform\n     */\n    invertTransform: function(t) {\n      var a = 1 / (t[0] * t[3] - t[1] * t[2]),\n          r = [a * t[3], -a * t[1], -a * t[2], a * t[0]],\n          o = fabric.util.transformPoint({ x: t[4], y: t[5] }, r, true);\n      r[4] = -o.x;\n      r[5] = -o.y;\n      return r;\n    },\n\n    /**\n     * A wrapper around Number#toFixed, which contrary to native method returns number, not string.\n     * @static\n     * @memberOf fabric.util\n     * @param {Number|String} number number to operate on\n     * @param {Number} fractionDigits number of fraction digits to \"leave\"\n     * @return {Number}\n     */\n    toFixed: function(number, fractionDigits) {\n      return parseFloat(Number(number).toFixed(fractionDigits));\n    },\n\n    /**\n     * Converts from attribute value to pixel value if applicable.\n     * Returns converted pixels or original value not converted.\n     * @param {Number|String} value number to operate on\n     * @param {Number} fontSize\n     * @return {Number|String}\n     */\n    parseUnit: function(value, fontSize) {\n      var unit = /\\D{0,2}$/.exec(value),\n          number = parseFloat(value);\n      if (!fontSize) {\n        fontSize = fabric.Text.DEFAULT_SVG_FONT_SIZE;\n      }\n      switch (unit[0]) {\n        case 'mm':\n          return number * fabric.DPI / 25.4;\n\n        case 'cm':\n          return number * fabric.DPI / 2.54;\n\n        case 'in':\n          return number * fabric.DPI;\n\n        case 'pt':\n          return number * fabric.DPI / 72; // or * 4 / 3\n\n        case 'pc':\n          return number * fabric.DPI / 72 * 12; // or * 16\n\n        case 'em':\n          return number * fontSize;\n\n        default:\n          return number;\n      }\n    },\n\n    /**\n     * Function which always returns `false`.\n     * @static\n     * @memberOf fabric.util\n     * @return {Boolean}\n     */\n    falseFunction: function() {\n      return false;\n    },\n\n    /**\n     * Returns klass \"Class\" object of given namespace\n     * @memberOf fabric.util\n     * @param {String} type Type of object (eg. 'circle')\n     * @param {String} namespace Namespace to get klass \"Class\" object from\n     * @return {Object} klass \"Class\"\n     */\n    getKlass: function(type, namespace) {\n      // capitalize first letter only\n      type = fabric.util.string.camelize(type.charAt(0).toUpperCase() + type.slice(1));\n      return fabric.util.resolveNamespace(namespace)[type];\n    },\n\n    /**\n     * Returns array of attributes for given svg that fabric parses\n     * @memberOf fabric.util\n     * @param {String} type Type of svg element (eg. 'circle')\n     * @return {Array} string names of supported attributes\n     */\n    getSvgAttributes: function(type) {\n      var attributes = [\n        'instantiated_by_use',\n        'style',\n        'id',\n        'class'\n      ];\n      switch (type) {\n        case 'linearGradient':\n          attributes = attributes.concat(['x1', 'y1', 'x2', 'y2', 'gradientUnits', 'gradientTransform']);\n          break;\n        case 'radialGradient':\n          attributes = attributes.concat(['gradientUnits', 'gradientTransform', 'cx', 'cy', 'r', 'fx', 'fy', 'fr']);\n          break;\n        case 'stop':\n          attributes = attributes.concat(['offset', 'stop-color', 'stop-opacity']);\n          break;\n      }\n      return attributes;\n    },\n\n    /**\n     * Returns object of given namespace\n     * @memberOf fabric.util\n     * @param {String} namespace Namespace string e.g. 'fabric.Image.filter' or 'fabric'\n     * @return {Object} Object for given namespace (default fabric)\n     */\n    resolveNamespace: function(namespace) {\n      if (!namespace) {\n        return fabric;\n      }\n\n      var parts = namespace.split('.'),\n          len = parts.length, i,\n          obj = global || fabric.window;\n\n      for (i = 0; i < len; ++i) {\n        obj = obj[parts[i]];\n      }\n\n      return obj;\n    },\n\n    /**\n     * Loads image element from given url and passes it to a callback\n     * @memberOf fabric.util\n     * @param {String} url URL representing an image\n     * @param {Function} callback Callback; invoked with loaded image\n     * @param {*} [context] Context to invoke callback in\n     * @param {Object} [crossOrigin] crossOrigin value to set image element to\n     */\n    loadImage: function(url, callback, context, crossOrigin) {\n      if (!url) {\n        callback && callback.call(context, url);\n        return;\n      }\n\n      var img = fabric.util.createImage();\n\n      /** @ignore */\n      var onLoadCallback = function () {\n        callback && callback.call(context, img, false);\n        img = img.onload = img.onerror = null;\n      };\n\n      img.onload = onLoadCallback;\n      /** @ignore */\n      img.onerror = function() {\n        fabric.log('Error loading ' + img.src);\n        callback && callback.call(context, null, true);\n        img = img.onload = img.onerror = null;\n      };\n\n      // data-urls appear to be buggy with crossOrigin\n      // https://github.com/kangax/fabric.js/commit/d0abb90f1cd5c5ef9d2a94d3fb21a22330da3e0a#commitcomment-4513767\n      // see https://code.google.com/p/chromium/issues/detail?id=315152\n      //     https://bugzilla.mozilla.org/show_bug.cgi?id=935069\n      // crossOrigin null is the same as not set.\n      if (url.indexOf('data') !== 0 &&\n        crossOrigin !== undefined &&\n        crossOrigin !== null) {\n        img.crossOrigin = crossOrigin;\n      }\n\n      // IE10 / IE11-Fix: SVG contents from data: URI\n      // will only be available if the IMG is present\n      // in the DOM (and visible)\n      if (url.substring(0,14) === 'data:image/svg') {\n        img.onload = null;\n        fabric.util.loadImageInDom(img, onLoadCallback);\n      }\n\n      img.src = url;\n    },\n\n    /**\n     * Attaches SVG image with data: URL to the dom\n     * @memberOf fabric.util\n     * @param {Object} img Image object with data:image/svg src\n     * @param {Function} callback Callback; invoked with loaded image\n     * @return {Object} DOM element (div containing the SVG image)\n     */\n    loadImageInDom: function(img, onLoadCallback) {\n      var div = fabric.document.createElement('div');\n      div.style.width = div.style.height = '1px';\n      div.style.left = div.style.top = '-100%';\n      div.style.position = 'absolute';\n      div.appendChild(img);\n      fabric.document.querySelector('body').appendChild(div);\n      /**\n       * Wrap in function to:\n       *   1. Call existing callback\n       *   2. Cleanup DOM\n       */\n      img.onload = function () {\n        onLoadCallback();\n        div.parentNode.removeChild(div);\n        div = null;\n      };\n    },\n\n    /**\n     * Creates corresponding fabric instances from their object representations\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} objects Objects to enliven\n     * @param {Function} callback Callback to invoke when all objects are created\n     * @param {String} namespace Namespace to get klass \"Class\" object from\n     * @param {Function} reviver Method for further parsing of object elements,\n     * called after each fabric object created.\n     */\n    enlivenObjects: function(objects, callback, namespace, reviver) {\n      objects = objects || [];\n\n      var enlivenedObjects = [],\n          numLoadedObjects = 0,\n          numTotalObjects = objects.length;\n\n      function onLoaded() {\n        if (++numLoadedObjects === numTotalObjects) {\n          callback && callback(enlivenedObjects.filter(function(obj) {\n            // filter out undefined objects (objects that gave error)\n            return obj;\n          }));\n        }\n      }\n\n      if (!numTotalObjects) {\n        callback && callback(enlivenedObjects);\n        return;\n      }\n\n      objects.forEach(function (o, index) {\n        // if sparse array\n        if (!o || !o.type) {\n          onLoaded();\n          return;\n        }\n        var klass = fabric.util.getKlass(o.type, namespace);\n        klass.fromObject(o, function (obj, error) {\n          error || (enlivenedObjects[index] = obj);\n          reviver && reviver(o, obj, error);\n          onLoaded();\n        });\n      });\n    },\n\n    /**\n     * Creates corresponding fabric instances residing in an object, e.g. `clipPath`\n     * @see {@link fabric.Object.ENLIVEN_PROPS}\n     * @param {Object} object\n     * @param {Object} [context] assign enlived props to this object (pass null to skip this)\n     * @param {(objects:fabric.Object[]) => void} callback\n     */\n    enlivenObjectEnlivables: function (object, context, callback) {\n      var enlivenProps = fabric.Object.ENLIVEN_PROPS.filter(function (key) { return !!object[key]; });\n      fabric.util.enlivenObjects(enlivenProps.map(function (key) { return object[key]; }), function (enlivedProps) {\n        var objects = {};\n        enlivenProps.forEach(function (key, index) {\n          objects[key] = enlivedProps[index];\n          context && (context[key] = enlivedProps[index]);\n        });\n        callback && callback(objects);\n      });\n    },\n\n    /**\n     * Create and wait for loading of patterns\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} patterns Objects to enliven\n     * @param {Function} callback Callback to invoke when all objects are created\n     * called after each fabric object created.\n     */\n    enlivenPatterns: function(patterns, callback) {\n      patterns = patterns || [];\n\n      function onLoaded() {\n        if (++numLoadedPatterns === numPatterns) {\n          callback && callback(enlivenedPatterns);\n        }\n      }\n\n      var enlivenedPatterns = [],\n          numLoadedPatterns = 0,\n          numPatterns = patterns.length;\n\n      if (!numPatterns) {\n        callback && callback(enlivenedPatterns);\n        return;\n      }\n\n      patterns.forEach(function (p, index) {\n        if (p && p.source) {\n          new fabric.Pattern(p, function(pattern) {\n            enlivenedPatterns[index] = pattern;\n            onLoaded();\n          });\n        }\n        else {\n          enlivenedPatterns[index] = p;\n          onLoaded();\n        }\n      });\n    },\n\n    /**\n     * Groups SVG elements (usually those retrieved from SVG document)\n     * @static\n     * @memberOf fabric.util\n     * @param {Array} elements SVG elements to group\n     * @param {Object} [options] Options object\n     * @param {String} path Value to set sourcePath to\n     * @return {fabric.Object|fabric.Group}\n     */\n    groupSVGElements: function(elements, options, path) {\n      var object;\n      if (elements && elements.length === 1) {\n        if (typeof path !== 'undefined') {\n          elements[0].sourcePath = path;\n        }\n        return elements[0];\n      }\n      if (options) {\n        if (options.width && options.height) {\n          options.centerPoint = {\n            x: options.width / 2,\n            y: options.height / 2\n          };\n        }\n        else {\n          delete options.width;\n          delete options.height;\n        }\n      }\n      object = new fabric.Group(elements, options);\n      if (typeof path !== 'undefined') {\n        object.sourcePath = path;\n      }\n      return object;\n    },\n\n    /**\n     * Populates an object with properties of another object\n     * @static\n     * @memberOf fabric.util\n     * @param {Object} source Source object\n     * @param {Object} destination Destination object\n     * @return {Array} properties Properties names to include\n     */\n    populateWithProperties: function(source, destination, properties) {\n      if (properties && Array.isArray(properties)) {\n        for (var i = 0, len = properties.length; i < len; i++) {\n          if (properties[i] in source) {\n            destination[properties[i]] = source[properties[i]];\n          }\n        }\n      }\n    },\n\n    /**\n     * Creates canvas element\n     * @static\n     * @memberOf fabric.util\n     * @return {CanvasElement} initialized canvas element\n     */\n    createCanvasElement: function() {\n      return fabric.document.createElement('canvas');\n    },\n\n    /**\n     * Creates a canvas element that is a copy of another and is also painted\n     * @param {CanvasElement} canvas to copy size and content of\n     * @static\n     * @memberOf fabric.util\n     * @return {CanvasElement} initialized canvas element\n     */\n    copyCanvasElement: function(canvas) {\n      var newCanvas = fabric.util.createCanvasElement();\n      newCanvas.width = canvas.width;\n      newCanvas.height = canvas.height;\n      newCanvas.getContext('2d').drawImage(canvas, 0, 0);\n      return newCanvas;\n    },\n\n    /**\n     * since 2.6.0 moved from canvas instance to utility.\n     * @param {CanvasElement} canvasEl to copy size and content of\n     * @param {String} format 'jpeg' or 'png', in some browsers 'webp' is ok too\n     * @param {Number} quality <= 1 and > 0\n     * @static\n     * @memberOf fabric.util\n     * @return {String} data url\n     */\n    toDataURL: function(canvasEl, format, quality) {\n      return canvasEl.toDataURL('image/' + format, quality);\n    },\n\n    /**\n     * Creates image element (works on client and node)\n     * @static\n     * @memberOf fabric.util\n     * @return {HTMLImageElement} HTML image element\n     */\n    createImage: function() {\n      return fabric.document.createElement('img');\n    },\n\n    /**\n     * Multiply matrix A by matrix B to nest transformations\n     * @static\n     * @memberOf fabric.util\n     * @param  {Array} a First transformMatrix\n     * @param  {Array} b Second transformMatrix\n     * @param  {Boolean} is2x2 flag to multiply matrices as 2x2 matrices\n     * @return {Array} The product of the two transform matrices\n     */\n    multiplyTransformMatrices: function(a, b, is2x2) {\n      // Matrix multiply a * b\n      return [\n        a[0] * b[0] + a[2] * b[1],\n        a[1] * b[0] + a[3] * b[1],\n        a[0] * b[2] + a[2] * b[3],\n        a[1] * b[2] + a[3] * b[3],\n        is2x2 ? 0 : a[0] * b[4] + a[2] * b[5] + a[4],\n        is2x2 ? 0 : a[1] * b[4] + a[3] * b[5] + a[5]\n      ];\n    },\n\n    /**\n     * Decomposes standard 2x3 matrix into transform components\n     * @static\n     * @memberOf fabric.util\n     * @param  {Array} a transformMatrix\n     * @return {Object} Components of transform\n     */\n    qrDecompose: function(a) {\n      var angle = atan2(a[1], a[0]),\n          denom = pow(a[0], 2) + pow(a[1], 2),\n          scaleX = sqrt(denom),\n          scaleY = (a[0] * a[3] - a[2] * a[1]) / scaleX,\n          skewX = atan2(a[0] * a[2] + a[1] * a [3], denom);\n      return {\n        angle: angle / PiBy180,\n        scaleX: scaleX,\n        scaleY: scaleY,\n        skewX: skewX / PiBy180,\n        skewY: 0,\n        translateX: a[4],\n        translateY: a[5]\n      };\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.angle] angle in degrees\n     * @return {Number[]} transform matrix\n     */\n    calcRotateMatrix: function(options) {\n      if (!options.angle) {\n        return fabric.iMatrix.concat();\n      }\n      var theta = fabric.util.degreesToRadians(options.angle),\n          cos = fabric.util.cos(theta),\n          sin = fabric.util.sin(theta);\n      return [cos, sin, -sin, cos, 0, 0];\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet.\n     * is called DimensionsTransformMatrix because those properties are the one that influence\n     * the size of the resulting box of the object.\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.scaleX]\n     * @param  {Number} [options.scaleY]\n     * @param  {Boolean} [options.flipX]\n     * @param  {Boolean} [options.flipY]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.skewY]\n     * @return {Number[]} transform matrix\n     */\n    calcDimensionsMatrix: function(options) {\n      var scaleX = typeof options.scaleX === 'undefined' ? 1 : options.scaleX,\n          scaleY = typeof options.scaleY === 'undefined' ? 1 : options.scaleY,\n          scaleMatrix = [\n            options.flipX ? -scaleX : scaleX,\n            0,\n            0,\n            options.flipY ? -scaleY : scaleY,\n            0,\n            0],\n          multiply = fabric.util.multiplyTransformMatrices,\n          degreesToRadians = fabric.util.degreesToRadians;\n      if (options.skewX) {\n        scaleMatrix = multiply(\n          scaleMatrix,\n          [1, 0, Math.tan(degreesToRadians(options.skewX)), 1],\n          true);\n      }\n      if (options.skewY) {\n        scaleMatrix = multiply(\n          scaleMatrix,\n          [1, Math.tan(degreesToRadians(options.skewY)), 0, 1],\n          true);\n      }\n      return scaleMatrix;\n    },\n\n    /**\n     * Returns a transform matrix starting from an object of the same kind of\n     * the one returned from qrDecompose, useful also if you want to calculate some\n     * transformations from an object that is not enlived yet\n     * @static\n     * @memberOf fabric.util\n     * @param  {Object} options\n     * @param  {Number} [options.angle]\n     * @param  {Number} [options.scaleX]\n     * @param  {Number} [options.scaleY]\n     * @param  {Boolean} [options.flipX]\n     * @param  {Boolean} [options.flipY]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.skewX]\n     * @param  {Number} [options.translateX]\n     * @param  {Number} [options.translateY]\n     * @return {Number[]} transform matrix\n     */\n    composeMatrix: function(options) {\n      var matrix = [1, 0, 0, 1, options.translateX || 0, options.translateY || 0],\n          multiply = fabric.util.multiplyTransformMatrices;\n      if (options.angle) {\n        matrix = multiply(matrix, fabric.util.calcRotateMatrix(options));\n      }\n      if (options.scaleX !== 1 || options.scaleY !== 1 ||\n          options.skewX || options.skewY || options.flipX || options.flipY) {\n        matrix = multiply(matrix, fabric.util.calcDimensionsMatrix(options));\n      }\n      return matrix;\n    },\n\n    /**\n     * reset an object transform state to neutral. Top and left are not accounted for\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Object} target object to transform\n     */\n    resetObjectTransform: function (target) {\n      target.scaleX = 1;\n      target.scaleY = 1;\n      target.skewX = 0;\n      target.skewY = 0;\n      target.flipX = false;\n      target.flipY = false;\n      target.rotate(0);\n    },\n\n    /**\n     * Extract Object transform values\n     * @static\n     * @memberOf fabric.util\n     * @param  {fabric.Object} target object to read from\n     * @return {Object} Components of transform\n     */\n    saveObjectTransform: function (target) {\n      return {\n        scaleX: target.scaleX,\n        scaleY: target.scaleY,\n        skewX: target.skewX,\n        skewY: target.skewY,\n        angle: target.angle,\n        left: target.left,\n        flipX: target.flipX,\n        flipY: target.flipY,\n        top: target.top\n      };\n    },\n\n    /**\n     * Returns true if context has transparent pixel\n     * at specified location (taking tolerance into account)\n     * @param {CanvasRenderingContext2D} ctx context\n     * @param {Number} x x coordinate\n     * @param {Number} y y coordinate\n     * @param {Number} tolerance Tolerance\n     */\n    isTransparent: function(ctx, x, y, tolerance) {\n\n      // If tolerance is > 0 adjust start coords to take into account.\n      // If moves off Canvas fix to 0\n      if (tolerance > 0) {\n        if (x > tolerance) {\n          x -= tolerance;\n        }\n        else {\n          x = 0;\n        }\n        if (y > tolerance) {\n          y -= tolerance;\n        }\n        else {\n          y = 0;\n        }\n      }\n\n      var _isTransparent = true, i, temp,\n          imageData = ctx.getImageData(x, y, (tolerance * 2) || 1, (tolerance * 2) || 1),\n          l = imageData.data.length;\n\n      // Split image data - for tolerance > 1, pixelDataSize = 4;\n      for (i = 3; i < l; i += 4) {\n        temp = imageData.data[i];\n        _isTransparent = temp <= 0;\n        if (_isTransparent === false) {\n          break; // Stop if colour found\n        }\n      }\n\n      imageData = null;\n\n      return _isTransparent;\n    },\n\n    /**\n     * Parse preserveAspectRatio attribute from element\n     * @param {string} attribute to be parsed\n     * @return {Object} an object containing align and meetOrSlice attribute\n     */\n    parsePreserveAspectRatioAttribute: function(attribute) {\n      var meetOrSlice = 'meet', alignX = 'Mid', alignY = 'Mid',\n          aspectRatioAttrs = attribute.split(' '), align;\n\n      if (aspectRatioAttrs && aspectRatioAttrs.length) {\n        meetOrSlice = aspectRatioAttrs.pop();\n        if (meetOrSlice !== 'meet' && meetOrSlice !== 'slice') {\n          align = meetOrSlice;\n          meetOrSlice = 'meet';\n        }\n        else if (aspectRatioAttrs.length) {\n          align = aspectRatioAttrs.pop();\n        }\n      }\n      //divide align in alignX and alignY\n      alignX = align !== 'none' ? align.slice(1, 4) : 'none';\n      alignY = align !== 'none' ? align.slice(5, 8) : 'none';\n      return {\n        meetOrSlice: meetOrSlice,\n        alignX: alignX,\n        alignY: alignY\n      };\n    },\n\n    /**\n     * Clear char widths cache for the given font family or all the cache if no\n     * fontFamily is specified.\n     * Use it if you know you are loading fonts in a lazy way and you are not waiting\n     * for custom fonts to load properly when adding text objects to the canvas.\n     * If a text object is added when its own font is not loaded yet, you will get wrong\n     * measurement and so wrong bounding boxes.\n     * After the font cache is cleared, either change the textObject text content or call\n     * initDimensions() to trigger a recalculation\n     * @memberOf fabric.util\n     * @param {String} [fontFamily] font family to clear\n     */\n    clearFabricFontCache: function(fontFamily) {\n      fontFamily = (fontFamily || '').toLowerCase();\n      if (!fontFamily) {\n        fabric.charWidthsCache = { };\n      }\n      else if (fabric.charWidthsCache[fontFamily]) {\n        delete fabric.charWidthsCache[fontFamily];\n      }\n    },\n\n    /**\n     * Given current aspect ratio, determines the max width and height that can\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Number} ar aspect ratio\n     * @param {Number} maximumArea Maximum area you want to achieve\n     * @return {Object.x} Limited dimensions by X\n     * @return {Object.y} Limited dimensions by Y\n     */\n    limitDimsByArea: function(ar, maximumArea) {\n      var roughWidth = Math.sqrt(maximumArea * ar),\n          perfLimitSizeY = Math.floor(maximumArea / roughWidth);\n      return { x: Math.floor(roughWidth), y: perfLimitSizeY };\n    },\n\n    capValue: function(min, value, max) {\n      return Math.max(min, Math.min(value, max));\n    },\n\n    /**\n     * Finds the scale for the object source to fit inside the object destination,\n     * keeping aspect ratio intact.\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Object | fabric.Object} source\n     * @param {Number} source.height natural unscaled height of the object\n     * @param {Number} source.width natural unscaled width of the object\n     * @param {Object | fabric.Object} destination\n     * @param {Number} destination.height natural unscaled height of the object\n     * @param {Number} destination.width natural unscaled width of the object\n     * @return {Number} scale factor to apply to source to fit into destination\n     */\n    findScaleToFit: function(source, destination) {\n      return Math.min(destination.width / source.width, destination.height / source.height);\n    },\n\n    /**\n     * Finds the scale for the object source to cover entirely the object destination,\n     * keeping aspect ratio intact.\n     * respect the total allowed area for the cache.\n     * @memberOf fabric.util\n     * @param {Object | fabric.Object} source\n     * @param {Number} source.height natural unscaled height of the object\n     * @param {Number} source.width natural unscaled width of the object\n     * @param {Object | fabric.Object} destination\n     * @param {Number} destination.height natural unscaled height of the object\n     * @param {Number} destination.width natural unscaled width of the object\n     * @return {Number} scale factor to apply to source to cover destination\n     */\n    findScaleToCover: function(source, destination) {\n      return Math.max(destination.width / source.width, destination.height / source.height);\n    },\n\n    /**\n     * given an array of 6 number returns something like `\"matrix(...numbers)\"`\n     * @memberOf fabric.util\n     * @param {Array} transform an array with 6 numbers\n     * @return {String} transform matrix for svg\n     * @return {Object.y} Limited dimensions by Y\n     */\n    matrixToSVG: function(transform) {\n      return 'matrix(' + transform.map(function(value) {\n        return fabric.util.toFixed(value, fabric.Object.NUM_FRACTION_DIGITS);\n      }).join(' ') + ')';\n    },\n\n    /**\n     * given an object and a transform, apply the inverse transform to the object,\n     * this is equivalent to remove from that object that transformation, so that\n     * added in a space with the removed transform, the object will be the same as before.\n     * Removing from an object a transform that scale by 2 is like scaling it by 1/2.\n     * Removing from an object a transfrom that rotate by 30deg is like rotating by 30deg\n     * in the opposite direction.\n     * This util is used to add objects inside transformed groups or nested groups.\n     * @memberOf fabric.util\n     * @param {fabric.Object} object the object you want to transform\n     * @param {Array} transform the destination transform\n     */\n    removeTransformFromObject: function(object, transform) {\n      var inverted = fabric.util.invertTransform(transform),\n          finalTransform = fabric.util.multiplyTransformMatrices(inverted, object.calcOwnMatrix());\n      fabric.util.applyTransformToObject(object, finalTransform);\n    },\n\n    /**\n     * given an object and a transform, apply the transform to the object.\n     * this is equivalent to change the space where the object is drawn.\n     * Adding to an object a transform that scale by 2 is like scaling it by 2.\n     * This is used when removing an object from an active selection for example.\n     * @memberOf fabric.util\n     * @param {fabric.Object} object the object you want to transform\n     * @param {Array} transform the destination transform\n     */\n    addTransformToObject: function(object, transform) {\n      fabric.util.applyTransformToObject(\n        object,\n        fabric.util.multiplyTransformMatrices(transform, object.calcOwnMatrix())\n      );\n    },\n\n    /**\n     * discard an object transform state and apply the one from the matrix.\n     * @memberOf fabric.util\n     * @param {fabric.Object} object the object you want to transform\n     * @param {Array} transform the destination transform\n     */\n    applyTransformToObject: function(object, transform) {\n      var options = fabric.util.qrDecompose(transform),\n          center = new fabric.Point(options.translateX, options.translateY);\n      object.flipX = false;\n      object.flipY = false;\n      object.set('scaleX', options.scaleX);\n      object.set('scaleY', options.scaleY);\n      object.skewX = options.skewX;\n      object.skewY = options.skewY;\n      object.angle = options.angle;\n      object.setPositionByOrigin(center, 'center', 'center');\n    },\n\n    /**\n     * given a width and height, return the size of the bounding box\n     * that can contains the box with width/height with applied transform\n     * described in options.\n     * Use to calculate the boxes around objects for controls.\n     * @memberOf fabric.util\n     * @param {Number} width\n     * @param {Number} height\n     * @param {Object} options\n     * @param {Number} options.scaleX\n     * @param {Number} options.scaleY\n     * @param {Number} options.skewX\n     * @param {Number} options.skewY\n     * @return {Object.x} width of containing\n     * @return {Object.y} height of containing\n     */\n    sizeAfterTransform: function(width, height, options) {\n      var dimX = width / 2, dimY = height / 2,\n          points = [\n            {\n              x: -dimX,\n              y: -dimY\n            },\n            {\n              x: dimX,\n              y: -dimY\n            },\n            {\n              x: -dimX,\n              y: dimY\n            },\n            {\n              x: dimX,\n              y: dimY\n            }],\n          transformMatrix = fabric.util.calcDimensionsMatrix(options),\n          bbox = fabric.util.makeBoundingBoxFromPoints(points, transformMatrix);\n      return {\n        x: bbox.width,\n        y: bbox.height,\n      };\n    },\n\n    /**\n     * Merges 2 clip paths into one visually equal clip path\n     *\n     * **IMPORTANT**:\\\n     * Does **NOT** clone the arguments, clone them proir if necessary.\n     *\n     * Creates a wrapper (group) that contains one clip path and is clipped by the other so content is kept where both overlap.\n     * Use this method if both the clip paths may have nested clip paths of their own, so assigning one to the other's clip path property is not possible.\n     *\n     * In order to handle the `inverted` property we follow logic described in the following cases:\\\n     * **(1)** both clip paths are inverted - the clip paths pass the inverted prop to the wrapper and loose it themselves.\\\n     * **(2)** one is inverted and the other isn't - the wrapper shouldn't become inverted and the inverted clip path must clip the non inverted one to produce an identical visual effect.\\\n     * **(3)** both clip paths are not inverted - wrapper and clip paths remain unchanged.\n     *\n     * @memberOf fabric.util\n     * @param {fabric.Object} c1\n     * @param {fabric.Object} c2\n     * @returns {fabric.Object} merged clip path\n     */\n    mergeClipPaths: function (c1, c2) {\n      var a = c1, b = c2;\n      if (a.inverted && !b.inverted) {\n        //  case (2)\n        a = c2;\n        b = c1;\n      }\n      //  `b` becomes `a`'s clip path so we transform `b` to `a` coordinate plane\n      fabric.util.applyTransformToObject(\n        b,\n        fabric.util.multiplyTransformMatrices(\n          fabric.util.invertTransform(a.calcTransformMatrix()),\n          b.calcTransformMatrix()\n        )\n      );\n      //  assign the `inverted` prop to the wrapping group\n      var inverted = a.inverted && b.inverted;\n      if (inverted) {\n        //  case (1)\n        a.inverted = b.inverted = false;\n      }\n      return new fabric.Group([a], { clipPath: b, inverted: inverted });\n    },\n\n    /**\n     * @memberOf fabric.util\n     * @param {Object} prevStyle first style to compare\n     * @param {Object} thisStyle second style to compare\n     * @param {boolean} forTextSpans whether to check overline, underline, and line-through properties\n     * @return {boolean} true if the style changed\n     */\n    hasStyleChanged: function(prevStyle, thisStyle, forTextSpans) {\n      forTextSpans = forTextSpans || false;\n      return (prevStyle.fill !== thisStyle.fill ||\n              prevStyle.stroke !== thisStyle.stroke ||\n              prevStyle.strokeWidth !== thisStyle.strokeWidth ||\n              prevStyle.fontSize !== thisStyle.fontSize ||\n              prevStyle.fontFamily !== thisStyle.fontFamily ||\n              prevStyle.fontWeight !== thisStyle.fontWeight ||\n              prevStyle.fontStyle !== thisStyle.fontStyle ||\n              prevStyle.textBackgroundColor !== thisStyle.textBackgroundColor ||\n              prevStyle.deltaY !== thisStyle.deltaY) ||\n              (forTextSpans &&\n                (prevStyle.overline !== thisStyle.overline ||\n                prevStyle.underline !== thisStyle.underline ||\n                prevStyle.linethrough !== thisStyle.linethrough));\n    },\n\n    /**\n     * Returns the array form of a text object's inline styles property with styles grouped in ranges\n     * rather than per character. This format is less verbose, and is better suited for storage\n     * so it is used in serialization (not during runtime).\n     * @memberOf fabric.util\n     * @param {object} styles per character styles for a text object\n     * @param {String} text the text string that the styles are applied to\n     * @return {{start: number, end: number, style: object}[]}\n     */\n    stylesToArray: function(styles, text) {\n      // clone style structure to prevent mutation\n      var styles = fabric.util.object.clone(styles, true),\n          textLines = text.split('\\n'),\n          charIndex = -1, prevStyle = {}, stylesArray = [];\n      //loop through each textLine\n      for (var i = 0; i < textLines.length; i++) {\n        if (!styles[i]) {\n          //no styles exist for this line, so add the line's length to the charIndex total\n          charIndex += textLines[i].length;\n          continue;\n        }\n        //loop through each character of the current line\n        for (var c = 0; c < textLines[i].length; c++) {\n          charIndex++;\n          var thisStyle = styles[i][c];\n          //check if style exists for this character\n          if (thisStyle && Object.keys(thisStyle).length > 0) {\n            var styleChanged = fabric.util.hasStyleChanged(prevStyle, thisStyle, true);\n            if (styleChanged) {\n              stylesArray.push({\n                start: charIndex,\n                end: charIndex + 1,\n                style: thisStyle\n              });\n            }\n            else {\n              //if style is the same as previous character, increase end index\n              stylesArray[stylesArray.length - 1].end++;\n            }\n          }\n          prevStyle = thisStyle || {};\n        }\n      }\n      return stylesArray;\n    },\n\n    /**\n     * Returns the object form of the styles property with styles that are assigned per\n     * character rather than grouped by range. This format is more verbose, and is\n     * only used during runtime (not for serialization/storage)\n     * @memberOf fabric.util\n     * @param {Array} styles the serialized form of a text object's styles\n     * @param {String} text the text string that the styles are applied to\n     * @return {Object}\n     */\n    stylesFromArray: function(styles, text) {\n      if (!Array.isArray(styles)) {\n        return styles;\n      }\n      var textLines = text.split('\\n'),\n          charIndex = -1, styleIndex = 0, stylesObject = {};\n      //loop through each textLine\n      for (var i = 0; i < textLines.length; i++) {\n        //loop through each character of the current line\n        for (var c = 0; c < textLines[i].length; c++) {\n          charIndex++;\n          //check if there's a style collection that includes the current character\n          if (styles[styleIndex]\n            && styles[styleIndex].start <= charIndex\n            && charIndex < styles[styleIndex].end) {\n            //create object for line index if it doesn't exist\n            stylesObject[i] = stylesObject[i] || {};\n            //assign a style at this character's index\n            stylesObject[i][c] = Object.assign({}, styles[styleIndex].style);\n            //if character is at the end of the current style collection, move to the next\n            if (charIndex === styles[styleIndex].end - 1) {\n              styleIndex++;\n            }\n          }\n        }\n      }\n      return stylesObject;\n    }\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function() {\n  var _join = Array.prototype.join,\n      commandLengths = {\n        m: 2,\n        l: 2,\n        h: 1,\n        v: 1,\n        c: 6,\n        s: 4,\n        q: 4,\n        t: 2,\n        a: 7\n      },\n      repeatedCommands = {\n        m: 'l',\n        M: 'L'\n      };\n  function segmentToBezier(th2, th3, cosTh, sinTh, rx, ry, cx1, cy1, mT, fromX, fromY) {\n    var costh2 = fabric.util.cos(th2),\n        sinth2 = fabric.util.sin(th2),\n        costh3 = fabric.util.cos(th3),\n        sinth3 = fabric.util.sin(th3),\n        toX = cosTh * rx * costh3 - sinTh * ry * sinth3 + cx1,\n        toY = sinTh * rx * costh3 + cosTh * ry * sinth3 + cy1,\n        cp1X = fromX + mT * ( -cosTh * rx * sinth2 - sinTh * ry * costh2),\n        cp1Y = fromY + mT * ( -sinTh * rx * sinth2 + cosTh * ry * costh2),\n        cp2X = toX + mT * ( cosTh * rx * sinth3 + sinTh * ry * costh3),\n        cp2Y = toY + mT * ( sinTh * rx * sinth3 - cosTh * ry * costh3);\n\n    return ['C',\n      cp1X, cp1Y,\n      cp2X, cp2Y,\n      toX, toY\n    ];\n  }\n\n  /* Adapted from http://dxr.mozilla.org/mozilla-central/source/content/svg/content/src/nsSVGPathDataParser.cpp\n   * by Andrea Bogazzi code is under MPL. if you don't have a copy of the license you can take it here\n   * http://mozilla.org/MPL/2.0/\n   */\n  function arcToSegments(toX, toY, rx, ry, large, sweep, rotateX) {\n    var PI = Math.PI, th = rotateX * PI / 180,\n        sinTh = fabric.util.sin(th),\n        cosTh = fabric.util.cos(th),\n        fromX = 0, fromY = 0;\n\n    rx = Math.abs(rx);\n    ry = Math.abs(ry);\n\n    var px = -cosTh * toX * 0.5 - sinTh * toY * 0.5,\n        py = -cosTh * toY * 0.5 + sinTh * toX * 0.5,\n        rx2 = rx * rx, ry2 = ry * ry, py2 = py * py, px2 = px * px,\n        pl = rx2 * ry2 - rx2 * py2 - ry2 * px2,\n        root = 0;\n\n    if (pl < 0) {\n      var s = Math.sqrt(1 - pl / (rx2 * ry2));\n      rx *= s;\n      ry *= s;\n    }\n    else {\n      root = (large === sweep ? -1.0 : 1.0) *\n              Math.sqrt( pl / (rx2 * py2 + ry2 * px2));\n    }\n\n    var cx = root * rx * py / ry,\n        cy = -root * ry * px / rx,\n        cx1 = cosTh * cx - sinTh * cy + toX * 0.5,\n        cy1 = sinTh * cx + cosTh * cy + toY * 0.5,\n        mTheta = calcVectorAngle(1, 0, (px - cx) / rx, (py - cy) / ry),\n        dtheta = calcVectorAngle((px - cx) / rx, (py - cy) / ry, (-px - cx) / rx, (-py - cy) / ry);\n\n    if (sweep === 0 && dtheta > 0) {\n      dtheta -= 2 * PI;\n    }\n    else if (sweep === 1 && dtheta < 0) {\n      dtheta += 2 * PI;\n    }\n\n    // Convert into cubic bezier segments <= 90deg\n    var segments = Math.ceil(Math.abs(dtheta / PI * 2)),\n        result = [], mDelta = dtheta / segments,\n        mT = 8 / 3 * Math.sin(mDelta / 4) * Math.sin(mDelta / 4) / Math.sin(mDelta / 2),\n        th3 = mTheta + mDelta;\n\n    for (var i = 0; i < segments; i++) {\n      result[i] = segmentToBezier(mTheta, th3, cosTh, sinTh, rx, ry, cx1, cy1, mT, fromX, fromY);\n      fromX = result[i][5];\n      fromY = result[i][6];\n      mTheta = th3;\n      th3 += mDelta;\n    }\n    return result;\n  }\n\n  /*\n   * Private\n   */\n  function calcVectorAngle(ux, uy, vx, vy) {\n    var ta = Math.atan2(uy, ux),\n        tb = Math.atan2(vy, vx);\n    if (tb >= ta) {\n      return tb - ta;\n    }\n    else {\n      return 2 * Math.PI - (ta - tb);\n    }\n  }\n\n  /**\n   * Calculate bounding box of a beziercurve\n   * @param {Number} x0 starting point\n   * @param {Number} y0\n   * @param {Number} x1 first control point\n   * @param {Number} y1\n   * @param {Number} x2 secondo control point\n   * @param {Number} y2\n   * @param {Number} x3 end of bezier\n   * @param {Number} y3\n   */\n  // taken from http://jsbin.com/ivomiq/56/edit  no credits available for that.\n  // TODO: can we normalize this with the starting points set at 0 and then translated the bbox?\n  function getBoundsOfCurve(x0, y0, x1, y1, x2, y2, x3, y3) {\n    var argsString;\n    if (fabric.cachesBoundsOfCurve) {\n      argsString = _join.call(arguments);\n      if (fabric.boundsOfCurveCache[argsString]) {\n        return fabric.boundsOfCurveCache[argsString];\n      }\n    }\n\n    var sqrt = Math.sqrt,\n        min = Math.min, max = Math.max,\n        abs = Math.abs, tvalues = [],\n        bounds = [[], []],\n        a, b, c, t, t1, t2, b2ac, sqrtb2ac;\n\n    b = 6 * x0 - 12 * x1 + 6 * x2;\n    a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n    c = 3 * x1 - 3 * x0;\n\n    for (var i = 0; i < 2; ++i) {\n      if (i > 0) {\n        b = 6 * y0 - 12 * y1 + 6 * y2;\n        a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n        c = 3 * y1 - 3 * y0;\n      }\n\n      if (abs(a) < 1e-12) {\n        if (abs(b) < 1e-12) {\n          continue;\n        }\n        t = -c / b;\n        if (0 < t && t < 1) {\n          tvalues.push(t);\n        }\n        continue;\n      }\n      b2ac = b * b - 4 * c * a;\n      if (b2ac < 0) {\n        continue;\n      }\n      sqrtb2ac = sqrt(b2ac);\n      t1 = (-b + sqrtb2ac) / (2 * a);\n      if (0 < t1 && t1 < 1) {\n        tvalues.push(t1);\n      }\n      t2 = (-b - sqrtb2ac) / (2 * a);\n      if (0 < t2 && t2 < 1) {\n        tvalues.push(t2);\n      }\n    }\n\n    var x, y, j = tvalues.length, jlen = j, mt;\n    while (j--) {\n      t = tvalues[j];\n      mt = 1 - t;\n      x = (mt * mt * mt * x0) + (3 * mt * mt * t * x1) + (3 * mt * t * t * x2) + (t * t * t * x3);\n      bounds[0][j] = x;\n\n      y = (mt * mt * mt * y0) + (3 * mt * mt * t * y1) + (3 * mt * t * t * y2) + (t * t * t * y3);\n      bounds[1][j] = y;\n    }\n\n    bounds[0][jlen] = x0;\n    bounds[1][jlen] = y0;\n    bounds[0][jlen + 1] = x3;\n    bounds[1][jlen + 1] = y3;\n    var result = [\n      {\n        x: min.apply(null, bounds[0]),\n        y: min.apply(null, bounds[1])\n      },\n      {\n        x: max.apply(null, bounds[0]),\n        y: max.apply(null, bounds[1])\n      }\n    ];\n    if (fabric.cachesBoundsOfCurve) {\n      fabric.boundsOfCurveCache[argsString] = result;\n    }\n    return result;\n  }\n\n  /**\n   * Converts arc to a bunch of bezier curves\n   * @param {Number} fx starting point x\n   * @param {Number} fy starting point y\n   * @param {Array} coords Arc command\n   */\n  function fromArcToBeziers(fx, fy, coords) {\n    var rx = coords[1],\n        ry = coords[2],\n        rot = coords[3],\n        large = coords[4],\n        sweep = coords[5],\n        tx = coords[6],\n        ty = coords[7],\n        segsNorm = arcToSegments(tx - fx, ty - fy, rx, ry, large, sweep, rot);\n\n    for (var i = 0, len = segsNorm.length; i < len; i++) {\n      segsNorm[i][1] += fx;\n      segsNorm[i][2] += fy;\n      segsNorm[i][3] += fx;\n      segsNorm[i][4] += fy;\n      segsNorm[i][5] += fx;\n      segsNorm[i][6] += fy;\n    }\n    return segsNorm;\n  };\n\n  /**\n   * This function take a parsed SVG path and make it simpler for fabricJS logic.\n   * simplification consist of: only UPPERCASE absolute commands ( relative converted to absolute )\n   * S converted in C, T converted in Q, A converted in C.\n   * @param {Array} path the array of commands of a parsed svg path for fabric.Path\n   * @return {Array} the simplified array of commands of a parsed svg path for fabric.Path\n   */\n  function makePathSimpler(path) {\n    // x and y represent the last point of the path. the previous command point.\n    // we add them to each relative command to make it an absolute comment.\n    // we also swap the v V h H with L, because are easier to transform.\n    var x = 0, y = 0, len = path.length,\n        // x1 and y1 represent the last point of the subpath. the subpath is started with\n        // m or M command. When a z or Z command is drawn, x and y need to be resetted to\n        // the last x1 and y1.\n        x1 = 0, y1 = 0, current, i, converted,\n        // previous will host the letter of the previous command, to handle S and T.\n        // controlX and controlY will host the previous reflected control point\n        destinationPath = [], previous, controlX, controlY;\n    for (i = 0; i < len; ++i) {\n      converted = false;\n      current = path[i].slice(0);\n      switch (current[0]) { // first letter\n        case 'l': // lineto, relative\n          current[0] = 'L';\n          current[1] += x;\n          current[2] += y;\n          // falls through\n        case 'L':\n          x = current[1];\n          y = current[2];\n          break;\n        case 'h': // horizontal lineto, relative\n          current[1] += x;\n          // falls through\n        case 'H':\n          current[0] = 'L';\n          current[2] = y;\n          x = current[1];\n          break;\n        case 'v': // vertical lineto, relative\n          current[1] += y;\n          // falls through\n        case 'V':\n          current[0] = 'L';\n          y = current[1];\n          current[1] = x;\n          current[2] = y;\n          break;\n        case 'm': // moveTo, relative\n          current[0] = 'M';\n          current[1] += x;\n          current[2] += y;\n          // falls through\n        case 'M':\n          x = current[1];\n          y = current[2];\n          x1 = current[1];\n          y1 = current[2];\n          break;\n        case 'c': // bezierCurveTo, relative\n          current[0] = 'C';\n          current[1] += x;\n          current[2] += y;\n          current[3] += x;\n          current[4] += y;\n          current[5] += x;\n          current[6] += y;\n          // falls through\n        case 'C':\n          controlX = current[3];\n          controlY = current[4];\n          x = current[5];\n          y = current[6];\n          break;\n        case 's': // shorthand cubic bezierCurveTo, relative\n          current[0] = 'S';\n          current[1] += x;\n          current[2] += y;\n          current[3] += x;\n          current[4] += y;\n          // falls through\n        case 'S':\n          // would be sScC but since we are swapping sSc for C, we check just that.\n          if (previous === 'C') {\n            // calculate reflection of previous control points\n            controlX = 2 * x - controlX;\n            controlY = 2 * y - controlY;\n          }\n          else {\n            // If there is no previous command or if the previous command was not a C, c, S, or s,\n            // the control point is coincident with the current point\n            controlX = x;\n            controlY = y;\n          }\n          x = current[3];\n          y = current[4];\n          current[0] = 'C';\n          current[5] = current[3];\n          current[6] = current[4];\n          current[3] = current[1];\n          current[4] = current[2];\n          current[1] = controlX;\n          current[2] = controlY;\n          // current[3] and current[4] are NOW the second control point.\n          // we keep it for the next reflection.\n          controlX = current[3];\n          controlY = current[4];\n          break;\n        case 'q': // quadraticCurveTo, relative\n          current[0] = 'Q';\n          current[1] += x;\n          current[2] += y;\n          current[3] += x;\n          current[4] += y;\n          // falls through\n        case 'Q':\n          controlX = current[1];\n          controlY = current[2];\n          x = current[3];\n          y = current[4];\n          break;\n        case 't': // shorthand quadraticCurveTo, relative\n          current[0] = 'T';\n          current[1] += x;\n          current[2] += y;\n          // falls through\n        case 'T':\n          if (previous === 'Q') {\n            // calculate reflection of previous control point\n            controlX = 2 * x - controlX;\n            controlY = 2 * y - controlY;\n          }\n          else {\n            // If there is no previous command or if the previous command was not a Q, q, T or t,\n            // assume the control point is coincident with the current point\n            controlX = x;\n            controlY = y;\n          }\n          current[0] = 'Q';\n          x = current[1];\n          y = current[2];\n          current[1] = controlX;\n          current[2] = controlY;\n          current[3] = x;\n          current[4] = y;\n          break;\n        case 'a':\n          current[0] = 'A';\n          current[6] += x;\n          current[7] += y;\n          // falls through\n        case 'A':\n          converted = true;\n          destinationPath = destinationPath.concat(fromArcToBeziers(x, y, current));\n          x = current[6];\n          y = current[7];\n          break;\n        case 'z':\n        case 'Z':\n          x = x1;\n          y = y1;\n          break;\n        default:\n      }\n      if (!converted) {\n        destinationPath.push(current);\n      }\n      previous = current[0];\n    }\n    return destinationPath;\n  };\n\n  /**\n   * Calc length from point x1,y1 to x2,y2\n   * @param {Number} x1 starting point x\n   * @param {Number} y1 starting point y\n   * @param {Number} x2 starting point x\n   * @param {Number} y2 starting point y\n   * @return {Number} length of segment\n   */\n  function calcLineLength(x1, y1, x2, y2) {\n    return Math.sqrt((x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1));\n  }\n\n  // functions for the Cubic beizer\n  // taken from: https://github.com/konvajs/konva/blob/7.0.5/src/shapes/Path.ts#L350\n  function CB1(t) {\n    return t * t * t;\n  }\n  function CB2(t) {\n    return 3 * t * t * (1 - t);\n  }\n  function CB3(t) {\n    return 3 * t * (1 - t) * (1 - t);\n  }\n  function CB4(t) {\n    return (1 - t) * (1 - t) * (1 - t);\n  }\n\n  function getPointOnCubicBezierIterator(p1x, p1y, p2x, p2y, p3x, p3y, p4x, p4y) {\n    return function(pct) {\n      var c1 = CB1(pct), c2 = CB2(pct), c3 = CB3(pct), c4 = CB4(pct);\n      return {\n        x: p4x * c1 + p3x * c2 + p2x * c3 + p1x * c4,\n        y: p4y * c1 + p3y * c2 + p2y * c3 + p1y * c4\n      };\n    };\n  }\n\n  function getTangentCubicIterator(p1x, p1y, p2x, p2y, p3x, p3y, p4x, p4y) {\n    return function (pct) {\n      var invT = 1 - pct,\n          tangentX = (3 * invT * invT * (p2x - p1x)) + (6 * invT * pct * (p3x - p2x)) +\n          (3 * pct * pct * (p4x - p3x)),\n          tangentY = (3 * invT * invT * (p2y - p1y)) + (6 * invT * pct * (p3y - p2y)) +\n          (3 * pct * pct * (p4y - p3y));\n      return Math.atan2(tangentY, tangentX);\n    };\n  }\n\n  function QB1(t) {\n    return t * t;\n  }\n\n  function QB2(t) {\n    return 2 * t * (1 - t);\n  }\n\n  function QB3(t) {\n    return (1 - t) * (1 - t);\n  }\n\n  function getPointOnQuadraticBezierIterator(p1x, p1y, p2x, p2y, p3x, p3y) {\n    return function(pct) {\n      var c1 = QB1(pct), c2 = QB2(pct), c3 = QB3(pct);\n      return {\n        x: p3x * c1 + p2x * c2 + p1x * c3,\n        y: p3y * c1 + p2y * c2 + p1y * c3\n      };\n    };\n  }\n\n  function getTangentQuadraticIterator(p1x, p1y, p2x, p2y, p3x, p3y) {\n    return function (pct) {\n      var invT = 1 - pct,\n          tangentX = (2 * invT * (p2x - p1x)) + (2 * pct * (p3x - p2x)),\n          tangentY = (2 * invT * (p2y - p1y)) + (2 * pct * (p3y - p2y));\n      return Math.atan2(tangentY, tangentX);\n    };\n  }\n\n\n  // this will run over a path segment ( a cubic or quadratic segment) and approximate it\n  // with 100 segemnts. This will good enough to calculate the length of the curve\n  function pathIterator(iterator, x1, y1) {\n    var tempP = { x: x1, y: y1 }, p, tmpLen = 0, perc;\n    for (perc = 1; perc <= 100; perc += 1) {\n      p = iterator(perc / 100);\n      tmpLen += calcLineLength(tempP.x, tempP.y, p.x, p.y);\n      tempP = p;\n    }\n    return tmpLen;\n  }\n\n  /**\n   * Given a pathInfo, and a distance in pixels, find the percentage from 0 to 1\n   * that correspond to that pixels run over the path.\n   * The percentage will be then used to find the correct point on the canvas for the path.\n   * @param {Array} segInfo fabricJS collection of information on a parsed path\n   * @param {Number} distance from starting point, in pixels.\n   * @return {Object} info object with x and y ( the point on canvas ) and angle, the tangent on that point;\n   */\n  function findPercentageForDistance(segInfo, distance) {\n    var perc = 0, tmpLen = 0, iterator = segInfo.iterator, tempP = { x: segInfo.x, y: segInfo.y },\n        p, nextLen, nextStep = 0.01, angleFinder = segInfo.angleFinder, lastPerc;\n    // nextStep > 0.0001 covers 0.00015625 that 1/64th of 1/100\n    // the path\n    while (tmpLen < distance && nextStep > 0.0001) {\n      p = iterator(perc);\n      lastPerc = perc;\n      nextLen = calcLineLength(tempP.x, tempP.y, p.x, p.y);\n      // compare tmpLen each cycle with distance, decide next perc to test.\n      if ((nextLen + tmpLen) > distance) {\n        // we discard this step and we make smaller steps.\n        perc -= nextStep;\n        nextStep /= 2;\n      }\n      else {\n        tempP = p;\n        perc += nextStep;\n        tmpLen += nextLen;\n      }\n    }\n    p.angle = angleFinder(lastPerc);\n    return p;\n  }\n\n  /**\n   * Run over a parsed and simplifed path and extrac some informations.\n   * informations are length of each command and starting point\n   * @param {Array} path fabricJS parsed path commands\n   * @return {Array} path commands informations\n   */\n  function getPathSegmentsInfo(path) {\n    var totalLength = 0, len = path.length, current,\n        //x2 and y2 are the coords of segment start\n        //x1 and y1 are the coords of the current point\n        x1 = 0, y1 = 0, x2 = 0, y2 = 0, info = [], iterator, tempInfo, angleFinder;\n    for (var i = 0; i < len; i++) {\n      current = path[i];\n      tempInfo = {\n        x: x1,\n        y: y1,\n        command: current[0],\n      };\n      switch (current[0]) { //first letter\n        case 'M':\n          tempInfo.length = 0;\n          x2 = x1 = current[1];\n          y2 = y1 = current[2];\n          break;\n        case 'L':\n          tempInfo.length = calcLineLength(x1, y1, current[1], current[2]);\n          x1 = current[1];\n          y1 = current[2];\n          break;\n        case 'C':\n          iterator = getPointOnCubicBezierIterator(\n            x1,\n            y1,\n            current[1],\n            current[2],\n            current[3],\n            current[4],\n            current[5],\n            current[6]\n          );\n          angleFinder = getTangentCubicIterator(\n            x1,\n            y1,\n            current[1],\n            current[2],\n            current[3],\n            current[4],\n            current[5],\n            current[6]\n          );\n          tempInfo.iterator = iterator;\n          tempInfo.angleFinder = angleFinder;\n          tempInfo.length = pathIterator(iterator, x1, y1);\n          x1 = current[5];\n          y1 = current[6];\n          break;\n        case 'Q':\n          iterator = getPointOnQuadraticBezierIterator(\n            x1,\n            y1,\n            current[1],\n            current[2],\n            current[3],\n            current[4]\n          );\n          angleFinder = getTangentQuadraticIterator(\n            x1,\n            y1,\n            current[1],\n            current[2],\n            current[3],\n            current[4]\n          );\n          tempInfo.iterator = iterator;\n          tempInfo.angleFinder = angleFinder;\n          tempInfo.length = pathIterator(iterator, x1, y1);\n          x1 = current[3];\n          y1 = current[4];\n          break;\n        case 'Z':\n        case 'z':\n          // we add those in order to ease calculations later\n          tempInfo.destX = x2;\n          tempInfo.destY = y2;\n          tempInfo.length = calcLineLength(x1, y1, x2, y2);\n          x1 = x2;\n          y1 = y2;\n          break;\n      }\n      totalLength += tempInfo.length;\n      info.push(tempInfo);\n    }\n    info.push({ length: totalLength, x: x1, y: y1 });\n    return info;\n  }\n\n  function getPointOnPath(path, distance, infos) {\n    if (!infos) {\n      infos = getPathSegmentsInfo(path);\n    }\n    var i = 0;\n    while ((distance - infos[i].length > 0) && i < (infos.length - 2)) {\n      distance -= infos[i].length;\n      i++;\n    }\n    // var distance = infos[infos.length - 1] * perc;\n    var segInfo = infos[i], segPercent = distance / segInfo.length,\n        command = segInfo.command, segment = path[i], info;\n\n    switch (command) {\n      case 'M':\n        return { x: segInfo.x, y: segInfo.y, angle: 0 };\n      case 'Z':\n      case 'z':\n        info = new fabric.Point(segInfo.x, segInfo.y).lerp(\n          new fabric.Point(segInfo.destX, segInfo.destY),\n          segPercent\n        );\n        info.angle = Math.atan2(segInfo.destY - segInfo.y, segInfo.destX - segInfo.x);\n        return info;\n      case 'L':\n        info = new fabric.Point(segInfo.x, segInfo.y).lerp(\n          new fabric.Point(segment[1], segment[2]),\n          segPercent\n        );\n        info.angle = Math.atan2(segment[2] - segInfo.y, segment[1] - segInfo.x);\n        return info;\n      case 'C':\n        return findPercentageForDistance(segInfo, distance);\n      case 'Q':\n        return findPercentageForDistance(segInfo, distance);\n    }\n  }\n\n  /**\n   *\n   * @param {string} pathString\n   * @return {(string|number)[][]} An array of SVG path commands\n   * @example <caption>Usage</caption>\n   * parsePath('M 3 4 Q 3 5 2 1 4 0 Q 9 12 2 1 4 0') === [\n   *   ['M', 3, 4],\n   *   ['Q', 3, 5, 2, 1, 4, 0],\n   *   ['Q', 9, 12, 2, 1, 4, 0],\n   * ];\n   *\n   */\n  function parsePath(pathString) {\n    var result = [],\n        coords = [],\n        currentPath,\n        parsed,\n        re = fabric.rePathCommand,\n        rNumber = '[-+]?(?:\\\\d*\\\\.\\\\d+|\\\\d+\\\\.?)(?:[eE][-+]?\\\\d+)?\\\\s*',\n        rNumberCommaWsp = '(' + rNumber + ')' + fabric.commaWsp,\n        rFlagCommaWsp = '([01])' + fabric.commaWsp + '?',\n        rArcSeq = rNumberCommaWsp + '?' + rNumberCommaWsp + '?' + rNumberCommaWsp + rFlagCommaWsp + rFlagCommaWsp +\n          rNumberCommaWsp + '?(' + rNumber + ')',\n        regArcArgumentSequence = new RegExp(rArcSeq, 'g'),\n        match,\n        coordsStr,\n        // one of commands (m,M,l,L,q,Q,c,C,etc.) followed by non-command characters (i.e. command values)\n        path;\n    if (!pathString || !pathString.match) {\n      return result;\n    }\n    path = pathString.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);\n\n    for (var i = 0, coordsParsed, len = path.length; i < len; i++) {\n      currentPath = path[i];\n\n      coordsStr = currentPath.slice(1).trim();\n      coords.length = 0;\n\n      var command = currentPath.charAt(0);\n      coordsParsed = [command];\n\n      if (command.toLowerCase() === 'a') {\n        // arcs have special flags that apparently don't require spaces so handle special\n        for (var args; (args = regArcArgumentSequence.exec(coordsStr));) {\n          for (var j = 1; j < args.length; j++) {\n            coords.push(args[j]);\n          }\n        }\n      }\n      else {\n        while ((match = re.exec(coordsStr))) {\n          coords.push(match[0]);\n        }\n      }\n\n      for (var j = 0, jlen = coords.length; j < jlen; j++) {\n        parsed = parseFloat(coords[j]);\n        if (!isNaN(parsed)) {\n          coordsParsed.push(parsed);\n        }\n      }\n\n      var commandLength = commandLengths[command.toLowerCase()],\n          repeatedCommand = repeatedCommands[command] || command;\n\n      if (coordsParsed.length - 1 > commandLength) {\n        for (var k = 1, klen = coordsParsed.length; k < klen; k += commandLength) {\n          result.push([command].concat(coordsParsed.slice(k, k + commandLength)));\n          command = repeatedCommand;\n        }\n      }\n      else {\n        result.push(coordsParsed);\n      }\n    }\n\n    return result;\n  };\n\n  /**\n   *\n   * Converts points to a smooth SVG path\n   * @param {{ x: number,y: number }[]} points Array of points\n   * @param {number} [correction] Apply a correction to the path (usually we use `width / 1000`). If value is undefined 0 is used as the correction value.\n   * @return {(string|number)[][]} An array of SVG path commands\n   */\n  function getSmoothPathFromPoints(points, correction) {\n    var path = [], i,\n        p1 = new fabric.Point(points[0].x, points[0].y),\n        p2 = new fabric.Point(points[1].x, points[1].y),\n        len = points.length, multSignX = 1, multSignY = 0, manyPoints = len > 2;\n    correction = correction || 0;\n\n    if (manyPoints) {\n      multSignX = points[2].x < p2.x ? -1 : points[2].x === p2.x ? 0 : 1;\n      multSignY = points[2].y < p2.y ? -1 : points[2].y === p2.y ? 0 : 1;\n    }\n    path.push(['M', p1.x - multSignX * correction, p1.y - multSignY * correction]);\n    for (i = 1; i < len; i++) {\n      if (!p1.eq(p2)) {\n        var midPoint = p1.midPointFrom(p2);\n        // p1 is our bezier control point\n        // midpoint is our endpoint\n        // start point is p(i-1) value.\n        path.push(['Q', p1.x, p1.y, midPoint.x, midPoint.y]);\n      }\n      p1 = points[i];\n      if ((i + 1) < points.length) {\n        p2 = points[i + 1];\n      }\n    }\n    if (manyPoints) {\n      multSignX = p1.x > points[i - 2].x ? 1 : p1.x === points[i - 2].x ? 0 : -1;\n      multSignY = p1.y > points[i - 2].y ? 1 : p1.y === points[i - 2].y ? 0 : -1;\n    }\n    path.push(['L', p1.x + multSignX * correction, p1.y + multSignY * correction]);\n    return path;\n  }\n  /**\n   * Transform a path by transforming each segment.\n   * it has to be a simplified path or it won't work.\n   * WARNING: this depends from pathOffset for correct operation\n   * @param {Array} path fabricJS parsed and simplified path commands\n   * @param {Array} transform matrix that represent the transformation\n   * @param {Object} [pathOffset] the fabric.Path pathOffset\n   * @param {Number} pathOffset.x\n   * @param {Number} pathOffset.y\n   * @returns {Array} the transformed path\n   */\n  function transformPath(path, transform, pathOffset) {\n    if (pathOffset) {\n      transform = fabric.util.multiplyTransformMatrices(\n        transform,\n        [1, 0, 0, 1, -pathOffset.x, -pathOffset.y]\n      );\n    }\n    return path.map(function(pathSegment) {\n      var newSegment = pathSegment.slice(0), point = {};\n      for (var i = 1; i < pathSegment.length - 1; i += 2) {\n        point.x = pathSegment[i];\n        point.y = pathSegment[i + 1];\n        point = fabric.util.transformPoint(point, transform);\n        newSegment[i] = point.x;\n        newSegment[i + 1] = point.y;\n      }\n      return newSegment;\n    });\n  }\n\n  /**\n   * Join path commands to go back to svg format\n   * @param {Array} pathData fabricJS parsed path commands\n   * @return {String} joined path 'M 0 0 L 20 30'\n   */\n  fabric.util.joinPath = function(pathData) {\n    return pathData.map(function (segment) { return segment.join(' '); }).join(' ');\n  };\n  fabric.util.parsePath = parsePath;\n  fabric.util.makePathSimpler = makePathSimpler;\n  fabric.util.getSmoothPathFromPoints = getSmoothPathFromPoints;\n  fabric.util.getPathSegmentsInfo = getPathSegmentsInfo;\n  fabric.util.getBoundsOfCurve = getBoundsOfCurve;\n  fabric.util.getPointOnPath = getPointOnPath;\n  fabric.util.transformPath = transformPath;\n})();\n\n\n(function() {\n\n  var slice = Array.prototype.slice;\n\n  /**\n   * Invokes method on all items in a given array\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} method Name of a method to invoke\n   * @return {Array}\n   */\n  function invoke(array, method) {\n    var args = slice.call(arguments, 2), result = [];\n    for (var i = 0, len = array.length; i < len; i++) {\n      result[i] = args.length ? array[i][method].apply(array[i], args) : array[i][method].call(array[i]);\n    }\n    return result;\n  }\n\n  /**\n   * Finds maximum value in array (not necessarily \"first\" one)\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} byProperty\n   * @return {*}\n   */\n  function max(array, byProperty) {\n    return find(array, byProperty, function(value1, value2) {\n      return value1 >= value2;\n    });\n  }\n\n  /**\n   * Finds minimum value in array (not necessarily \"first\" one)\n   * @memberOf fabric.util.array\n   * @param {Array} array Array to iterate over\n   * @param {String} byProperty\n   * @return {*}\n   */\n  function min(array, byProperty) {\n    return find(array, byProperty, function(value1, value2) {\n      return value1 < value2;\n    });\n  }\n\n  /**\n   * @private\n   */\n  function fill(array, value) {\n    var k = array.length;\n    while (k--) {\n      array[k] = value;\n    }\n    return array;\n  }\n\n  /**\n   * @private\n   */\n  function find(array, byProperty, condition) {\n    if (!array || array.length === 0) {\n      return;\n    }\n\n    var i = array.length - 1,\n        result = byProperty ? array[i][byProperty] : array[i];\n    if (byProperty) {\n      while (i--) {\n        if (condition(array[i][byProperty], result)) {\n          result = array[i][byProperty];\n        }\n      }\n    }\n    else {\n      while (i--) {\n        if (condition(array[i], result)) {\n          result = array[i];\n        }\n      }\n    }\n    return result;\n  }\n\n  /**\n   * @namespace fabric.util.array\n   */\n  fabric.util.array = {\n    fill: fill,\n    invoke: invoke,\n    min: min,\n    max: max\n  };\n\n})();\n\n\n(function() {\n  /**\n   * Copies all enumerable properties of one js object to another\n   * this does not and cannot compete with generic utils.\n   * Does not clone or extend fabric.Object subclasses.\n   * This is mostly for internal use and has extra handling for fabricJS objects\n   * it skips the canvas and group properties in deep cloning.\n   * @memberOf fabric.util.object\n   * @param {Object} destination Where to copy to\n   * @param {Object} source Where to copy from\n   * @param {Boolean} [deep] Whether to extend nested objects\n   * @return {Object}\n   */\n\n  function extend(destination, source, deep) {\n    // JScript DontEnum bug is not taken care of\n    // the deep clone is for internal use, is not meant to avoid\n    // javascript traps or cloning html element or self referenced objects.\n    if (deep) {\n      if (!fabric.isLikelyNode && source instanceof Element) {\n        // avoid cloning deep images, canvases,\n        destination = source;\n      }\n      else if (source instanceof Array) {\n        destination = [];\n        for (var i = 0, len = source.length; i < len; i++) {\n          destination[i] = extend({ }, source[i], deep);\n        }\n      }\n      else if (source && typeof source === 'object') {\n        for (var property in source) {\n          if (property === 'canvas' || property === 'group') {\n            // we do not want to clone this props at all.\n            // we want to keep the keys in the copy\n            destination[property] = null;\n          }\n          else if (source.hasOwnProperty(property)) {\n            destination[property] = extend({ }, source[property], deep);\n          }\n        }\n      }\n      else {\n        // this sounds odd for an extend but is ok for recursive use\n        destination = source;\n      }\n    }\n    else {\n      for (var property in source) {\n        destination[property] = source[property];\n      }\n    }\n    return destination;\n  }\n\n  /**\n   * Creates an empty object and copies all enumerable properties of another object to it\n   * This method is mostly for internal use, and not intended for duplicating shapes in canvas. \n   * @memberOf fabric.util.object\n   * @param {Object} object Object to clone\n   * @param {Boolean} [deep] Whether to clone nested objects\n   * @return {Object}\n   */\n\n  //TODO: this function return an empty object if you try to clone null\n  function clone(object, deep) {\n    return extend({ }, object, deep);\n  }\n\n  /** @namespace fabric.util.object */\n  fabric.util.object = {\n    extend: extend,\n    clone: clone\n  };\n  fabric.util.object.extend(fabric.util, fabric.Observable);\n})();\n\n\n(function() {\n\n  /**\n   * Camelizes a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to camelize\n   * @return {String} Camelized version of a string\n   */\n  function camelize(string) {\n    return string.replace(/-+(.)?/g, function(match, character) {\n      return character ? character.toUpperCase() : '';\n    });\n  }\n\n  /**\n   * Capitalizes a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to capitalize\n   * @param {Boolean} [firstLetterOnly] If true only first letter is capitalized\n   * and other letters stay untouched, if false first letter is capitalized\n   * and other letters are converted to lowercase.\n   * @return {String} Capitalized version of a string\n   */\n  function capitalize(string, firstLetterOnly) {\n    return string.charAt(0).toUpperCase() +\n      (firstLetterOnly ? string.slice(1) : string.slice(1).toLowerCase());\n  }\n\n  /**\n   * Escapes XML in a string\n   * @memberOf fabric.util.string\n   * @param {String} string String to escape\n   * @return {String} Escaped version of a string\n   */\n  function escapeXml(string) {\n    return string.replace(/&/g, '&amp;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&apos;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;');\n  }\n\n  /**\n   * Divide a string in the user perceived single units\n   * @memberOf fabric.util.string\n   * @param {String} textstring String to escape\n   * @return {Array} array containing the graphemes\n   */\n  function graphemeSplit(textstring) {\n    var i = 0, chr, graphemes = [];\n    for (i = 0, chr; i < textstring.length; i++) {\n      if ((chr = getWholeChar(textstring, i)) === false) {\n        continue;\n      }\n      graphemes.push(chr);\n    }\n    return graphemes;\n  }\n\n  // taken from mdn in the charAt doc page.\n  function getWholeChar(str, i) {\n    var code = str.charCodeAt(i);\n\n    if (isNaN(code)) {\n      return ''; // Position not found\n    }\n    if (code < 0xD800 || code > 0xDFFF) {\n      return str.charAt(i);\n    }\n\n    // High surrogate (could change last hex to 0xDB7F to treat high private\n    // surrogates as single characters)\n    if (0xD800 <= code && code <= 0xDBFF) {\n      if (str.length <= (i + 1)) {\n        throw 'High surrogate without following low surrogate';\n      }\n      var next = str.charCodeAt(i + 1);\n      if (0xDC00 > next || next > 0xDFFF) {\n        throw 'High surrogate without following low surrogate';\n      }\n      return str.charAt(i) + str.charAt(i + 1);\n    }\n    // Low surrogate (0xDC00 <= code && code <= 0xDFFF)\n    if (i === 0) {\n      throw 'Low surrogate without preceding high surrogate';\n    }\n    var prev = str.charCodeAt(i - 1);\n\n    // (could change last hex to 0xDB7F to treat high private\n    // surrogates as single characters)\n    if (0xD800 > prev || prev > 0xDBFF) {\n      throw 'Low surrogate without preceding high surrogate';\n    }\n    // We can pass over low surrogates now as the second component\n    // in a pair which we have already processed\n    return false;\n  }\n\n\n  /**\n   * String utilities\n   * @namespace fabric.util.string\n   */\n  fabric.util.string = {\n    camelize: camelize,\n    capitalize: capitalize,\n    escapeXml: escapeXml,\n    graphemeSplit: graphemeSplit\n  };\n})();\n\n\n(function() {\n\n  var slice = Array.prototype.slice, emptyFunction = function() { },\n\n      IS_DONTENUM_BUGGY = (function() {\n        for (var p in { toString: 1 }) {\n          if (p === 'toString') {\n            return false;\n          }\n        }\n        return true;\n      })(),\n\n      /** @ignore */\n      addMethods = function(klass, source, parent) {\n        for (var property in source) {\n\n          if (property in klass.prototype &&\n              typeof klass.prototype[property] === 'function' &&\n              (source[property] + '').indexOf('callSuper') > -1) {\n\n            klass.prototype[property] = (function(property) {\n              return function() {\n\n                var superclass = this.constructor.superclass;\n                this.constructor.superclass = parent;\n                var returnValue = source[property].apply(this, arguments);\n                this.constructor.superclass = superclass;\n\n                if (property !== 'initialize') {\n                  return returnValue;\n                }\n              };\n            })(property);\n          }\n          else {\n            klass.prototype[property] = source[property];\n          }\n\n          if (IS_DONTENUM_BUGGY) {\n            if (source.toString !== Object.prototype.toString) {\n              klass.prototype.toString = source.toString;\n            }\n            if (source.valueOf !== Object.prototype.valueOf) {\n              klass.prototype.valueOf = source.valueOf;\n            }\n          }\n        }\n      };\n\n  function Subclass() { }\n\n  function callSuper(methodName) {\n    var parentMethod = null,\n        _this = this;\n\n    // climb prototype chain to find method not equal to callee's method\n    while (_this.constructor.superclass) {\n      var superClassMethod = _this.constructor.superclass.prototype[methodName];\n      if (_this[methodName] !== superClassMethod) {\n        parentMethod = superClassMethod;\n        break;\n      }\n      // eslint-disable-next-line\n      _this = _this.constructor.superclass.prototype;\n    }\n\n    if (!parentMethod) {\n      return console.log('tried to callSuper ' + methodName + ', method not found in prototype chain', this);\n    }\n\n    return (arguments.length > 1)\n      ? parentMethod.apply(this, slice.call(arguments, 1))\n      : parentMethod.call(this);\n  }\n\n  /**\n   * Helper for creation of \"classes\".\n   * @memberOf fabric.util\n   * @param {Function} [parent] optional \"Class\" to inherit from\n   * @param {Object} [properties] Properties shared by all instances of this class\n   *                  (be careful modifying objects defined here as this would affect all instances)\n   */\n  function createClass() {\n    var parent = null,\n        properties = slice.call(arguments, 0);\n\n    if (typeof properties[0] === 'function') {\n      parent = properties.shift();\n    }\n    function klass() {\n      this.initialize.apply(this, arguments);\n    }\n\n    klass.superclass = parent;\n    klass.subclasses = [];\n\n    if (parent) {\n      Subclass.prototype = parent.prototype;\n      klass.prototype = new Subclass();\n      parent.subclasses.push(klass);\n    }\n    for (var i = 0, length = properties.length; i < length; i++) {\n      addMethods(klass, properties[i], parent);\n    }\n    if (!klass.prototype.initialize) {\n      klass.prototype.initialize = emptyFunction;\n    }\n    klass.prototype.constructor = klass;\n    klass.prototype.callSuper = callSuper;\n    return klass;\n  }\n\n  fabric.util.createClass = createClass;\n})();\n\n\n(function () {\n  // since ie11 can use addEventListener but they do not support options, i need to check\n  var couldUseAttachEvent = !!fabric.document.createElement('div').attachEvent,\n      touchEvents = ['touchstart', 'touchmove', 'touchend'];\n  /**\n   * Adds an event listener to an element\n   * @function\n   * @memberOf fabric.util\n   * @param {HTMLElement} element\n   * @param {String} eventName\n   * @param {Function} handler\n   */\n  fabric.util.addListener = function(element, eventName, handler, options) {\n    element && element.addEventListener(eventName, handler, couldUseAttachEvent ? false : options);\n  };\n\n  /**\n   * Removes an event listener from an element\n   * @function\n   * @memberOf fabric.util\n   * @param {HTMLElement} element\n   * @param {String} eventName\n   * @param {Function} handler\n   */\n  fabric.util.removeListener = function(element, eventName, handler, options) {\n    element && element.removeEventListener(eventName, handler, couldUseAttachEvent ? false : options);\n  };\n\n  function getTouchInfo(event) {\n    var touchProp = event.changedTouches;\n    if (touchProp && touchProp[0]) {\n      return touchProp[0];\n    }\n    return event;\n  }\n\n  fabric.util.getPointer = function(event) {\n    var element = event.target,\n        scroll = fabric.util.getScrollLeftTop(element),\n        _evt = getTouchInfo(event);\n    return {\n      x: _evt.clientX + scroll.left,\n      y: _evt.clientY + scroll.top\n    };\n  };\n\n  fabric.util.isTouchEvent = function(event) {\n    return touchEvents.indexOf(event.type) > -1 || event.pointerType === 'touch';\n  };\n})();\n\n\n(function () {\n\n  /**\n   * Cross-browser wrapper for setting element's style\n   * @memberOf fabric.util\n   * @param {HTMLElement} element\n   * @param {Object} styles\n   * @return {HTMLElement} Element that was passed as a first argument\n   */\n  function setStyle(element, styles) {\n    var elementStyle = element.style;\n    if (!elementStyle) {\n      return element;\n    }\n    if (typeof styles === 'string') {\n      element.style.cssText += ';' + styles;\n      return styles.indexOf('opacity') > -1\n        ? setOpacity(element, styles.match(/opacity:\\s*(\\d?\\.?\\d*)/)[1])\n        : element;\n    }\n    for (var property in styles) {\n      if (property === 'opacity') {\n        setOpacity(element, styles[property]);\n      }\n      else {\n        var normalizedProperty = (property === 'float' || property === 'cssFloat')\n          ? (typeof elementStyle.styleFloat === 'undefined' ? 'cssFloat' : 'styleFloat')\n          : property;\n        elementStyle.setProperty(normalizedProperty, styles[property]);\n      }\n    }\n    return element;\n  }\n\n  var parseEl = fabric.document.createElement('div'),\n      supportsOpacity = typeof parseEl.style.opacity === 'string',\n      supportsFilters = typeof parseEl.style.filter === 'string',\n      reOpacity = /alpha\\s*\\(\\s*opacity\\s*=\\s*([^\\)]+)\\)/,\n\n      /** @ignore */\n      setOpacity = function (element) { return element; };\n\n  if (supportsOpacity) {\n    /** @ignore */\n    setOpacity = function(element, value) {\n      element.style.opacity = value;\n      return element;\n    };\n  }\n  else if (supportsFilters) {\n    /** @ignore */\n    setOpacity = function(element, value) {\n      var es = element.style;\n      if (element.currentStyle && !element.currentStyle.hasLayout) {\n        es.zoom = 1;\n      }\n      if (reOpacity.test(es.filter)) {\n        value = value >= 0.9999 ? '' : ('alpha(opacity=' + (value * 100) + ')');\n        es.filter = es.filter.replace(reOpacity, value);\n      }\n      else {\n        es.filter += ' alpha(opacity=' + (value * 100) + ')';\n      }\n      return element;\n    };\n  }\n\n  fabric.util.setStyle = setStyle;\n\n})();\n\n\n(function() {\n\n  var _slice = Array.prototype.slice;\n\n  /**\n   * Takes id and returns an element with that id (if one exists in a document)\n   * @memberOf fabric.util\n   * @param {String|HTMLElement} id\n   * @return {HTMLElement|null}\n   */\n  function getById(id) {\n    return typeof id === 'string' ? fabric.document.getElementById(id) : id;\n  }\n\n  var sliceCanConvertNodelists,\n      /**\n       * Converts an array-like object (e.g. arguments or NodeList) to an array\n       * @memberOf fabric.util\n       * @param {Object} arrayLike\n       * @return {Array}\n       */\n      toArray = function(arrayLike) {\n        return _slice.call(arrayLike, 0);\n      };\n\n  try {\n    sliceCanConvertNodelists = toArray(fabric.document.childNodes) instanceof Array;\n  }\n  catch (err) { }\n\n  if (!sliceCanConvertNodelists) {\n    toArray = function(arrayLike) {\n      var arr = new Array(arrayLike.length), i = arrayLike.length;\n      while (i--) {\n        arr[i] = arrayLike[i];\n      }\n      return arr;\n    };\n  }\n\n  /**\n   * Creates specified element with specified attributes\n   * @memberOf fabric.util\n   * @param {String} tagName Type of an element to create\n   * @param {Object} [attributes] Attributes to set on an element\n   * @return {HTMLElement} Newly created element\n   */\n  function makeElement(tagName, attributes) {\n    var el = fabric.document.createElement(tagName);\n    for (var prop in attributes) {\n      if (prop === 'class') {\n        el.className = attributes[prop];\n      }\n      else if (prop === 'for') {\n        el.htmlFor = attributes[prop];\n      }\n      else {\n        el.setAttribute(prop, attributes[prop]);\n      }\n    }\n    return el;\n  }\n\n  /**\n   * Adds class to an element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to add class to\n   * @param {String} className Class to add to an element\n   */\n  function addClass(element, className) {\n    if (element && (' ' + element.className + ' ').indexOf(' ' + className + ' ') === -1) {\n      element.className += (element.className ? ' ' : '') + className;\n    }\n  }\n\n  /**\n   * Wraps element with another element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to wrap\n   * @param {HTMLElement|String} wrapper Element to wrap with\n   * @param {Object} [attributes] Attributes to set on a wrapper\n   * @return {HTMLElement} wrapper\n   */\n  function wrapElement(element, wrapper, attributes) {\n    if (typeof wrapper === 'string') {\n      wrapper = makeElement(wrapper, attributes);\n    }\n    if (element.parentNode) {\n      element.parentNode.replaceChild(wrapper, element);\n    }\n    wrapper.appendChild(element);\n    return wrapper;\n  }\n\n  /**\n   * Returns element scroll offsets\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to operate on\n   * @return {Object} Object with left/top values\n   */\n  function getScrollLeftTop(element) {\n\n    var left = 0,\n        top = 0,\n        docElement = fabric.document.documentElement,\n        body = fabric.document.body || {\n          scrollLeft: 0, scrollTop: 0\n        };\n\n    // While loop checks (and then sets element to) .parentNode OR .host\n    //  to account for ShadowDOM. We still want to traverse up out of ShadowDOM,\n    //  but the .parentNode of a root ShadowDOM node will always be null, instead\n    //  it should be accessed through .host. See http://stackoverflow.com/a/24765528/4383938\n    while (element && (element.parentNode || element.host)) {\n\n      // Set element to element parent, or 'host' in case of ShadowDOM\n      element = element.parentNode || element.host;\n\n      if (element === fabric.document) {\n        left = body.scrollLeft || docElement.scrollLeft || 0;\n        top = body.scrollTop ||  docElement.scrollTop || 0;\n      }\n      else {\n        left += element.scrollLeft || 0;\n        top += element.scrollTop || 0;\n      }\n\n      if (element.nodeType === 1 && element.style.position === 'fixed') {\n        break;\n      }\n    }\n\n    return { left: left, top: top };\n  }\n\n  /**\n   * Returns offset for a given element\n   * @function\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to get offset for\n   * @return {Object} Object with \"left\" and \"top\" properties\n   */\n  function getElementOffset(element) {\n    var docElem,\n        doc = element && element.ownerDocument,\n        box = { left: 0, top: 0 },\n        offset = { left: 0, top: 0 },\n        scrollLeftTop,\n        offsetAttributes = {\n          borderLeftWidth: 'left',\n          borderTopWidth:  'top',\n          paddingLeft:     'left',\n          paddingTop:      'top'\n        };\n\n    if (!doc) {\n      return offset;\n    }\n\n    for (var attr in offsetAttributes) {\n      offset[offsetAttributes[attr]] += parseInt(getElementStyle(element, attr), 10) || 0;\n    }\n\n    docElem = doc.documentElement;\n    if ( typeof element.getBoundingClientRect !== 'undefined' ) {\n      box = element.getBoundingClientRect();\n    }\n\n    scrollLeftTop = getScrollLeftTop(element);\n\n    return {\n      left: box.left + scrollLeftTop.left - (docElem.clientLeft || 0) + offset.left,\n      top: box.top + scrollLeftTop.top - (docElem.clientTop || 0)  + offset.top\n    };\n  }\n\n  /**\n   * Returns style attribute value of a given element\n   * @memberOf fabric.util\n   * @param {HTMLElement} element Element to get style attribute for\n   * @param {String} attr Style attribute to get for element\n   * @return {String} Style attribute value of the given element.\n   */\n  var getElementStyle;\n  if (fabric.document.defaultView && fabric.document.defaultView.getComputedStyle) {\n    getElementStyle = function(element, attr) {\n      var style = fabric.document.defaultView.getComputedStyle(element, null);\n      return style ? style[attr] : undefined;\n    };\n  }\n  else {\n    getElementStyle = function(element, attr) {\n      var value = element.style[attr];\n      if (!value && element.currentStyle) {\n        value = element.currentStyle[attr];\n      }\n      return value;\n    };\n  }\n\n  (function () {\n    var style = fabric.document.documentElement.style,\n        selectProp = 'userSelect' in style\n          ? 'userSelect'\n          : 'MozUserSelect' in style\n            ? 'MozUserSelect'\n            : 'WebkitUserSelect' in style\n              ? 'WebkitUserSelect'\n              : 'KhtmlUserSelect' in style\n                ? 'KhtmlUserSelect'\n                : '';\n\n    /**\n     * Makes element unselectable\n     * @memberOf fabric.util\n     * @param {HTMLElement} element Element to make unselectable\n     * @return {HTMLElement} Element that was passed in\n     */\n    function makeElementUnselectable(element) {\n      if (typeof element.onselectstart !== 'undefined') {\n        element.onselectstart = fabric.util.falseFunction;\n      }\n      if (selectProp) {\n        element.style[selectProp] = 'none';\n      }\n      else if (typeof element.unselectable === 'string') {\n        element.unselectable = 'on';\n      }\n      return element;\n    }\n\n    /**\n     * Makes element selectable\n     * @memberOf fabric.util\n     * @param {HTMLElement} element Element to make selectable\n     * @return {HTMLElement} Element that was passed in\n     */\n    function makeElementSelectable(element) {\n      if (typeof element.onselectstart !== 'undefined') {\n        element.onselectstart = null;\n      }\n      if (selectProp) {\n        element.style[selectProp] = '';\n      }\n      else if (typeof element.unselectable === 'string') {\n        element.unselectable = '';\n      }\n      return element;\n    }\n\n    fabric.util.makeElementUnselectable = makeElementUnselectable;\n    fabric.util.makeElementSelectable = makeElementSelectable;\n  })();\n\n  function getNodeCanvas(element) {\n    var impl = fabric.jsdomImplForWrapper(element);\n    return impl._canvas || impl._image;\n  };\n\n  function cleanUpJsdomNode(element) {\n    if (!fabric.isLikelyNode) {\n      return;\n    }\n    var impl = fabric.jsdomImplForWrapper(element);\n    if (impl) {\n      impl._image = null;\n      impl._canvas = null;\n      // unsure if necessary\n      impl._currentSrc = null;\n      impl._attributes = null;\n      impl._classList = null;\n    }\n  }\n\n  function setImageSmoothing(ctx, value) {\n    ctx.imageSmoothingEnabled = ctx.imageSmoothingEnabled || ctx.webkitImageSmoothingEnabled\n      || ctx.mozImageSmoothingEnabled || ctx.msImageSmoothingEnabled || ctx.oImageSmoothingEnabled;\n    ctx.imageSmoothingEnabled = value;\n  }\n\n  /**\n   * setImageSmoothing sets the context imageSmoothingEnabled property.\n   * Used by canvas and by ImageObject.\n   * @memberOf fabric.util\n   * @since 4.0.0\n   * @param {HTMLRenderingContext2D} ctx to set on\n   * @param {Boolean} value true or false\n   */\n  fabric.util.setImageSmoothing = setImageSmoothing;\n  fabric.util.getById = getById;\n  fabric.util.toArray = toArray;\n  fabric.util.addClass = addClass;\n  fabric.util.makeElement = makeElement;\n  fabric.util.wrapElement = wrapElement;\n  fabric.util.getScrollLeftTop = getScrollLeftTop;\n  fabric.util.getElementOffset = getElementOffset;\n  fabric.util.getNodeCanvas = getNodeCanvas;\n  fabric.util.cleanUpJsdomNode = cleanUpJsdomNode;\n\n})();\n\n\n(function() {\n\n  function addParamToUrl(url, param) {\n    return url + (/\\?/.test(url) ? '&' : '?') + param;\n  }\n\n  function emptyFn() { }\n\n  /**\n   * Cross-browser abstraction for sending XMLHttpRequest\n   * @memberOf fabric.util\n   * @param {String} url URL to send XMLHttpRequest to\n   * @param {Object} [options] Options object\n   * @param {String} [options.method=\"GET\"]\n   * @param {String} [options.parameters] parameters to append to url in GET or in body\n   * @param {String} [options.body] body to send with POST or PUT request\n   * @param {Function} options.onComplete Callback to invoke when request is completed\n   * @return {XMLHttpRequest} request\n   */\n  function request(url, options) {\n    options || (options = { });\n\n    var method = options.method ? options.method.toUpperCase() : 'GET',\n        onComplete = options.onComplete || function() { },\n        xhr = new fabric.window.XMLHttpRequest(),\n        body = options.body || options.parameters;\n\n    /** @ignore */\n    xhr.onreadystatechange = function() {\n      if (xhr.readyState === 4) {\n        onComplete(xhr);\n        xhr.onreadystatechange = emptyFn;\n      }\n    };\n\n    if (method === 'GET') {\n      body = null;\n      if (typeof options.parameters === 'string') {\n        url = addParamToUrl(url, options.parameters);\n      }\n    }\n\n    xhr.open(method, url, true);\n\n    if (method === 'POST' || method === 'PUT') {\n      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n    }\n\n    xhr.send(body);\n    return xhr;\n  }\n\n  fabric.util.request = request;\n})();\n\n\n/**\n * Wrapper around `console.log` (when available)\n * @param {*} [values] Values to log\n */\nfabric.log = console.log;\n\n/**\n * Wrapper around `console.warn` (when available)\n * @param {*} [values] Values to log as a warning\n */\nfabric.warn = console.warn;\n\n\n(function () {\n\n  var extend = fabric.util.object.extend,\n      clone = fabric.util.object.clone;\n\n  /**\n   * @typedef {Object} AnimationOptions\n   * Animation of a value or list of values.\n   * When using lists, think of something like this:\n   * fabric.util.animate({\n   *   startValue: [1, 2, 3],\n   *   endValue: [2, 4, 6],\n   *   onChange: function([a, b, c]) {\n   *     canvas.zoomToPoint({x: b, y: c}, a)\n   *     canvas.renderAll()\n   *   }\n   * });\n   * @example\n   * @property {Function} [onChange] Callback; invoked on every value change\n   * @property {Function} [onComplete] Callback; invoked when value change is completed\n   * @example\n   * // Note: startValue, endValue, and byValue must match the type\n   * var animationOptions = { startValue: 0, endValue: 1, byValue: 0.25 }\n   * var animationOptions = { startValue: [0, 1], endValue: [1, 2], byValue: [0.25, 0.25] }\n   * @property {number | number[]} [startValue=0] Starting value\n   * @property {number | number[]} [endValue=100] Ending value\n   * @property {number | number[]} [byValue=100] Value to modify the property by\n   * @property {Function} [easing] Easing function\n   * @property {Number} [duration=500] Duration of change (in ms)\n   * @property {Function} [abort] Additional function with logic. If returns true, animation aborts.\n   *\n   * @typedef {() => void} CancelFunction\n   *\n   * @typedef {Object} AnimationCurrentState\n   * @property {number | number[]} currentValue value in range [`startValue`, `endValue`]\n   * @property {number} completionRate value in range [0, 1]\n   * @property {number} durationRate value in range [0, 1]\n   *\n   * @typedef {(AnimationOptions & AnimationCurrentState & { cancel: CancelFunction }} AnimationContext\n   */\n\n  /**\n   * Array holding all running animations\n   * @memberof fabric\n   * @type {AnimationContext[]}\n   */\n  var RUNNING_ANIMATIONS = [];\n  fabric.util.object.extend(RUNNING_ANIMATIONS, {\n\n    /**\n     * cancel all running animations at the next requestAnimFrame\n     * @returns {AnimationContext[]}\n     */\n    cancelAll: function () {\n      var animations = this.splice(0);\n      animations.forEach(function (animation) {\n        animation.cancel();\n      });\n      return animations;\n    },\n\n    /**\n     * cancel all running animations attached to canvas at the next requestAnimFrame\n     * @param {fabric.Canvas} canvas\n     * @returns {AnimationContext[]}\n     */\n    cancelByCanvas: function (canvas) {\n      if (!canvas) {\n        return [];\n      }\n      var cancelled = this.filter(function (animation) {\n        return typeof animation.target === 'object' && animation.target.canvas === canvas;\n      });\n      cancelled.forEach(function (animation) {\n        animation.cancel();\n      });\n      return cancelled;\n    },\n\n    /**\n     * cancel all running animations for target at the next requestAnimFrame\n     * @param {*} target\n     * @returns {AnimationContext[]}\n     */\n    cancelByTarget: function (target) {\n      var cancelled = this.findAnimationsByTarget(target);\n      cancelled.forEach(function (animation) {\n        animation.cancel();\n      });\n      return cancelled;\n    },\n\n    /**\n     *\n     * @param {CancelFunction} cancelFunc the function returned by animate\n     * @returns {number}\n     */\n    findAnimationIndex: function (cancelFunc) {\n      return this.indexOf(this.findAnimation(cancelFunc));\n    },\n\n    /**\n     *\n     * @param {CancelFunction} cancelFunc the function returned by animate\n     * @returns {AnimationContext | undefined} animation's options object\n     */\n    findAnimation: function (cancelFunc) {\n      return this.find(function (animation) {\n        return animation.cancel === cancelFunc;\n      });\n    },\n\n    /**\n     *\n     * @param {*} target the object that is assigned to the target property of the animation context\n     * @returns {AnimationContext[]} array of animation options object associated with target\n     */\n    findAnimationsByTarget: function (target) {\n      if (!target) {\n        return [];\n      }\n      return this.filter(function (animation) {\n        return animation.target === target;\n      });\n    }\n  });\n\n  function noop() {\n    return false;\n  }\n\n  function defaultEasing(t, b, c, d) {\n    return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;\n  }\n\n  /**\n   * Changes value from one to another within certain period of time, invoking callbacks as value is being changed.\n   * @memberOf fabric.util\n   * @param {AnimationOptions} [options] Animation options\n   * @example\n   * // Note: startValue, endValue, and byValue must match the type\n   * fabric.util.animate({ startValue: 0, endValue: 1, byValue: 0.25 })\n   * fabric.util.animate({ startValue: [0, 1], endValue: [1, 2], byValue: [0.25, 0.25] })\n   * @returns {CancelFunction} cancel function\n   */\n  function animate(options) {\n    options || (options = {});\n    var cancel = false,\n        context,\n        removeFromRegistry = function () {\n          var index = fabric.runningAnimations.indexOf(context);\n          return index > -1 && fabric.runningAnimations.splice(index, 1)[0];\n        };\n\n    context = extend(clone(options), {\n      cancel: function () {\n        cancel = true;\n        return removeFromRegistry();\n      },\n      currentValue: 'startValue' in options ? options.startValue : 0,\n      completionRate: 0,\n      durationRate: 0\n    });\n    fabric.runningAnimations.push(context);\n\n    requestAnimFrame(function(timestamp) {\n      var start = timestamp || +new Date(),\n          duration = options.duration || 500,\n          finish = start + duration, time,\n          onChange = options.onChange || noop,\n          abort = options.abort || noop,\n          onComplete = options.onComplete || noop,\n          easing = options.easing || defaultEasing,\n          isMany = 'startValue' in options ? options.startValue.length > 0 : false,\n          startValue = 'startValue' in options ? options.startValue : 0,\n          endValue = 'endValue' in options ? options.endValue : 100,\n          byValue = options.byValue || (isMany ? startValue.map(function(value, i) {\n            return endValue[i] - startValue[i];\n          }) : endValue - startValue);\n\n      options.onStart && options.onStart();\n\n      (function tick(ticktime) {\n        time = ticktime || +new Date();\n        var currentTime = time > finish ? duration : (time - start),\n            timePerc = currentTime / duration,\n            current = isMany ? startValue.map(function(_value, i) {\n              return easing(currentTime, startValue[i], byValue[i], duration);\n            }) : easing(currentTime, startValue, byValue, duration),\n            valuePerc = isMany ? Math.abs((current[0] - startValue[0]) / byValue[0])\n              : Math.abs((current - startValue) / byValue);\n        //  update context\n        context.currentValue = isMany ? current.slice() : current;\n        context.completionRate = valuePerc;\n        context.durationRate = timePerc;\n        if (cancel) {\n          return;\n        }\n        if (abort(current, valuePerc, timePerc)) {\n          removeFromRegistry();\n          return;\n        }\n        if (time > finish) {\n          //  update context\n          context.currentValue = isMany ? endValue.slice() : endValue;\n          context.completionRate = 1;\n          context.durationRate = 1;\n          //  execute callbacks\n          onChange(isMany ? endValue.slice() : endValue, 1, 1);\n          onComplete(endValue, 1, 1);\n          removeFromRegistry();\n          return;\n        }\n        else {\n          onChange(current, valuePerc, timePerc);\n          requestAnimFrame(tick);\n        }\n      })(start);\n    });\n\n    return context.cancel;\n  }\n\n  var _requestAnimFrame = fabric.window.requestAnimationFrame       ||\n                          fabric.window.webkitRequestAnimationFrame ||\n                          fabric.window.mozRequestAnimationFrame    ||\n                          fabric.window.oRequestAnimationFrame      ||\n                          fabric.window.msRequestAnimationFrame     ||\n                          function(callback) {\n                            return fabric.window.setTimeout(callback, 1000 / 60);\n                          };\n\n  var _cancelAnimFrame = fabric.window.cancelAnimationFrame || fabric.window.clearTimeout;\n\n  /**\n   * requestAnimationFrame polyfill based on http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n   * In order to get a precise start time, `requestAnimFrame` should be called as an entry into the method\n   * @memberOf fabric.util\n   * @param {Function} callback Callback to invoke\n   * @param {DOMElement} element optional Element to associate with animation\n   */\n  function requestAnimFrame() {\n    return _requestAnimFrame.apply(fabric.window, arguments);\n  }\n\n  function cancelAnimFrame() {\n    return _cancelAnimFrame.apply(fabric.window, arguments);\n  }\n\n  fabric.util.animate = animate;\n  fabric.util.requestAnimFrame = requestAnimFrame;\n  fabric.util.cancelAnimFrame = cancelAnimFrame;\n  fabric.runningAnimations = RUNNING_ANIMATIONS;\n})();\n\n\n(function() {\n  // Calculate an in-between color. Returns a \"rgba()\" string.\n  // Credit: Edwin Martin <edwin@bitstorm.org>\n  //         http://www.bitstorm.org/jquery/color-animation/jquery.animate-colors.js\n  function calculateColor(begin, end, pos) {\n    var color = 'rgba('\n        + parseInt((begin[0] + pos * (end[0] - begin[0])), 10) + ','\n        + parseInt((begin[1] + pos * (end[1] - begin[1])), 10) + ','\n        + parseInt((begin[2] + pos * (end[2] - begin[2])), 10);\n\n    color += ',' + (begin && end ? parseFloat(begin[3] + pos * (end[3] - begin[3])) : 1);\n    color += ')';\n    return color;\n  }\n\n  /**\n   * Changes the color from one to another within certain period of time, invoking callbacks as value is being changed.\n   * @memberOf fabric.util\n   * @param {String} fromColor The starting color in hex or rgb(a) format.\n   * @param {String} toColor The starting color in hex or rgb(a) format.\n   * @param {Number} [duration] Duration of change (in ms).\n   * @param {Object} [options] Animation options\n   * @param {Function} [options.onChange] Callback; invoked on every value change\n   * @param {Function} [options.onComplete] Callback; invoked when value change is completed\n   * @param {Function} [options.colorEasing] Easing function. Note that this function only take two arguments (currentTime, duration). Thus the regular animation easing functions cannot be used.\n   * @param {Function} [options.abort] Additional function with logic. If returns true, onComplete is called.\n   * @returns {Function} abort function\n   */\n  function animateColor(fromColor, toColor, duration, options) {\n    var startColor = new fabric.Color(fromColor).getSource(),\n        endColor = new fabric.Color(toColor).getSource(),\n        originalOnComplete = options.onComplete,\n        originalOnChange = options.onChange;\n    options = options || {};\n\n    return fabric.util.animate(fabric.util.object.extend(options, {\n      duration: duration || 500,\n      startValue: startColor,\n      endValue: endColor,\n      byValue: endColor,\n      easing: function (currentTime, startValue, byValue, duration) {\n        var posValue = options.colorEasing\n          ? options.colorEasing(currentTime, duration)\n          : 1 - Math.cos(currentTime / duration * (Math.PI / 2));\n        return calculateColor(startValue, byValue, posValue);\n      },\n      // has to take in account for color restoring;\n      onComplete: function(current, valuePerc, timePerc) {\n        if (originalOnComplete) {\n          return originalOnComplete(\n            calculateColor(endColor, endColor, 0),\n            valuePerc,\n            timePerc\n          );\n        }\n      },\n      onChange: function(current, valuePerc, timePerc) {\n        if (originalOnChange) {\n          if (Array.isArray(current)) {\n            return originalOnChange(\n              calculateColor(current, current, 0),\n              valuePerc,\n              timePerc\n            );\n          }\n          originalOnChange(current, valuePerc, timePerc);\n        }\n      }\n    }));\n  }\n\n  fabric.util.animateColor = animateColor;\n\n})();\n\n\n(function() {\n\n  function normalize(a, c, p, s) {\n    if (a < Math.abs(c)) {\n      a = c;\n      s = p / 4;\n    }\n    else {\n      //handle the 0/0 case:\n      if (c === 0 && a === 0) {\n        s = p / (2 * Math.PI) * Math.asin(1);\n      }\n      else {\n        s = p / (2 * Math.PI) * Math.asin(c / a);\n      }\n    }\n    return { a: a, c: c, p: p, s: s };\n  }\n\n  function elastic(opts, t, d) {\n    return opts.a *\n      Math.pow(2, 10 * (t -= 1)) *\n      Math.sin( (t * d - opts.s) * (2 * Math.PI) / opts.p );\n  }\n\n  /**\n   * Cubic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutCubic(t, b, c, d) {\n    return c * ((t = t / d - 1) * t * t + 1) + b;\n  }\n\n  /**\n   * Cubic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutCubic(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return c / 2 * t * t * t + b;\n    }\n    return c / 2 * ((t -= 2) * t * t + 2) + b;\n  }\n\n  /**\n   * Quartic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInQuart(t, b, c, d) {\n    return c * (t /= d) * t * t * t + b;\n  }\n\n  /**\n   * Quartic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutQuart(t, b, c, d) {\n    return -c * ((t = t / d - 1) * t * t * t - 1) + b;\n  }\n\n  /**\n   * Quartic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutQuart(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return c / 2 * t * t * t * t + b;\n    }\n    return -c / 2 * ((t -= 2) * t * t * t - 2) + b;\n  }\n\n  /**\n   * Quintic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInQuint(t, b, c, d) {\n    return c * (t /= d) * t * t * t * t + b;\n  }\n\n  /**\n   * Quintic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutQuint(t, b, c, d) {\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\n  }\n\n  /**\n   * Quintic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutQuint(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return c / 2 * t * t * t * t * t + b;\n    }\n    return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\n  }\n\n  /**\n   * Sinusoidal easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInSine(t, b, c, d) {\n    return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;\n  }\n\n  /**\n   * Sinusoidal easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutSine(t, b, c, d) {\n    return c * Math.sin(t / d * (Math.PI / 2)) + b;\n  }\n\n  /**\n   * Sinusoidal easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutSine(t, b, c, d) {\n    return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;\n  }\n\n  /**\n   * Exponential easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInExpo(t, b, c, d) {\n    return (t === 0) ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;\n  }\n\n  /**\n   * Exponential easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutExpo(t, b, c, d) {\n    return (t === d) ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;\n  }\n\n  /**\n   * Exponential easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutExpo(t, b, c, d) {\n    if (t === 0) {\n      return b;\n    }\n    if (t === d) {\n      return b + c;\n    }\n    t /= d / 2;\n    if (t < 1) {\n      return c / 2 * Math.pow(2, 10 * (t - 1)) + b;\n    }\n    return c / 2 * (-Math.pow(2, -10 * --t) + 2) + b;\n  }\n\n  /**\n   * Circular easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInCirc(t, b, c, d) {\n    return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\n  }\n\n  /**\n   * Circular easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutCirc(t, b, c, d) {\n    return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\n  }\n\n  /**\n   * Circular easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutCirc(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n      return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b;\n    }\n    return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\n  }\n\n  /**\n   * Elastic easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInElastic(t, b, c, d) {\n    var s = 1.70158, p = 0, a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d;\n    if (t === 1) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * 0.3;\n    }\n    var opts = normalize(a, c, p, s);\n    return -elastic(opts, t, d) + b;\n  }\n\n  /**\n   * Elastic easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutElastic(t, b, c, d) {\n    var s = 1.70158, p = 0, a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d;\n    if (t === 1) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * 0.3;\n    }\n    var opts = normalize(a, c, p, s);\n    return opts.a * Math.pow(2, -10 * t) * Math.sin((t * d - opts.s) * (2 * Math.PI) / opts.p ) + opts.c + b;\n  }\n\n  /**\n   * Elastic easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutElastic(t, b, c, d) {\n    var s = 1.70158, p = 0, a = c;\n    if (t === 0) {\n      return b;\n    }\n    t /= d / 2;\n    if (t === 2) {\n      return b + c;\n    }\n    if (!p) {\n      p = d * (0.3 * 1.5);\n    }\n    var opts = normalize(a, c, p, s);\n    if (t < 1) {\n      return -0.5 * elastic(opts, t, d) + b;\n    }\n    return opts.a * Math.pow(2, -10 * (t -= 1)) *\n      Math.sin((t * d - opts.s) * (2 * Math.PI) / opts.p ) * 0.5 + opts.c + b;\n  }\n\n  /**\n   * Backwards easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    return c * (t /= d) * t * ((s + 1) * t - s) + b;\n  }\n\n  /**\n   * Backwards easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\n  }\n\n  /**\n   * Backwards easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutBack(t, b, c, d, s) {\n    if (s === undefined) {\n      s = 1.70158;\n    }\n    t /= d / 2;\n    if (t < 1) {\n      return c / 2 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;\n    }\n    return c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;\n  }\n\n  /**\n   * Bouncing easing in\n   * @memberOf fabric.util.ease\n   */\n  function easeInBounce(t, b, c, d) {\n    return c - easeOutBounce (d - t, 0, c, d) + b;\n  }\n\n  /**\n   * Bouncing easing out\n   * @memberOf fabric.util.ease\n   */\n  function easeOutBounce(t, b, c, d) {\n    if ((t /= d) < (1 / 2.75)) {\n      return c * (7.5625 * t * t) + b;\n    }\n    else if (t < (2 / 2.75)) {\n      return c * (7.5625 * (t -= (1.5 / 2.75)) * t + 0.75) + b;\n    }\n    else if (t < (2.5 / 2.75)) {\n      return c * (7.5625 * (t -= (2.25 / 2.75)) * t + 0.9375) + b;\n    }\n    else {\n      return c * (7.5625 * (t -= (2.625 / 2.75)) * t + 0.984375) + b;\n    }\n  }\n\n  /**\n   * Bouncing easing in and out\n   * @memberOf fabric.util.ease\n   */\n  function easeInOutBounce(t, b, c, d) {\n    if (t < d / 2) {\n      return easeInBounce (t * 2, 0, c, d) * 0.5 + b;\n    }\n    return easeOutBounce(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\n  }\n\n  /**\n   * Easing functions\n   * See <a href=\"http://gizma.com/easing/\">Easing Equations by Robert Penner</a>\n   * @namespace fabric.util.ease\n   */\n  fabric.util.ease = {\n\n    /**\n     * Quadratic easing in\n     * @memberOf fabric.util.ease\n     */\n    easeInQuad: function(t, b, c, d) {\n      return c * (t /= d) * t + b;\n    },\n\n    /**\n     * Quadratic easing out\n     * @memberOf fabric.util.ease\n     */\n    easeOutQuad: function(t, b, c, d) {\n      return -c * (t /= d) * (t - 2) + b;\n    },\n\n    /**\n     * Quadratic easing in and out\n     * @memberOf fabric.util.ease\n     */\n    easeInOutQuad: function(t, b, c, d) {\n      t /= (d / 2);\n      if (t < 1) {\n        return c / 2 * t * t + b;\n      }\n      return -c / 2 * ((--t) * (t - 2) - 1) + b;\n    },\n\n    /**\n     * Cubic easing in\n     * @memberOf fabric.util.ease\n     */\n    easeInCubic: function(t, b, c, d) {\n      return c * (t /= d) * t * t + b;\n    },\n\n    easeOutCubic: easeOutCubic,\n    easeInOutCubic: easeInOutCubic,\n    easeInQuart: easeInQuart,\n    easeOutQuart: easeOutQuart,\n    easeInOutQuart: easeInOutQuart,\n    easeInQuint: easeInQuint,\n    easeOutQuint: easeOutQuint,\n    easeInOutQuint: easeInOutQuint,\n    easeInSine: easeInSine,\n    easeOutSine: easeOutSine,\n    easeInOutSine: easeInOutSine,\n    easeInExpo: easeInExpo,\n    easeOutExpo: easeOutExpo,\n    easeInOutExpo: easeInOutExpo,\n    easeInCirc: easeInCirc,\n    easeOutCirc: easeOutCirc,\n    easeInOutCirc: easeInOutCirc,\n    easeInElastic: easeInElastic,\n    easeOutElastic: easeOutElastic,\n    easeInOutElastic: easeInOutElastic,\n    easeInBack: easeInBack,\n    easeOutBack: easeOutBack,\n    easeInOutBack: easeInOutBack,\n    easeInBounce: easeInBounce,\n    easeOutBounce: easeOutBounce,\n    easeInOutBounce: easeInOutBounce\n  };\n\n})();\n\n\n(function(global) {\n\n  'use strict';\n\n  /**\n   * @name fabric\n   * @namespace\n   */\n\n  var fabric = global.fabric || (global.fabric = { }),\n      extend = fabric.util.object.extend,\n      clone = fabric.util.object.clone,\n      toFixed = fabric.util.toFixed,\n      parseUnit = fabric.util.parseUnit,\n      multiplyTransformMatrices = fabric.util.multiplyTransformMatrices,\n\n      svgValidTagNames = ['path', 'circle', 'polygon', 'polyline', 'ellipse', 'rect', 'line',\n        'image', 'text'],\n      svgViewBoxElements = ['symbol', 'image', 'marker', 'pattern', 'view', 'svg'],\n      svgInvalidAncestors = ['pattern', 'defs', 'symbol', 'metadata', 'clipPath', 'mask', 'desc'],\n      svgValidParents = ['symbol', 'g', 'a', 'svg', 'clipPath', 'defs'],\n\n      attributesMap = {\n        cx:                   'left',\n        x:                    'left',\n        r:                    'radius',\n        cy:                   'top',\n        y:                    'top',\n        display:              'visible',\n        visibility:           'visible',\n        transform:            'transformMatrix',\n        'fill-opacity':       'fillOpacity',\n        'fill-rule':          'fillRule',\n        'font-family':        'fontFamily',\n        'font-size':          'fontSize',\n        'font-style':         'fontStyle',\n        'font-weight':        'fontWeight',\n        'letter-spacing':     'charSpacing',\n        'paint-order':        'paintFirst',\n        'stroke-dasharray':   'strokeDashArray',\n        'stroke-dashoffset':  'strokeDashOffset',\n        'stroke-linecap':     'strokeLineCap',\n        'stroke-linejoin':    'strokeLineJoin',\n        'stroke-miterlimit':  'strokeMiterLimit',\n        'stroke-opacity':     'strokeOpacity',\n        'stroke-width':       'strokeWidth',\n        'text-decoration':    'textDecoration',\n        'text-anchor':        'textAnchor',\n        opacity:              'opacity',\n        'clip-path':          'clipPath',\n        'clip-rule':          'clipRule',\n        'vector-effect':      'strokeUniform',\n        'image-rendering':    'imageSmoothing',\n      },\n\n      colorAttributes = {\n        stroke: 'strokeOpacity',\n        fill:   'fillOpacity'\n      },\n\n      fSize = 'font-size', cPath = 'clip-path';\n\n  fabric.svgValidTagNamesRegEx = getSvgRegex(svgValidTagNames);\n  fabric.svgViewBoxElementsRegEx = getSvgRegex(svgViewBoxElements);\n  fabric.svgInvalidAncestorsRegEx = getSvgRegex(svgInvalidAncestors);\n  fabric.svgValidParentsRegEx = getSvgRegex(svgValidParents);\n\n  fabric.cssRules = { };\n  fabric.gradientDefs = { };\n  fabric.clipPaths = { };\n\n  function normalizeAttr(attr) {\n    // transform attribute names\n    if (attr in attributesMap) {\n      return attributesMap[attr];\n    }\n    return attr;\n  }\n\n  function normalizeValue(attr, value, parentAttributes, fontSize) {\n    var isArray = Array.isArray(value), parsed;\n\n    if ((attr === 'fill' || attr === 'stroke') && value === 'none') {\n      value = '';\n    }\n    else if (attr === 'strokeUniform') {\n      return (value === 'non-scaling-stroke');\n    }\n    else if (attr === 'strokeDashArray') {\n      if (value === 'none') {\n        value = null;\n      }\n      else {\n        value = value.replace(/,/g, ' ').split(/\\s+/).map(parseFloat);\n      }\n    }\n    else if (attr === 'transformMatrix') {\n      if (parentAttributes && parentAttributes.transformMatrix) {\n        value = multiplyTransformMatrices(\n          parentAttributes.transformMatrix, fabric.parseTransformAttribute(value));\n      }\n      else {\n        value = fabric.parseTransformAttribute(value);\n      }\n    }\n    else if (attr === 'visible') {\n      value = value !== 'none' && value !== 'hidden';\n      // display=none on parent element always takes precedence over child element\n      if (parentAttributes && parentAttributes.visible === false) {\n        value = false;\n      }\n    }\n    else if (attr === 'opacity') {\n      value = parseFloat(value);\n      if (parentAttributes && typeof parentAttributes.opacity !== 'undefined') {\n        value *= parentAttributes.opacity;\n      }\n    }\n    else if (attr === 'textAnchor' /* text-anchor */) {\n      value = value === 'start' ? 'left' : value === 'end' ? 'right' : 'center';\n    }\n    else if (attr === 'charSpacing') {\n      // parseUnit returns px and we convert it to em\n      parsed = parseUnit(value, fontSize) / fontSize * 1000;\n    }\n    else if (attr === 'paintFirst') {\n      var fillIndex = value.indexOf('fill');\n      var strokeIndex = value.indexOf('stroke');\n      var value = 'fill';\n      if (fillIndex > -1 && strokeIndex > -1 && strokeIndex < fillIndex) {\n        value = 'stroke';\n      }\n      else if (fillIndex === -1 && strokeIndex > -1) {\n        value = 'stroke';\n      }\n    }\n    else if (attr === 'href' || attr === 'xlink:href' || attr === 'font') {\n      return value;\n    }\n    else if (attr === 'imageSmoothing') {\n      return (value === 'optimizeQuality');\n    }\n    else {\n      parsed = isArray ? value.map(parseUnit) : parseUnit(value, fontSize);\n    }\n\n    return (!isArray && isNaN(parsed) ? value : parsed);\n  }\n\n  /**\n    * @private\n    */\n  function getSvgRegex(arr) {\n    return new RegExp('^(' + arr.join('|') + ')\\\\b', 'i');\n  }\n\n  /**\n   * @private\n   * @param {Object} attributes Array of attributes to parse\n   */\n  function _setStrokeFillOpacity(attributes) {\n    for (var attr in colorAttributes) {\n\n      if (typeof attributes[colorAttributes[attr]] === 'undefined' || attributes[attr] === '') {\n        continue;\n      }\n\n      if (typeof attributes[attr] === 'undefined') {\n        if (!fabric.Object.prototype[attr]) {\n          continue;\n        }\n        attributes[attr] = fabric.Object.prototype[attr];\n      }\n\n      if (attributes[attr].indexOf('url(') === 0) {\n        continue;\n      }\n\n      var color = new fabric.Color(attributes[attr]);\n      attributes[attr] = color.setAlpha(toFixed(color.getAlpha() * attributes[colorAttributes[attr]], 2)).toRgba();\n    }\n    return attributes;\n  }\n\n  /**\n   * @private\n   */\n  function _getMultipleNodes(doc, nodeNames) {\n    var nodeName, nodeArray = [], nodeList, i, len;\n    for (i = 0, len = nodeNames.length; i < len; i++) {\n      nodeName = nodeNames[i];\n      nodeList = doc.getElementsByTagName(nodeName);\n      nodeArray = nodeArray.concat(Array.prototype.slice.call(nodeList));\n    }\n    return nodeArray;\n  }\n\n  /**\n   * Parses \"transform\" attribute, returning an array of values\n   * @static\n   * @function\n   * @memberOf fabric\n   * @param {String} attributeValue String containing attribute value\n   * @return {Array} Array of 6 elements representing transformation matrix\n   */\n  fabric.parseTransformAttribute = (function() {\n    function rotateMatrix(matrix, args) {\n      var cos = fabric.util.cos(args[0]), sin = fabric.util.sin(args[0]),\n          x = 0, y = 0;\n      if (args.length === 3) {\n        x = args[1];\n        y = args[2];\n      }\n\n      matrix[0] = cos;\n      matrix[1] = sin;\n      matrix[2] = -sin;\n      matrix[3] = cos;\n      matrix[4] = x - (cos * x - sin * y);\n      matrix[5] = y - (sin * x + cos * y);\n    }\n\n    function scaleMatrix(matrix, args) {\n      var multiplierX = args[0],\n          multiplierY = (args.length === 2) ? args[1] : args[0];\n\n      matrix[0] = multiplierX;\n      matrix[3] = multiplierY;\n    }\n\n    function skewMatrix(matrix, args, pos) {\n      matrix[pos] = Math.tan(fabric.util.degreesToRadians(args[0]));\n    }\n\n    function translateMatrix(matrix, args) {\n      matrix[4] = args[0];\n      if (args.length === 2) {\n        matrix[5] = args[1];\n      }\n    }\n\n    // identity matrix\n    var iMatrix = fabric.iMatrix,\n\n        // == begin transform regexp\n        number = fabric.reNum,\n\n        commaWsp = fabric.commaWsp,\n\n        skewX = '(?:(skewX)\\\\s*\\\\(\\\\s*(' + number + ')\\\\s*\\\\))',\n\n        skewY = '(?:(skewY)\\\\s*\\\\(\\\\s*(' + number + ')\\\\s*\\\\))',\n\n        rotate = '(?:(rotate)\\\\s*\\\\(\\\\s*(' + number + ')(?:' +\n                    commaWsp + '(' + number + ')' +\n                    commaWsp + '(' + number + '))?\\\\s*\\\\))',\n\n        scale = '(?:(scale)\\\\s*\\\\(\\\\s*(' + number + ')(?:' +\n                    commaWsp + '(' + number + '))?\\\\s*\\\\))',\n\n        translate = '(?:(translate)\\\\s*\\\\(\\\\s*(' + number + ')(?:' +\n                    commaWsp + '(' + number + '))?\\\\s*\\\\))',\n\n        matrix = '(?:(matrix)\\\\s*\\\\(\\\\s*' +\n                  '(' + number + ')' + commaWsp +\n                  '(' + number + ')' + commaWsp +\n                  '(' + number + ')' + commaWsp +\n                  '(' + number + ')' + commaWsp +\n                  '(' + number + ')' + commaWsp +\n                  '(' + number + ')' +\n                  '\\\\s*\\\\))',\n\n        transform = '(?:' +\n                    matrix + '|' +\n                    translate + '|' +\n                    scale + '|' +\n                    rotate + '|' +\n                    skewX + '|' +\n                    skewY +\n                    ')',\n\n        transforms = '(?:' + transform + '(?:' + commaWsp + '*' + transform + ')*' + ')',\n\n        transformList = '^\\\\s*(?:' + transforms + '?)\\\\s*$',\n\n        // http://www.w3.org/TR/SVG/coords.html#TransformAttribute\n        reTransformList = new RegExp(transformList),\n        // == end transform regexp\n\n        reTransform = new RegExp(transform, 'g');\n\n    return function(attributeValue) {\n\n      // start with identity matrix\n      var matrix = iMatrix.concat(),\n          matrices = [];\n\n      // return if no argument was given or\n      // an argument does not match transform attribute regexp\n      if (!attributeValue || (attributeValue && !reTransformList.test(attributeValue))) {\n        return matrix;\n      }\n\n      attributeValue.replace(reTransform, function(match) {\n\n        var m = new RegExp(transform).exec(match).filter(function (match) {\n              // match !== '' && match != null\n              return (!!match);\n            }),\n            operation = m[1],\n            args = m.slice(2).map(parseFloat);\n\n        switch (operation) {\n          case 'translate':\n            translateMatrix(matrix, args);\n            break;\n          case 'rotate':\n            args[0] = fabric.util.degreesToRadians(args[0]);\n            rotateMatrix(matrix, args);\n            break;\n          case 'scale':\n            scaleMatrix(matrix, args);\n            break;\n          case 'skewX':\n            skewMatrix(matrix, args, 2);\n            break;\n          case 'skewY':\n            skewMatrix(matrix, args, 1);\n            break;\n          case 'matrix':\n            matrix = args;\n            break;\n        }\n\n        // snapshot current matrix into matrices array\n        matrices.push(matrix.concat());\n        // reset\n        matrix = iMatrix.concat();\n      });\n\n      var combinedMatrix = matrices[0];\n      while (matrices.length > 1) {\n        matrices.shift();\n        combinedMatrix = fabric.util.multiplyTransformMatrices(combinedMatrix, matrices[0]);\n      }\n      return combinedMatrix;\n    };\n  })();\n\n  /**\n   * @private\n   */\n  function parseStyleString(style, oStyle) {\n    var attr, value;\n    style.replace(/;\\s*$/, '').split(';').forEach(function (chunk) {\n      var pair = chunk.split(':');\n\n      attr = pair[0].trim().toLowerCase();\n      value =  pair[1].trim();\n\n      oStyle[attr] = value;\n    });\n  }\n\n  /**\n   * @private\n   */\n  function parseStyleObject(style, oStyle) {\n    var attr, value;\n    for (var prop in style) {\n      if (typeof style[prop] === 'undefined') {\n        continue;\n      }\n\n      attr = prop.toLowerCase();\n      value = style[prop];\n\n      oStyle[attr] = value;\n    }\n  }\n\n  /**\n   * @private\n   */\n  function getGlobalStylesForElement(element, svgUid) {\n    var styles = { };\n    for (var rule in fabric.cssRules[svgUid]) {\n      if (elementMatchesRule(element, rule.split(' '))) {\n        for (var property in fabric.cssRules[svgUid][rule]) {\n          styles[property] = fabric.cssRules[svgUid][rule][property];\n        }\n      }\n    }\n    return styles;\n  }\n\n  /**\n   * @private\n   */\n  function elementMatchesRule(element, selectors) {\n    var firstMatching, parentMatching = true;\n    //start from rightmost selector.\n    firstMatching = selectorMatches(element, selectors.pop());\n    if (firstMatching && selectors.length) {\n      parentMatching = doesSomeParentMatch(element, selectors);\n    }\n    return firstMatching && parentMatching && (selectors.length === 0);\n  }\n\n  function doesSomeParentMatch(element, selectors) {\n    var selector, parentMatching = true;\n    while (element.parentNode && element.parentNode.nodeType === 1 && selectors.length) {\n      if (parentMatching) {\n        selector = selectors.pop();\n      }\n      element = element.parentNode;\n      parentMatching = selectorMatches(element, selector);\n    }\n    return selectors.length === 0;\n  }\n\n  /**\n   * @private\n   */\n  function selectorMatches(element, selector) {\n    var nodeName = element.nodeName,\n        classNames = element.getAttribute('class'),\n        id = element.getAttribute('id'), matcher, i;\n    // i check if a selector matches slicing away part from it.\n    // if i get empty string i should match\n    matcher = new RegExp('^' + nodeName, 'i');\n    selector = selector.replace(matcher, '');\n    if (id && selector.length) {\n      matcher = new RegExp('#' + id + '(?![a-zA-Z\\\\-]+)', 'i');\n      selector = selector.replace(matcher, '');\n    }\n    if (classNames && selector.length) {\n      classNames = classNames.split(' ');\n      for (i = classNames.length; i--;) {\n        matcher = new RegExp('\\\\.' + classNames[i] + '(?![a-zA-Z\\\\-]+)', 'i');\n        selector = selector.replace(matcher, '');\n      }\n    }\n    return selector.length === 0;\n  }\n\n  /**\n   * @private\n   * to support IE8 missing getElementById on SVGdocument and on node xmlDOM\n   */\n  function elementById(doc, id) {\n    var el;\n    doc.getElementById && (el = doc.getElementById(id));\n    if (el) {\n      return el;\n    }\n    var node, i, len, nodelist = doc.getElementsByTagName('*');\n    for (i = 0, len = nodelist.length; i < len; i++) {\n      node = nodelist[i];\n      if (id === node.getAttribute('id')) {\n        return node;\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  function parseUseDirectives(doc) {\n    var nodelist = _getMultipleNodes(doc, ['use', 'svg:use']), i = 0;\n    while (nodelist.length && i < nodelist.length) {\n      var el = nodelist[i],\n          xlinkAttribute = el.getAttribute('xlink:href') || el.getAttribute('href');\n\n      if (xlinkAttribute === null) {\n        return;\n      }\n\n      var xlink = xlinkAttribute.slice(1),\n          x = el.getAttribute('x') || 0,\n          y = el.getAttribute('y') || 0,\n          el2 = elementById(doc, xlink).cloneNode(true),\n          currentTrans = (el2.getAttribute('transform') || '') + ' translate(' + x + ', ' + y + ')',\n          parentNode,\n          oldLength = nodelist.length, attr,\n          j,\n          attrs,\n          len,\n          namespace = fabric.svgNS;\n\n      applyViewboxTransform(el2);\n      if (/^svg$/i.test(el2.nodeName)) {\n        var el3 = el2.ownerDocument.createElementNS(namespace, 'g');\n        for (j = 0, attrs = el2.attributes, len = attrs.length; j < len; j++) {\n          attr = attrs.item(j);\n          el3.setAttributeNS(namespace, attr.nodeName, attr.nodeValue);\n        }\n        // el2.firstChild != null\n        while (el2.firstChild) {\n          el3.appendChild(el2.firstChild);\n        }\n        el2 = el3;\n      }\n\n      for (j = 0, attrs = el.attributes, len = attrs.length; j < len; j++) {\n        attr = attrs.item(j);\n        if (attr.nodeName === 'x' || attr.nodeName === 'y' ||\n          attr.nodeName === 'xlink:href' || attr.nodeName === 'href') {\n          continue;\n        }\n\n        if (attr.nodeName === 'transform') {\n          currentTrans = attr.nodeValue + ' ' + currentTrans;\n        }\n        else {\n          el2.setAttribute(attr.nodeName, attr.nodeValue);\n        }\n      }\n\n      el2.setAttribute('transform', currentTrans);\n      el2.setAttribute('instantiated_by_use', '1');\n      el2.removeAttribute('id');\n      parentNode = el.parentNode;\n      parentNode.replaceChild(el2, el);\n      // some browsers do not shorten nodelist after replaceChild (IE8)\n      if (nodelist.length === oldLength) {\n        i++;\n      }\n    }\n  }\n\n  // http://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute\n  // matches, e.g.: +14.56e-12, etc.\n  var reViewBoxAttrValue = new RegExp(\n    '^' +\n    '\\\\s*(' + fabric.reNum + '+)\\\\s*,?' +\n    '\\\\s*(' + fabric.reNum + '+)\\\\s*,?' +\n    '\\\\s*(' + fabric.reNum + '+)\\\\s*,?' +\n    '\\\\s*(' + fabric.reNum + '+)\\\\s*' +\n    '$'\n  );\n\n  /**\n   * Add a <g> element that envelop all child elements and makes the viewbox transformMatrix descend on all elements\n   */\n  function applyViewboxTransform(element) {\n    if (!fabric.svgViewBoxElementsRegEx.test(element.nodeName)) {\n      return {};\n    }\n    var viewBoxAttr = element.getAttribute('viewBox'),\n        scaleX = 1,\n        scaleY = 1,\n        minX = 0,\n        minY = 0,\n        viewBoxWidth, viewBoxHeight, matrix, el,\n        widthAttr = element.getAttribute('width'),\n        heightAttr = element.getAttribute('height'),\n        x = element.getAttribute('x') || 0,\n        y = element.getAttribute('y') || 0,\n        preserveAspectRatio = element.getAttribute('preserveAspectRatio') || '',\n        missingViewBox = (!viewBoxAttr || !(viewBoxAttr = viewBoxAttr.match(reViewBoxAttrValue))),\n        missingDimAttr = (!widthAttr || !heightAttr || widthAttr === '100%' || heightAttr === '100%'),\n        toBeParsed = missingViewBox && missingDimAttr,\n        parsedDim = { }, translateMatrix = '', widthDiff = 0, heightDiff = 0;\n\n    parsedDim.width = 0;\n    parsedDim.height = 0;\n    parsedDim.toBeParsed = toBeParsed;\n\n    if (missingViewBox) {\n      if (((x || y) && element.parentNode && element.parentNode.nodeName !== '#document')) {\n        translateMatrix = ' translate(' + parseUnit(x) + ' ' + parseUnit(y) + ') ';\n        matrix = (element.getAttribute('transform') || '') + translateMatrix;\n        element.setAttribute('transform', matrix);\n        element.removeAttribute('x');\n        element.removeAttribute('y');\n      }\n    }\n\n    if (toBeParsed) {\n      return parsedDim;\n    }\n\n    if (missingViewBox) {\n      parsedDim.width = parseUnit(widthAttr);\n      parsedDim.height = parseUnit(heightAttr);\n      // set a transform for elements that have x y and are inner(only) SVGs\n      return parsedDim;\n    }\n    minX = -parseFloat(viewBoxAttr[1]);\n    minY = -parseFloat(viewBoxAttr[2]);\n    viewBoxWidth = parseFloat(viewBoxAttr[3]);\n    viewBoxHeight = parseFloat(viewBoxAttr[4]);\n    parsedDim.minX = minX;\n    parsedDim.minY = minY;\n    parsedDim.viewBoxWidth = viewBoxWidth;\n    parsedDim.viewBoxHeight = viewBoxHeight;\n    if (!missingDimAttr) {\n      parsedDim.width = parseUnit(widthAttr);\n      parsedDim.height = parseUnit(heightAttr);\n      scaleX = parsedDim.width / viewBoxWidth;\n      scaleY = parsedDim.height / viewBoxHeight;\n    }\n    else {\n      parsedDim.width = viewBoxWidth;\n      parsedDim.height = viewBoxHeight;\n    }\n\n    // default is to preserve aspect ratio\n    preserveAspectRatio = fabric.util.parsePreserveAspectRatioAttribute(preserveAspectRatio);\n    if (preserveAspectRatio.alignX !== 'none') {\n      //translate all container for the effect of Mid, Min, Max\n      if (preserveAspectRatio.meetOrSlice === 'meet') {\n        scaleY = scaleX = (scaleX > scaleY ? scaleY : scaleX);\n        // calculate additional translation to move the viewbox\n      }\n      if (preserveAspectRatio.meetOrSlice === 'slice') {\n        scaleY = scaleX = (scaleX > scaleY ? scaleX : scaleY);\n        // calculate additional translation to move the viewbox\n      }\n      widthDiff = parsedDim.width - viewBoxWidth * scaleX;\n      heightDiff = parsedDim.height - viewBoxHeight * scaleX;\n      if (preserveAspectRatio.alignX === 'Mid') {\n        widthDiff /= 2;\n      }\n      if (preserveAspectRatio.alignY === 'Mid') {\n        heightDiff /= 2;\n      }\n      if (preserveAspectRatio.alignX === 'Min') {\n        widthDiff = 0;\n      }\n      if (preserveAspectRatio.alignY === 'Min') {\n        heightDiff = 0;\n      }\n    }\n\n    if (scaleX === 1 && scaleY === 1 && minX === 0 && minY === 0 && x === 0 && y === 0) {\n      return parsedDim;\n    }\n    if ((x || y) && element.parentNode.nodeName !== '#document') {\n      translateMatrix = ' translate(' + parseUnit(x) + ' ' + parseUnit(y) + ') ';\n    }\n\n    matrix = translateMatrix + ' matrix(' + scaleX +\n                  ' 0' +\n                  ' 0 ' +\n                  scaleY + ' ' +\n                  (minX * scaleX + widthDiff) + ' ' +\n                  (minY * scaleY + heightDiff) + ') ';\n    // seems unused.\n    // parsedDim.viewboxTransform = fabric.parseTransformAttribute(matrix);\n    if (element.nodeName === 'svg') {\n      el = element.ownerDocument.createElementNS(fabric.svgNS, 'g');\n      // element.firstChild != null\n      while (element.firstChild) {\n        el.appendChild(element.firstChild);\n      }\n      element.appendChild(el);\n    }\n    else {\n      el = element;\n      el.removeAttribute('x');\n      el.removeAttribute('y');\n      matrix = el.getAttribute('transform') + matrix;\n    }\n    el.setAttribute('transform', matrix);\n    return parsedDim;\n  }\n\n  function hasAncestorWithNodeName(element, nodeName) {\n    while (element && (element = element.parentNode)) {\n      if (element.nodeName && nodeName.test(element.nodeName.replace('svg:', ''))\n        && !element.getAttribute('instantiated_by_use')) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Parses an SVG document, converts it to an array of corresponding fabric.* instances and passes them to a callback\n   * @static\n   * @function\n   * @memberOf fabric\n   * @param {SVGDocument} doc SVG document to parse\n   * @param {Function} callback Callback to call when parsing is finished;\n   * It's being passed an array of elements (parsed from a document).\n   * @param {Function} [reviver] Method for further parsing of SVG elements, called after each fabric object created.\n   * @param {Object} [parsingOptions] options for parsing document\n   * @param {String} [parsingOptions.crossOrigin] crossOrigin settings\n   */\n  fabric.parseSVGDocument = function(doc, callback, reviver, parsingOptions) {\n    if (!doc) {\n      return;\n    }\n\n    parseUseDirectives(doc);\n\n    var svgUid =  fabric.Object.__uid++, i, len,\n        options = applyViewboxTransform(doc),\n        descendants = fabric.util.toArray(doc.getElementsByTagName('*'));\n    options.crossOrigin = parsingOptions && parsingOptions.crossOrigin;\n    options.svgUid = svgUid;\n\n    if (descendants.length === 0 && fabric.isLikelyNode) {\n      // we're likely in node, where \"o3-xml\" library fails to gEBTN(\"*\")\n      // https://github.com/ajaxorg/node-o3-xml/issues/21\n      descendants = doc.selectNodes('//*[name(.)!=\"svg\"]');\n      var arr = [];\n      for (i = 0, len = descendants.length; i < len; i++) {\n        arr[i] = descendants[i];\n      }\n      descendants = arr;\n    }\n\n    var elements = descendants.filter(function(el) {\n      applyViewboxTransform(el);\n      return fabric.svgValidTagNamesRegEx.test(el.nodeName.replace('svg:', '')) &&\n            !hasAncestorWithNodeName(el, fabric.svgInvalidAncestorsRegEx); // http://www.w3.org/TR/SVG/struct.html#DefsElement\n    });\n    if (!elements || (elements && !elements.length)) {\n      callback && callback([], {});\n      return;\n    }\n    var clipPaths = { };\n    descendants.filter(function(el) {\n      return el.nodeName.replace('svg:', '') === 'clipPath';\n    }).forEach(function(el) {\n      var id = el.getAttribute('id');\n      clipPaths[id] = fabric.util.toArray(el.getElementsByTagName('*')).filter(function(el) {\n        return fabric.svgValidTagNamesRegEx.test(el.nodeName.replace('svg:', ''));\n      });\n    });\n    fabric.gradientDefs[svgUid] = fabric.getGradientDefs(doc);\n    fabric.cssRules[svgUid] = fabric.getCSSRules(doc);\n    fabric.clipPaths[svgUid] = clipPaths;\n    // Precedence of rules:   style > class > attribute\n    fabric.parseElements(elements, function(instances, elements) {\n      if (callback) {\n        callback(instances, options, elements, descendants);\n        delete fabric.gradientDefs[svgUid];\n        delete fabric.cssRules[svgUid];\n        delete fabric.clipPaths[svgUid];\n      }\n    }, clone(options), reviver, parsingOptions);\n  };\n\n  function recursivelyParseGradientsXlink(doc, gradient) {\n    var gradientsAttrs = ['gradientTransform', 'x1', 'x2', 'y1', 'y2', 'gradientUnits', 'cx', 'cy', 'r', 'fx', 'fy'],\n        xlinkAttr = 'xlink:href',\n        xLink = gradient.getAttribute(xlinkAttr).slice(1),\n        referencedGradient = elementById(doc, xLink);\n    if (referencedGradient && referencedGradient.getAttribute(xlinkAttr)) {\n      recursivelyParseGradientsXlink(doc, referencedGradient);\n    }\n    gradientsAttrs.forEach(function(attr) {\n      if (referencedGradient && !gradient.hasAttribute(attr) && referencedGradient.hasAttribute(attr)) {\n        gradient.setAttribute(attr, referencedGradient.getAttribute(attr));\n      }\n    });\n    if (!gradient.children.length) {\n      var referenceClone = referencedGradient.cloneNode(true);\n      while (referenceClone.firstChild) {\n        gradient.appendChild(referenceClone.firstChild);\n      }\n    }\n    gradient.removeAttribute(xlinkAttr);\n  }\n\n  var reFontDeclaration = new RegExp(\n    '(normal|italic)?\\\\s*(normal|small-caps)?\\\\s*' +\n    '(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\\\s*(' +\n      fabric.reNum +\n    '(?:px|cm|mm|em|pt|pc|in)*)(?:\\\\/(normal|' + fabric.reNum + '))?\\\\s+(.*)');\n\n  extend(fabric, {\n    /**\n     * Parses a short font declaration, building adding its properties to a style object\n     * @static\n     * @function\n     * @memberOf fabric\n     * @param {String} value font declaration\n     * @param {Object} oStyle definition\n     */\n    parseFontDeclaration: function(value, oStyle) {\n      var match = value.match(reFontDeclaration);\n\n      if (!match) {\n        return;\n      }\n      var fontStyle = match[1],\n          // font variant is not used\n          // fontVariant = match[2],\n          fontWeight = match[3],\n          fontSize = match[4],\n          lineHeight = match[5],\n          fontFamily = match[6];\n\n      if (fontStyle) {\n        oStyle.fontStyle = fontStyle;\n      }\n      if (fontWeight) {\n        oStyle.fontWeight = isNaN(parseFloat(fontWeight)) ? fontWeight : parseFloat(fontWeight);\n      }\n      if (fontSize) {\n        oStyle.fontSize = parseUnit(fontSize);\n      }\n      if (fontFamily) {\n        oStyle.fontFamily = fontFamily;\n      }\n      if (lineHeight) {\n        oStyle.lineHeight = lineHeight === 'normal' ? 1 : lineHeight;\n      }\n    },\n\n    /**\n     * Parses an SVG document, returning all of the gradient declarations found in it\n     * @static\n     * @function\n     * @memberOf fabric\n     * @param {SVGDocument} doc SVG document to parse\n     * @return {Object} Gradient definitions; key corresponds to element id, value -- to gradient definition element\n     */\n    getGradientDefs: function(doc) {\n      var tagArray = [\n            'linearGradient',\n            'radialGradient',\n            'svg:linearGradient',\n            'svg:radialGradient'],\n          elList = _getMultipleNodes(doc, tagArray),\n          el, j = 0, gradientDefs = { };\n      j = elList.length;\n      while (j--) {\n        el = elList[j];\n        if (el.getAttribute('xlink:href')) {\n          recursivelyParseGradientsXlink(doc, el);\n        }\n        gradientDefs[el.getAttribute('id')] = el;\n      }\n      return gradientDefs;\n    },\n\n    /**\n     * Returns an object of attributes' name/value, given element and an array of attribute names;\n     * Parses parent \"g\" nodes recursively upwards.\n     * @static\n     * @memberOf fabric\n     * @param {DOMElement} element Element to parse\n     * @param {Array} attributes Array of attributes to parse\n     * @return {Object} object containing parsed attributes' names/values\n     */\n    parseAttributes: function(element, attributes, svgUid) {\n\n      if (!element) {\n        return;\n      }\n\n      var value,\n          parentAttributes = { },\n          fontSize, parentFontSize;\n\n      if (typeof svgUid === 'undefined') {\n        svgUid = element.getAttribute('svgUid');\n      }\n      // if there's a parent container (`g` or `a` or `symbol` node), parse its attributes recursively upwards\n      if (element.parentNode && fabric.svgValidParentsRegEx.test(element.parentNode.nodeName)) {\n        parentAttributes = fabric.parseAttributes(element.parentNode, attributes, svgUid);\n      }\n\n      var ownAttributes = attributes.reduce(function(memo, attr) {\n        value = element.getAttribute(attr);\n        if (value) { // eslint-disable-line\n          memo[attr] = value;\n        }\n        return memo;\n      }, { });\n      // add values parsed from style, which take precedence over attributes\n      // (see: http://www.w3.org/TR/SVG/styling.html#UsingPresentationAttributes)\n      var cssAttrs = extend(\n        getGlobalStylesForElement(element, svgUid),\n        fabric.parseStyleAttribute(element)\n      );\n      ownAttributes = extend(\n        ownAttributes,\n        cssAttrs\n      );\n      if (cssAttrs[cPath]) {\n        element.setAttribute(cPath, cssAttrs[cPath]);\n      }\n      fontSize = parentFontSize = parentAttributes.fontSize || fabric.Text.DEFAULT_SVG_FONT_SIZE;\n      if (ownAttributes[fSize]) {\n        // looks like the minimum should be 9px when dealing with ems. this is what looks like in browsers.\n        ownAttributes[fSize] = fontSize = parseUnit(ownAttributes[fSize], parentFontSize);\n      }\n\n      var normalizedAttr, normalizedValue, normalizedStyle = {};\n      for (var attr in ownAttributes) {\n        normalizedAttr = normalizeAttr(attr);\n        normalizedValue = normalizeValue(normalizedAttr, ownAttributes[attr], parentAttributes, fontSize);\n        normalizedStyle[normalizedAttr] = normalizedValue;\n      }\n      if (normalizedStyle && normalizedStyle.font) {\n        fabric.parseFontDeclaration(normalizedStyle.font, normalizedStyle);\n      }\n      var mergedAttrs = extend(parentAttributes, normalizedStyle);\n      return fabric.svgValidParentsRegEx.test(element.nodeName) ? mergedAttrs : _setStrokeFillOpacity(mergedAttrs);\n    },\n\n    /**\n     * Transforms an array of svg elements to corresponding fabric.* instances\n     * @static\n     * @memberOf fabric\n     * @param {Array} elements Array of elements to parse\n     * @param {Function} callback Being passed an array of fabric instances (transformed from SVG elements)\n     * @param {Object} [options] Options object\n     * @param {Function} [reviver] Method for further parsing of SVG elements, called after each fabric object created.\n     */\n    parseElements: function(elements, callback, options, reviver, parsingOptions) {\n      new fabric.ElementsParser(elements, callback, options, reviver, parsingOptions).parse();\n    },\n\n    /**\n     * Parses \"style\" attribute, retuning an object with values\n     * @static\n     * @memberOf fabric\n     * @param {SVGElement} element Element to parse\n     * @return {Object} Objects with values parsed from style attribute of an element\n     */\n    parseStyleAttribute: function(element) {\n      var oStyle = { },\n          style = element.getAttribute('style');\n\n      if (!style) {\n        return oStyle;\n      }\n\n      if (typeof style === 'string') {\n        parseStyleString(style, oStyle);\n      }\n      else {\n        parseStyleObject(style, oStyle);\n      }\n\n      return oStyle;\n    },\n\n    /**\n     * Parses \"points\" attribute, returning an array of values\n     * @static\n     * @memberOf fabric\n     * @param {String} points points attribute string\n     * @return {Array} array of points\n     */\n    parsePointsAttribute: function(points) {\n\n      // points attribute is required and must not be empty\n      if (!points) {\n        return null;\n      }\n\n      // replace commas with whitespace and remove bookending whitespace\n      points = points.replace(/,/g, ' ').trim();\n\n      points = points.split(/\\s+/);\n      var parsedPoints = [], i, len;\n\n      for (i = 0, len = points.length; i < len; i += 2) {\n        parsedPoints.push({\n          x: parseFloat(points[i]),\n          y: parseFloat(points[i + 1])\n        });\n      }\n\n      // odd number of points is an error\n      // if (parsedPoints.length % 2 !== 0) {\n      //   return null;\n      // }\n\n      return parsedPoints;\n    },\n\n    /**\n     * Returns CSS rules for a given SVG document\n     * @static\n     * @function\n     * @memberOf fabric\n     * @param {SVGDocument} doc SVG document to parse\n     * @return {Object} CSS rules of this document\n     */\n    getCSSRules: function(doc) {\n      var styles = doc.getElementsByTagName('style'), i, len,\n          allRules = { }, rules;\n\n      // very crude parsing of style contents\n      for (i = 0, len = styles.length; i < len; i++) {\n        var styleContents = styles[i].textContent;\n\n        // remove comments\n        styleContents = styleContents.replace(/\\/\\*[\\s\\S]*?\\*\\//g, '');\n        if (styleContents.trim() === '') {\n          continue;\n        }\n        // recovers all the rule in this form `body { style code... }`\n        // rules = styleContents.match(/[^{]*\\{[\\s\\S]*?\\}/g);\n        rules = styleContents.split('}');\n        // remove empty rules.\n        rules = rules.filter(function(rule) { return rule.trim(); });\n        // at this point we have hopefully an array of rules `body { style code... `\n        // eslint-disable-next-line no-loop-func\n        rules.forEach(function(rule) {\n\n          var match = rule.split('{'),\n              ruleObj = { }, declaration = match[1].trim(),\n              propertyValuePairs = declaration.split(';').filter(function(pair) { return pair.trim(); });\n\n          for (i = 0, len = propertyValuePairs.length; i < len; i++) {\n            var pair = propertyValuePairs[i].split(':'),\n                property = pair[0].trim(),\n                value = pair[1].trim();\n            ruleObj[property] = value;\n          }\n          rule = match[0].trim();\n          rule.split(',').forEach(function(_rule) {\n            _rule = _rule.replace(/^svg/i, '').trim();\n            if (_rule === '') {\n              return;\n            }\n            if (allRules[_rule]) {\n              fabric.util.object.extend(allRules[_rule], ruleObj);\n            }\n            else {\n              allRules[_rule] = fabric.util.object.clone(ruleObj);\n            }\n          });\n        });\n      }\n      return allRules;\n    },\n\n    /**\n     * Takes url corresponding to an SVG document, and parses it into a set of fabric objects.\n     * Note that SVG is fetched via XMLHttpRequest, so it needs to conform to SOP (Same Origin Policy)\n     * @memberOf fabric\n     * @param {String} url\n     * @param {Function} callback\n     * @param {Function} [reviver] Method for further parsing of SVG elements, called after each fabric object created.\n     * @param {Object} [options] Object containing options for parsing\n     * @param {String} [options.crossOrigin] crossOrigin crossOrigin setting to use for external resources\n     */\n    loadSVGFromURL: function(url, callback, reviver, options) {\n\n      url = url.replace(/^\\n\\s*/, '').trim();\n      new fabric.util.request(url, {\n        method: 'get',\n        onComplete: onComplete\n      });\n\n      function onComplete(r) {\n\n        var xml = r.responseXML;\n        if (!xml || !xml.documentElement) {\n          callback && callback(null);\n          return false;\n        }\n\n        fabric.parseSVGDocument(xml.documentElement, function (results, _options, elements, allElements) {\n          callback && callback(results, _options, elements, allElements);\n        }, reviver, options);\n      }\n    },\n\n    /**\n     * Takes string corresponding to an SVG document, and parses it into a set of fabric objects\n     * @memberOf fabric\n     * @param {String} string\n     * @param {Function} callback\n     * @param {Function} [reviver] Method for further parsing of SVG elements, called after each fabric object created.\n     * @param {Object} [options] Object containing options for parsing\n     * @param {String} [options.crossOrigin] crossOrigin crossOrigin setting to use for external resources\n     */\n    loadSVGFromString: function(string, callback, reviver, options) {\n      var parser = new fabric.window.DOMParser(),\n          doc = parser.parseFromString(string.trim(), 'text/xml');\n      fabric.parseSVGDocument(doc.documentElement, function (results, _options, elements, allElements) {\n        callback(results, _options, elements, allElements);\n      }, reviver, options);\n    }\n  });\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\nfabric.ElementsParser = function(elements, callback, options, reviver, parsingOptions, doc) {\n  this.elements = elements;\n  this.callback = callback;\n  this.options = options;\n  this.reviver = reviver;\n  this.svgUid = (options && options.svgUid) || 0;\n  this.parsingOptions = parsingOptions;\n  this.regexUrl = /^url\\(['\"]?#([^'\"]+)['\"]?\\)/g;\n  this.doc = doc;\n};\n\n(function(proto) {\n  proto.parse = function() {\n    this.instances = new Array(this.elements.length);\n    this.numElements = this.elements.length;\n    this.createObjects();\n  };\n\n  proto.createObjects = function() {\n    var _this = this;\n    this.elements.forEach(function(element, i) {\n      element.setAttribute('svgUid', _this.svgUid);\n      _this.createObject(element, i);\n    });\n  };\n\n  proto.findTag = function(el) {\n    return fabric[fabric.util.string.capitalize(el.tagName.replace('svg:', ''))];\n  };\n\n  proto.createObject = function(el, index) {\n    var klass = this.findTag(el);\n    if (klass && klass.fromElement) {\n      try {\n        klass.fromElement(el, this.createCallback(index, el), this.options);\n      }\n      catch (err) {\n        fabric.log(err);\n      }\n    }\n    else {\n      this.checkIfDone();\n    }\n  };\n\n  proto.createCallback = function(index, el) {\n    var _this = this;\n    return function(obj) {\n      var _options;\n      _this.resolveGradient(obj, el, 'fill');\n      _this.resolveGradient(obj, el, 'stroke');\n      if (obj instanceof fabric.Image && obj._originalElement) {\n        _options = obj.parsePreserveAspectRatioAttribute(el);\n      }\n      obj._removeTransformMatrix(_options);\n      _this.resolveClipPath(obj, el);\n      _this.reviver && _this.reviver(el, obj);\n      _this.instances[index] = obj;\n      _this.checkIfDone();\n    };\n  };\n\n  proto.extractPropertyDefinition = function(obj, property, storage) {\n    var value = obj[property], regex = this.regexUrl;\n    if (!regex.test(value)) {\n      return;\n    }\n    regex.lastIndex = 0;\n    var id = regex.exec(value)[1];\n    regex.lastIndex = 0;\n    return fabric[storage][this.svgUid][id];\n  };\n\n  proto.resolveGradient = function(obj, el, property) {\n    var gradientDef = this.extractPropertyDefinition(obj, property, 'gradientDefs');\n    if (gradientDef) {\n      var opacityAttr = el.getAttribute(property + '-opacity');\n      var gradient = fabric.Gradient.fromElement(gradientDef, obj, opacityAttr, this.options);\n      obj.set(property, gradient);\n    }\n  };\n\n  proto.createClipPathCallback = function(obj, container) {\n    return function(_newObj) {\n      _newObj._removeTransformMatrix();\n      _newObj.fillRule = _newObj.clipRule;\n      container.push(_newObj);\n    };\n  };\n\n  proto.resolveClipPath = function(obj, usingElement) {\n    var clipPath = this.extractPropertyDefinition(obj, 'clipPath', 'clipPaths'),\n        element, klass, objTransformInv, container, gTransform, options;\n    if (clipPath) {\n      container = [];\n      objTransformInv = fabric.util.invertTransform(obj.calcTransformMatrix());\n      // move the clipPath tag as sibling to the real element that is using it\n      var clipPathTag = clipPath[0].parentNode;\n      var clipPathOwner = usingElement;\n      while (clipPathOwner.parentNode && clipPathOwner.getAttribute('clip-path') !== obj.clipPath) {\n        clipPathOwner = clipPathOwner.parentNode;\n      }\n      clipPathOwner.parentNode.appendChild(clipPathTag);\n      for (var i = 0; i < clipPath.length; i++) {\n        element = clipPath[i];\n        klass = this.findTag(element);\n        klass.fromElement(\n          element,\n          this.createClipPathCallback(obj, container),\n          this.options\n        );\n      }\n      if (container.length === 1) {\n        clipPath = container[0];\n      }\n      else {\n        clipPath = new fabric.Group(container);\n      }\n      gTransform = fabric.util.multiplyTransformMatrices(\n        objTransformInv,\n        clipPath.calcTransformMatrix()\n      );\n      if (clipPath.clipPath) {\n        this.resolveClipPath(clipPath, clipPathOwner);\n      }\n      var options = fabric.util.qrDecompose(gTransform);\n      clipPath.flipX = false;\n      clipPath.flipY = false;\n      clipPath.set('scaleX', options.scaleX);\n      clipPath.set('scaleY', options.scaleY);\n      clipPath.angle = options.angle;\n      clipPath.skewX = options.skewX;\n      clipPath.skewY = 0;\n      clipPath.setPositionByOrigin({ x: options.translateX, y: options.translateY }, 'center', 'center');\n      obj.clipPath = clipPath;\n    }\n    else {\n      // if clip-path does not resolve to any element, delete the property.\n      delete obj.clipPath;\n    }\n  };\n\n  proto.checkIfDone = function() {\n    if (--this.numElements === 0) {\n      this.instances = this.instances.filter(function(el) {\n        // eslint-disable-next-line no-eq-null, eqeqeq\n        return el != null;\n      });\n      this.callback(this.instances, this.elements);\n    }\n  };\n})(fabric.ElementsParser.prototype);\n\n\n(function(global) {\n\n  'use strict';\n\n  /* Adaptation of work of Kevin Lindsey (kevin@kevlindev.com) */\n\n  var fabric = global.fabric || (global.fabric = { });\n\n  if (fabric.Point) {\n    fabric.warn('fabric.Point is already defined');\n    return;\n  }\n\n  fabric.Point = Point;\n\n  /**\n   * Point class\n   * @class fabric.Point\n   * @memberOf fabric\n   * @constructor\n   * @param {Number} x\n   * @param {Number} y\n   * @return {fabric.Point} thisArg\n   */\n  function Point(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n\n  Point.prototype = /** @lends fabric.Point.prototype */ {\n\n    type: 'point',\n\n    constructor: Point,\n\n    /**\n     * Adds another point to this one and returns another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} new Point instance with added values\n     */\n    add: function (that) {\n      return new Point(this.x + that.x, this.y + that.y);\n    },\n\n    /**\n     * Adds another point to this one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    addEquals: function (that) {\n      this.x += that.x;\n      this.y += that.y;\n      return this;\n    },\n\n    /**\n     * Adds value to this point and returns a new one\n     * @param {Number} scalar\n     * @return {fabric.Point} new Point with added value\n     */\n    scalarAdd: function (scalar) {\n      return new Point(this.x + scalar, this.y + scalar);\n    },\n\n    /**\n     * Adds value to this point\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    scalarAddEquals: function (scalar) {\n      this.x += scalar;\n      this.y += scalar;\n      return this;\n    },\n\n    /**\n     * Subtracts another point from this point and returns a new one\n     * @param {fabric.Point} that\n     * @return {fabric.Point} new Point object with subtracted values\n     */\n    subtract: function (that) {\n      return new Point(this.x - that.x, this.y - that.y);\n    },\n\n    /**\n     * Subtracts another point from this point\n     * @param {fabric.Point} that\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    subtractEquals: function (that) {\n      this.x -= that.x;\n      this.y -= that.y;\n      return this;\n    },\n\n    /**\n     * Subtracts value from this point and returns a new one\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    scalarSubtract: function (scalar) {\n      return new Point(this.x - scalar, this.y - scalar);\n    },\n\n    /**\n     * Subtracts value from this point\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    scalarSubtractEquals: function (scalar) {\n      this.x -= scalar;\n      this.y -= scalar;\n      return this;\n    },\n\n    /**\n     * Multiplies this point by a value and returns a new one\n     * TODO: rename in scalarMultiply in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    multiply: function (scalar) {\n      return new Point(this.x * scalar, this.y * scalar);\n    },\n\n    /**\n     * Multiplies this point by a value\n     * TODO: rename in scalarMultiplyEquals in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    multiplyEquals: function (scalar) {\n      this.x *= scalar;\n      this.y *= scalar;\n      return this;\n    },\n\n    /**\n     * Divides this point by a value and returns a new one\n     * TODO: rename in scalarDivide in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point}\n     */\n    divide: function (scalar) {\n      return new Point(this.x / scalar, this.y / scalar);\n    },\n\n    /**\n     * Divides this point by a value\n     * TODO: rename in scalarDivideEquals in 2.0\n     * @param {Number} scalar\n     * @return {fabric.Point} thisArg\n     * @chainable\n     */\n    divideEquals: function (scalar) {\n      this.x /= scalar;\n      this.y /= scalar;\n      return this;\n    },\n\n    /**\n     * Returns true if this point is equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    eq: function (that) {\n      return (this.x === that.x && this.y === that.y);\n    },\n\n    /**\n     * Returns true if this point is less than another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    lt: function (that) {\n      return (this.x < that.x && this.y < that.y);\n    },\n\n    /**\n     * Returns true if this point is less than or equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    lte: function (that) {\n      return (this.x <= that.x && this.y <= that.y);\n    },\n\n    /**\n\n     * Returns true if this point is greater another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    gt: function (that) {\n      return (this.x > that.x && this.y > that.y);\n    },\n\n    /**\n     * Returns true if this point is greater than or equal to another one\n     * @param {fabric.Point} that\n     * @return {Boolean}\n     */\n    gte: function (that) {\n      return (this.x >= that.x && this.y >= that.y);\n    },\n\n    /**\n     * Returns new point which is the result of linear interpolation with this one and another one\n     * @param {fabric.Point} that\n     * @param {Number} t , position of interpolation, between 0 and 1 default 0.5\n     * @return {fabric.Point}\n     */\n    lerp: function (that, t) {\n      if (typeof t === 'undefined') {\n        t = 0.5;\n      }\n      t = Math.max(Math.min(1, t), 0);\n      return new Point(this.x + (that.x - this.x) * t, this.y + (that.y - this.y) * t);\n    },\n\n    /**\n     * Returns distance from this point and another one\n     * @param {fabric.Point} that\n     * @return {Number}\n     */\n    distanceFrom: function (that) {\n      var dx = this.x - that.x,\n          dy = this.y - that.y;\n      return Math.sqrt(dx * dx + dy * dy);\n    },\n\n    /**\n     * Returns the point between this point and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    midPointFrom: function (that) {\n      return this.lerp(that);\n    },\n\n    /**\n     * Returns a new point which is the min of this and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    min: function (that) {\n      return new Point(Math.min(this.x, that.x), Math.min(this.y, that.y));\n    },\n\n    /**\n     * Returns a new point which is the max of this and another one\n     * @param {fabric.Point} that\n     * @return {fabric.Point}\n     */\n    max: function (that) {\n      return new Point(Math.max(this.x, that.x), Math.max(this.y, that.y));\n    },\n\n    /**\n     * Returns string representation of this point\n     * @return {String}\n     */\n    toString: function () {\n      return this.x + ',' + this.y;\n    },\n\n    /**\n     * Sets x/y of this point\n     * @param {Number} x\n     * @param {Number} y\n     * @chainable\n     */\n    setXY: function (x, y) {\n      this.x = x;\n      this.y = y;\n      return this;\n    },\n\n    /**\n     * Sets x of this point\n     * @param {Number} x\n     * @chainable\n     */\n    setX: function (x) {\n      this.x = x;\n      return this;\n    },\n\n    /**\n     * Sets y of this point\n     * @param {Number} y\n     * @chainable\n     */\n    setY: function (y) {\n      this.y = y;\n      return this;\n    },\n\n    /**\n     * Sets x/y of this point from another point\n     * @param {fabric.Point} that\n     * @chainable\n     */\n    setFromPoint: function (that) {\n      this.x = that.x;\n      this.y = that.y;\n      return this;\n    },\n\n    /**\n     * Swaps x/y of this point and another point\n     * @param {fabric.Point} that\n     */\n    swap: function (that) {\n      var x = this.x,\n          y = this.y;\n      this.x = that.x;\n      this.y = that.y;\n      that.x = x;\n      that.y = y;\n    },\n\n    /**\n     * return a cloned instance of the point\n     * @return {fabric.Point}\n     */\n    clone: function () {\n      return new Point(this.x, this.y);\n    }\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  /* Adaptation of work of Kevin Lindsey (kevin@kevlindev.com) */\n  var fabric = global.fabric || (global.fabric = { });\n\n  if (fabric.Intersection) {\n    fabric.warn('fabric.Intersection is already defined');\n    return;\n  }\n\n  /**\n   * Intersection class\n   * @class fabric.Intersection\n   * @memberOf fabric\n   * @constructor\n   */\n  function Intersection(status) {\n    this.status = status;\n    this.points = [];\n  }\n\n  fabric.Intersection = Intersection;\n\n  fabric.Intersection.prototype = /** @lends fabric.Intersection.prototype */ {\n\n    constructor: Intersection,\n\n    /**\n     * Appends a point to intersection\n     * @param {fabric.Point} point\n     * @return {fabric.Intersection} thisArg\n     * @chainable\n     */\n    appendPoint: function (point) {\n      this.points.push(point);\n      return this;\n    },\n\n    /**\n     * Appends points to intersection\n     * @param {Array} points\n     * @return {fabric.Intersection} thisArg\n     * @chainable\n     */\n    appendPoints: function (points) {\n      this.points = this.points.concat(points);\n      return this;\n    }\n  };\n\n  /**\n   * Checks if one line intersects another\n   * TODO: rename in intersectSegmentSegment\n   * @static\n   * @param {fabric.Point} a1\n   * @param {fabric.Point} a2\n   * @param {fabric.Point} b1\n   * @param {fabric.Point} b2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectLineLine = function (a1, a2, b1, b2) {\n    var result,\n        uaT = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x),\n        ubT = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x),\n        uB = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);\n    if (uB !== 0) {\n      var ua = uaT / uB,\n          ub = ubT / uB;\n      if (0 <= ua && ua <= 1 && 0 <= ub && ub <= 1) {\n        result = new Intersection('Intersection');\n        result.appendPoint(new fabric.Point(a1.x + ua * (a2.x - a1.x), a1.y + ua * (a2.y - a1.y)));\n      }\n      else {\n        result = new Intersection();\n      }\n    }\n    else {\n      if (uaT === 0 || ubT === 0) {\n        result = new Intersection('Coincident');\n      }\n      else {\n        result = new Intersection('Parallel');\n      }\n    }\n    return result;\n  };\n\n  /**\n   * Checks if line intersects polygon\n   * TODO: rename in intersectSegmentPolygon\n   * fix detection of coincident\n   * @static\n   * @param {fabric.Point} a1\n   * @param {fabric.Point} a2\n   * @param {Array} points\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectLinePolygon = function(a1, a2, points) {\n    var result = new Intersection(),\n        length = points.length,\n        b1, b2, inter, i;\n\n    for (i = 0; i < length; i++) {\n      b1 = points[i];\n      b2 = points[(i + 1) % length];\n      inter = Intersection.intersectLineLine(a1, a2, b1, b2);\n\n      result.appendPoints(inter.points);\n    }\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n\n  /**\n   * Checks if polygon intersects another polygon\n   * @static\n   * @param {Array} points1\n   * @param {Array} points2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectPolygonPolygon = function (points1, points2) {\n    var result = new Intersection(),\n        length = points1.length, i;\n\n    for (i = 0; i < length; i++) {\n      var a1 = points1[i],\n          a2 = points1[(i + 1) % length],\n          inter = Intersection.intersectLinePolygon(a1, a2, points2);\n\n      result.appendPoints(inter.points);\n    }\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n\n  /**\n   * Checks if polygon intersects rectangle\n   * @static\n   * @param {Array} points\n   * @param {fabric.Point} r1\n   * @param {fabric.Point} r2\n   * @return {fabric.Intersection}\n   */\n  fabric.Intersection.intersectPolygonRectangle = function (points, r1, r2) {\n    var min = r1.min(r2),\n        max = r1.max(r2),\n        topRight = new fabric.Point(max.x, min.y),\n        bottomLeft = new fabric.Point(min.x, max.y),\n        inter1 = Intersection.intersectLinePolygon(min, topRight, points),\n        inter2 = Intersection.intersectLinePolygon(topRight, max, points),\n        inter3 = Intersection.intersectLinePolygon(max, bottomLeft, points),\n        inter4 = Intersection.intersectLinePolygon(bottomLeft, min, points),\n        result = new Intersection();\n\n    result.appendPoints(inter1.points);\n    result.appendPoints(inter2.points);\n    result.appendPoints(inter3.points);\n    result.appendPoints(inter4.points);\n\n    if (result.points.length > 0) {\n      result.status = 'Intersection';\n    }\n    return result;\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { });\n\n  if (fabric.Color) {\n    fabric.warn('fabric.Color is already defined.');\n    return;\n  }\n\n  /**\n   * Color class\n   * The purpose of {@link fabric.Color} is to abstract and encapsulate common color operations;\n   * {@link fabric.Color} is a constructor and creates instances of {@link fabric.Color} objects.\n   *\n   * @class fabric.Color\n   * @param {String} color optional in hex or rgb(a) or hsl format or from known color list\n   * @return {fabric.Color} thisArg\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#colors}\n   */\n  function Color(color) {\n    if (!color) {\n      this.setSource([0, 0, 0, 1]);\n    }\n    else {\n      this._tryParsingColor(color);\n    }\n  }\n\n  fabric.Color = Color;\n\n  fabric.Color.prototype = /** @lends fabric.Color.prototype */ {\n\n    /**\n     * @private\n     * @param {String|Array} color Color value to parse\n     */\n    _tryParsingColor: function(color) {\n      var source;\n\n      if (color in Color.colorNameMap) {\n        color = Color.colorNameMap[color];\n      }\n\n      if (color === 'transparent') {\n        source = [255, 255, 255, 0];\n      }\n\n      if (!source) {\n        source = Color.sourceFromHex(color);\n      }\n      if (!source) {\n        source = Color.sourceFromRgb(color);\n      }\n      if (!source) {\n        source = Color.sourceFromHsl(color);\n      }\n      if (!source) {\n        //if color is not recognize let's make black as canvas does\n        source = [0, 0, 0, 1];\n      }\n      if (source) {\n        this.setSource(source);\n      }\n    },\n\n    /**\n     * Adapted from <a href=\"https://rawgithub.com/mjijackson/mjijackson.github.com/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.html\">https://github.com/mjijackson</a>\n     * @private\n     * @param {Number} r Red color value\n     * @param {Number} g Green color value\n     * @param {Number} b Blue color value\n     * @return {Array} Hsl color\n     */\n    _rgbToHsl: function(r, g, b) {\n      r /= 255; g /= 255; b /= 255;\n\n      var h, s, l,\n          max = fabric.util.array.max([r, g, b]),\n          min = fabric.util.array.min([r, g, b]);\n\n      l = (max + min) / 2;\n\n      if (max === min) {\n        h = s = 0; // achromatic\n      }\n      else {\n        var d = max - min;\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n        switch (max) {\n          case r:\n            h = (g - b) / d + (g < b ? 6 : 0);\n            break;\n          case g:\n            h = (b - r) / d + 2;\n            break;\n          case b:\n            h = (r - g) / d + 4;\n            break;\n        }\n        h /= 6;\n      }\n\n      return [\n        Math.round(h * 360),\n        Math.round(s * 100),\n        Math.round(l * 100)\n      ];\n    },\n\n    /**\n     * Returns source of this color (where source is an array representation; ex: [200, 200, 100, 1])\n     * @return {Array}\n     */\n    getSource: function() {\n      return this._source;\n    },\n\n    /**\n     * Sets source of this color (where source is an array representation; ex: [200, 200, 100, 1])\n     * @param {Array} source\n     */\n    setSource: function(source) {\n      this._source = source;\n    },\n\n    /**\n     * Returns color representation in RGB format\n     * @return {String} ex: rgb(0-255,0-255,0-255)\n     */\n    toRgb: function() {\n      var source = this.getSource();\n      return 'rgb(' + source[0] + ',' + source[1] + ',' + source[2] + ')';\n    },\n\n    /**\n     * Returns color representation in RGBA format\n     * @return {String} ex: rgba(0-255,0-255,0-255,0-1)\n     */\n    toRgba: function() {\n      var source = this.getSource();\n      return 'rgba(' + source[0] + ',' + source[1] + ',' + source[2] + ',' + source[3] + ')';\n    },\n\n    /**\n     * Returns color representation in HSL format\n     * @return {String} ex: hsl(0-360,0%-100%,0%-100%)\n     */\n    toHsl: function() {\n      var source = this.getSource(),\n          hsl = this._rgbToHsl(source[0], source[1], source[2]);\n\n      return 'hsl(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%)';\n    },\n\n    /**\n     * Returns color representation in HSLA format\n     * @return {String} ex: hsla(0-360,0%-100%,0%-100%,0-1)\n     */\n    toHsla: function() {\n      var source = this.getSource(),\n          hsl = this._rgbToHsl(source[0], source[1], source[2]);\n\n      return 'hsla(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%,' + source[3] + ')';\n    },\n\n    /**\n     * Returns color representation in HEX format\n     * @return {String} ex: FF5555\n     */\n    toHex: function() {\n      var source = this.getSource(), r, g, b;\n\n      r = source[0].toString(16);\n      r = (r.length === 1) ? ('0' + r) : r;\n\n      g = source[1].toString(16);\n      g = (g.length === 1) ? ('0' + g) : g;\n\n      b = source[2].toString(16);\n      b = (b.length === 1) ? ('0' + b) : b;\n\n      return r.toUpperCase() + g.toUpperCase() + b.toUpperCase();\n    },\n\n    /**\n     * Returns color representation in HEXA format\n     * @return {String} ex: FF5555CC\n     */\n    toHexa: function() {\n      var source = this.getSource(), a;\n\n      a = Math.round(source[3] * 255);\n      a = a.toString(16);\n      a = (a.length === 1) ? ('0' + a) : a;\n\n      return this.toHex() + a.toUpperCase();\n    },\n\n    /**\n     * Gets value of alpha channel for this color\n     * @return {Number} 0-1\n     */\n    getAlpha: function() {\n      return this.getSource()[3];\n    },\n\n    /**\n     * Sets value of alpha channel for this color\n     * @param {Number} alpha Alpha value 0-1\n     * @return {fabric.Color} thisArg\n     */\n    setAlpha: function(alpha) {\n      var source = this.getSource();\n      source[3] = alpha;\n      this.setSource(source);\n      return this;\n    },\n\n    /**\n     * Transforms color to its grayscale representation\n     * @return {fabric.Color} thisArg\n     */\n    toGrayscale: function() {\n      var source = this.getSource(),\n          average = parseInt((source[0] * 0.3 + source[1] * 0.59 + source[2] * 0.11).toFixed(0), 10),\n          currentAlpha = source[3];\n      this.setSource([average, average, average, currentAlpha]);\n      return this;\n    },\n\n    /**\n     * Transforms color to its black and white representation\n     * @param {Number} threshold\n     * @return {fabric.Color} thisArg\n     */\n    toBlackWhite: function(threshold) {\n      var source = this.getSource(),\n          average = (source[0] * 0.3 + source[1] * 0.59 + source[2] * 0.11).toFixed(0),\n          currentAlpha = source[3];\n\n      threshold = threshold || 127;\n\n      average = (Number(average) < Number(threshold)) ? 0 : 255;\n      this.setSource([average, average, average, currentAlpha]);\n      return this;\n    },\n\n    /**\n     * Overlays color with another color\n     * @param {String|fabric.Color} otherColor\n     * @return {fabric.Color} thisArg\n     */\n    overlayWith: function(otherColor) {\n      if (!(otherColor instanceof Color)) {\n        otherColor = new Color(otherColor);\n      }\n\n      var result = [],\n          alpha = this.getAlpha(),\n          otherAlpha = 0.5,\n          source = this.getSource(),\n          otherSource = otherColor.getSource(), i;\n\n      for (i = 0; i < 3; i++) {\n        result.push(Math.round((source[i] * (1 - otherAlpha)) + (otherSource[i] * otherAlpha)));\n      }\n\n      result[3] = alpha;\n      this.setSource(result);\n      return this;\n    }\n  };\n\n  /**\n   * Regex matching color in RGB or RGBA formats (ex: rgb(0, 0, 0), rgba(255, 100, 10, 0.5), rgba( 255 , 100 , 10 , 0.5 ), rgb(1,1,1), rgba(100%, 60%, 10%, 0.5))\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  // eslint-disable-next-line max-len\n  fabric.Color.reRGBa = /^rgba?\\(\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*(?:\\s*,\\s*((?:\\d*\\.?\\d+)?)\\s*)?\\)$/i;\n\n  /**\n   * Regex matching color in HSL or HSLA formats (ex: hsl(200, 80%, 10%), hsla(300, 50%, 80%, 0.5), hsla( 300 , 50% , 80% , 0.5 ))\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  fabric.Color.reHSLa = /^hsla?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3}\\%)\\s*,\\s*(\\d{1,3}\\%)\\s*(?:\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*)?\\)$/i;\n\n  /**\n   * Regex matching color in HEX format (ex: #FF5544CC, #FF5555, 010155, aff)\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   */\n  fabric.Color.reHex = /^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i;\n\n  /**\n   * Map of the 148 color names with HEX code\n   * @static\n   * @field\n   * @memberOf fabric.Color\n   * @see: https://www.w3.org/TR/css3-color/#svg-color\n   */\n  fabric.Color.colorNameMap = {\n    aliceblue:            '#F0F8FF',\n    antiquewhite:         '#FAEBD7',\n    aqua:                 '#00FFFF',\n    aquamarine:           '#7FFFD4',\n    azure:                '#F0FFFF',\n    beige:                '#F5F5DC',\n    bisque:               '#FFE4C4',\n    black:                '#000000',\n    blanchedalmond:       '#FFEBCD',\n    blue:                 '#0000FF',\n    blueviolet:           '#8A2BE2',\n    brown:                '#A52A2A',\n    burlywood:            '#DEB887',\n    cadetblue:            '#5F9EA0',\n    chartreuse:           '#7FFF00',\n    chocolate:            '#D2691E',\n    coral:                '#FF7F50',\n    cornflowerblue:       '#6495ED',\n    cornsilk:             '#FFF8DC',\n    crimson:              '#DC143C',\n    cyan:                 '#00FFFF',\n    darkblue:             '#00008B',\n    darkcyan:             '#008B8B',\n    darkgoldenrod:        '#B8860B',\n    darkgray:             '#A9A9A9',\n    darkgrey:             '#A9A9A9',\n    darkgreen:            '#006400',\n    darkkhaki:            '#BDB76B',\n    darkmagenta:          '#8B008B',\n    darkolivegreen:       '#556B2F',\n    darkorange:           '#FF8C00',\n    darkorchid:           '#9932CC',\n    darkred:              '#8B0000',\n    darksalmon:           '#E9967A',\n    darkseagreen:         '#8FBC8F',\n    darkslateblue:        '#483D8B',\n    darkslategray:        '#2F4F4F',\n    darkslategrey:        '#2F4F4F',\n    darkturquoise:        '#00CED1',\n    darkviolet:           '#9400D3',\n    deeppink:             '#FF1493',\n    deepskyblue:          '#00BFFF',\n    dimgray:              '#696969',\n    dimgrey:              '#696969',\n    dodgerblue:           '#1E90FF',\n    firebrick:            '#B22222',\n    floralwhite:          '#FFFAF0',\n    forestgreen:          '#228B22',\n    fuchsia:              '#FF00FF',\n    gainsboro:            '#DCDCDC',\n    ghostwhite:           '#F8F8FF',\n    gold:                 '#FFD700',\n    goldenrod:            '#DAA520',\n    gray:                 '#808080',\n    grey:                 '#808080',\n    green:                '#008000',\n    greenyellow:          '#ADFF2F',\n    honeydew:             '#F0FFF0',\n    hotpink:              '#FF69B4',\n    indianred:            '#CD5C5C',\n    indigo:               '#4B0082',\n    ivory:                '#FFFFF0',\n    khaki:                '#F0E68C',\n    lavender:             '#E6E6FA',\n    lavenderblush:        '#FFF0F5',\n    lawngreen:            '#7CFC00',\n    lemonchiffon:         '#FFFACD',\n    lightblue:            '#ADD8E6',\n    lightcoral:           '#F08080',\n    lightcyan:            '#E0FFFF',\n    lightgoldenrodyellow: '#FAFAD2',\n    lightgray:            '#D3D3D3',\n    lightgrey:            '#D3D3D3',\n    lightgreen:           '#90EE90',\n    lightpink:            '#FFB6C1',\n    lightsalmon:          '#FFA07A',\n    lightseagreen:        '#20B2AA',\n    lightskyblue:         '#87CEFA',\n    lightslategray:       '#778899',\n    lightslategrey:       '#778899',\n    lightsteelblue:       '#B0C4DE',\n    lightyellow:          '#FFFFE0',\n    lime:                 '#00FF00',\n    limegreen:            '#32CD32',\n    linen:                '#FAF0E6',\n    magenta:              '#FF00FF',\n    maroon:               '#800000',\n    mediumaquamarine:     '#66CDAA',\n    mediumblue:           '#0000CD',\n    mediumorchid:         '#BA55D3',\n    mediumpurple:         '#9370DB',\n    mediumseagreen:       '#3CB371',\n    mediumslateblue:      '#7B68EE',\n    mediumspringgreen:    '#00FA9A',\n    mediumturquoise:      '#48D1CC',\n    mediumvioletred:      '#C71585',\n    midnightblue:         '#191970',\n    mintcream:            '#F5FFFA',\n    mistyrose:            '#FFE4E1',\n    moccasin:             '#FFE4B5',\n    navajowhite:          '#FFDEAD',\n    navy:                 '#000080',\n    oldlace:              '#FDF5E6',\n    olive:                '#808000',\n    olivedrab:            '#6B8E23',\n    orange:               '#FFA500',\n    orangered:            '#FF4500',\n    orchid:               '#DA70D6',\n    palegoldenrod:        '#EEE8AA',\n    palegreen:            '#98FB98',\n    paleturquoise:        '#AFEEEE',\n    palevioletred:        '#DB7093',\n    papayawhip:           '#FFEFD5',\n    peachpuff:            '#FFDAB9',\n    peru:                 '#CD853F',\n    pink:                 '#FFC0CB',\n    plum:                 '#DDA0DD',\n    powderblue:           '#B0E0E6',\n    purple:               '#800080',\n    rebeccapurple:        '#663399',\n    red:                  '#FF0000',\n    rosybrown:            '#BC8F8F',\n    royalblue:            '#4169E1',\n    saddlebrown:          '#8B4513',\n    salmon:               '#FA8072',\n    sandybrown:           '#F4A460',\n    seagreen:             '#2E8B57',\n    seashell:             '#FFF5EE',\n    sienna:               '#A0522D',\n    silver:               '#C0C0C0',\n    skyblue:              '#87CEEB',\n    slateblue:            '#6A5ACD',\n    slategray:            '#708090',\n    slategrey:            '#708090',\n    snow:                 '#FFFAFA',\n    springgreen:          '#00FF7F',\n    steelblue:            '#4682B4',\n    tan:                  '#D2B48C',\n    teal:                 '#008080',\n    thistle:              '#D8BFD8',\n    tomato:               '#FF6347',\n    turquoise:            '#40E0D0',\n    violet:               '#EE82EE',\n    wheat:                '#F5DEB3',\n    white:                '#FFFFFF',\n    whitesmoke:           '#F5F5F5',\n    yellow:               '#FFFF00',\n    yellowgreen:          '#9ACD32'\n  };\n\n  /**\n   * @private\n   * @param {Number} p\n   * @param {Number} q\n   * @param {Number} t\n   * @return {Number}\n   */\n  function hue2rgb(p, q, t) {\n    if (t < 0) {\n      t += 1;\n    }\n    if (t > 1) {\n      t -= 1;\n    }\n    if (t < 1 / 6) {\n      return p + (q - p) * 6 * t;\n    }\n    if (t < 1 / 2) {\n      return q;\n    }\n    if (t < 2 / 3) {\n      return p + (q - p) * (2 / 3 - t) * 6;\n    }\n    return p;\n  }\n\n  /**\n   * Returns new color object, when given a color in RGB format\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: rgb(0-255,0-255,0-255)\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromRgb = function(color) {\n    return Color.fromSource(Color.sourceFromRgb(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in RGB or RGBA format\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: rgb(0-255,0-255,0-255), rgb(0%-100%,0%-100%,0%-100%)\n   * @return {Array} source\n   */\n  fabric.Color.sourceFromRgb = function(color) {\n    var match = color.match(Color.reRGBa);\n    if (match) {\n      var r = parseInt(match[1], 10) / (/%$/.test(match[1]) ? 100 : 1) * (/%$/.test(match[1]) ? 255 : 1),\n          g = parseInt(match[2], 10) / (/%$/.test(match[2]) ? 100 : 1) * (/%$/.test(match[2]) ? 255 : 1),\n          b = parseInt(match[3], 10) / (/%$/.test(match[3]) ? 100 : 1) * (/%$/.test(match[3]) ? 255 : 1);\n\n      return [\n        parseInt(r, 10),\n        parseInt(g, 10),\n        parseInt(b, 10),\n        match[4] ? parseFloat(match[4]) : 1\n      ];\n    }\n  };\n\n  /**\n   * Returns new color object, when given a color in RGBA format\n   * @static\n   * @function\n   * @memberOf fabric.Color\n   * @param {String} color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromRgba = Color.fromRgb;\n\n  /**\n   * Returns new color object, when given a color in HSL format\n   * @param {String} color Color value ex: hsl(0-260,0%-100%,0%-100%)\n   * @memberOf fabric.Color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHsl = function(color) {\n    return Color.fromSource(Color.sourceFromHsl(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in HSL or HSLA format.\n   * Adapted from <a href=\"https://rawgithub.com/mjijackson/mjijackson.github.com/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.html\">https://github.com/mjijackson</a>\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: hsl(0-360,0%-100%,0%-100%) or hsla(0-360,0%-100%,0%-100%, 0-1)\n   * @return {Array} source\n   * @see http://http://www.w3.org/TR/css3-color/#hsl-color\n   */\n  fabric.Color.sourceFromHsl = function(color) {\n    var match = color.match(Color.reHSLa);\n    if (!match) {\n      return;\n    }\n\n    var h = (((parseFloat(match[1]) % 360) + 360) % 360) / 360,\n        s = parseFloat(match[2]) / (/%$/.test(match[2]) ? 100 : 1),\n        l = parseFloat(match[3]) / (/%$/.test(match[3]) ? 100 : 1),\n        r, g, b;\n\n    if (s === 0) {\n      r = g = b = l;\n    }\n    else {\n      var q = l <= 0.5 ? l * (s + 1) : l + s - l * s,\n          p = l * 2 - q;\n\n      r = hue2rgb(p, q, h + 1 / 3);\n      g = hue2rgb(p, q, h);\n      b = hue2rgb(p, q, h - 1 / 3);\n    }\n\n    return [\n      Math.round(r * 255),\n      Math.round(g * 255),\n      Math.round(b * 255),\n      match[4] ? parseFloat(match[4]) : 1\n    ];\n  };\n\n  /**\n   * Returns new color object, when given a color in HSLA format\n   * @static\n   * @function\n   * @memberOf fabric.Color\n   * @param {String} color\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHsla = Color.fromHsl;\n\n  /**\n   * Returns new color object, when given a color in HEX format\n   * @static\n   * @memberOf fabric.Color\n   * @param {String} color Color value ex: FF5555\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromHex = function(color) {\n    return Color.fromSource(Color.sourceFromHex(color));\n  };\n\n  /**\n   * Returns array representation (ex: [100, 100, 200, 1]) of a color that's in HEX format\n   * @static\n   * @memberOf fabric.Color\n   * @param {String} color ex: FF5555 or FF5544CC (RGBa)\n   * @return {Array} source\n   */\n  fabric.Color.sourceFromHex = function(color) {\n    if (color.match(Color.reHex)) {\n      var value = color.slice(color.indexOf('#') + 1),\n          isShortNotation = (value.length === 3 || value.length === 4),\n          isRGBa = (value.length === 8 || value.length === 4),\n          r = isShortNotation ? (value.charAt(0) + value.charAt(0)) : value.substring(0, 2),\n          g = isShortNotation ? (value.charAt(1) + value.charAt(1)) : value.substring(2, 4),\n          b = isShortNotation ? (value.charAt(2) + value.charAt(2)) : value.substring(4, 6),\n          a = isRGBa ? (isShortNotation ? (value.charAt(3) + value.charAt(3)) : value.substring(6, 8)) : 'FF';\n\n      return [\n        parseInt(r, 16),\n        parseInt(g, 16),\n        parseInt(b, 16),\n        parseFloat((parseInt(a, 16) / 255).toFixed(2))\n      ];\n    }\n  };\n\n  /**\n   * Returns new color object, when given color in array representation (ex: [200, 100, 100, 0.5])\n   * @static\n   * @memberOf fabric.Color\n   * @param {Array} source\n   * @return {fabric.Color}\n   */\n  fabric.Color.fromSource = function(source) {\n    var oColor = new Color();\n    oColor.setSource(source);\n    return oColor;\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      scaleMap = ['e', 'se', 's', 'sw', 'w', 'nw', 'n', 'ne', 'e'],\n      skewMap = ['ns', 'nesw', 'ew', 'nwse'],\n      controls = {},\n      LEFT = 'left', TOP = 'top', RIGHT = 'right', BOTTOM = 'bottom', CENTER = 'center',\n      opposite = {\n        top: BOTTOM,\n        bottom: TOP,\n        left: RIGHT,\n        right: LEFT,\n        center: CENTER,\n      }, radiansToDegrees = fabric.util.radiansToDegrees,\n      sign = (Math.sign || function(x) { return ((x > 0) - (x < 0)) || +x; });\n\n  /**\n   * Combine control position and object angle to find the control direction compared\n   * to the object center.\n   * @param {fabric.Object} fabricObject the fabric object for which we are rendering controls\n   * @param {fabric.Control} control the control class\n   * @return {Number} 0 - 7 a quadrant number\n   */\n  function findCornerQuadrant(fabricObject, control) {\n    var cornerAngle = fabricObject.angle + radiansToDegrees(Math.atan2(control.y, control.x)) + 360;\n    return Math.round((cornerAngle % 360) / 45);\n  }\n\n  function fireEvent(eventName, options) {\n    var target = options.transform.target,\n        canvas = target.canvas,\n        canvasOptions = fabric.util.object.clone(options);\n    canvasOptions.target = target;\n    canvas && canvas.fire('object:' + eventName, canvasOptions);\n    target.fire(eventName, options);\n  }\n\n  /**\n   * Inspect event and fabricObject properties to understand if the scaling action\n   * @param {Event} eventData from the user action\n   * @param {fabric.Object} fabricObject the fabric object about to scale\n   * @return {Boolean} true if scale is proportional\n   */\n  function scaleIsProportional(eventData, fabricObject) {\n    var canvas = fabricObject.canvas, uniScaleKey = canvas.uniScaleKey,\n        uniformIsToggled = eventData[uniScaleKey];\n    return (canvas.uniformScaling && !uniformIsToggled) ||\n    (!canvas.uniformScaling && uniformIsToggled);\n  }\n\n  /**\n   * Checks if transform is centered\n   * @param {Object} transform transform data\n   * @return {Boolean} true if transform is centered\n   */\n  function isTransformCentered(transform) {\n    return transform.originX === CENTER && transform.originY === CENTER;\n  }\n\n  /**\n   * Inspect fabricObject to understand if the current scaling action is allowed\n   * @param {fabric.Object} fabricObject the fabric object about to scale\n   * @param {String} by 'x' or 'y' or ''\n   * @param {Boolean} scaleProportionally true if we are trying to scale proportionally\n   * @return {Boolean} true if scaling is not allowed at current conditions\n   */\n  function scalingIsForbidden(fabricObject, by, scaleProportionally) {\n    var lockX = fabricObject.lockScalingX, lockY = fabricObject.lockScalingY;\n    if (lockX && lockY) {\n      return true;\n    }\n    if (!by && (lockX || lockY) && scaleProportionally) {\n      return true;\n    }\n    if (lockX && by === 'x') {\n      return true;\n    }\n    if (lockY && by === 'y') {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * return the correct cursor style for the scale action\n   * @param {Event} eventData the javascript event that is causing the scale\n   * @param {fabric.Control} control the control that is interested in the action\n   * @param {fabric.Object} fabricObject the fabric object that is interested in the action\n   * @return {String} a valid css string for the cursor\n   */\n  function scaleCursorStyleHandler(eventData, control, fabricObject) {\n    var notAllowed = 'not-allowed',\n        scaleProportionally = scaleIsProportional(eventData, fabricObject),\n        by = '';\n    if (control.x !== 0 && control.y === 0) {\n      by = 'x';\n    }\n    else if (control.x === 0 && control.y !== 0) {\n      by = 'y';\n    }\n    if (scalingIsForbidden(fabricObject, by, scaleProportionally)) {\n      return notAllowed;\n    }\n    var n = findCornerQuadrant(fabricObject, control);\n    return scaleMap[n] + '-resize';\n  }\n\n  /**\n   * return the correct cursor style for the skew action\n   * @param {Event} eventData the javascript event that is causing the scale\n   * @param {fabric.Control} control the control that is interested in the action\n   * @param {fabric.Object} fabricObject the fabric object that is interested in the action\n   * @return {String} a valid css string for the cursor\n   */\n  function skewCursorStyleHandler(eventData, control, fabricObject) {\n    var notAllowed = 'not-allowed';\n    if (control.x !== 0 && fabricObject.lockSkewingY) {\n      return notAllowed;\n    }\n    if (control.y !== 0 && fabricObject.lockSkewingX) {\n      return notAllowed;\n    }\n    var n = findCornerQuadrant(fabricObject, control) % 4;\n    return skewMap[n] + '-resize';\n  }\n\n  /**\n   * Combine skew and scale style handlers to cover fabric standard use case\n   * @param {Event} eventData the javascript event that is causing the scale\n   * @param {fabric.Control} control the control that is interested in the action\n   * @param {fabric.Object} fabricObject the fabric object that is interested in the action\n   * @return {String} a valid css string for the cursor\n   */\n  function scaleSkewCursorStyleHandler(eventData, control, fabricObject) {\n    if (eventData[fabricObject.canvas.altActionKey]) {\n      return controls.skewCursorStyleHandler(eventData, control, fabricObject);\n    }\n    return controls.scaleCursorStyleHandler(eventData, control, fabricObject);\n  }\n\n  /**\n   * Inspect event, control and fabricObject to return the correct action name\n   * @param {Event} eventData the javascript event that is causing the scale\n   * @param {fabric.Control} control the control that is interested in the action\n   * @param {fabric.Object} fabricObject the fabric object that is interested in the action\n   * @return {String} an action name\n   */\n  function scaleOrSkewActionName(eventData, control, fabricObject) {\n    var isAlternative = eventData[fabricObject.canvas.altActionKey];\n    if (control.x === 0) {\n      // then is scaleY or skewX\n      return isAlternative ? 'skewX' : 'scaleY';\n    }\n    if (control.y === 0) {\n      // then is scaleY or skewX\n      return isAlternative ? 'skewY' : 'scaleX';\n    }\n  }\n\n  /**\n   * Find the correct style for the control that is used for rotation.\n   * this function is very simple and it just take care of not-allowed or standard cursor\n   * @param {Event} eventData the javascript event that is causing the scale\n   * @param {fabric.Control} control the control that is interested in the action\n   * @param {fabric.Object} fabricObject the fabric object that is interested in the action\n   * @return {String} a valid css string for the cursor\n   */\n  function rotationStyleHandler(eventData, control, fabricObject) {\n    if (fabricObject.lockRotation) {\n      return 'not-allowed';\n    }\n    return control.cursorStyle;\n  }\n\n  function commonEventInfo(eventData, transform, x, y) {\n    return {\n      e: eventData,\n      transform: transform,\n      pointer: {\n        x: x,\n        y: y,\n      }\n    };\n  }\n\n  /**\n   * Wrap an action handler with saving/restoring object position on the transform.\n   * this is the code that permits to objects to keep their position while transforming.\n   * @param {Function} actionHandler the function to wrap\n   * @return {Function} a function with an action handler signature\n   */\n  function wrapWithFixedAnchor(actionHandler) {\n    return function(eventData, transform, x, y) {\n      var target = transform.target, centerPoint = target.getCenterPoint(),\n          constraint = target.translateToOriginPoint(centerPoint, transform.originX, transform.originY),\n          actionPerformed = actionHandler(eventData, transform, x, y);\n      target.setPositionByOrigin(constraint, transform.originX, transform.originY);\n      return actionPerformed;\n    };\n  }\n\n  /**\n   * Wrap an action handler with firing an event if the action is performed\n   * @param {Function} actionHandler the function to wrap\n   * @return {Function} a function with an action handler signature\n   */\n  function wrapWithFireEvent(eventName, actionHandler) {\n    return function(eventData, transform, x, y) {\n      var actionPerformed = actionHandler(eventData, transform, x, y);\n      if (actionPerformed) {\n        fireEvent(eventName, commonEventInfo(eventData, transform, x, y));\n      }\n      return actionPerformed;\n    };\n  }\n\n  /**\n   * Transforms a point described by x and y in a distance from the top left corner of the object\n   * bounding box.\n   * @param {Object} transform\n   * @param {String} originX\n   * @param {String} originY\n   * @param {number} x\n   * @param {number} y\n   * @return {Fabric.Point} the normalized point\n   */\n  function getLocalPoint(transform, originX, originY, x, y) {\n    var target = transform.target,\n        control = target.controls[transform.corner],\n        zoom = target.canvas.getZoom(),\n        padding = target.padding / zoom,\n        localPoint = target.toLocalPoint(new fabric.Point(x, y), originX, originY);\n    if (localPoint.x >= padding) {\n      localPoint.x -= padding;\n    }\n    if (localPoint.x <= -padding) {\n      localPoint.x += padding;\n    }\n    if (localPoint.y >= padding) {\n      localPoint.y -= padding;\n    }\n    if (localPoint.y <= padding) {\n      localPoint.y += padding;\n    }\n    localPoint.x -= control.offsetX;\n    localPoint.y -= control.offsetY;\n    return localPoint;\n  }\n\n  /**\n   * Detect if the fabric object is flipped on one side.\n   * @param {fabric.Object} target\n   * @return {Boolean} true if one flip, but not two.\n   */\n  function targetHasOneFlip(target) {\n    return target.flipX !== target.flipY;\n  }\n\n  /**\n   * Utility function to compensate the scale factor when skew is applied on both axes\n   * @private\n   */\n  function compensateScaleForSkew(target, oppositeSkew, scaleToCompensate, axis, reference) {\n    if (target[oppositeSkew] !== 0) {\n      var newDim = target._getTransformedDimensions()[axis];\n      var newValue = reference / newDim * target[scaleToCompensate];\n      target.set(scaleToCompensate, newValue);\n    }\n  }\n\n  /**\n   * Action handler for skewing on the X axis\n   * @private\n   */\n  function skewObjectX(eventData, transform, x, y) {\n    var target = transform.target,\n        // find how big the object would be, if there was no skewX. takes in account scaling\n        dimNoSkew = target._getTransformedDimensions(0, target.skewY),\n        localPoint = getLocalPoint(transform, transform.originX, transform.originY, x, y),\n        // the mouse is in the center of the object, and we want it to stay there.\n        // so the object will grow twice as much as the mouse.\n        // this makes the skew growth to localPoint * 2 - dimNoSkew.\n        totalSkewSize = Math.abs(localPoint.x * 2) - dimNoSkew.x,\n        currentSkew = target.skewX, newSkew;\n    if (totalSkewSize < 2) {\n      // let's make it easy to go back to position 0.\n      newSkew = 0;\n    }\n    else {\n      newSkew = radiansToDegrees(\n        Math.atan2((totalSkewSize / target.scaleX), (dimNoSkew.y / target.scaleY))\n      );\n      // now we have to find the sign of the skew.\n      // it mostly depend on the origin of transformation.\n      if (transform.originX === LEFT && transform.originY === BOTTOM) {\n        newSkew = -newSkew;\n      }\n      if (transform.originX === RIGHT && transform.originY === TOP) {\n        newSkew = -newSkew;\n      }\n      if (targetHasOneFlip(target)) {\n        newSkew = -newSkew;\n      }\n    }\n    var hasSkewed = currentSkew !== newSkew;\n    if (hasSkewed) {\n      var dimBeforeSkewing = target._getTransformedDimensions().y;\n      target.set('skewX', newSkew);\n      compensateScaleForSkew(target, 'skewY', 'scaleY', 'y', dimBeforeSkewing);\n    }\n    return hasSkewed;\n  }\n\n  /**\n   * Action handler for skewing on the Y axis\n   * @private\n   */\n  function skewObjectY(eventData, transform, x, y) {\n    var target = transform.target,\n        // find how big the object would be, if there was no skewX. takes in account scaling\n        dimNoSkew = target._getTransformedDimensions(target.skewX, 0),\n        localPoint = getLocalPoint(transform, transform.originX, transform.originY, x, y),\n        // the mouse is in the center of the object, and we want it to stay there.\n        // so the object will grow twice as much as the mouse.\n        // this makes the skew growth to localPoint * 2 - dimNoSkew.\n        totalSkewSize = Math.abs(localPoint.y * 2) - dimNoSkew.y,\n        currentSkew = target.skewY, newSkew;\n    if (totalSkewSize < 2) {\n      // let's make it easy to go back to position 0.\n      newSkew = 0;\n    }\n    else {\n      newSkew = radiansToDegrees(\n        Math.atan2((totalSkewSize / target.scaleY), (dimNoSkew.x / target.scaleX))\n      );\n      // now we have to find the sign of the skew.\n      // it mostly depend on the origin of transformation.\n      if (transform.originX === LEFT && transform.originY === BOTTOM) {\n        newSkew = -newSkew;\n      }\n      if (transform.originX === RIGHT && transform.originY === TOP) {\n        newSkew = -newSkew;\n      }\n      if (targetHasOneFlip(target)) {\n        newSkew = -newSkew;\n      }\n    }\n    var hasSkewed = currentSkew !== newSkew;\n    if (hasSkewed) {\n      var dimBeforeSkewing = target._getTransformedDimensions().x;\n      target.set('skewY', newSkew);\n      compensateScaleForSkew(target, 'skewX', 'scaleX', 'x', dimBeforeSkewing);\n    }\n    return hasSkewed;\n  }\n\n  /**\n   * Wrapped Action handler for skewing on the Y axis, takes care of the\n   * skew direction and determine the correct transform origin for the anchor point\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   */\n  function skewHandlerX(eventData, transform, x, y) {\n    // step1 figure out and change transform origin.\n    // if skewX > 0 and originY bottom we anchor on right\n    // if skewX > 0 and originY top we anchor on left\n    // if skewX < 0 and originY bottom we anchor on left\n    // if skewX < 0 and originY top we anchor on right\n    // if skewX is 0, we look for mouse position to understand where are we going.\n    var target = transform.target, currentSkew = target.skewX, originX, originY = transform.originY;\n    if (target.lockSkewingX) {\n      return false;\n    }\n    if (currentSkew === 0) {\n      var localPointFromCenter = getLocalPoint(transform, CENTER, CENTER, x, y);\n      if (localPointFromCenter.x > 0) {\n        // we are pulling right, anchor left;\n        originX = LEFT;\n      }\n      else {\n        // we are pulling right, anchor right\n        originX = RIGHT;\n      }\n    }\n    else {\n      if (currentSkew > 0) {\n        originX = originY === TOP ? LEFT : RIGHT;\n      }\n      if (currentSkew < 0) {\n        originX = originY === TOP ? RIGHT : LEFT;\n      }\n      // is the object flipped on one side only? swap the origin.\n      if (targetHasOneFlip(target)) {\n        originX = originX === LEFT ? RIGHT : LEFT;\n      }\n    }\n\n    // once we have the origin, we find the anchor point\n    transform.originX = originX;\n    var finalHandler = wrapWithFireEvent('skewing', wrapWithFixedAnchor(skewObjectX));\n    return finalHandler(eventData, transform, x, y);\n  }\n\n  /**\n   * Wrapped Action handler for skewing on the Y axis, takes care of the\n   * skew direction and determine the correct transform origin for the anchor point\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   */\n  function skewHandlerY(eventData, transform, x, y) {\n    // step1 figure out and change transform origin.\n    // if skewY > 0 and originX left we anchor on top\n    // if skewY > 0 and originX right we anchor on bottom\n    // if skewY < 0 and originX left we anchor on bottom\n    // if skewY < 0 and originX right we anchor on top\n    // if skewY is 0, we look for mouse position to understand where are we going.\n    var target = transform.target, currentSkew = target.skewY, originY, originX = transform.originX;\n    if (target.lockSkewingY) {\n      return false;\n    }\n    if (currentSkew === 0) {\n      var localPointFromCenter = getLocalPoint(transform, CENTER, CENTER, x, y);\n      if (localPointFromCenter.y > 0) {\n        // we are pulling down, anchor up;\n        originY = TOP;\n      }\n      else {\n        // we are pulling up, anchor down\n        originY = BOTTOM;\n      }\n    }\n    else {\n      if (currentSkew > 0) {\n        originY = originX === LEFT ? TOP : BOTTOM;\n      }\n      if (currentSkew < 0) {\n        originY = originX === LEFT ? BOTTOM : TOP;\n      }\n      // is the object flipped on one side only? swap the origin.\n      if (targetHasOneFlip(target)) {\n        originY = originY === TOP ? BOTTOM : TOP;\n      }\n    }\n\n    // once we have the origin, we find the anchor point\n    transform.originY = originY;\n    var finalHandler = wrapWithFireEvent('skewing', wrapWithFixedAnchor(skewObjectY));\n    return finalHandler(eventData, transform, x, y);\n  }\n\n  /**\n   * Action handler for rotation and snapping, without anchor point.\n   * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   * @private\n   */\n  function rotationWithSnapping(eventData, transform, x, y) {\n    var t = transform,\n        target = t.target,\n        pivotPoint = target.translateToOriginPoint(target.getCenterPoint(), t.originX, t.originY);\n\n    if (target.lockRotation) {\n      return false;\n    }\n\n    var lastAngle = Math.atan2(t.ey - pivotPoint.y, t.ex - pivotPoint.x),\n        curAngle = Math.atan2(y - pivotPoint.y, x - pivotPoint.x),\n        angle = radiansToDegrees(curAngle - lastAngle + t.theta),\n        hasRotated = true;\n\n    if (target.snapAngle > 0) {\n      var snapAngle  = target.snapAngle,\n          snapThreshold  = target.snapThreshold || snapAngle,\n          rightAngleLocked = Math.ceil(angle / snapAngle) * snapAngle,\n          leftAngleLocked = Math.floor(angle / snapAngle) * snapAngle;\n\n      if (Math.abs(angle - leftAngleLocked) < snapThreshold) {\n        angle = leftAngleLocked;\n      }\n      else if (Math.abs(angle - rightAngleLocked) < snapThreshold) {\n        angle = rightAngleLocked;\n      }\n    }\n\n    // normalize angle to positive value\n    if (angle < 0) {\n      angle = 360 + angle;\n    }\n    angle %= 360;\n\n    hasRotated = target.angle !== angle;\n    target.angle = angle;\n    return hasRotated;\n  }\n\n  /**\n   * Basic scaling logic, reused with different constrain for scaling X,Y, freely or equally.\n   * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @param {Object} options additional information for scaling\n   * @param {String} options.by 'x', 'y', 'equally' or '' to indicate type of scaling\n   * @return {Boolean} true if some change happened\n   * @private\n   */\n  function scaleObject(eventData, transform, x, y, options) {\n    options = options || {};\n    var target = transform.target,\n        lockScalingX = target.lockScalingX, lockScalingY = target.lockScalingY,\n        by = options.by, newPoint, scaleX, scaleY, dim,\n        scaleProportionally = scaleIsProportional(eventData, target),\n        forbidScaling = scalingIsForbidden(target, by, scaleProportionally),\n        signX, signY, gestureScale = transform.gestureScale;\n\n    if (forbidScaling) {\n      return false;\n    }\n    if (gestureScale) {\n      scaleX = transform.scaleX * gestureScale;\n      scaleY = transform.scaleY * gestureScale;\n    }\n    else {\n      newPoint = getLocalPoint(transform, transform.originX, transform.originY, x, y);\n      // use of sign: We use sign to detect change of direction of an action. sign usually change when\n      // we cross the origin point with the mouse. So a scale flip for example. There is an issue when scaling\n      // by center and scaling using one middle control ( default: mr, mt, ml, mb), the mouse movement can easily\n      // cross many time the origin point and flip the object. so we need a way to filter out the noise.\n      // This ternary here should be ok to filter out X scaling when we want Y only and vice versa.\n      signX = by !== 'y' ? sign(newPoint.x) : 1;\n      signY = by !== 'x' ? sign(newPoint.y) : 1;\n      if (!transform.signX) {\n        transform.signX = signX;\n      }\n      if (!transform.signY) {\n        transform.signY = signY;\n      }\n\n      if (target.lockScalingFlip &&\n        (transform.signX !== signX || transform.signY !== signY)\n      ) {\n        return false;\n      }\n\n      dim = target._getTransformedDimensions();\n      // missing detection of flip and logic to switch the origin\n      if (scaleProportionally && !by) {\n        // uniform scaling\n        var distance = Math.abs(newPoint.x) + Math.abs(newPoint.y),\n            original = transform.original,\n            originalDistance = Math.abs(dim.x * original.scaleX / target.scaleX) +\n              Math.abs(dim.y * original.scaleY / target.scaleY),\n            scale = distance / originalDistance;\n        scaleX = original.scaleX * scale;\n        scaleY = original.scaleY * scale;\n      }\n      else {\n        scaleX = Math.abs(newPoint.x * target.scaleX / dim.x);\n        scaleY = Math.abs(newPoint.y * target.scaleY / dim.y);\n      }\n      // if we are scaling by center, we need to double the scale\n      if (isTransformCentered(transform)) {\n        scaleX *= 2;\n        scaleY *= 2;\n      }\n      if (transform.signX !== signX && by !== 'y') {\n        transform.originX = opposite[transform.originX];\n        scaleX *= -1;\n        transform.signX = signX;\n      }\n      if (transform.signY !== signY && by !== 'x') {\n        transform.originY = opposite[transform.originY];\n        scaleY *= -1;\n        transform.signY = signY;\n      }\n    }\n    // minScale is taken are in the setter.\n    var oldScaleX = target.scaleX, oldScaleY = target.scaleY;\n    if (!by) {\n      !lockScalingX && target.set('scaleX', scaleX);\n      !lockScalingY && target.set('scaleY', scaleY);\n    }\n    else {\n      // forbidden cases already handled on top here.\n      by === 'x' && target.set('scaleX', scaleX);\n      by === 'y' && target.set('scaleY', scaleY);\n    }\n    return oldScaleX !== target.scaleX || oldScaleY !== target.scaleY;\n  }\n\n  /**\n   * Generic scaling logic, to scale from corners either equally or freely.\n   * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   */\n  function scaleObjectFromCorner(eventData, transform, x, y) {\n    return scaleObject(eventData, transform, x, y);\n  }\n\n  /**\n   * Scaling logic for the X axis.\n   * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   */\n  function scaleObjectX(eventData, transform, x, y) {\n    return scaleObject(eventData, transform, x, y , { by: 'x' });\n  }\n\n  /**\n   * Scaling logic for the Y axis.\n   * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   */\n  function scaleObjectY(eventData, transform, x, y) {\n    return scaleObject(eventData, transform, x, y , { by: 'y' });\n  }\n\n  /**\n   * Composed action handler to either scale Y or skew X\n   * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   */\n  function scalingYOrSkewingX(eventData, transform, x, y) {\n    // ok some safety needed here.\n    if (eventData[transform.target.canvas.altActionKey]) {\n      return controls.skewHandlerX(eventData, transform, x, y);\n    }\n    return controls.scalingY(eventData, transform, x, y);\n  }\n\n  /**\n   * Composed action handler to either scale X or skew Y\n   * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   */\n  function scalingXOrSkewingY(eventData, transform, x, y) {\n    // ok some safety needed here.\n    if (eventData[transform.target.canvas.altActionKey]) {\n      return controls.skewHandlerY(eventData, transform, x, y);\n    }\n    return controls.scalingX(eventData, transform, x, y);\n  }\n\n  /**\n   * Action handler to change textbox width\n   * Needs to be wrapped with `wrapWithFixedAnchor` to be effective\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if some change happened\n   */\n  function changeWidth(eventData, transform, x, y) {\n    var target = transform.target, localPoint = getLocalPoint(transform, transform.originX, transform.originY, x, y),\n        strokePadding = target.strokeWidth / (target.strokeUniform ? target.scaleX : 1),\n        multiplier = isTransformCentered(transform) ? 2 : 1,\n        oldWidth = target.width,\n        newWidth = Math.abs(localPoint.x * multiplier / target.scaleX) - strokePadding;\n    target.set('width', Math.max(newWidth, 0));\n    return oldWidth !== newWidth;\n  }\n\n  /**\n   * Action handler\n   * @private\n   * @param {Event} eventData javascript event that is doing the transform\n   * @param {Object} transform javascript object containing a series of information around the current transform\n   * @param {number} x current mouse x position, canvas normalized\n   * @param {number} y current mouse y position, canvas normalized\n   * @return {Boolean} true if the translation occurred\n   */\n  function dragHandler(eventData, transform, x, y) {\n    var target = transform.target,\n        newLeft = x - transform.offsetX,\n        newTop = y - transform.offsetY,\n        moveX = !target.get('lockMovementX') && target.left !== newLeft,\n        moveY = !target.get('lockMovementY') && target.top !== newTop;\n    moveX && target.set('left', newLeft);\n    moveY && target.set('top', newTop);\n    if (moveX || moveY) {\n      fireEvent('moving', commonEventInfo(eventData, transform, x, y));\n    }\n    return moveX || moveY;\n  }\n\n  controls.scaleCursorStyleHandler = scaleCursorStyleHandler;\n  controls.skewCursorStyleHandler = skewCursorStyleHandler;\n  controls.scaleSkewCursorStyleHandler = scaleSkewCursorStyleHandler;\n  controls.rotationWithSnapping = wrapWithFireEvent('rotating', wrapWithFixedAnchor(rotationWithSnapping));\n  controls.scalingEqually = wrapWithFireEvent('scaling', wrapWithFixedAnchor( scaleObjectFromCorner));\n  controls.scalingX = wrapWithFireEvent('scaling', wrapWithFixedAnchor(scaleObjectX));\n  controls.scalingY = wrapWithFireEvent('scaling', wrapWithFixedAnchor(scaleObjectY));\n  controls.scalingYOrSkewingX = scalingYOrSkewingX;\n  controls.scalingXOrSkewingY = scalingXOrSkewingY;\n  controls.changeWidth = wrapWithFireEvent('resizing', wrapWithFixedAnchor(changeWidth));\n  controls.skewHandlerX = skewHandlerX;\n  controls.skewHandlerY = skewHandlerY;\n  controls.dragHandler = dragHandler;\n  controls.scaleOrSkewActionName = scaleOrSkewActionName;\n  controls.rotationStyleHandler = rotationStyleHandler;\n  controls.fireEvent = fireEvent;\n  controls.wrapWithFixedAnchor = wrapWithFixedAnchor;\n  controls.wrapWithFireEvent = wrapWithFireEvent;\n  controls.getLocalPoint = getLocalPoint;\n  fabric.controlsUtils = controls;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      degreesToRadians = fabric.util.degreesToRadians,\n      controls = fabric.controlsUtils;\n\n  /**\n   * Render a round control, as per fabric features.\n   * This function is written to respect object properties like transparentCorners, cornerSize\n   * cornerColor, cornerStrokeColor\n   * plus the addition of offsetY and offsetX.\n   * @param {CanvasRenderingContext2D} ctx context to render on\n   * @param {Number} left x coordinate where the control center should be\n   * @param {Number} top y coordinate where the control center should be\n   * @param {Object} styleOverride override for fabric.Object controls style\n   * @param {fabric.Object} fabricObject the fabric object for which we are rendering controls\n   */\n  function renderCircleControl (ctx, left, top, styleOverride, fabricObject) {\n    styleOverride = styleOverride || {};\n    var xSize = this.sizeX || styleOverride.cornerSize || fabricObject.cornerSize,\n        ySize = this.sizeY || styleOverride.cornerSize || fabricObject.cornerSize,\n        transparentCorners = typeof styleOverride.transparentCorners !== 'undefined' ?\n          styleOverride.transparentCorners : fabricObject.transparentCorners,\n        methodName = transparentCorners ? 'stroke' : 'fill',\n        stroke = !transparentCorners && (styleOverride.cornerStrokeColor || fabricObject.cornerStrokeColor),\n        myLeft = left,\n        myTop = top, size;\n    ctx.save();\n    ctx.fillStyle = styleOverride.cornerColor || fabricObject.cornerColor;\n    ctx.strokeStyle = styleOverride.cornerStrokeColor || fabricObject.cornerStrokeColor;\n    // as soon as fabric react v5, remove ie11, use proper ellipse code.\n    if (xSize > ySize) {\n      size = xSize;\n      ctx.scale(1.0, ySize / xSize);\n      myTop = top * xSize / ySize;\n    }\n    else if (ySize > xSize) {\n      size = ySize;\n      ctx.scale(xSize / ySize, 1.0);\n      myLeft = left * ySize / xSize;\n    }\n    else {\n      size = xSize;\n    }\n    // this is still wrong\n    ctx.lineWidth = 1;\n    ctx.beginPath();\n    ctx.arc(myLeft, myTop, size / 2, 0, 2 * Math.PI, false);\n    ctx[methodName]();\n    if (stroke) {\n      ctx.stroke();\n    }\n    ctx.restore();\n  }\n\n  /**\n   * Render a square control, as per fabric features.\n   * This function is written to respect object properties like transparentCorners, cornerSize\n   * cornerColor, cornerStrokeColor\n   * plus the addition of offsetY and offsetX.\n   * @param {CanvasRenderingContext2D} ctx context to render on\n   * @param {Number} left x coordinate where the control center should be\n   * @param {Number} top y coordinate where the control center should be\n   * @param {Object} styleOverride override for fabric.Object controls style\n   * @param {fabric.Object} fabricObject the fabric object for which we are rendering controls\n   */\n  function renderSquareControl(ctx, left, top, styleOverride, fabricObject) {\n    styleOverride = styleOverride || {};\n    var xSize = this.sizeX || styleOverride.cornerSize || fabricObject.cornerSize,\n        ySize = this.sizeY || styleOverride.cornerSize || fabricObject.cornerSize,\n        transparentCorners = typeof styleOverride.transparentCorners !== 'undefined' ?\n          styleOverride.transparentCorners : fabricObject.transparentCorners,\n        methodName = transparentCorners ? 'stroke' : 'fill',\n        stroke = !transparentCorners && (\n          styleOverride.cornerStrokeColor || fabricObject.cornerStrokeColor\n        ), xSizeBy2 = xSize / 2, ySizeBy2 = ySize / 2;\n    ctx.save();\n    ctx.fillStyle = styleOverride.cornerColor || fabricObject.cornerColor;\n    ctx.strokeStyle = styleOverride.cornerStrokeColor || fabricObject.cornerStrokeColor;\n    // this is still wrong\n    ctx.lineWidth = 1;\n    ctx.translate(left, top);\n    ctx.rotate(degreesToRadians(fabricObject.angle));\n    // this does not work, and fixed with ( && ) does not make sense.\n    // to have real transparent corners we need the controls on upperCanvas\n    // transparentCorners || ctx.clearRect(-xSizeBy2, -ySizeBy2, xSize, ySize);\n    ctx[methodName + 'Rect'](-xSizeBy2, -ySizeBy2, xSize, ySize);\n    if (stroke) {\n      ctx.strokeRect(-xSizeBy2, -ySizeBy2, xSize, ySize);\n    }\n    ctx.restore();\n  }\n\n  controls.renderCircleControl = renderCircleControl;\n  controls.renderSquareControl = renderSquareControl;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { });\n\n  function Control(options) {\n    for (var i in options) {\n      this[i] = options[i];\n    }\n  }\n\n  fabric.Control = Control;\n\n  fabric.Control.prototype = /** @lends fabric.Control.prototype */ {\n\n    /**\n     * keep track of control visibility.\n     * mainly for backward compatibility.\n     * if you do not want to see a control, you can remove it\n     * from the controlset.\n     * @type {Boolean}\n     * @default true\n     */\n    visible: true,\n\n    /**\n     * Name of the action that the control will likely execute.\n     * This is optional. FabricJS uses to identify what the user is doing for some\n     * extra optimizations. If you are writing a custom control and you want to know\n     * somewhere else in the code what is going on, you can use this string here.\n     * you can also provide a custom getActionName if your control run multiple actions\n     * depending on some external state.\n     * default to scale since is the most common, used on 4 corners by default\n     * @type {String}\n     * @default 'scale'\n     */\n    actionName: 'scale',\n\n    /**\n     * Drawing angle of the control.\n     * NOT used for now, but name marked as needed for internal logic\n     * example: to reuse the same drawing function for different rotated controls\n     * @type {Number}\n     * @default 0\n     */\n    angle: 0,\n\n    /**\n     * Relative position of the control. X\n     * 0,0 is the center of the Object, while -0.5 (left) or 0.5 (right) are the extremities\n     * of the bounding box.\n     * @type {Number}\n     * @default 0\n     */\n    x: 0,\n\n    /**\n     * Relative position of the control. Y\n     * 0,0 is the center of the Object, while -0.5 (top) or 0.5 (bottom) are the extremities\n     * of the bounding box.\n     * @type {Number}\n     * @default 0\n     */\n    y: 0,\n\n    /**\n     * Horizontal offset of the control from the defined position. In pixels\n     * Positive offset moves the control to the right, negative to the left.\n     * It used when you want to have position of control that does not scale with\n     * the bounding box. Example: rotation control is placed at x:0, y: 0.5 on\n     * the boundindbox, with an offset of 30 pixels vertically. Those 30 pixels will\n     * stay 30 pixels no matter how the object is big. Another example is having 2\n     * controls in the corner, that stay in the same position when the object scale.\n     * of the bounding box.\n     * @type {Number}\n     * @default 0\n     */\n    offsetX: 0,\n\n    /**\n     * Vertical offset of the control from the defined position. In pixels\n     * Positive offset moves the control to the bottom, negative to the top.\n     * @type {Number}\n     * @default 0\n     */\n    offsetY: 0,\n\n    /**\n     * Sets the length of the control. If null, defaults to object's cornerSize.\n     * Expects both sizeX and sizeY to be set when set.\n     * @type {?Number}\n     * @default null\n     */\n    sizeX: null,\n\n    /**\n     * Sets the height of the control. If null, defaults to object's cornerSize.\n     * Expects both sizeX and sizeY to be set when set.\n     * @type {?Number}\n     * @default null\n     */\n    sizeY: null,\n\n    /**\n     * Sets the length of the touch area of the control. If null, defaults to object's touchCornerSize.\n     * Expects both touchSizeX and touchSizeY to be set when set.\n     * @type {?Number}\n     * @default null\n     */\n    touchSizeX: null,\n\n    /**\n     * Sets the height of the touch area of the control. If null, defaults to object's touchCornerSize.\n     * Expects both touchSizeX and touchSizeY to be set when set.\n     * @type {?Number}\n     * @default null\n     */\n    touchSizeY: null,\n\n    /**\n     * Css cursor style to display when the control is hovered.\n     * if the method `cursorStyleHandler` is provided, this property is ignored.\n     * @type {String}\n     * @default 'crosshair'\n     */\n    cursorStyle: 'crosshair',\n\n    /**\n     * If controls has an offsetY or offsetX, draw a line that connects\n     * the control to the bounding box\n     * @type {Boolean}\n     * @default false\n     */\n    withConnection: false,\n\n    /**\n     * The control actionHandler, provide one to handle action ( control being moved )\n     * @param {Event} eventData the native mouse event\n     * @param {Object} transformData properties of the current transform\n     * @param {Number} x x position of the cursor\n     * @param {Number} y y position of the cursor\n     * @return {Boolean} true if the action/event modified the object\n     */\n    actionHandler: function(/* eventData, transformData, x, y */) { },\n\n    /**\n     * The control handler for mouse down, provide one to handle mouse down on control\n     * @param {Event} eventData the native mouse event\n     * @param {Object} transformData properties of the current transform\n     * @param {Number} x x position of the cursor\n     * @param {Number} y y position of the cursor\n     * @return {Boolean} true if the action/event modified the object\n     */\n    mouseDownHandler: function(/* eventData, transformData, x, y */) { },\n\n    /**\n     * The control mouseUpHandler, provide one to handle an effect on mouse up.\n     * @param {Event} eventData the native mouse event\n     * @param {Object} transformData properties of the current transform\n     * @param {Number} x x position of the cursor\n     * @param {Number} y y position of the cursor\n     * @return {Boolean} true if the action/event modified the object\n     */\n    mouseUpHandler: function(/* eventData, transformData, x, y */) { },\n\n    /**\n     * Returns control actionHandler\n     * @param {Event} eventData the native mouse event\n     * @param {fabric.Object} fabricObject on which the control is displayed\n     * @param {fabric.Control} control control for which the action handler is being asked\n     * @return {Function} the action handler\n     */\n    getActionHandler: function(/* eventData, fabricObject, control */) {\n      return this.actionHandler;\n    },\n\n    /**\n     * Returns control mouseDown handler\n     * @param {Event} eventData the native mouse event\n     * @param {fabric.Object} fabricObject on which the control is displayed\n     * @param {fabric.Control} control control for which the action handler is being asked\n     * @return {Function} the action handler\n     */\n    getMouseDownHandler: function(/* eventData, fabricObject, control */) {\n      return this.mouseDownHandler;\n    },\n\n    /**\n     * Returns control mouseUp handler\n     * @param {Event} eventData the native mouse event\n     * @param {fabric.Object} fabricObject on which the control is displayed\n     * @param {fabric.Control} control control for which the action handler is being asked\n     * @return {Function} the action handler\n     */\n    getMouseUpHandler: function(/* eventData, fabricObject, control */) {\n      return this.mouseUpHandler;\n    },\n\n    /**\n     * Returns control cursorStyle for css using cursorStyle. If you need a more elaborate\n     * function you can pass one in the constructor\n     * the cursorStyle property\n     * @param {Event} eventData the native mouse event\n     * @param {fabric.Control} control the current control ( likely this)\n     * @param {fabric.Object} object on which the control is displayed\n     * @return {String}\n     */\n    cursorStyleHandler: function(eventData, control /* fabricObject */) {\n      return control.cursorStyle;\n    },\n\n    /**\n     * Returns the action name. The basic implementation just return the actionName property.\n     * @param {Event} eventData the native mouse event\n     * @param {fabric.Control} control the current control ( likely this)\n     * @param {fabric.Object} object on which the control is displayed\n     * @return {String}\n     */\n    getActionName: function(eventData, control /* fabricObject */) {\n      return control.actionName;\n    },\n\n    /**\n     * Returns controls visibility\n     * @param {fabric.Object} object on which the control is displayed\n     * @param {String} controlKey key where the control is memorized on the\n     * @return {Boolean}\n     */\n    getVisibility: function(fabricObject, controlKey) {\n      var objectVisibility = fabricObject._controlsVisibility;\n      if (objectVisibility && typeof objectVisibility[controlKey] !== 'undefined') {\n        return objectVisibility[controlKey];\n      }\n      return this.visible;\n    },\n\n    /**\n     * Sets controls visibility\n     * @param {Boolean} visibility for the object\n     * @return {Void}\n     */\n    setVisibility: function(visibility /* name, fabricObject */) {\n      this.visible = visibility;\n    },\n\n\n    positionHandler: function(dim, finalMatrix /*, fabricObject, currentControl */) {\n      var point = fabric.util.transformPoint({\n        x: this.x * dim.x + this.offsetX,\n        y: this.y * dim.y + this.offsetY }, finalMatrix);\n      return point;\n    },\n\n    /**\n     * Returns the coords for this control based on object values.\n     * @param {Number} objectAngle angle from the fabric object holding the control\n     * @param {Number} objectCornerSize cornerSize from the fabric object holding the control (or touchCornerSize if\n     *   isTouch is true)\n     * @param {Number} centerX x coordinate where the control center should be\n     * @param {Number} centerY y coordinate where the control center should be\n     * @param {boolean} isTouch true if touch corner, false if normal corner\n     */\n    calcCornerCoords: function(objectAngle, objectCornerSize, centerX, centerY, isTouch) {\n      var cosHalfOffset,\n          sinHalfOffset,\n          cosHalfOffsetComp,\n          sinHalfOffsetComp,\n          xSize = (isTouch) ? this.touchSizeX : this.sizeX,\n          ySize = (isTouch) ? this.touchSizeY : this.sizeY;\n      if (xSize && ySize && xSize !== ySize) {\n        // handle rectangular corners\n        var controlTriangleAngle = Math.atan2(ySize, xSize);\n        var cornerHypotenuse = Math.sqrt(xSize * xSize + ySize * ySize) / 2;\n        var newTheta = controlTriangleAngle - fabric.util.degreesToRadians(objectAngle);\n        var newThetaComp = Math.PI / 2 - controlTriangleAngle - fabric.util.degreesToRadians(objectAngle);\n        cosHalfOffset = cornerHypotenuse * fabric.util.cos(newTheta);\n        sinHalfOffset = cornerHypotenuse * fabric.util.sin(newTheta);\n        // use complementary angle for two corners\n        cosHalfOffsetComp = cornerHypotenuse * fabric.util.cos(newThetaComp);\n        sinHalfOffsetComp = cornerHypotenuse * fabric.util.sin(newThetaComp);\n      }\n      else {\n        // handle square corners\n        // use default object corner size unless size is defined\n        var cornerSize = (xSize && ySize) ? xSize : objectCornerSize;\n        /* 0.7071067812 stands for sqrt(2)/2 */\n        cornerHypotenuse = cornerSize * 0.7071067812;\n        // complementary angles are equal since they're both 45 degrees\n        var newTheta = fabric.util.degreesToRadians(45 - objectAngle);\n        cosHalfOffset = cosHalfOffsetComp = cornerHypotenuse * fabric.util.cos(newTheta);\n        sinHalfOffset = sinHalfOffsetComp = cornerHypotenuse * fabric.util.sin(newTheta);\n      }\n\n      return {\n        tl: {\n          x: centerX - sinHalfOffsetComp,\n          y: centerY - cosHalfOffsetComp,\n        },\n        tr: {\n          x: centerX + cosHalfOffset,\n          y: centerY - sinHalfOffset,\n        },\n        bl: {\n          x: centerX - cosHalfOffset,\n          y: centerY + sinHalfOffset,\n        },\n        br: {\n          x: centerX + sinHalfOffsetComp,\n          y: centerY + cosHalfOffsetComp,\n        },\n      };\n    },\n\n    /**\n    * Render function for the control.\n    * When this function runs the context is unscaled. unrotate. Just retina scaled.\n    * all the functions will have to translate to the point left,top before starting Drawing\n    * if they want to draw a control where the position is detected.\n    * left and top are the result of the positionHandler function\n    * @param {RenderingContext2D} ctx the context where the control will be drawn\n    * @param {Number} left position of the canvas where we are about to render the control.\n    * @param {Number} top position of the canvas where we are about to render the control.\n    * @param {Object} styleOverride\n    * @param {fabric.Object} fabricObject the object where the control is about to be rendered\n    */\n    render: function(ctx, left, top, styleOverride, fabricObject) {\n      styleOverride = styleOverride || {};\n      switch (styleOverride.cornerStyle || fabricObject.cornerStyle) {\n        case 'circle':\n          fabric.controlsUtils.renderCircleControl.call(this, ctx, left, top, styleOverride, fabricObject);\n          break;\n        default:\n          fabric.controlsUtils.renderSquareControl.call(this, ctx, left, top, styleOverride, fabricObject);\n      }\n    },\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function() {\n\n  /* _FROM_SVG_START_ */\n  function getColorStop(el, multiplier) {\n    var style = el.getAttribute('style'),\n        offset = el.getAttribute('offset') || 0,\n        color, colorAlpha, opacity, i;\n\n    // convert percents to absolute values\n    offset = parseFloat(offset) / (/%$/.test(offset) ? 100 : 1);\n    offset = offset < 0 ? 0 : offset > 1 ? 1 : offset;\n    if (style) {\n      var keyValuePairs = style.split(/\\s*;\\s*/);\n\n      if (keyValuePairs[keyValuePairs.length - 1] === '') {\n        keyValuePairs.pop();\n      }\n\n      for (i = keyValuePairs.length; i--; ) {\n\n        var split = keyValuePairs[i].split(/\\s*:\\s*/),\n            key = split[0].trim(),\n            value = split[1].trim();\n\n        if (key === 'stop-color') {\n          color = value;\n        }\n        else if (key === 'stop-opacity') {\n          opacity = value;\n        }\n      }\n    }\n\n    if (!color) {\n      color = el.getAttribute('stop-color') || 'rgb(0,0,0)';\n    }\n    if (!opacity) {\n      opacity = el.getAttribute('stop-opacity');\n    }\n\n    color = new fabric.Color(color);\n    colorAlpha = color.getAlpha();\n    opacity = isNaN(parseFloat(opacity)) ? 1 : parseFloat(opacity);\n    opacity *= colorAlpha * multiplier;\n\n    return {\n      offset: offset,\n      color: color.toRgb(),\n      opacity: opacity\n    };\n  }\n\n  function getLinearCoords(el) {\n    return {\n      x1: el.getAttribute('x1') || 0,\n      y1: el.getAttribute('y1') || 0,\n      x2: el.getAttribute('x2') || '100%',\n      y2: el.getAttribute('y2') || 0\n    };\n  }\n\n  function getRadialCoords(el) {\n    return {\n      x1: el.getAttribute('fx') || el.getAttribute('cx') || '50%',\n      y1: el.getAttribute('fy') || el.getAttribute('cy') || '50%',\n      r1: 0,\n      x2: el.getAttribute('cx') || '50%',\n      y2: el.getAttribute('cy') || '50%',\n      r2: el.getAttribute('r') || '50%'\n    };\n  }\n  /* _FROM_SVG_END_ */\n\n  var clone = fabric.util.object.clone;\n\n  /**\n   * Gradient class\n   * @class fabric.Gradient\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#gradients}\n   * @see {@link fabric.Gradient#initialize} for constructor definition\n   */\n  fabric.Gradient = fabric.util.createClass(/** @lends fabric.Gradient.prototype */ {\n\n    /**\n     * Horizontal offset for aligning gradients coming from SVG when outside pathgroups\n     * @type Number\n     * @default 0\n     */\n    offsetX: 0,\n\n    /**\n     * Vertical offset for aligning gradients coming from SVG when outside pathgroups\n     * @type Number\n     * @default 0\n     */\n    offsetY: 0,\n\n    /**\n     * A transform matrix to apply to the gradient before painting.\n     * Imported from svg gradients, is not applied with the current transform in the center.\n     * Before this transform is applied, the origin point is at the top left corner of the object\n     * plus the addition of offsetY and offsetX.\n     * @type Number[]\n     * @default null\n     */\n    gradientTransform: null,\n\n    /**\n     * coordinates units for coords.\n     * If `pixels`, the number of coords are in the same unit of width / height.\n     * If set as `percentage` the coords are still a number, but 1 means 100% of width\n     * for the X and 100% of the height for the y. It can be bigger than 1 and negative.\n     * allowed values pixels or percentage.\n     * @type String\n     * @default 'pixels'\n     */\n    gradientUnits: 'pixels',\n\n    /**\n     * Gradient type linear or radial\n     * @type String\n     * @default 'pixels'\n     */\n    type: 'linear',\n\n    /**\n     * Constructor\n     * @param {Object} options Options object with type, coords, gradientUnits and colorStops\n     * @param {Object} [options.type] gradient type linear or radial\n     * @param {Object} [options.gradientUnits] gradient units\n     * @param {Object} [options.offsetX] SVG import compatibility\n     * @param {Object} [options.offsetY] SVG import compatibility\n     * @param {Object[]} options.colorStops contains the colorstops.\n     * @param {Object} options.coords contains the coords of the gradient\n     * @param {Number} [options.coords.x1] X coordiante of the first point for linear or of the focal point for radial\n     * @param {Number} [options.coords.y1] Y coordiante of the first point for linear or of the focal point for radial\n     * @param {Number} [options.coords.x2] X coordiante of the second point for linear or of the center point for radial\n     * @param {Number} [options.coords.y2] Y coordiante of the second point for linear or of the center point for radial\n     * @param {Number} [options.coords.r1] only for radial gradient, radius of the inner circle\n     * @param {Number} [options.coords.r2] only for radial gradient, radius of the external circle\n     * @return {fabric.Gradient} thisArg\n     */\n    initialize: function(options) {\n      options || (options = { });\n      options.coords || (options.coords = { });\n\n      var coords, _this = this;\n\n      // sets everything, then coords and colorstops get sets again\n      Object.keys(options).forEach(function(option) {\n        _this[option] = options[option];\n      });\n\n      if (this.id) {\n        this.id += '_' + fabric.Object.__uid++;\n      }\n      else {\n        this.id = fabric.Object.__uid++;\n      }\n\n      coords = {\n        x1: options.coords.x1 || 0,\n        y1: options.coords.y1 || 0,\n        x2: options.coords.x2 || 0,\n        y2: options.coords.y2 || 0\n      };\n\n      if (this.type === 'radial') {\n        coords.r1 = options.coords.r1 || 0;\n        coords.r2 = options.coords.r2 || 0;\n      }\n\n      this.coords = coords;\n      this.colorStops = options.colorStops.slice();\n    },\n\n    /**\n     * Adds another colorStop\n     * @param {Object} colorStop Object with offset and color\n     * @return {fabric.Gradient} thisArg\n     */\n    addColorStop: function(colorStops) {\n      for (var position in colorStops) {\n        var color = new fabric.Color(colorStops[position]);\n        this.colorStops.push({\n          offset: parseFloat(position),\n          color: color.toRgb(),\n          opacity: color.getAlpha()\n        });\n      }\n      return this;\n    },\n\n    /**\n     * Returns object representation of a gradient\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object}\n     */\n    toObject: function(propertiesToInclude) {\n      var object = {\n        type: this.type,\n        coords: this.coords,\n        colorStops: this.colorStops,\n        offsetX: this.offsetX,\n        offsetY: this.offsetY,\n        gradientUnits: this.gradientUnits,\n        gradientTransform: this.gradientTransform ? this.gradientTransform.concat() : this.gradientTransform\n      };\n      fabric.util.populateWithProperties(this, object, propertiesToInclude);\n\n      return object;\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns SVG representation of an gradient\n     * @param {Object} object Object to create a gradient for\n     * @return {String} SVG representation of an gradient (linear/radial)\n     */\n    toSVG: function(object, options) {\n      var coords = clone(this.coords, true), i, len, options = options || {},\n          markup, commonAttributes, colorStops = clone(this.colorStops, true),\n          needsSwap = coords.r1 > coords.r2,\n          transform = this.gradientTransform ? this.gradientTransform.concat() : fabric.iMatrix.concat(),\n          offsetX = -this.offsetX, offsetY = -this.offsetY,\n          withViewport = !!options.additionalTransform,\n          gradientUnits = this.gradientUnits === 'pixels' ? 'userSpaceOnUse' : 'objectBoundingBox';\n      // colorStops must be sorted ascending\n      colorStops.sort(function(a, b) {\n        return a.offset - b.offset;\n      });\n\n      if (gradientUnits === 'objectBoundingBox') {\n        offsetX /= object.width;\n        offsetY /= object.height;\n      }\n      else {\n        offsetX += object.width / 2;\n        offsetY += object.height / 2;\n      }\n      if (object.type === 'path' && this.gradientUnits !== 'percentage') {\n        offsetX -= object.pathOffset.x;\n        offsetY -= object.pathOffset.y;\n      }\n\n\n      transform[4] -= offsetX;\n      transform[5] -= offsetY;\n\n      commonAttributes = 'id=\"SVGID_' + this.id +\n                     '\" gradientUnits=\"' + gradientUnits + '\"';\n      commonAttributes += ' gradientTransform=\"' + (withViewport ?\n        options.additionalTransform + ' ' : '') + fabric.util.matrixToSVG(transform) + '\" ';\n\n      if (this.type === 'linear') {\n        markup = [\n          '<linearGradient ',\n          commonAttributes,\n          ' x1=\"', coords.x1,\n          '\" y1=\"', coords.y1,\n          '\" x2=\"', coords.x2,\n          '\" y2=\"', coords.y2,\n          '\">\\n'\n        ];\n      }\n      else if (this.type === 'radial') {\n        // svg radial gradient has just 1 radius. the biggest.\n        markup = [\n          '<radialGradient ',\n          commonAttributes,\n          ' cx=\"', needsSwap ? coords.x1 : coords.x2,\n          '\" cy=\"', needsSwap ? coords.y1 : coords.y2,\n          '\" r=\"', needsSwap ? coords.r1 : coords.r2,\n          '\" fx=\"', needsSwap ? coords.x2 : coords.x1,\n          '\" fy=\"', needsSwap ? coords.y2 : coords.y1,\n          '\">\\n'\n        ];\n      }\n\n      if (this.type === 'radial') {\n        if (needsSwap) {\n          // svg goes from internal to external radius. if radius are inverted, swap color stops.\n          colorStops = colorStops.concat();\n          colorStops.reverse();\n          for (i = 0, len = colorStops.length; i < len; i++) {\n            colorStops[i].offset = 1 - colorStops[i].offset;\n          }\n        }\n        var minRadius = Math.min(coords.r1, coords.r2);\n        if (minRadius > 0) {\n          // i have to shift all colorStops and add new one in 0.\n          var maxRadius = Math.max(coords.r1, coords.r2),\n              percentageShift = minRadius / maxRadius;\n          for (i = 0, len = colorStops.length; i < len; i++) {\n            colorStops[i].offset += percentageShift * (1 - colorStops[i].offset);\n          }\n        }\n      }\n\n      for (i = 0, len = colorStops.length; i < len; i++) {\n        var colorStop = colorStops[i];\n        markup.push(\n          '<stop ',\n          'offset=\"', (colorStop.offset * 100) + '%',\n          '\" style=\"stop-color:', colorStop.color,\n          (typeof colorStop.opacity !== 'undefined' ? ';stop-opacity: ' + colorStop.opacity : ';'),\n          '\"/>\\n'\n        );\n      }\n\n      markup.push((this.type === 'linear' ? '</linearGradient>\\n' : '</radialGradient>\\n'));\n\n      return markup.join('');\n    },\n    /* _TO_SVG_END_ */\n\n    /**\n     * Returns an instance of CanvasGradient\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @return {CanvasGradient}\n     */\n    toLive: function(ctx) {\n      var gradient, coords = fabric.util.object.clone(this.coords), i, len;\n\n      if (!this.type) {\n        return;\n      }\n\n      if (this.type === 'linear') {\n        gradient = ctx.createLinearGradient(\n          coords.x1, coords.y1, coords.x2, coords.y2);\n      }\n      else if (this.type === 'radial') {\n        gradient = ctx.createRadialGradient(\n          coords.x1, coords.y1, coords.r1, coords.x2, coords.y2, coords.r2);\n      }\n\n      for (i = 0, len = this.colorStops.length; i < len; i++) {\n        var color = this.colorStops[i].color,\n            opacity = this.colorStops[i].opacity,\n            offset = this.colorStops[i].offset;\n\n        if (typeof opacity !== 'undefined') {\n          color = new fabric.Color(color).setAlpha(opacity).toRgba();\n        }\n        gradient.addColorStop(offset, color);\n      }\n\n      return gradient;\n    }\n  });\n\n  fabric.util.object.extend(fabric.Gradient, {\n\n    /* _FROM_SVG_START_ */\n    /**\n     * Returns {@link fabric.Gradient} instance from an SVG element\n     * @static\n     * @memberOf fabric.Gradient\n     * @param {SVGGradientElement} el SVG gradient element\n     * @param {fabric.Object} instance\n     * @param {String} opacityAttr A fill-opacity or stroke-opacity attribute to multiply to each stop's opacity.\n     * @param {Object} svgOptions an object containing the size of the SVG in order to parse correctly gradients\n     * that uses gradientUnits as 'userSpaceOnUse' and percentages.\n     * @param {Object.number} viewBoxWidth width part of the viewBox attribute on svg\n     * @param {Object.number} viewBoxHeight height part of the viewBox attribute on svg\n     * @param {Object.number} width width part of the svg tag if viewBox is not specified\n     * @param {Object.number} height height part of the svg tag if viewBox is not specified\n     * @return {fabric.Gradient} Gradient instance\n     * @see http://www.w3.org/TR/SVG/pservers.html#LinearGradientElement\n     * @see http://www.w3.org/TR/SVG/pservers.html#RadialGradientElement\n     */\n    fromElement: function(el, instance, opacityAttr, svgOptions) {\n      /**\n       *  @example:\n       *\n       *  <linearGradient id=\"linearGrad1\">\n       *    <stop offset=\"0%\" stop-color=\"white\"/>\n       *    <stop offset=\"100%\" stop-color=\"black\"/>\n       *  </linearGradient>\n       *\n       *  OR\n       *\n       *  <linearGradient id=\"linearGrad2\">\n       *    <stop offset=\"0\" style=\"stop-color:rgb(255,255,255)\"/>\n       *    <stop offset=\"1\" style=\"stop-color:rgb(0,0,0)\"/>\n       *  </linearGradient>\n       *\n       *  OR\n       *\n       *  <radialGradient id=\"radialGrad1\">\n       *    <stop offset=\"0%\" stop-color=\"white\" stop-opacity=\"1\" />\n       *    <stop offset=\"50%\" stop-color=\"black\" stop-opacity=\"0.5\" />\n       *    <stop offset=\"100%\" stop-color=\"white\" stop-opacity=\"1\" />\n       *  </radialGradient>\n       *\n       *  OR\n       *\n       *  <radialGradient id=\"radialGrad2\">\n       *    <stop offset=\"0\" stop-color=\"rgb(255,255,255)\" />\n       *    <stop offset=\"0.5\" stop-color=\"rgb(0,0,0)\" />\n       *    <stop offset=\"1\" stop-color=\"rgb(255,255,255)\" />\n       *  </radialGradient>\n       *\n       */\n\n      var multiplier = parseFloat(opacityAttr) / (/%$/.test(opacityAttr) ? 100 : 1);\n      multiplier = multiplier < 0 ? 0 : multiplier > 1 ? 1 : multiplier;\n      if (isNaN(multiplier)) {\n        multiplier = 1;\n      }\n\n      var colorStopEls = el.getElementsByTagName('stop'),\n          type,\n          gradientUnits = el.getAttribute('gradientUnits') === 'userSpaceOnUse' ?\n            'pixels' : 'percentage',\n          gradientTransform = el.getAttribute('gradientTransform') || '',\n          colorStops = [],\n          coords, i, offsetX = 0, offsetY = 0,\n          transformMatrix;\n      if (el.nodeName === 'linearGradient' || el.nodeName === 'LINEARGRADIENT') {\n        type = 'linear';\n        coords = getLinearCoords(el);\n      }\n      else {\n        type = 'radial';\n        coords = getRadialCoords(el);\n      }\n\n      for (i = colorStopEls.length; i--; ) {\n        colorStops.push(getColorStop(colorStopEls[i], multiplier));\n      }\n\n      transformMatrix = fabric.parseTransformAttribute(gradientTransform);\n\n      __convertPercentUnitsToValues(instance, coords, svgOptions, gradientUnits);\n\n      if (gradientUnits === 'pixels') {\n        offsetX = -instance.left;\n        offsetY = -instance.top;\n      }\n\n      var gradient = new fabric.Gradient({\n        id: el.getAttribute('id'),\n        type: type,\n        coords: coords,\n        colorStops: colorStops,\n        gradientUnits: gradientUnits,\n        gradientTransform: transformMatrix,\n        offsetX: offsetX,\n        offsetY: offsetY,\n      });\n\n      return gradient;\n    }\n    /* _FROM_SVG_END_ */\n  });\n\n  /**\n   * @private\n   */\n  function __convertPercentUnitsToValues(instance, options, svgOptions, gradientUnits) {\n    var propValue, finalValue;\n    Object.keys(options).forEach(function(prop) {\n      propValue = options[prop];\n      if (propValue === 'Infinity') {\n        finalValue = 1;\n      }\n      else if (propValue === '-Infinity') {\n        finalValue = 0;\n      }\n      else {\n        finalValue = parseFloat(options[prop], 10);\n        if (typeof propValue === 'string' && /^(\\d+\\.\\d+)%|(\\d+)%$/.test(propValue)) {\n          finalValue *= 0.01;\n          if (gradientUnits === 'pixels') {\n            // then we need to fix those percentages here in svg parsing\n            if (prop === 'x1' || prop === 'x2' || prop === 'r2') {\n              finalValue *= svgOptions.viewBoxWidth || svgOptions.width;\n            }\n            if (prop === 'y1' || prop === 'y2') {\n              finalValue *= svgOptions.viewBoxHeight || svgOptions.height;\n            }\n          }\n        }\n      }\n      options[prop] = finalValue;\n    });\n  }\n})();\n\n\n(function() {\n\n  'use strict';\n\n  var toFixed = fabric.util.toFixed;\n\n  /**\n   * Pattern class\n   * @class fabric.Pattern\n   * @see {@link http://fabricjs.com/patterns|Pattern demo}\n   * @see {@link http://fabricjs.com/dynamic-patterns|DynamicPattern demo}\n   * @see {@link fabric.Pattern#initialize} for constructor definition\n   */\n\n\n  fabric.Pattern = fabric.util.createClass(/** @lends fabric.Pattern.prototype */ {\n\n    /**\n     * Repeat property of a pattern (one of repeat, repeat-x, repeat-y or no-repeat)\n     * @type String\n     * @default\n     */\n    repeat: 'repeat',\n\n    /**\n     * Pattern horizontal offset from object's left/top corner\n     * @type Number\n     * @default\n     */\n    offsetX: 0,\n\n    /**\n     * Pattern vertical offset from object's left/top corner\n     * @type Number\n     * @default\n     */\n    offsetY: 0,\n\n    /**\n     * crossOrigin value (one of \"\", \"anonymous\", \"use-credentials\")\n     * @see https://developer.mozilla.org/en-US/docs/HTML/CORS_settings_attributes\n     * @type String\n     * @default\n     */\n    crossOrigin: '',\n\n    /**\n     * transform matrix to change the pattern, imported from svgs.\n     * @type Array\n     * @default\n     */\n    patternTransform: null,\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     * @param {Function} [callback] function to invoke after callback init.\n     * @return {fabric.Pattern} thisArg\n     */\n    initialize: function(options, callback) {\n      options || (options = { });\n\n      this.id = fabric.Object.__uid++;\n      this.setOptions(options);\n      if (!options.source || (options.source && typeof options.source !== 'string')) {\n        callback && callback(this);\n        return;\n      }\n      else {\n        // img src string\n        var _this = this;\n        this.source = fabric.util.createImage();\n        fabric.util.loadImage(options.source, function(img, isError) {\n          _this.source = img;\n          callback && callback(_this, isError);\n        }, null, this.crossOrigin);\n      }\n    },\n\n    /**\n     * Returns object representation of a pattern\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} Object representation of a pattern instance\n     */\n    toObject: function(propertiesToInclude) {\n      var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS,\n          source, object;\n\n      // <img> element\n      if (typeof this.source.src === 'string') {\n        source = this.source.src;\n      }\n      // <canvas> element\n      else if (typeof this.source === 'object' && this.source.toDataURL) {\n        source = this.source.toDataURL();\n      }\n\n      object = {\n        type: 'pattern',\n        source: source,\n        repeat: this.repeat,\n        crossOrigin: this.crossOrigin,\n        offsetX: toFixed(this.offsetX, NUM_FRACTION_DIGITS),\n        offsetY: toFixed(this.offsetY, NUM_FRACTION_DIGITS),\n        patternTransform: this.patternTransform ? this.patternTransform.concat() : null\n      };\n      fabric.util.populateWithProperties(this, object, propertiesToInclude);\n\n      return object;\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns SVG representation of a pattern\n     * @param {fabric.Object} object\n     * @return {String} SVG representation of a pattern\n     */\n    toSVG: function(object) {\n      var patternSource = typeof this.source === 'function' ? this.source() : this.source,\n          patternWidth = patternSource.width / object.width,\n          patternHeight = patternSource.height / object.height,\n          patternOffsetX = this.offsetX / object.width,\n          patternOffsetY = this.offsetY / object.height,\n          patternImgSrc = '';\n      if (this.repeat === 'repeat-x' || this.repeat === 'no-repeat') {\n        patternHeight = 1;\n        if (patternOffsetY) {\n          patternHeight += Math.abs(patternOffsetY);\n        }\n      }\n      if (this.repeat === 'repeat-y' || this.repeat === 'no-repeat') {\n        patternWidth = 1;\n        if (patternOffsetX) {\n          patternWidth += Math.abs(patternOffsetX);\n        }\n\n      }\n      if (patternSource.src) {\n        patternImgSrc = patternSource.src;\n      }\n      else if (patternSource.toDataURL) {\n        patternImgSrc = patternSource.toDataURL();\n      }\n\n      return '<pattern id=\"SVGID_' + this.id +\n                    '\" x=\"' + patternOffsetX +\n                    '\" y=\"' + patternOffsetY +\n                    '\" width=\"' + patternWidth +\n                    '\" height=\"' + patternHeight + '\">\\n' +\n               '<image x=\"0\" y=\"0\"' +\n                      ' width=\"' + patternSource.width +\n                      '\" height=\"' + patternSource.height +\n                      '\" xlink:href=\"' + patternImgSrc +\n               '\"></image>\\n' +\n             '</pattern>\\n';\n    },\n    /* _TO_SVG_END_ */\n\n    setOptions: function(options) {\n      for (var prop in options) {\n        this[prop] = options[prop];\n      }\n    },\n\n    /**\n     * Returns an instance of CanvasPattern\n     * @param {CanvasRenderingContext2D} ctx Context to create pattern\n     * @return {CanvasPattern}\n     */\n    toLive: function(ctx) {\n      var source = this.source;\n      // if the image failed to load, return, and allow rest to continue loading\n      if (!source) {\n        return '';\n      }\n\n      // if an image\n      if (typeof source.src !== 'undefined') {\n        if (!source.complete) {\n          return '';\n        }\n        if (source.naturalWidth === 0 || source.naturalHeight === 0) {\n          return '';\n        }\n      }\n      return ctx.createPattern(source, this.repeat);\n    }\n  });\n})();\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      toFixed = fabric.util.toFixed;\n\n  if (fabric.Shadow) {\n    fabric.warn('fabric.Shadow is already defined.');\n    return;\n  }\n\n  /**\n   * Shadow class\n   * @class fabric.Shadow\n   * @see {@link http://fabricjs.com/shadows|Shadow demo}\n   * @see {@link fabric.Shadow#initialize} for constructor definition\n   */\n  fabric.Shadow = fabric.util.createClass(/** @lends fabric.Shadow.prototype */ {\n\n    /**\n     * Shadow color\n     * @type String\n     * @default\n     */\n    color: 'rgb(0,0,0)',\n\n    /**\n     * Shadow blur\n     * @type Number\n     */\n    blur: 0,\n\n    /**\n     * Shadow horizontal offset\n     * @type Number\n     * @default\n     */\n    offsetX: 0,\n\n    /**\n     * Shadow vertical offset\n     * @type Number\n     * @default\n     */\n    offsetY: 0,\n\n    /**\n     * Whether the shadow should affect stroke operations\n     * @type Boolean\n     * @default\n     */\n    affectStroke: false,\n\n    /**\n     * Indicates whether toObject should include default values\n     * @type Boolean\n     * @default\n     */\n    includeDefaultValues: true,\n\n    /**\n     * When `false`, the shadow will scale with the object.\n     * When `true`, the shadow's offsetX, offsetY, and blur will not be affected by the object's scale.\n     * default to false\n     * @type Boolean\n     * @default\n     */\n    nonScaling: false,\n\n    /**\n     * Constructor\n     * @param {Object|String} [options] Options object with any of color, blur, offsetX, offsetY properties or string (e.g. \"rgba(0,0,0,0.2) 2px 2px 10px\")\n     * @return {fabric.Shadow} thisArg\n     */\n    initialize: function(options) {\n\n      if (typeof options === 'string') {\n        options = this._parseShadow(options);\n      }\n\n      for (var prop in options) {\n        this[prop] = options[prop];\n      }\n\n      this.id = fabric.Object.__uid++;\n    },\n\n    /**\n     * @private\n     * @param {String} shadow Shadow value to parse\n     * @return {Object} Shadow object with color, offsetX, offsetY and blur\n     */\n    _parseShadow: function(shadow) {\n      var shadowStr = shadow.trim(),\n          offsetsAndBlur = fabric.Shadow.reOffsetsAndBlur.exec(shadowStr) || [],\n          color = shadowStr.replace(fabric.Shadow.reOffsetsAndBlur, '') || 'rgb(0,0,0)';\n\n      return {\n        color: color.trim(),\n        offsetX: parseFloat(offsetsAndBlur[1], 10) || 0,\n        offsetY: parseFloat(offsetsAndBlur[2], 10) || 0,\n        blur: parseFloat(offsetsAndBlur[3], 10) || 0\n      };\n    },\n\n    /**\n     * Returns a string representation of an instance\n     * @see http://www.w3.org/TR/css-text-decor-3/#text-shadow\n     * @return {String} Returns CSS3 text-shadow declaration\n     */\n    toString: function() {\n      return [this.offsetX, this.offsetY, this.blur, this.color].join('px ');\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns SVG representation of a shadow\n     * @param {fabric.Object} object\n     * @return {String} SVG representation of a shadow\n     */\n    toSVG: function(object) {\n      var fBoxX = 40, fBoxY = 40, NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS,\n          offset = fabric.util.rotateVector(\n            { x: this.offsetX, y: this.offsetY },\n            fabric.util.degreesToRadians(-object.angle)),\n          BLUR_BOX = 20, color = new fabric.Color(this.color);\n\n      if (object.width && object.height) {\n        //http://www.w3.org/TR/SVG/filters.html#FilterEffectsRegion\n        // we add some extra space to filter box to contain the blur ( 20 )\n        fBoxX = toFixed((Math.abs(offset.x) + this.blur) / object.width, NUM_FRACTION_DIGITS) * 100 + BLUR_BOX;\n        fBoxY = toFixed((Math.abs(offset.y) + this.blur) / object.height, NUM_FRACTION_DIGITS) * 100 + BLUR_BOX;\n      }\n      if (object.flipX) {\n        offset.x *= -1;\n      }\n      if (object.flipY) {\n        offset.y *= -1;\n      }\n\n      return (\n        '<filter id=\"SVGID_' + this.id + '\" y=\"-' + fBoxY + '%\" height=\"' + (100 + 2 * fBoxY) + '%\" ' +\n          'x=\"-' + fBoxX + '%\" width=\"' + (100 + 2 * fBoxX) + '%\" ' + '>\\n' +\n          '\\t<feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"' +\n            toFixed(this.blur ? this.blur / 2 : 0, NUM_FRACTION_DIGITS) + '\"></feGaussianBlur>\\n' +\n          '\\t<feOffset dx=\"' + toFixed(offset.x, NUM_FRACTION_DIGITS) +\n          '\" dy=\"' + toFixed(offset.y, NUM_FRACTION_DIGITS) + '\" result=\"oBlur\" ></feOffset>\\n' +\n          '\\t<feFlood flood-color=\"' + color.toRgb() + '\" flood-opacity=\"' + color.getAlpha() + '\"/>\\n' +\n          '\\t<feComposite in2=\"oBlur\" operator=\"in\" />\\n' +\n          '\\t<feMerge>\\n' +\n            '\\t\\t<feMergeNode></feMergeNode>\\n' +\n            '\\t\\t<feMergeNode in=\"SourceGraphic\"></feMergeNode>\\n' +\n          '\\t</feMerge>\\n' +\n        '</filter>\\n');\n    },\n    /* _TO_SVG_END_ */\n\n    /**\n     * Returns object representation of a shadow\n     * @return {Object} Object representation of a shadow instance\n     */\n    toObject: function() {\n      if (this.includeDefaultValues) {\n        return {\n          color: this.color,\n          blur: this.blur,\n          offsetX: this.offsetX,\n          offsetY: this.offsetY,\n          affectStroke: this.affectStroke,\n          nonScaling: this.nonScaling\n        };\n      }\n      var obj = { }, proto = fabric.Shadow.prototype;\n\n      ['color', 'blur', 'offsetX', 'offsetY', 'affectStroke', 'nonScaling'].forEach(function(prop) {\n        if (this[prop] !== proto[prop]) {\n          obj[prop] = this[prop];\n        }\n      }, this);\n\n      return obj;\n    }\n  });\n\n  /**\n   * Regex matching shadow offsetX, offsetY and blur (ex: \"2px 2px 10px rgba(0,0,0,0.2)\", \"rgb(0,255,0) 2px 2px\")\n   * @static\n   * @field\n   * @memberOf fabric.Shadow\n   */\n  // eslint-disable-next-line max-len\n  fabric.Shadow.reOffsetsAndBlur = /(?:\\s|^)(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?(\\d+(?:\\.\\d*)?(?:px)?)?(?:\\s?|$)(?:$|\\s)/;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function () {\n\n  'use strict';\n\n  if (fabric.StaticCanvas) {\n    fabric.warn('fabric.StaticCanvas is already defined.');\n    return;\n  }\n\n  // aliases for faster resolution\n  var extend = fabric.util.object.extend,\n      getElementOffset = fabric.util.getElementOffset,\n      removeFromArray = fabric.util.removeFromArray,\n      toFixed = fabric.util.toFixed,\n      transformPoint = fabric.util.transformPoint,\n      invertTransform = fabric.util.invertTransform,\n      getNodeCanvas = fabric.util.getNodeCanvas,\n      createCanvasElement = fabric.util.createCanvasElement,\n\n      CANVAS_INIT_ERROR = new Error('Could not initialize `canvas` element');\n\n  /**\n   * Static canvas class\n   * @class fabric.StaticCanvas\n   * @mixes fabric.Collection\n   * @mixes fabric.Observable\n   * @see {@link http://fabricjs.com/static_canvas|StaticCanvas demo}\n   * @see {@link fabric.StaticCanvas#initialize} for constructor definition\n   * @fires before:render\n   * @fires after:render\n   * @fires canvas:cleared\n   * @fires object:added\n   * @fires object:removed\n   */\n  fabric.StaticCanvas = fabric.util.createClass(fabric.CommonMethods, /** @lends fabric.StaticCanvas.prototype */ {\n\n    /**\n     * Constructor\n     * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\n     * @param {Object} [options] Options object\n     * @return {Object} thisArg\n     */\n    initialize: function(el, options) {\n      options || (options = { });\n      this.renderAndResetBound = this.renderAndReset.bind(this);\n      this.requestRenderAllBound = this.requestRenderAll.bind(this);\n      this._initStatic(el, options);\n    },\n\n    /**\n     * Background color of canvas instance.\n     * Should be set via {@link fabric.StaticCanvas#setBackgroundColor}.\n     * @type {(String|fabric.Pattern)}\n     * @default\n     */\n    backgroundColor: '',\n\n    /**\n     * Background image of canvas instance.\n     * since 2.4.0 image caching is active, please when putting an image as background, add to the\n     * canvas property a reference to the canvas it is on. Otherwise the image cannot detect the zoom\n     * vale. As an alternative you can disable image objectCaching\n     * @type fabric.Image\n     * @default\n     */\n    backgroundImage: null,\n\n    /**\n     * Overlay color of canvas instance.\n     * Should be set via {@link fabric.StaticCanvas#setOverlayColor}\n     * @since 1.3.9\n     * @type {(String|fabric.Pattern)}\n     * @default\n     */\n    overlayColor: '',\n\n    /**\n     * Overlay image of canvas instance.\n     * since 2.4.0 image caching is active, please when putting an image as overlay, add to the\n     * canvas property a reference to the canvas it is on. Otherwise the image cannot detect the zoom\n     * vale. As an alternative you can disable image objectCaching\n     * @type fabric.Image\n     * @default\n     */\n    overlayImage: null,\n\n    /**\n     * Indicates whether toObject/toDatalessObject should include default values\n     * if set to false, takes precedence over the object value.\n     * @type Boolean\n     * @default\n     */\n    includeDefaultValues: true,\n\n    /**\n     * Indicates whether objects' state should be saved\n     * @type Boolean\n     * @default\n     */\n    stateful: false,\n\n    /**\n     * Indicates whether {@link fabric.Collection.add}, {@link fabric.Collection.insertAt} and {@link fabric.Collection.remove},\n     * {@link fabric.StaticCanvas.moveTo}, {@link fabric.StaticCanvas.clear} and many more, should also re-render canvas.\n     * Disabling this option will not give a performance boost when adding/removing a lot of objects to/from canvas at once\n     * since the renders are quequed and executed one per frame.\n     * Disabling is suggested anyway and managing the renders of the app manually is not a big effort ( canvas.requestRenderAll() )\n     * Left default to true to do not break documentation and old app, fiddles.\n     * @type Boolean\n     * @default\n     */\n    renderOnAddRemove: true,\n\n    /**\n     * Indicates whether object controls (borders/controls) are rendered above overlay image\n     * @type Boolean\n     * @default\n     */\n    controlsAboveOverlay: false,\n\n    /**\n     * Indicates whether the browser can be scrolled when using a touchscreen and dragging on the canvas\n     * @type Boolean\n     * @default\n     */\n    allowTouchScrolling: false,\n\n    /**\n     * Indicates whether this canvas will use image smoothing, this is on by default in browsers\n     * @type Boolean\n     * @default\n     */\n    imageSmoothingEnabled: true,\n\n    /**\n     * The transformation (a Canvas 2D API transform matrix) which focuses the viewport\n     * @type Array\n     * @example <caption>Default transform</caption>\n     * canvas.viewportTransform = [1, 0, 0, 1, 0, 0];\n     * @example <caption>Scale by 70% and translate toward bottom-right by 50, without skewing</caption>\n     * canvas.viewportTransform = [0.7, 0, 0, 0.7, 50, 50];\n     * @default\n     */\n    viewportTransform: fabric.iMatrix.concat(),\n\n    /**\n     * if set to false background image is not affected by viewport transform\n     * @since 1.6.3\n     * @type Boolean\n     * @default\n     */\n    backgroundVpt: true,\n\n    /**\n     * if set to false overlya image is not affected by viewport transform\n     * @since 1.6.3\n     * @type Boolean\n     * @default\n     */\n    overlayVpt: true,\n\n    /**\n     * When true, canvas is scaled by devicePixelRatio for better rendering on retina screens\n     * @type Boolean\n     * @default\n     */\n    enableRetinaScaling: true,\n\n    /**\n     * Describe canvas element extension over design\n     * properties are tl,tr,bl,br.\n     * if canvas is not zoomed/panned those points are the four corner of canvas\n     * if canvas is viewportTransformed you those points indicate the extension\n     * of canvas element in plain untrasformed coordinates\n     * The coordinates get updated with @method calcViewportBoundaries.\n     * @memberOf fabric.StaticCanvas.prototype\n     */\n    vptCoords: { },\n\n    /**\n     * Based on vptCoords and object.aCoords, skip rendering of objects that\n     * are not included in current viewport.\n     * May greatly help in applications with crowded canvas and use of zoom/pan\n     * If One of the corner of the bounding box of the object is on the canvas\n     * the objects get rendered.\n     * @memberOf fabric.StaticCanvas.prototype\n     * @type Boolean\n     * @default\n     */\n    skipOffscreen: true,\n\n    /**\n     * a fabricObject that, without stroke define a clipping area with their shape. filled in black\n     * the clipPath object gets used when the canvas has rendered, and the context is placed in the\n     * top left corner of the canvas.\n     * clipPath will clip away controls, if you do not want this to happen use controlsAboveOverlay = true\n     * @type fabric.Object\n     */\n    clipPath: undefined,\n\n    /**\n     * @private\n     * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\n     * @param {Object} [options] Options object\n     */\n    _initStatic: function(el, options) {\n      var cb = this.requestRenderAllBound;\n      this._objects = [];\n      this._createLowerCanvas(el);\n      this._initOptions(options);\n      // only initialize retina scaling once\n      if (!this.interactive) {\n        this._initRetinaScaling();\n      }\n\n      if (options.overlayImage) {\n        this.setOverlayImage(options.overlayImage, cb);\n      }\n      if (options.backgroundImage) {\n        this.setBackgroundImage(options.backgroundImage, cb);\n      }\n      if (options.backgroundColor) {\n        this.setBackgroundColor(options.backgroundColor, cb);\n      }\n      if (options.overlayColor) {\n        this.setOverlayColor(options.overlayColor, cb);\n      }\n      this.calcOffset();\n    },\n\n    /**\n     * @private\n     */\n    _isRetinaScaling: function() {\n      return (fabric.devicePixelRatio > 1 && this.enableRetinaScaling);\n    },\n\n    /**\n     * @private\n     * @return {Number} retinaScaling if applied, otherwise 1;\n     */\n    getRetinaScaling: function() {\n      return this._isRetinaScaling() ? Math.max(1, fabric.devicePixelRatio) : 1;\n    },\n\n    /**\n     * @private\n     */\n    _initRetinaScaling: function() {\n      if (!this._isRetinaScaling()) {\n        return;\n      }\n      var scaleRatio = fabric.devicePixelRatio;\n      this.__initRetinaScaling(scaleRatio, this.lowerCanvasEl, this.contextContainer);\n      if (this.upperCanvasEl) {\n        this.__initRetinaScaling(scaleRatio, this.upperCanvasEl, this.contextTop);\n      }\n    },\n\n    __initRetinaScaling: function(scaleRatio, canvas, context) {\n      canvas.setAttribute('width', this.width * scaleRatio);\n      canvas.setAttribute('height', this.height * scaleRatio);\n      context.scale(scaleRatio, scaleRatio);\n    },\n\n\n    /**\n     * Calculates canvas element offset relative to the document\n     * This method is also attached as \"resize\" event handler of window\n     * @return {fabric.Canvas} instance\n     * @chainable\n     */\n    calcOffset: function () {\n      this._offset = getElementOffset(this.lowerCanvasEl);\n      return this;\n    },\n\n    /**\n     * Sets {@link fabric.StaticCanvas#overlayImage|overlay image} for this canvas\n     * @param {(fabric.Image|String)} image fabric.Image instance or URL of an image to set overlay to\n     * @param {Function} callback callback to invoke when image is loaded and set as an overlay\n     * @param {Object} [options] Optional options to set for the {@link fabric.Image|overlay image}.\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     * @see {@link http://jsfiddle.net/fabricjs/MnzHT/|jsFiddle demo}\n     * @example <caption>Normal overlayImage with left/top = 0</caption>\n     * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n     *   // Needed to position overlayImage at 0/0\n     *   originX: 'left',\n     *   originY: 'top'\n     * });\n     * @example <caption>overlayImage with different properties</caption>\n     * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n     *   opacity: 0.5,\n     *   angle: 45,\n     *   left: 400,\n     *   top: 400,\n     *   originX: 'left',\n     *   originY: 'top'\n     * });\n     * @example <caption>Stretched overlayImage #1 - width/height correspond to canvas width/height</caption>\n     * fabric.Image.fromURL('http://fabricjs.com/assets/jail_cell_bars.png', function(img, isError) {\n     *    img.set({width: canvas.width, height: canvas.height, originX: 'left', originY: 'top'});\n     *    canvas.setOverlayImage(img, canvas.renderAll.bind(canvas));\n     * });\n     * @example <caption>Stretched overlayImage #2 - width/height correspond to canvas width/height</caption>\n     * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n     *   width: canvas.width,\n     *   height: canvas.height,\n     *   // Needed to position overlayImage at 0/0\n     *   originX: 'left',\n     *   originY: 'top'\n     * });\n     * @example <caption>overlayImage loaded from cross-origin</caption>\n     * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\n     *   opacity: 0.5,\n     *   angle: 45,\n     *   left: 400,\n     *   top: 400,\n     *   originX: 'left',\n     *   originY: 'top',\n     *   crossOrigin: 'anonymous'\n     * });\n     */\n    setOverlayImage: function (image, callback, options) {\n      return this.__setBgOverlayImage('overlayImage', image, callback, options);\n    },\n\n    /**\n     * Sets {@link fabric.StaticCanvas#backgroundImage|background image} for this canvas\n     * @param {(fabric.Image|String)} image fabric.Image instance or URL of an image to set background to\n     * @param {Function} callback Callback to invoke when image is loaded and set as background\n     * @param {Object} [options] Optional options to set for the {@link fabric.Image|background image}.\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     * @see {@link http://jsfiddle.net/djnr8o7a/28/|jsFiddle demo}\n     * @example <caption>Normal backgroundImage with left/top = 0</caption>\n     * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n     *   // Needed to position backgroundImage at 0/0\n     *   originX: 'left',\n     *   originY: 'top'\n     * });\n     * @example <caption>backgroundImage with different properties</caption>\n     * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n     *   opacity: 0.5,\n     *   angle: 45,\n     *   left: 400,\n     *   top: 400,\n     *   originX: 'left',\n     *   originY: 'top'\n     * });\n     * @example <caption>Stretched backgroundImage #1 - width/height correspond to canvas width/height</caption>\n     * fabric.Image.fromURL('http://fabricjs.com/assets/honey_im_subtle.png', function(img, isError) {\n     *    img.set({width: canvas.width, height: canvas.height, originX: 'left', originY: 'top'});\n     *    canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));\n     * });\n     * @example <caption>Stretched backgroundImage #2 - width/height correspond to canvas width/height</caption>\n     * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n     *   width: canvas.width,\n     *   height: canvas.height,\n     *   // Needed to position backgroundImage at 0/0\n     *   originX: 'left',\n     *   originY: 'top'\n     * });\n     * @example <caption>backgroundImage loaded from cross-origin</caption>\n     * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\n     *   opacity: 0.5,\n     *   angle: 45,\n     *   left: 400,\n     *   top: 400,\n     *   originX: 'left',\n     *   originY: 'top',\n     *   crossOrigin: 'anonymous'\n     * });\n     */\n    // TODO: fix stretched examples\n    setBackgroundImage: function (image, callback, options) {\n      return this.__setBgOverlayImage('backgroundImage', image, callback, options);\n    },\n\n    /**\n     * Sets {@link fabric.StaticCanvas#overlayColor|foreground color} for this canvas\n     * @param {(String|fabric.Pattern)} overlayColor Color or pattern to set foreground color to\n     * @param {Function} callback Callback to invoke when foreground color is set\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     * @see {@link http://jsfiddle.net/fabricjs/pB55h/|jsFiddle demo}\n     * @example <caption>Normal overlayColor - color value</caption>\n     * canvas.setOverlayColor('rgba(255, 73, 64, 0.6)', canvas.renderAll.bind(canvas));\n     * @example <caption>fabric.Pattern used as overlayColor</caption>\n     * canvas.setOverlayColor({\n     *   source: 'http://fabricjs.com/assets/escheresque_ste.png'\n     * }, canvas.renderAll.bind(canvas));\n     * @example <caption>fabric.Pattern used as overlayColor with repeat and offset</caption>\n     * canvas.setOverlayColor({\n     *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\n     *   repeat: 'repeat',\n     *   offsetX: 200,\n     *   offsetY: 100\n     * }, canvas.renderAll.bind(canvas));\n     */\n    setOverlayColor: function(overlayColor, callback) {\n      return this.__setBgOverlayColor('overlayColor', overlayColor, callback);\n    },\n\n    /**\n     * Sets {@link fabric.StaticCanvas#backgroundColor|background color} for this canvas\n     * @param {(String|fabric.Pattern)} backgroundColor Color or pattern to set background color to\n     * @param {Function} callback Callback to invoke when background color is set\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     * @see {@link http://jsfiddle.net/fabricjs/hXzvk/|jsFiddle demo}\n     * @example <caption>Normal backgroundColor - color value</caption>\n     * canvas.setBackgroundColor('rgba(255, 73, 64, 0.6)', canvas.renderAll.bind(canvas));\n     * @example <caption>fabric.Pattern used as backgroundColor</caption>\n     * canvas.setBackgroundColor({\n     *   source: 'http://fabricjs.com/assets/escheresque_ste.png'\n     * }, canvas.renderAll.bind(canvas));\n     * @example <caption>fabric.Pattern used as backgroundColor with repeat and offset</caption>\n     * canvas.setBackgroundColor({\n     *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\n     *   repeat: 'repeat',\n     *   offsetX: 200,\n     *   offsetY: 100\n     * }, canvas.renderAll.bind(canvas));\n     */\n    setBackgroundColor: function(backgroundColor, callback) {\n      return this.__setBgOverlayColor('backgroundColor', backgroundColor, callback);\n    },\n\n    /**\n     * @private\n     * @param {String} property Property to set ({@link fabric.StaticCanvas#backgroundImage|backgroundImage}\n     * or {@link fabric.StaticCanvas#overlayImage|overlayImage})\n     * @param {(fabric.Image|String|null)} image fabric.Image instance, URL of an image or null to set background or overlay to\n     * @param {Function} callback Callback to invoke when image is loaded and set as background or overlay. The first argument is the created image, the second argument is a flag indicating whether an error occurred or not.\n     * @param {Object} [options] Optional options to set for the {@link fabric.Image|image}.\n     */\n    __setBgOverlayImage: function(property, image, callback, options) {\n      if (typeof image === 'string') {\n        fabric.util.loadImage(image, function(img, isError) {\n          if (img) {\n            var instance = new fabric.Image(img, options);\n            this[property] = instance;\n            instance.canvas = this;\n          }\n          callback && callback(img, isError);\n        }, this, options && options.crossOrigin);\n      }\n      else {\n        options && image.setOptions(options);\n        this[property] = image;\n        image && (image.canvas = this);\n        callback && callback(image, false);\n      }\n\n      return this;\n    },\n\n    /**\n     * @private\n     * @param {String} property Property to set ({@link fabric.StaticCanvas#backgroundColor|backgroundColor}\n     * or {@link fabric.StaticCanvas#overlayColor|overlayColor})\n     * @param {(Object|String|null)} color Object with pattern information, color value or null\n     * @param {Function} [callback] Callback is invoked when color is set\n     */\n    __setBgOverlayColor: function(property, color, callback) {\n      this[property] = color;\n      this._initGradient(color, property);\n      this._initPattern(color, property, callback);\n      return this;\n    },\n\n    /**\n     * @private\n     */\n    _createCanvasElement: function() {\n      var element = createCanvasElement();\n      if (!element) {\n        throw CANVAS_INIT_ERROR;\n      }\n      if (!element.style) {\n        element.style = { };\n      }\n      if (typeof element.getContext === 'undefined') {\n        throw CANVAS_INIT_ERROR;\n      }\n      return element;\n    },\n\n    /**\n     * @private\n     * @param {Object} [options] Options object\n     */\n    _initOptions: function (options) {\n      var lowerCanvasEl = this.lowerCanvasEl;\n      this._setOptions(options);\n\n      this.width = this.width || parseInt(lowerCanvasEl.width, 10) || 0;\n      this.height = this.height || parseInt(lowerCanvasEl.height, 10) || 0;\n\n      if (!this.lowerCanvasEl.style) {\n        return;\n      }\n\n      lowerCanvasEl.width = this.width;\n      lowerCanvasEl.height = this.height;\n\n      lowerCanvasEl.style.width = this.width + 'px';\n      lowerCanvasEl.style.height = this.height + 'px';\n\n      this.viewportTransform = this.viewportTransform.slice();\n    },\n\n    /**\n     * Creates a bottom canvas\n     * @private\n     * @param {HTMLElement} [canvasEl]\n     */\n    _createLowerCanvas: function (canvasEl) {\n      // canvasEl === 'HTMLCanvasElement' does not work on jsdom/node\n      if (canvasEl && canvasEl.getContext) {\n        this.lowerCanvasEl = canvasEl;\n      }\n      else {\n        this.lowerCanvasEl = fabric.util.getById(canvasEl) || this._createCanvasElement();\n      }\n\n      fabric.util.addClass(this.lowerCanvasEl, 'lower-canvas');\n      this._originalCanvasStyle = this.lowerCanvasEl.style;\n      if (this.interactive) {\n        this._applyCanvasStyle(this.lowerCanvasEl);\n      }\n\n      this.contextContainer = this.lowerCanvasEl.getContext('2d');\n    },\n\n    /**\n     * Returns canvas width (in px)\n     * @return {Number}\n     */\n    getWidth: function () {\n      return this.width;\n    },\n\n    /**\n     * Returns canvas height (in px)\n     * @return {Number}\n     */\n    getHeight: function () {\n      return this.height;\n    },\n\n    /**\n     * Sets width of this canvas instance\n     * @param {Number|String} value                         Value to set width to\n     * @param {Object}        [options]                     Options object\n     * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n     * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    setWidth: function (value, options) {\n      return this.setDimensions({ width: value }, options);\n    },\n\n    /**\n     * Sets height of this canvas instance\n     * @param {Number|String} value                         Value to set height to\n     * @param {Object}        [options]                     Options object\n     * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n     * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    setHeight: function (value, options) {\n      return this.setDimensions({ height: value }, options);\n    },\n\n    /**\n     * Sets dimensions (width, height) of this canvas instance. when options.cssOnly flag active you should also supply the unit of measure (px/%/em)\n     * @param {Object}        dimensions                    Object with width/height properties\n     * @param {Number|String} [dimensions.width]            Width of canvas element\n     * @param {Number|String} [dimensions.height]           Height of canvas element\n     * @param {Object}        [options]                     Options object\n     * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\n     * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    setDimensions: function (dimensions, options) {\n      var cssValue;\n\n      options = options || {};\n\n      for (var prop in dimensions) {\n        cssValue = dimensions[prop];\n\n        if (!options.cssOnly) {\n          this._setBackstoreDimension(prop, dimensions[prop]);\n          cssValue += 'px';\n          this.hasLostContext = true;\n        }\n\n        if (!options.backstoreOnly) {\n          this._setCssDimension(prop, cssValue);\n        }\n      }\n      if (this._isCurrentlyDrawing) {\n        this.freeDrawingBrush && this.freeDrawingBrush._setBrushStyles(this.contextTop);\n      }\n      this._initRetinaScaling();\n      this.calcOffset();\n\n      if (!options.cssOnly) {\n        this.requestRenderAll();\n      }\n\n      return this;\n    },\n\n    /**\n     * Helper for setting width/height\n     * @private\n     * @param {String} prop property (width|height)\n     * @param {Number} value value to set property to\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    _setBackstoreDimension: function (prop, value) {\n      this.lowerCanvasEl[prop] = value;\n\n      if (this.upperCanvasEl) {\n        this.upperCanvasEl[prop] = value;\n      }\n\n      if (this.cacheCanvasEl) {\n        this.cacheCanvasEl[prop] = value;\n      }\n\n      this[prop] = value;\n\n      return this;\n    },\n\n    /**\n     * Helper for setting css width/height\n     * @private\n     * @param {String} prop property (width|height)\n     * @param {String} value value to set property to\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    _setCssDimension: function (prop, value) {\n      this.lowerCanvasEl.style[prop] = value;\n\n      if (this.upperCanvasEl) {\n        this.upperCanvasEl.style[prop] = value;\n      }\n\n      if (this.wrapperEl) {\n        this.wrapperEl.style[prop] = value;\n      }\n\n      return this;\n    },\n\n    /**\n     * Returns canvas zoom level\n     * @return {Number}\n     */\n    getZoom: function () {\n      return this.viewportTransform[0];\n    },\n\n    /**\n     * Sets viewport transformation of this canvas instance\n     * @param {Array} vpt a Canvas 2D API transform matrix\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    setViewportTransform: function (vpt) {\n      var activeObject = this._activeObject,\n          backgroundObject = this.backgroundImage,\n          overlayObject = this.overlayImage,\n          object, i, len;\n      this.viewportTransform = vpt;\n      for (i = 0, len = this._objects.length; i < len; i++) {\n        object = this._objects[i];\n        object.group || object.setCoords(true);\n      }\n      if (activeObject) {\n        activeObject.setCoords();\n      }\n      if (backgroundObject) {\n        backgroundObject.setCoords(true);\n      }\n      if (overlayObject) {\n        overlayObject.setCoords(true);\n      }\n      this.calcViewportBoundaries();\n      this.renderOnAddRemove && this.requestRenderAll();\n      return this;\n    },\n\n    /**\n     * Sets zoom level of this canvas instance, the zoom centered around point\n     * meaning that following zoom to point with the same point will have the visual\n     * effect of the zoom originating from that point. The point won't move.\n     * It has nothing to do with canvas center or visual center of the viewport.\n     * @param {fabric.Point} point to zoom with respect to\n     * @param {Number} value to set zoom to, less than 1 zooms out\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    zoomToPoint: function (point, value) {\n      // TODO: just change the scale, preserve other transformations\n      var before = point, vpt = this.viewportTransform.slice(0);\n      point = transformPoint(point, invertTransform(this.viewportTransform));\n      vpt[0] = value;\n      vpt[3] = value;\n      var after = transformPoint(point, vpt);\n      vpt[4] += before.x - after.x;\n      vpt[5] += before.y - after.y;\n      return this.setViewportTransform(vpt);\n    },\n\n    /**\n     * Sets zoom level of this canvas instance\n     * @param {Number} value to set zoom to, less than 1 zooms out\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    setZoom: function (value) {\n      this.zoomToPoint(new fabric.Point(0, 0), value);\n      return this;\n    },\n\n    /**\n     * Pan viewport so as to place point at top left corner of canvas\n     * @param {fabric.Point} point to move to\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    absolutePan: function (point) {\n      var vpt = this.viewportTransform.slice(0);\n      vpt[4] = -point.x;\n      vpt[5] = -point.y;\n      return this.setViewportTransform(vpt);\n    },\n\n    /**\n     * Pans viewpoint relatively\n     * @param {fabric.Point} point (position vector) to move by\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    relativePan: function (point) {\n      return this.absolutePan(new fabric.Point(\n        -point.x - this.viewportTransform[4],\n        -point.y - this.viewportTransform[5]\n      ));\n    },\n\n    /**\n     * Returns &lt;canvas> element corresponding to this instance\n     * @return {HTMLCanvasElement}\n     */\n    getElement: function () {\n      return this.lowerCanvasEl;\n    },\n\n    /**\n     * @private\n     * @param {fabric.Object} obj Object that was added\n     */\n    _onObjectAdded: function(obj) {\n      this.stateful && obj.setupState();\n      obj._set('canvas', this);\n      obj.setCoords();\n      this.fire('object:added', { target: obj });\n      obj.fire('added');\n    },\n\n    /**\n     * @private\n     * @param {fabric.Object} obj Object that was removed\n     */\n    _onObjectRemoved: function(obj) {\n      this.fire('object:removed', { target: obj });\n      obj.fire('removed');\n      delete obj.canvas;\n    },\n\n    /**\n     * Clears specified context of canvas element\n     * @param {CanvasRenderingContext2D} ctx Context to clear\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    clearContext: function(ctx) {\n      ctx.clearRect(0, 0, this.width, this.height);\n      return this;\n    },\n\n    /**\n     * Returns context of canvas where objects are drawn\n     * @return {CanvasRenderingContext2D}\n     */\n    getContext: function () {\n      return this.contextContainer;\n    },\n\n    /**\n     * Clears all contexts (background, main, top) of an instance\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    clear: function () {\n      this.remove.apply(this, this.getObjects());\n      this.backgroundImage = null;\n      this.overlayImage = null;\n      this.backgroundColor = '';\n      this.overlayColor = '';\n      if (this._hasITextHandlers) {\n        this.off('mouse:up', this._mouseUpITextHandler);\n        this._iTextInstances = null;\n        this._hasITextHandlers = false;\n      }\n      this.clearContext(this.contextContainer);\n      this.fire('canvas:cleared');\n      this.renderOnAddRemove && this.requestRenderAll();\n      return this;\n    },\n\n    /**\n     * Renders the canvas\n     * @return {fabric.Canvas} instance\n     * @chainable\n     */\n    renderAll: function () {\n      var canvasToDrawOn = this.contextContainer;\n      this.renderCanvas(canvasToDrawOn, this._objects);\n      return this;\n    },\n\n    /**\n     * Function created to be instance bound at initialization\n     * used in requestAnimationFrame rendering\n     * Let the fabricJS call it. If you call it manually you could have more\n     * animationFrame stacking on to of each other\n     * for an imperative rendering, use canvas.renderAll\n     * @private\n     * @return {fabric.Canvas} instance\n     * @chainable\n     */\n    renderAndReset: function() {\n      this.isRendering = 0;\n      this.renderAll();\n    },\n\n    /**\n     * Append a renderAll request to next animation frame.\n     * unless one is already in progress, in that case nothing is done\n     * a boolean flag will avoid appending more.\n     * @return {fabric.Canvas} instance\n     * @chainable\n     */\n    requestRenderAll: function () {\n      if (!this.isRendering) {\n        this.isRendering = fabric.util.requestAnimFrame(this.renderAndResetBound);\n      }\n      return this;\n    },\n\n    /**\n     * Calculate the position of the 4 corner of canvas with current viewportTransform.\n     * helps to determinate when an object is in the current rendering viewport using\n     * object absolute coordinates ( aCoords )\n     * @return {Object} points.tl\n     * @chainable\n     */\n    calcViewportBoundaries: function() {\n      var points = { }, width = this.width, height = this.height,\n          iVpt = invertTransform(this.viewportTransform);\n      points.tl = transformPoint({ x: 0, y: 0 }, iVpt);\n      points.br = transformPoint({ x: width, y: height }, iVpt);\n      points.tr = new fabric.Point(points.br.x, points.tl.y);\n      points.bl = new fabric.Point(points.tl.x, points.br.y);\n      this.vptCoords = points;\n      return points;\n    },\n\n    cancelRequestedRender: function() {\n      if (this.isRendering) {\n        fabric.util.cancelAnimFrame(this.isRendering);\n        this.isRendering = 0;\n      }\n    },\n\n    /**\n     * Renders background, objects, overlay and controls.\n     * @param {CanvasRenderingContext2D} ctx\n     * @param {Array} objects to render\n     * @return {fabric.Canvas} instance\n     * @chainable\n     */\n    renderCanvas: function(ctx, objects) {\n      var v = this.viewportTransform, path = this.clipPath;\n      this.cancelRequestedRender();\n      this.calcViewportBoundaries();\n      this.clearContext(ctx);\n      fabric.util.setImageSmoothing(ctx, this.imageSmoothingEnabled);\n      this.fire('before:render', { ctx: ctx, });\n      this._renderBackground(ctx);\n\n      ctx.save();\n      //apply viewport transform once for all rendering process\n      ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n      this._renderObjects(ctx, objects);\n      ctx.restore();\n      if (!this.controlsAboveOverlay && this.interactive) {\n        this.drawControls(ctx);\n      }\n      if (path) {\n        path.canvas = this;\n        // needed to setup a couple of variables\n        path.shouldCache();\n        path._transformDone = true;\n        path.renderCache({ forClipping: true });\n        this.drawClipPathOnCanvas(ctx);\n      }\n      this._renderOverlay(ctx);\n      if (this.controlsAboveOverlay && this.interactive) {\n        this.drawControls(ctx);\n      }\n      this.fire('after:render', { ctx: ctx, });\n    },\n\n    /**\n     * Paint the cached clipPath on the lowerCanvasEl\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    drawClipPathOnCanvas: function(ctx) {\n      var v = this.viewportTransform, path = this.clipPath;\n      ctx.save();\n      ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n      // DEBUG: uncomment this line, comment the following\n      // ctx.globalAlpha = 0.4;\n      ctx.globalCompositeOperation = 'destination-in';\n      path.transform(ctx);\n      ctx.scale(1 / path.zoomX, 1 / path.zoomY);\n      ctx.drawImage(path._cacheCanvas, -path.cacheTranslationX, -path.cacheTranslationY);\n      ctx.restore();\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {Array} objects to render\n     */\n    _renderObjects: function(ctx, objects) {\n      var i, len;\n      for (i = 0, len = objects.length; i < len; ++i) {\n        objects[i] && objects[i].render(ctx);\n      }\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {string} property 'background' or 'overlay'\n     */\n    _renderBackgroundOrOverlay: function(ctx, property) {\n      var fill = this[property + 'Color'], object = this[property + 'Image'],\n          v = this.viewportTransform, needsVpt = this[property + 'Vpt'];\n      if (!fill && !object) {\n        return;\n      }\n      if (fill) {\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(0, 0);\n        ctx.lineTo(this.width, 0);\n        ctx.lineTo(this.width, this.height);\n        ctx.lineTo(0, this.height);\n        ctx.closePath();\n        ctx.fillStyle = fill.toLive\n          ? fill.toLive(ctx, this)\n          : fill;\n        if (needsVpt) {\n          ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n        }\n        ctx.transform(1, 0, 0, 1, fill.offsetX || 0, fill.offsetY || 0);\n        var m = fill.gradientTransform || fill.patternTransform;\n        m && ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n        ctx.fill();\n        ctx.restore();\n      }\n      if (object) {\n        ctx.save();\n        var skipOffscreen = this.skipOffscreen;\n        // if the object doesn't move with the viewport,\n        // the offscreen concept does not apply;\n        this.skipOffscreen = needsVpt;\n        if (needsVpt) {\n          ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n        }\n        object.render(ctx);\n        this.skipOffscreen = skipOffscreen;\n        ctx.restore();\n      }\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderBackground: function(ctx) {\n      this._renderBackgroundOrOverlay(ctx, 'background');\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderOverlay: function(ctx) {\n      this._renderBackgroundOrOverlay(ctx, 'overlay');\n    },\n\n    /**\n     * Returns coordinates of a center of canvas.\n     * Returned value is an object with top and left properties\n     * @return {Object} object with \"top\" and \"left\" number values\n     * @deprecated migrate to `getCenterPoint`\n     */\n    getCenter: function () {\n      return {\n        top: this.height / 2,\n        left: this.width / 2\n      };\n    },\n\n    /**\n     * Returns coordinates of a center of canvas.\n     * @return {fabric.Point} \n     */\n    getCenterPoint: function () {\n      return new fabric.Point(this.width / 2, this.height / 2);\n    },\n\n    /**\n     * Centers object horizontally in the canvas\n     * @param {fabric.Object} object Object to center horizontally\n     * @return {fabric.Canvas} thisArg\n     */\n    centerObjectH: function (object) {\n      return this._centerObject(object, new fabric.Point(this.getCenterPoint().x, object.getCenterPoint().y));\n    },\n\n    /**\n     * Centers object vertically in the canvas\n     * @param {fabric.Object} object Object to center vertically\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    centerObjectV: function (object) {\n      return this._centerObject(object, new fabric.Point(object.getCenterPoint().x, this.getCenterPoint().y));\n    },\n\n    /**\n     * Centers object vertically and horizontally in the canvas\n     * @param {fabric.Object} object Object to center vertically and horizontally\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    centerObject: function(object) {\n      var center = this.getCenterPoint();\n      return this._centerObject(object, center);\n    },\n\n    /**\n     * Centers object vertically and horizontally in the viewport\n     * @param {fabric.Object} object Object to center vertically and horizontally\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    viewportCenterObject: function(object) {\n      var vpCenter = this.getVpCenter();\n      return this._centerObject(object, vpCenter);\n    },\n\n    /**\n     * Centers object horizontally in the viewport, object.top is unchanged\n     * @param {fabric.Object} object Object to center vertically and horizontally\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    viewportCenterObjectH: function(object) {\n      var vpCenter = this.getVpCenter();\n      this._centerObject(object, new fabric.Point(vpCenter.x, object.getCenterPoint().y));\n      return this;\n    },\n\n    /**\n     * Centers object Vertically in the viewport, object.top is unchanged\n     * @param {fabric.Object} object Object to center vertically and horizontally\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    viewportCenterObjectV: function(object) {\n      var vpCenter = this.getVpCenter();\n\n      return this._centerObject(object, new fabric.Point(object.getCenterPoint().x, vpCenter.y));\n    },\n\n    /**\n     * Calculate the point in canvas that correspond to the center of actual viewport.\n     * @return {fabric.Point} vpCenter, viewport center\n     * @chainable\n     */\n    getVpCenter: function() {\n      var center = this.getCenterPoint(),\n          iVpt = invertTransform(this.viewportTransform);\n      return transformPoint(center, iVpt);\n    },\n\n    /**\n     * @private\n     * @param {fabric.Object} object Object to center\n     * @param {fabric.Point} center Center point\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    _centerObject: function(object, center) {\n      object.setPositionByOrigin(center, 'center', 'center');\n      object.setCoords();\n      this.renderOnAddRemove && this.requestRenderAll();\n      return this;\n    },\n\n    /**\n     * Returns dataless JSON representation of canvas\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {String} json string\n     */\n    toDatalessJSON: function (propertiesToInclude) {\n      return this.toDatalessObject(propertiesToInclude);\n    },\n\n    /**\n     * Returns object representation of canvas\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toObject: function (propertiesToInclude) {\n      return this._toObjectMethod('toObject', propertiesToInclude);\n    },\n\n    /**\n     * Returns dataless object representation of canvas\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toDatalessObject: function (propertiesToInclude) {\n      return this._toObjectMethod('toDatalessObject', propertiesToInclude);\n    },\n\n    /**\n     * @private\n     */\n    _toObjectMethod: function (methodName, propertiesToInclude) {\n\n      var clipPath = this.clipPath, data = {\n        version: fabric.version,\n        objects: this._toObjects(methodName, propertiesToInclude),\n      };\n      if (clipPath && !clipPath.excludeFromExport) {\n        data.clipPath = this._toObject(this.clipPath, methodName, propertiesToInclude);\n      }\n      extend(data, this.__serializeBgOverlay(methodName, propertiesToInclude));\n\n      fabric.util.populateWithProperties(this, data, propertiesToInclude);\n\n      return data;\n    },\n\n    /**\n     * @private\n     */\n    _toObjects: function(methodName, propertiesToInclude) {\n      return this._objects.filter(function(object) {\n        return !object.excludeFromExport;\n      }).map(function(instance) {\n        return this._toObject(instance, methodName, propertiesToInclude);\n      }, this);\n    },\n\n    /**\n     * @private\n     */\n    _toObject: function(instance, methodName, propertiesToInclude) {\n      var originalValue;\n\n      if (!this.includeDefaultValues) {\n        originalValue = instance.includeDefaultValues;\n        instance.includeDefaultValues = false;\n      }\n\n      var object = instance[methodName](propertiesToInclude);\n      if (!this.includeDefaultValues) {\n        instance.includeDefaultValues = originalValue;\n      }\n      return object;\n    },\n\n    /**\n     * @private\n     */\n    __serializeBgOverlay: function(methodName, propertiesToInclude) {\n      var data = {}, bgImage = this.backgroundImage, overlayImage = this.overlayImage,\n          bgColor = this.backgroundColor, overlayColor = this.overlayColor;\n\n      if (bgColor && bgColor.toObject) {\n        if (!bgColor.excludeFromExport) {\n          data.background = bgColor.toObject(propertiesToInclude);\n        }\n      }\n      else if (bgColor) {\n        data.background = bgColor;\n      }\n\n      if (overlayColor && overlayColor.toObject) {\n        if (!overlayColor.excludeFromExport) {\n          data.overlay = overlayColor.toObject(propertiesToInclude);\n        }\n      }\n      else if (overlayColor) {\n        data.overlay = overlayColor;\n      }\n\n      if (bgImage && !bgImage.excludeFromExport) {\n        data.backgroundImage = this._toObject(bgImage, methodName, propertiesToInclude);\n      }\n      if (overlayImage && !overlayImage.excludeFromExport) {\n        data.overlayImage = this._toObject(overlayImage, methodName, propertiesToInclude);\n      }\n\n      return data;\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * When true, getSvgTransform() will apply the StaticCanvas.viewportTransform to the SVG transformation. When true,\n     * a zoomed canvas will then produce zoomed SVG output.\n     * @type Boolean\n     * @default\n     */\n    svgViewportTransformation: true,\n\n    /**\n     * Returns SVG representation of canvas\n     * @function\n     * @param {Object} [options] Options object for SVG output\n     * @param {Boolean} [options.suppressPreamble=false] If true xml tag is not included\n     * @param {Object} [options.viewBox] SVG viewbox object\n     * @param {Number} [options.viewBox.x] x-coordinate of viewbox\n     * @param {Number} [options.viewBox.y] y-coordinate of viewbox\n     * @param {Number} [options.viewBox.width] Width of viewbox\n     * @param {Number} [options.viewBox.height] Height of viewbox\n     * @param {String} [options.encoding=UTF-8] Encoding of SVG output\n     * @param {String} [options.width] desired width of svg with or without units\n     * @param {String} [options.height] desired height of svg with or without units\n     * @param {Function} [reviver] Method for further parsing of svg elements, called after each fabric object converted into svg representation.\n     * @return {String} SVG string\n     * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#serialization}\n     * @see {@link http://jsfiddle.net/fabricjs/jQ3ZZ/|jsFiddle demo}\n     * @example <caption>Normal SVG output</caption>\n     * var svg = canvas.toSVG();\n     * @example <caption>SVG output without preamble (without &lt;?xml ../>)</caption>\n     * var svg = canvas.toSVG({suppressPreamble: true});\n     * @example <caption>SVG output with viewBox attribute</caption>\n     * var svg = canvas.toSVG({\n     *   viewBox: {\n     *     x: 100,\n     *     y: 100,\n     *     width: 200,\n     *     height: 300\n     *   }\n     * });\n     * @example <caption>SVG output with different encoding (default: UTF-8)</caption>\n     * var svg = canvas.toSVG({encoding: 'ISO-8859-1'});\n     * @example <caption>Modify SVG output with reviver function</caption>\n     * var svg = canvas.toSVG(null, function(svg) {\n     *   return svg.replace('stroke-dasharray: ; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; ', '');\n     * });\n     */\n    toSVG: function(options, reviver) {\n      options || (options = { });\n      options.reviver = reviver;\n      var markup = [];\n\n      this._setSVGPreamble(markup, options);\n      this._setSVGHeader(markup, options);\n      if (this.clipPath) {\n        markup.push('<g clip-path=\"url(#' + this.clipPath.clipPathId + ')\" >\\n');\n      }\n      this._setSVGBgOverlayColor(markup, 'background');\n      this._setSVGBgOverlayImage(markup, 'backgroundImage', reviver);\n      this._setSVGObjects(markup, reviver);\n      if (this.clipPath) {\n        markup.push('</g>\\n');\n      }\n      this._setSVGBgOverlayColor(markup, 'overlay');\n      this._setSVGBgOverlayImage(markup, 'overlayImage', reviver);\n\n      markup.push('</svg>');\n\n      return markup.join('');\n    },\n\n    /**\n     * @private\n     */\n    _setSVGPreamble: function(markup, options) {\n      if (options.suppressPreamble) {\n        return;\n      }\n      markup.push(\n        '<?xml version=\"1.0\" encoding=\"', (options.encoding || 'UTF-8'), '\" standalone=\"no\" ?>\\n',\n        '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" ',\n        '\"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n'\n      );\n    },\n\n    /**\n     * @private\n     */\n    _setSVGHeader: function(markup, options) {\n      var width = options.width || this.width,\n          height = options.height || this.height,\n          vpt, viewBox = 'viewBox=\"0 0 ' + this.width + ' ' + this.height + '\" ',\n          NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS;\n\n      if (options.viewBox) {\n        viewBox = 'viewBox=\"' +\n                options.viewBox.x + ' ' +\n                options.viewBox.y + ' ' +\n                options.viewBox.width + ' ' +\n                options.viewBox.height + '\" ';\n      }\n      else {\n        if (this.svgViewportTransformation) {\n          vpt = this.viewportTransform;\n          viewBox = 'viewBox=\"' +\n                  toFixed(-vpt[4] / vpt[0], NUM_FRACTION_DIGITS) + ' ' +\n                  toFixed(-vpt[5] / vpt[3], NUM_FRACTION_DIGITS) + ' ' +\n                  toFixed(this.width / vpt[0], NUM_FRACTION_DIGITS) + ' ' +\n                  toFixed(this.height / vpt[3], NUM_FRACTION_DIGITS) + '\" ';\n        }\n      }\n\n      markup.push(\n        '<svg ',\n        'xmlns=\"http://www.w3.org/2000/svg\" ',\n        'xmlns:xlink=\"http://www.w3.org/1999/xlink\" ',\n        'version=\"1.1\" ',\n        'width=\"', width, '\" ',\n        'height=\"', height, '\" ',\n        viewBox,\n        'xml:space=\"preserve\">\\n',\n        '<desc>Created with Fabric.js ', fabric.version, '</desc>\\n',\n        '<defs>\\n',\n        this.createSVGFontFacesMarkup(),\n        this.createSVGRefElementsMarkup(),\n        this.createSVGClipPathMarkup(options),\n        '</defs>\\n'\n      );\n    },\n\n    createSVGClipPathMarkup: function(options) {\n      var clipPath = this.clipPath;\n      if (clipPath) {\n        clipPath.clipPathId = 'CLIPPATH_' + fabric.Object.__uid++;\n        return  '<clipPath id=\"' + clipPath.clipPathId + '\" >\\n' +\n          this.clipPath.toClipPathSVG(options.reviver) +\n          '</clipPath>\\n';\n      }\n      return '';\n    },\n\n    /**\n     * Creates markup containing SVG referenced elements like patterns, gradients etc.\n     * @return {String}\n     */\n    createSVGRefElementsMarkup: function() {\n      var _this = this,\n          markup = ['background', 'overlay'].map(function(prop) {\n            var fill = _this[prop + 'Color'];\n            if (fill && fill.toLive) {\n              var shouldTransform = _this[prop + 'Vpt'], vpt = _this.viewportTransform,\n                  object = {\n                    width: _this.width / (shouldTransform ? vpt[0] : 1),\n                    height: _this.height / (shouldTransform ? vpt[3] : 1)\n                  };\n              return fill.toSVG(\n                object,\n                { additionalTransform: shouldTransform ? fabric.util.matrixToSVG(vpt) : '' }\n              );\n            }\n          });\n      return markup.join('');\n    },\n\n    /**\n     * Creates markup containing SVG font faces,\n     * font URLs for font faces must be collected by developers\n     * and are not extracted from the DOM by fabricjs\n     * @param {Array} objects Array of fabric objects\n     * @return {String}\n     */\n    createSVGFontFacesMarkup: function() {\n      var markup = '', fontList = { }, obj, fontFamily,\n          style, row, rowIndex, _char, charIndex, i, len,\n          fontPaths = fabric.fontPaths, objects = [];\n\n      this._objects.forEach(function add(object) {\n        objects.push(object);\n        if (object._objects) {\n          object._objects.forEach(add);\n        }\n      });\n\n      for (i = 0, len = objects.length; i < len; i++) {\n        obj = objects[i];\n        fontFamily = obj.fontFamily;\n        if (obj.type.indexOf('text') === -1 || fontList[fontFamily] || !fontPaths[fontFamily]) {\n          continue;\n        }\n        fontList[fontFamily] = true;\n        if (!obj.styles) {\n          continue;\n        }\n        style = obj.styles;\n        for (rowIndex in style) {\n          row = style[rowIndex];\n          for (charIndex in row) {\n            _char = row[charIndex];\n            fontFamily = _char.fontFamily;\n            if (!fontList[fontFamily] && fontPaths[fontFamily]) {\n              fontList[fontFamily] = true;\n            }\n          }\n        }\n      }\n\n      for (var j in fontList) {\n        markup += [\n          '\\t\\t@font-face {\\n',\n          '\\t\\t\\tfont-family: \\'', j, '\\';\\n',\n          '\\t\\t\\tsrc: url(\\'', fontPaths[j], '\\');\\n',\n          '\\t\\t}\\n'\n        ].join('');\n      }\n\n      if (markup) {\n        markup = [\n          '\\t<style type=\"text/css\">',\n          '<![CDATA[\\n',\n          markup,\n          ']]>',\n          '</style>\\n'\n        ].join('');\n      }\n\n      return markup;\n    },\n\n    /**\n     * @private\n     */\n    _setSVGObjects: function(markup, reviver) {\n      var instance, i, len, objects = this._objects;\n      for (i = 0, len = objects.length; i < len; i++) {\n        instance = objects[i];\n        if (instance.excludeFromExport) {\n          continue;\n        }\n        this._setSVGObject(markup, instance, reviver);\n      }\n    },\n\n    /**\n     * @private\n     */\n    _setSVGObject: function(markup, instance, reviver) {\n      markup.push(instance.toSVG(reviver));\n    },\n\n    /**\n     * @private\n     */\n    _setSVGBgOverlayImage: function(markup, property, reviver) {\n      if (this[property] && !this[property].excludeFromExport && this[property].toSVG) {\n        markup.push(this[property].toSVG(reviver));\n      }\n    },\n\n    /**\n     * @private\n     */\n    _setSVGBgOverlayColor: function(markup, property) {\n      var filler = this[property + 'Color'], vpt = this.viewportTransform, finalWidth = this.width,\n          finalHeight = this.height;\n      if (!filler) {\n        return;\n      }\n      if (filler.toLive) {\n        var repeat = filler.repeat, iVpt = fabric.util.invertTransform(vpt), shouldInvert = this[property + 'Vpt'],\n            additionalTransform = shouldInvert ? fabric.util.matrixToSVG(iVpt) : '';\n        markup.push(\n          '<rect transform=\"' + additionalTransform + ' translate(', finalWidth / 2, ',', finalHeight / 2, ')\"',\n          ' x=\"', filler.offsetX - finalWidth / 2,\n          '\" y=\"', filler.offsetY - finalHeight / 2, '\" ',\n          'width=\"',\n          (repeat === 'repeat-y' || repeat === 'no-repeat'\n            ? filler.source.width\n            : finalWidth ),\n          '\" height=\"',\n          (repeat === 'repeat-x' || repeat === 'no-repeat'\n            ? filler.source.height\n            : finalHeight),\n          '\" fill=\"url(#SVGID_' + filler.id + ')\"',\n          '></rect>\\n'\n        );\n      }\n      else {\n        markup.push(\n          '<rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" ',\n          'fill=\"', filler, '\"',\n          '></rect>\\n'\n        );\n      }\n    },\n    /* _TO_SVG_END_ */\n\n    /**\n     * Moves an object or the objects of a multiple selection\n     * to the bottom of the stack of drawn objects\n     * @param {fabric.Object} object Object to send to back\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    sendToBack: function (object) {\n      if (!object) {\n        return this;\n      }\n      var activeSelection = this._activeObject,\n          i, obj, objs;\n      if (object === activeSelection && object.type === 'activeSelection') {\n        objs = activeSelection._objects;\n        for (i = objs.length; i--;) {\n          obj = objs[i];\n          removeFromArray(this._objects, obj);\n          this._objects.unshift(obj);\n        }\n      }\n      else {\n        removeFromArray(this._objects, object);\n        this._objects.unshift(object);\n      }\n      this.renderOnAddRemove && this.requestRenderAll();\n      return this;\n    },\n\n    /**\n     * Moves an object or the objects of a multiple selection\n     * to the top of the stack of drawn objects\n     * @param {fabric.Object} object Object to send\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    bringToFront: function (object) {\n      if (!object) {\n        return this;\n      }\n      var activeSelection = this._activeObject,\n          i, obj, objs;\n      if (object === activeSelection && object.type === 'activeSelection') {\n        objs = activeSelection._objects;\n        for (i = 0; i < objs.length; i++) {\n          obj = objs[i];\n          removeFromArray(this._objects, obj);\n          this._objects.push(obj);\n        }\n      }\n      else {\n        removeFromArray(this._objects, object);\n        this._objects.push(object);\n      }\n      this.renderOnAddRemove && this.requestRenderAll();\n      return this;\n    },\n\n    /**\n     * Moves an object or a selection down in stack of drawn objects\n     * An optional parameter, intersecting allows to move the object in behind\n     * the first intersecting object. Where intersection is calculated with\n     * bounding box. If no intersection is found, there will not be change in the\n     * stack.\n     * @param {fabric.Object} object Object to send\n     * @param {Boolean} [intersecting] If `true`, send object behind next lower intersecting object\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    sendBackwards: function (object, intersecting) {\n      if (!object) {\n        return this;\n      }\n      var activeSelection = this._activeObject,\n          i, obj, idx, newIdx, objs, objsMoved = 0;\n\n      if (object === activeSelection && object.type === 'activeSelection') {\n        objs = activeSelection._objects;\n        for (i = 0; i < objs.length; i++) {\n          obj = objs[i];\n          idx = this._objects.indexOf(obj);\n          if (idx > 0 + objsMoved) {\n            newIdx = idx - 1;\n            removeFromArray(this._objects, obj);\n            this._objects.splice(newIdx, 0, obj);\n          }\n          objsMoved++;\n        }\n      }\n      else {\n        idx = this._objects.indexOf(object);\n        if (idx !== 0) {\n          // if object is not on the bottom of stack\n          newIdx = this._findNewLowerIndex(object, idx, intersecting);\n          removeFromArray(this._objects, object);\n          this._objects.splice(newIdx, 0, object);\n        }\n      }\n      this.renderOnAddRemove && this.requestRenderAll();\n      return this;\n    },\n\n    /**\n     * @private\n     */\n    _findNewLowerIndex: function(object, idx, intersecting) {\n      var newIdx, i;\n\n      if (intersecting) {\n        newIdx = idx;\n\n        // traverse down the stack looking for the nearest intersecting object\n        for (i = idx - 1; i >= 0; --i) {\n\n          var isIntersecting = object.intersectsWithObject(this._objects[i]) ||\n                               object.isContainedWithinObject(this._objects[i]) ||\n                               this._objects[i].isContainedWithinObject(object);\n\n          if (isIntersecting) {\n            newIdx = i;\n            break;\n          }\n        }\n      }\n      else {\n        newIdx = idx - 1;\n      }\n\n      return newIdx;\n    },\n\n    /**\n     * Moves an object or a selection up in stack of drawn objects\n     * An optional parameter, intersecting allows to move the object in front\n     * of the first intersecting object. Where intersection is calculated with\n     * bounding box. If no intersection is found, there will not be change in the\n     * stack.\n     * @param {fabric.Object} object Object to send\n     * @param {Boolean} [intersecting] If `true`, send object in front of next upper intersecting object\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    bringForward: function (object, intersecting) {\n      if (!object) {\n        return this;\n      }\n      var activeSelection = this._activeObject,\n          i, obj, idx, newIdx, objs, objsMoved = 0;\n\n      if (object === activeSelection && object.type === 'activeSelection') {\n        objs = activeSelection._objects;\n        for (i = objs.length; i--;) {\n          obj = objs[i];\n          idx = this._objects.indexOf(obj);\n          if (idx < this._objects.length - 1 - objsMoved) {\n            newIdx = idx + 1;\n            removeFromArray(this._objects, obj);\n            this._objects.splice(newIdx, 0, obj);\n          }\n          objsMoved++;\n        }\n      }\n      else {\n        idx = this._objects.indexOf(object);\n        if (idx !== this._objects.length - 1) {\n          // if object is not on top of stack (last item in an array)\n          newIdx = this._findNewUpperIndex(object, idx, intersecting);\n          removeFromArray(this._objects, object);\n          this._objects.splice(newIdx, 0, object);\n        }\n      }\n      this.renderOnAddRemove && this.requestRenderAll();\n      return this;\n    },\n\n    /**\n     * @private\n     */\n    _findNewUpperIndex: function(object, idx, intersecting) {\n      var newIdx, i, len;\n\n      if (intersecting) {\n        newIdx = idx;\n\n        // traverse up the stack looking for the nearest intersecting object\n        for (i = idx + 1, len = this._objects.length; i < len; ++i) {\n\n          var isIntersecting = object.intersectsWithObject(this._objects[i]) ||\n                               object.isContainedWithinObject(this._objects[i]) ||\n                               this._objects[i].isContainedWithinObject(object);\n\n          if (isIntersecting) {\n            newIdx = i;\n            break;\n          }\n        }\n      }\n      else {\n        newIdx = idx + 1;\n      }\n\n      return newIdx;\n    },\n\n    /**\n     * Moves an object to specified level in stack of drawn objects\n     * @param {fabric.Object} object Object to send\n     * @param {Number} index Position to move to\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    moveTo: function (object, index) {\n      removeFromArray(this._objects, object);\n      this._objects.splice(index, 0, object);\n      return this.renderOnAddRemove && this.requestRenderAll();\n    },\n\n    /**\n     * Clears a canvas element and dispose objects\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    dispose: function () {\n      // cancel eventually ongoing renders\n      if (this.isRendering) {\n        fabric.util.cancelAnimFrame(this.isRendering);\n        this.isRendering = 0;\n      }\n      this.forEachObject(function(object) {\n        object.dispose && object.dispose();\n      });\n      this._objects = [];\n      if (this.backgroundImage && this.backgroundImage.dispose) {\n        this.backgroundImage.dispose();\n      }\n      this.backgroundImage = null;\n      if (this.overlayImage && this.overlayImage.dispose) {\n        this.overlayImage.dispose();\n      }\n      this.overlayImage = null;\n      this._iTextInstances = null;\n      this.contextContainer = null;\n      // restore canvas style\n      this.lowerCanvasEl.classList.remove('lower-canvas');\n      fabric.util.setStyle(this.lowerCanvasEl, this._originalCanvasStyle);\n      delete this._originalCanvasStyle;\n      // restore canvas size to original size in case retina scaling was applied\n      this.lowerCanvasEl.setAttribute('width', this.width);\n      this.lowerCanvasEl.setAttribute('height', this.height);\n      fabric.util.cleanUpJsdomNode(this.lowerCanvasEl);\n      this.lowerCanvasEl = undefined;\n      return this;\n    },\n\n    /**\n     * Returns a string representation of an instance\n     * @return {String} string representation of an instance\n     */\n    toString: function () {\n      return '#<fabric.Canvas (' + this.complexity() + '): ' +\n               '{ objects: ' + this._objects.length + ' }>';\n    }\n  });\n\n  extend(fabric.StaticCanvas.prototype, fabric.Observable);\n  extend(fabric.StaticCanvas.prototype, fabric.Collection);\n  extend(fabric.StaticCanvas.prototype, fabric.DataURLExporter);\n\n  extend(fabric.StaticCanvas, /** @lends fabric.StaticCanvas */ {\n\n    /**\n     * @static\n     * @type String\n     * @default\n     */\n    EMPTY_JSON: '{\"objects\": [], \"background\": \"white\"}',\n\n    /**\n     * Provides a way to check support of some of the canvas methods\n     * (either those of HTMLCanvasElement itself, or rendering context)\n     *\n     * @param {String} methodName Method to check support for;\n     *                            Could be one of \"setLineDash\"\n     * @return {Boolean | null} `true` if method is supported (or at least exists),\n     *                          `null` if canvas element or context can not be initialized\n     */\n    supports: function (methodName) {\n      var el = createCanvasElement();\n\n      if (!el || !el.getContext) {\n        return null;\n      }\n\n      var ctx = el.getContext('2d');\n      if (!ctx) {\n        return null;\n      }\n\n      switch (methodName) {\n\n        case 'setLineDash':\n          return typeof ctx.setLineDash !== 'undefined';\n\n        default:\n          return null;\n      }\n    }\n  });\n\n  /**\n   * Returns Object representation of canvas\n   * this alias is provided because if you call JSON.stringify on an instance,\n   * the toJSON object will be invoked if it exists.\n   * Having a toJSON method means you can do JSON.stringify(myCanvas)\n   * @function\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n   * @return {Object} JSON compatible object\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#serialization}\n   * @see {@link http://jsfiddle.net/fabricjs/pec86/|jsFiddle demo}\n   * @example <caption>JSON without additional properties</caption>\n   * var json = canvas.toJSON();\n   * @example <caption>JSON with additional properties included</caption>\n   * var json = canvas.toJSON(['lockMovementX', 'lockMovementY', 'lockRotation', 'lockScalingX', 'lockScalingY']);\n   * @example <caption>JSON without default values</caption>\n   * canvas.includeDefaultValues = false;\n   * var json = canvas.toJSON();\n   */\n  fabric.StaticCanvas.prototype.toJSON = fabric.StaticCanvas.prototype.toObject;\n\n  if (fabric.isLikelyNode) {\n    fabric.StaticCanvas.prototype.createPNGStream = function() {\n      var impl = getNodeCanvas(this.lowerCanvasEl);\n      return impl && impl.createPNGStream();\n    };\n    fabric.StaticCanvas.prototype.createJPEGStream = function(opts) {\n      var impl = getNodeCanvas(this.lowerCanvasEl);\n      return impl && impl.createJPEGStream(opts);\n    };\n  }\n})();\n\n\n/**\n * BaseBrush class\n * @class fabric.BaseBrush\n * @see {@link http://fabricjs.com/freedrawing|Freedrawing demo}\n */\nfabric.BaseBrush = fabric.util.createClass(/** @lends fabric.BaseBrush.prototype */ {\n\n  /**\n   * Color of a brush\n   * @type String\n   * @default\n   */\n  color: 'rgb(0, 0, 0)',\n\n  /**\n   * Width of a brush, has to be a Number, no string literals\n   * @type Number\n   * @default\n   */\n  width: 1,\n\n  /**\n   * Shadow object representing shadow of this shape.\n   * <b>Backwards incompatibility note:</b> This property replaces \"shadowColor\" (String), \"shadowOffsetX\" (Number),\n   * \"shadowOffsetY\" (Number) and \"shadowBlur\" (Number) since v1.2.12\n   * @type fabric.Shadow\n   * @default\n   */\n  shadow: null,\n\n  /**\n   * Line endings style of a brush (one of \"butt\", \"round\", \"square\")\n   * @type String\n   * @default\n   */\n  strokeLineCap: 'round',\n\n  /**\n   * Corner style of a brush (one of \"bevel\", \"round\", \"miter\")\n   * @type String\n   * @default\n   */\n  strokeLineJoin: 'round',\n\n  /**\n   * Maximum miter length (used for strokeLineJoin = \"miter\") of a brush's\n   * @type Number\n   * @default\n   */\n  strokeMiterLimit:         10,\n\n  /**\n   * Stroke Dash Array.\n   * @type Array\n   * @default\n   */\n  strokeDashArray: null,\n\n  /**\n   * When `true`, the free drawing is limited to the whiteboard size. Default to false.\n   * @type Boolean\n   * @default false\n  */\n\n  limitedToCanvasSize: false,\n\n\n  /**\n   * Sets brush styles\n   * @private\n   * @param {CanvasRenderingContext2D} ctx\n   */\n  _setBrushStyles: function (ctx) {\n    ctx.strokeStyle = this.color;\n    ctx.lineWidth = this.width;\n    ctx.lineCap = this.strokeLineCap;\n    ctx.miterLimit = this.strokeMiterLimit;\n    ctx.lineJoin = this.strokeLineJoin;\n    ctx.setLineDash(this.strokeDashArray || []);\n  },\n\n  /**\n   * Sets the transformation on given context\n   * @param {RenderingContext2d} ctx context to render on\n   * @private\n   */\n  _saveAndTransform: function(ctx) {\n    var v = this.canvas.viewportTransform;\n    ctx.save();\n    ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n  },\n\n  /**\n   * Sets brush shadow styles\n   * @private\n   */\n  _setShadow: function() {\n    if (!this.shadow) {\n      return;\n    }\n\n    var canvas = this.canvas,\n        shadow = this.shadow,\n        ctx = canvas.contextTop,\n        zoom = canvas.getZoom();\n    if (canvas && canvas._isRetinaScaling()) {\n      zoom *= fabric.devicePixelRatio;\n    }\n\n    ctx.shadowColor = shadow.color;\n    ctx.shadowBlur = shadow.blur * zoom;\n    ctx.shadowOffsetX = shadow.offsetX * zoom;\n    ctx.shadowOffsetY = shadow.offsetY * zoom;\n  },\n\n  needsFullRender: function() {\n    var color = new fabric.Color(this.color);\n    return color.getAlpha() < 1 || !!this.shadow;\n  },\n\n  /**\n   * Removes brush shadow styles\n   * @private\n   */\n  _resetShadow: function() {\n    var ctx = this.canvas.contextTop;\n\n    ctx.shadowColor = '';\n    ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n  },\n\n  /**\n   * Check is pointer is outside canvas boundaries\n   * @param {Object} pointer\n   * @private\n  */\n  _isOutSideCanvas: function(pointer) {\n    return pointer.x < 0 || pointer.x > this.canvas.getWidth() || pointer.y < 0 || pointer.y > this.canvas.getHeight();\n  }\n});\n\n\n(function() {\n  /**\n   * PencilBrush class\n   * @class fabric.PencilBrush\n   * @extends fabric.BaseBrush\n   */\n  fabric.PencilBrush = fabric.util.createClass(fabric.BaseBrush, /** @lends fabric.PencilBrush.prototype */ {\n\n    /**\n     * Discard points that are less than `decimate` pixel distant from each other\n     * @type Number\n     * @default 0.4\n     */\n    decimate: 0.4,\n\n    /**\n     * Draws a straight line between last recorded point to current pointer\n     * Used for `shift` functionality\n     *\n     * @type boolean\n     * @default false\n     */\n    drawStraightLine: false,\n\n    /**\n     * The event modifier key that makes the brush draw a straight line.\n     * If `null` or 'none' or any other string that is not a modifier key the feature is disabled.\n     * @type {'altKey' | 'shiftKey' | 'ctrlKey' | 'none' | undefined | null}\n     */\n    straightLineKey: 'shiftKey',\n\n    /**\n     * Constructor\n     * @param {fabric.Canvas} canvas\n     * @return {fabric.PencilBrush} Instance of a pencil brush\n     */\n    initialize: function(canvas) {\n      this.canvas = canvas;\n      this._points = [];\n    },\n\n    needsFullRender: function () {\n      return this.callSuper('needsFullRender') || this._hasStraightLine;\n    },\n\n    /**\n     * Invoked inside on mouse down and mouse move\n     * @param {Object} pointer\n     */\n    _drawSegment: function (ctx, p1, p2) {\n      var midPoint = p1.midPointFrom(p2);\n      ctx.quadraticCurveTo(p1.x, p1.y, midPoint.x, midPoint.y);\n      return midPoint;\n    },\n\n    /**\n     * Invoked on mouse down\n     * @param {Object} pointer\n     */\n    onMouseDown: function(pointer, options) {\n      if (!this.canvas._isMainEvent(options.e)) {\n        return;\n      }\n      this.drawStraightLine = options.e[this.straightLineKey];\n      this._prepareForDrawing(pointer);\n      // capture coordinates immediately\n      // this allows to draw dots (when movement never occurs)\n      this._captureDrawingPath(pointer);\n      this._render();\n    },\n\n    /**\n     * Invoked on mouse move\n     * @param {Object} pointer\n     */\n    onMouseMove: function(pointer, options) {\n      if (!this.canvas._isMainEvent(options.e)) {\n        return;\n      }\n      this.drawStraightLine = options.e[this.straightLineKey];\n      if (this.limitedToCanvasSize === true && this._isOutSideCanvas(pointer)) {\n        return;\n      }\n      if (this._captureDrawingPath(pointer) && this._points.length > 1) {\n        if (this.needsFullRender()) {\n          // redraw curve\n          // clear top canvas\n          this.canvas.clearContext(this.canvas.contextTop);\n          this._render();\n        }\n        else {\n          var points = this._points, length = points.length, ctx = this.canvas.contextTop;\n          // draw the curve update\n          this._saveAndTransform(ctx);\n          if (this.oldEnd) {\n            ctx.beginPath();\n            ctx.moveTo(this.oldEnd.x, this.oldEnd.y);\n          }\n          this.oldEnd = this._drawSegment(ctx, points[length - 2], points[length - 1], true);\n          ctx.stroke();\n          ctx.restore();\n        }\n      }\n    },\n\n    /**\n     * Invoked on mouse up\n     */\n    onMouseUp: function(options) {\n      if (!this.canvas._isMainEvent(options.e)) {\n        return true;\n      }\n      this.drawStraightLine = false;\n      this.oldEnd = undefined;\n      this._finalizeAndAddPath();\n      return false;\n    },\n\n    /**\n     * @private\n     * @param {Object} pointer Actual mouse position related to the canvas.\n     */\n    _prepareForDrawing: function(pointer) {\n\n      var p = new fabric.Point(pointer.x, pointer.y);\n\n      this._reset();\n      this._addPoint(p);\n      this.canvas.contextTop.moveTo(p.x, p.y);\n    },\n\n    /**\n     * @private\n     * @param {fabric.Point} point Point to be added to points array\n     */\n    _addPoint: function(point) {\n      if (this._points.length > 1 && point.eq(this._points[this._points.length - 1])) {\n        return false;\n      }\n      if (this.drawStraightLine && this._points.length > 1) {\n        this._hasStraightLine = true;\n        this._points.pop();\n      }\n      this._points.push(point);\n      return true;\n    },\n\n    /**\n     * Clear points array and set contextTop canvas style.\n     * @private\n     */\n    _reset: function() {\n      this._points = [];\n      this._setBrushStyles(this.canvas.contextTop);\n      this._setShadow();\n      this._hasStraightLine = false;\n    },\n\n    /**\n     * @private\n     * @param {Object} pointer Actual mouse position related to the canvas.\n     */\n    _captureDrawingPath: function(pointer) {\n      var pointerPoint = new fabric.Point(pointer.x, pointer.y);\n      return this._addPoint(pointerPoint);\n    },\n\n    /**\n     * Draw a smooth path on the topCanvas using quadraticCurveTo\n     * @private\n     * @param {CanvasRenderingContext2D} [ctx]\n     */\n    _render: function(ctx) {\n      var i, len,\n          p1 = this._points[0],\n          p2 = this._points[1];\n      ctx = ctx || this.canvas.contextTop;\n      this._saveAndTransform(ctx);\n      ctx.beginPath();\n      //if we only have 2 points in the path and they are the same\n      //it means that the user only clicked the canvas without moving the mouse\n      //then we should be drawing a dot. A path isn't drawn between two identical dots\n      //that's why we set them apart a bit\n      if (this._points.length === 2 && p1.x === p2.x && p1.y === p2.y) {\n        var width = this.width / 1000;\n        p1 = new fabric.Point(p1.x, p1.y);\n        p2 = new fabric.Point(p2.x, p2.y);\n        p1.x -= width;\n        p2.x += width;\n      }\n      ctx.moveTo(p1.x, p1.y);\n\n      for (i = 1, len = this._points.length; i < len; i++) {\n        // we pick the point between pi + 1 & pi + 2 as the\n        // end point and p1 as our control point.\n        this._drawSegment(ctx, p1, p2);\n        p1 = this._points[i];\n        p2 = this._points[i + 1];\n      }\n      // Draw last line as a straight line while\n      // we wait for the next point to be able to calculate\n      // the bezier control point\n      ctx.lineTo(p1.x, p1.y);\n      ctx.stroke();\n      ctx.restore();\n    },\n\n    /**\n     * Converts points to SVG path\n     * @param {Array} points Array of points\n     * @return {(string|number)[][]} SVG path commands\n     */\n    convertPointsToSVGPath: function (points) {\n      var correction = this.width / 1000;\n      return fabric.util.getSmoothPathFromPoints(points, correction);\n    },\n\n    /**\n     * @private\n     * @param {(string|number)[][]} pathData SVG path commands\n     * @returns {boolean}\n     */\n    _isEmptySVGPath: function (pathData) {\n      var pathString = fabric.util.joinPath(pathData);\n      return pathString === 'M 0 0 Q 0 0 0 0 L 0 0';\n    },\n\n    /**\n     * Creates fabric.Path object to add on canvas\n     * @param {(string|number)[][]} pathData Path data\n     * @return {fabric.Path} Path to add on canvas\n     */\n    createPath: function(pathData) {\n      var path = new fabric.Path(pathData, {\n        fill: null,\n        stroke: this.color,\n        strokeWidth: this.width,\n        strokeLineCap: this.strokeLineCap,\n        strokeMiterLimit: this.strokeMiterLimit,\n        strokeLineJoin: this.strokeLineJoin,\n        strokeDashArray: this.strokeDashArray,\n      });\n      if (this.shadow) {\n        this.shadow.affectStroke = true;\n        path.shadow = new fabric.Shadow(this.shadow);\n      }\n\n      return path;\n    },\n\n    /**\n     * Decimate points array with the decimate value\n     */\n    decimatePoints: function(points, distance) {\n      if (points.length <= 2) {\n        return points;\n      }\n      var zoom = this.canvas.getZoom(), adjustedDistance = Math.pow(distance / zoom, 2),\n          i, l = points.length - 1, lastPoint = points[0], newPoints = [lastPoint],\n          cDistance;\n      for (i = 1; i < l - 1; i++) {\n        cDistance = Math.pow(lastPoint.x - points[i].x, 2) + Math.pow(lastPoint.y - points[i].y, 2);\n        if (cDistance >= adjustedDistance) {\n          lastPoint = points[i];\n          newPoints.push(lastPoint);\n        }\n      }\n      /**\n       * Add the last point from the original line to the end of the array.\n       * This ensures decimate doesn't delete the last point on the line, and ensures the line is > 1 point.\n       */\n      newPoints.push(points[l]);\n      return newPoints;\n    },\n\n    /**\n     * On mouseup after drawing the path on contextTop canvas\n     * we use the points captured to create an new fabric path object\n     * and add it to the fabric canvas.\n     */\n    _finalizeAndAddPath: function() {\n      var ctx = this.canvas.contextTop;\n      ctx.closePath();\n      if (this.decimate) {\n        this._points = this.decimatePoints(this._points, this.decimate);\n      }\n      var pathData = this.convertPointsToSVGPath(this._points);\n      if (this._isEmptySVGPath(pathData)) {\n        // do not create 0 width/height paths, as they are\n        // rendered inconsistently across browsers\n        // Firefox 4, for example, renders a dot,\n        // whereas Chrome 10 renders nothing\n        this.canvas.requestRenderAll();\n        return;\n      }\n\n      var path = this.createPath(pathData);\n      this.canvas.clearContext(this.canvas.contextTop);\n      this.canvas.fire('before:path:created', { path: path });\n      this.canvas.add(path);\n      this.canvas.requestRenderAll();\n      path.setCoords();\n      this._resetShadow();\n\n\n      // fire event 'path' created\n      this.canvas.fire('path:created', { path: path });\n    }\n  });\n})();\n\n\n/**\n * CircleBrush class\n * @class fabric.CircleBrush\n */\nfabric.CircleBrush = fabric.util.createClass(fabric.BaseBrush, /** @lends fabric.CircleBrush.prototype */ {\n\n  /**\n   * Width of a brush\n   * @type Number\n   * @default\n   */\n  width: 10,\n\n  /**\n   * Constructor\n   * @param {fabric.Canvas} canvas\n   * @return {fabric.CircleBrush} Instance of a circle brush\n   */\n  initialize: function(canvas) {\n    this.canvas = canvas;\n    this.points = [];\n  },\n\n  /**\n   * Invoked inside on mouse down and mouse move\n   * @param {Object} pointer\n   */\n  drawDot: function(pointer) {\n    var point = this.addPoint(pointer),\n        ctx = this.canvas.contextTop;\n    this._saveAndTransform(ctx);\n    this.dot(ctx, point);\n    ctx.restore();\n  },\n\n  dot: function(ctx, point) {\n    ctx.fillStyle = point.fill;\n    ctx.beginPath();\n    ctx.arc(point.x, point.y, point.radius, 0, Math.PI * 2, false);\n    ctx.closePath();\n    ctx.fill();\n  },\n\n  /**\n   * Invoked on mouse down\n   */\n  onMouseDown: function(pointer) {\n    this.points.length = 0;\n    this.canvas.clearContext(this.canvas.contextTop);\n    this._setShadow();\n    this.drawDot(pointer);\n  },\n\n  /**\n   * Render the full state of the brush\n   * @private\n   */\n  _render: function() {\n    var ctx  = this.canvas.contextTop, i, len,\n        points = this.points;\n    this._saveAndTransform(ctx);\n    for (i = 0, len = points.length; i < len; i++) {\n      this.dot(ctx, points[i]);\n    }\n    ctx.restore();\n  },\n\n  /**\n   * Invoked on mouse move\n   * @param {Object} pointer\n   */\n  onMouseMove: function(pointer) {\n    if (this.limitedToCanvasSize === true && this._isOutSideCanvas(pointer)) {\n      return;\n    }\n    if (this.needsFullRender()) {\n      this.canvas.clearContext(this.canvas.contextTop);\n      this.addPoint(pointer);\n      this._render();\n    }\n    else {\n      this.drawDot(pointer);\n    }\n  },\n\n  /**\n   * Invoked on mouse up\n   */\n  onMouseUp: function() {\n    var originalRenderOnAddRemove = this.canvas.renderOnAddRemove, i, len;\n    this.canvas.renderOnAddRemove = false;\n\n    var circles = [];\n\n    for (i = 0, len = this.points.length; i < len; i++) {\n      var point = this.points[i],\n          circle = new fabric.Circle({\n            radius: point.radius,\n            left: point.x,\n            top: point.y,\n            originX: 'center',\n            originY: 'center',\n            fill: point.fill\n          });\n\n      this.shadow && (circle.shadow = new fabric.Shadow(this.shadow));\n\n      circles.push(circle);\n    }\n    var group = new fabric.Group(circles);\n    group.canvas = this.canvas;\n\n    this.canvas.fire('before:path:created', { path: group });\n    this.canvas.add(group);\n    this.canvas.fire('path:created', { path: group });\n\n    this.canvas.clearContext(this.canvas.contextTop);\n    this._resetShadow();\n    this.canvas.renderOnAddRemove = originalRenderOnAddRemove;\n    this.canvas.requestRenderAll();\n  },\n\n  /**\n   * @param {Object} pointer\n   * @return {fabric.Point} Just added pointer point\n   */\n  addPoint: function(pointer) {\n    var pointerPoint = new fabric.Point(pointer.x, pointer.y),\n\n        circleRadius = fabric.util.getRandomInt(\n          Math.max(0, this.width - 20), this.width + 20) / 2,\n\n        circleColor = new fabric.Color(this.color)\n          .setAlpha(fabric.util.getRandomInt(0, 100) / 100)\n          .toRgba();\n\n    pointerPoint.radius = circleRadius;\n    pointerPoint.fill = circleColor;\n\n    this.points.push(pointerPoint);\n\n    return pointerPoint;\n  }\n});\n\n\n/**\n * SprayBrush class\n * @class fabric.SprayBrush\n */\nfabric.SprayBrush = fabric.util.createClass( fabric.BaseBrush, /** @lends fabric.SprayBrush.prototype */ {\n\n  /**\n   * Width of a spray\n   * @type Number\n   * @default\n   */\n  width:              10,\n\n  /**\n   * Density of a spray (number of dots per chunk)\n   * @type Number\n   * @default\n   */\n  density:            20,\n\n  /**\n   * Width of spray dots\n   * @type Number\n   * @default\n   */\n  dotWidth:           1,\n\n  /**\n   * Width variance of spray dots\n   * @type Number\n   * @default\n   */\n  dotWidthVariance:   1,\n\n  /**\n   * Whether opacity of a dot should be random\n   * @type Boolean\n   * @default\n   */\n  randomOpacity:        false,\n\n  /**\n   * Whether overlapping dots (rectangles) should be removed (for performance reasons)\n   * @type Boolean\n   * @default\n   */\n  optimizeOverlapping:  true,\n\n  /**\n   * Constructor\n   * @param {fabric.Canvas} canvas\n   * @return {fabric.SprayBrush} Instance of a spray brush\n   */\n  initialize: function(canvas) {\n    this.canvas = canvas;\n    this.sprayChunks = [];\n  },\n\n  /**\n   * Invoked on mouse down\n   * @param {Object} pointer\n   */\n  onMouseDown: function(pointer) {\n    this.sprayChunks.length = 0;\n    this.canvas.clearContext(this.canvas.contextTop);\n    this._setShadow();\n\n    this.addSprayChunk(pointer);\n    this.render(this.sprayChunkPoints);\n  },\n\n  /**\n   * Invoked on mouse move\n   * @param {Object} pointer\n   */\n  onMouseMove: function(pointer) {\n    if (this.limitedToCanvasSize === true && this._isOutSideCanvas(pointer)) {\n      return;\n    }\n    this.addSprayChunk(pointer);\n    this.render(this.sprayChunkPoints);\n  },\n\n  /**\n   * Invoked on mouse up\n   */\n  onMouseUp: function() {\n    var originalRenderOnAddRemove = this.canvas.renderOnAddRemove;\n    this.canvas.renderOnAddRemove = false;\n\n    var rects = [];\n\n    for (var i = 0, ilen = this.sprayChunks.length; i < ilen; i++) {\n      var sprayChunk = this.sprayChunks[i];\n\n      for (var j = 0, jlen = sprayChunk.length; j < jlen; j++) {\n\n        var rect = new fabric.Rect({\n          width: sprayChunk[j].width,\n          height: sprayChunk[j].width,\n          left: sprayChunk[j].x + 1,\n          top: sprayChunk[j].y + 1,\n          originX: 'center',\n          originY: 'center',\n          fill: this.color\n        });\n        rects.push(rect);\n      }\n    }\n\n    if (this.optimizeOverlapping) {\n      rects = this._getOptimizedRects(rects);\n    }\n\n    var group = new fabric.Group(rects);\n    this.shadow && group.set('shadow', new fabric.Shadow(this.shadow));\n    this.canvas.fire('before:path:created', { path: group });\n    this.canvas.add(group);\n    this.canvas.fire('path:created', { path: group });\n\n    this.canvas.clearContext(this.canvas.contextTop);\n    this._resetShadow();\n    this.canvas.renderOnAddRemove = originalRenderOnAddRemove;\n    this.canvas.requestRenderAll();\n  },\n\n  /**\n   * @private\n   * @param {Array} rects\n   */\n  _getOptimizedRects: function(rects) {\n\n    // avoid creating duplicate rects at the same coordinates\n    var uniqueRects = { }, key, i, len;\n\n    for (i = 0, len = rects.length; i < len; i++) {\n      key = rects[i].left + '' + rects[i].top;\n      if (!uniqueRects[key]) {\n        uniqueRects[key] = rects[i];\n      }\n    }\n    var uniqueRectsArray = [];\n    for (key in uniqueRects) {\n      uniqueRectsArray.push(uniqueRects[key]);\n    }\n\n    return uniqueRectsArray;\n  },\n\n  /**\n   * Render new chunk of spray brush\n   */\n  render: function(sprayChunk) {\n    var ctx = this.canvas.contextTop, i, len;\n    ctx.fillStyle = this.color;\n\n    this._saveAndTransform(ctx);\n\n    for (i = 0, len = sprayChunk.length; i < len; i++) {\n      var point = sprayChunk[i];\n      if (typeof point.opacity !== 'undefined') {\n        ctx.globalAlpha = point.opacity;\n      }\n      ctx.fillRect(point.x, point.y, point.width, point.width);\n    }\n    ctx.restore();\n  },\n\n  /**\n   * Render all spray chunks\n   */\n  _render: function() {\n    var ctx = this.canvas.contextTop, i, ilen;\n    ctx.fillStyle = this.color;\n\n    this._saveAndTransform(ctx);\n\n    for (i = 0, ilen = this.sprayChunks.length; i < ilen; i++) {\n      this.render(this.sprayChunks[i]);\n    }\n    ctx.restore();\n  },\n\n  /**\n   * @param {Object} pointer\n   */\n  addSprayChunk: function(pointer) {\n    this.sprayChunkPoints = [];\n\n    var x, y, width, radius = this.width / 2, i;\n\n    for (i = 0; i < this.density; i++) {\n\n      x = fabric.util.getRandomInt(pointer.x - radius, pointer.x + radius);\n      y = fabric.util.getRandomInt(pointer.y - radius, pointer.y + radius);\n\n      if (this.dotWidthVariance) {\n        width = fabric.util.getRandomInt(\n          // bottom clamp width to 1\n          Math.max(1, this.dotWidth - this.dotWidthVariance),\n          this.dotWidth + this.dotWidthVariance);\n      }\n      else {\n        width = this.dotWidth;\n      }\n\n      var point = new fabric.Point(x, y);\n      point.width = width;\n\n      if (this.randomOpacity) {\n        point.opacity = fabric.util.getRandomInt(0, 100) / 100;\n      }\n\n      this.sprayChunkPoints.push(point);\n    }\n\n    this.sprayChunks.push(this.sprayChunkPoints);\n  }\n});\n\n\n/**\n * PatternBrush class\n * @class fabric.PatternBrush\n * @extends fabric.BaseBrush\n */\nfabric.PatternBrush = fabric.util.createClass(fabric.PencilBrush, /** @lends fabric.PatternBrush.prototype */ {\n\n  getPatternSrc: function() {\n\n    var dotWidth = 20,\n        dotDistance = 5,\n        patternCanvas = fabric.util.createCanvasElement(),\n        patternCtx = patternCanvas.getContext('2d');\n\n    patternCanvas.width = patternCanvas.height = dotWidth + dotDistance;\n\n    patternCtx.fillStyle = this.color;\n    patternCtx.beginPath();\n    patternCtx.arc(dotWidth / 2, dotWidth / 2, dotWidth / 2, 0, Math.PI * 2, false);\n    patternCtx.closePath();\n    patternCtx.fill();\n\n    return patternCanvas;\n  },\n\n  getPatternSrcFunction: function() {\n    return String(this.getPatternSrc).replace('this.color', '\"' + this.color + '\"');\n  },\n\n  /**\n   * Creates \"pattern\" instance property\n   * @param {CanvasRenderingContext2D} ctx\n   */\n  getPattern: function(ctx) {\n    return ctx.createPattern(this.source || this.getPatternSrc(), 'repeat');\n  },\n\n  /**\n   * Sets brush styles\n   * @param {CanvasRenderingContext2D} ctx\n   */\n  _setBrushStyles: function(ctx) {\n    this.callSuper('_setBrushStyles', ctx);\n    ctx.strokeStyle = this.getPattern(ctx);\n  },\n\n  /**\n   * Creates path\n   */\n  createPath: function(pathData) {\n    var path = this.callSuper('createPath', pathData),\n        topLeft = path._getLeftTopCoords().scalarAdd(path.strokeWidth / 2);\n\n    path.stroke = new fabric.Pattern({\n      source: this.source || this.getPatternSrcFunction(),\n      offsetX: -topLeft.x,\n      offsetY: -topLeft.y\n    });\n    return path;\n  }\n});\n\n\n(function() {\n\n  var getPointer = fabric.util.getPointer,\n      degreesToRadians = fabric.util.degreesToRadians,\n      isTouchEvent = fabric.util.isTouchEvent;\n\n  /**\n   * Canvas class\n   * @class fabric.Canvas\n   * @extends fabric.StaticCanvas\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#canvas}\n   * @see {@link fabric.Canvas#initialize} for constructor definition\n   *\n   * @fires object:modified at the end of a transform or any change when statefull is true\n   * @fires object:rotating while an object is being rotated from the control\n   * @fires object:scaling while an object is being scaled by controls\n   * @fires object:moving while an object is being dragged\n   * @fires object:skewing while an object is being skewed from the controls\n   *\n   * @fires before:transform before a transform is is started\n   * @fires before:selection:cleared\n   * @fires selection:cleared\n   * @fires selection:updated\n   * @fires selection:created\n   *\n   * @fires path:created after a drawing operation ends and the path is added\n   * @fires mouse:down\n   * @fires mouse:move\n   * @fires mouse:up\n   * @fires mouse:down:before  on mouse down, before the inner fabric logic runs\n   * @fires mouse:move:before on mouse move, before the inner fabric logic runs\n   * @fires mouse:up:before on mouse up, before the inner fabric logic runs\n   * @fires mouse:over\n   * @fires mouse:out\n   * @fires mouse:dblclick whenever a native dbl click event fires on the canvas.\n   *\n   * @fires dragover\n   * @fires dragenter\n   * @fires dragleave\n   * @fires drop:before before drop event. same native event. This is added to handle edge cases\n   * @fires drop\n   * @fires after:render at the end of the render process, receives the context in the callback\n   * @fires before:render at start the render process, receives the context in the callback\n   *\n   */\n  fabric.Canvas = fabric.util.createClass(fabric.StaticCanvas, /** @lends fabric.Canvas.prototype */ {\n\n    /**\n     * Constructor\n     * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\n     * @param {Object} [options] Options object\n     * @return {Object} thisArg\n     */\n    initialize: function(el, options) {\n      options || (options = { });\n      this.renderAndResetBound = this.renderAndReset.bind(this);\n      this.requestRenderAllBound = this.requestRenderAll.bind(this);\n      this._initStatic(el, options);\n      this._initInteractive();\n      this._createCacheCanvas();\n    },\n\n    /**\n     * When true, objects can be transformed by one side (unproportionally)\n     * when dragged on the corners that normally would not do that.\n     * @type Boolean\n     * @default\n     * @since fabric 4.0 // changed name and default value\n     */\n    uniformScaling:      true,\n\n    /**\n     * Indicates which key switches uniform scaling.\n     * values: 'altKey', 'shiftKey', 'ctrlKey'.\n     * If `null` or 'none' or any other string that is not a modifier key\n     * feature is disabled.\n     * totally wrong named. this sounds like `uniform scaling`\n     * if Canvas.uniformScaling is true, pressing this will set it to false\n     * and viceversa.\n     * @since 1.6.2\n     * @type String\n     * @default\n     */\n    uniScaleKey:           'shiftKey',\n\n    /**\n     * When true, objects use center point as the origin of scale transformation.\n     * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\n     * @since 1.3.4\n     * @type Boolean\n     * @default\n     */\n    centeredScaling:        false,\n\n    /**\n     * When true, objects use center point as the origin of rotate transformation.\n     * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\n     * @since 1.3.4\n     * @type Boolean\n     * @default\n     */\n    centeredRotation:       false,\n\n    /**\n     * Indicates which key enable centered Transform\n     * values: 'altKey', 'shiftKey', 'ctrlKey'.\n     * If `null` or 'none' or any other string that is not a modifier key\n     * feature is disabled feature disabled.\n     * @since 1.6.2\n     * @type String\n     * @default\n     */\n    centeredKey:           'altKey',\n\n    /**\n     * Indicates which key enable alternate action on corner\n     * values: 'altKey', 'shiftKey', 'ctrlKey'.\n     * If `null` or 'none' or any other string that is not a modifier key\n     * feature is disabled feature disabled.\n     * @since 1.6.2\n     * @type String\n     * @default\n     */\n    altActionKey:           'shiftKey',\n\n    /**\n     * Indicates that canvas is interactive. This property should not be changed.\n     * @type Boolean\n     * @default\n     */\n    interactive:            true,\n\n    /**\n     * Indicates whether group selection should be enabled\n     * @type Boolean\n     * @default\n     */\n    selection:              true,\n\n    /**\n     * Indicates which key or keys enable multiple click selection\n     * Pass value as a string or array of strings\n     * values: 'altKey', 'shiftKey', 'ctrlKey'.\n     * If `null` or empty or containing any other string that is not a modifier key\n     * feature is disabled.\n     * @since 1.6.2\n     * @type String|Array\n     * @default\n     */\n    selectionKey:           'shiftKey',\n\n    /**\n     * Indicates which key enable alternative selection\n     * in case of target overlapping with active object\n     * values: 'altKey', 'shiftKey', 'ctrlKey'.\n     * For a series of reason that come from the general expectations on how\n     * things should work, this feature works only for preserveObjectStacking true.\n     * If `null` or 'none' or any other string that is not a modifier key\n     * feature is disabled.\n     * @since 1.6.5\n     * @type null|String\n     * @default\n     */\n    altSelectionKey:           null,\n\n    /**\n     * Color of selection\n     * @type String\n     * @default\n     */\n    selectionColor:         'rgba(100, 100, 255, 0.3)', // blue\n\n    /**\n     * Default dash array pattern\n     * If not empty the selection border is dashed\n     * @type Array\n     */\n    selectionDashArray:     [],\n\n    /**\n     * Color of the border of selection (usually slightly darker than color of selection itself)\n     * @type String\n     * @default\n     */\n    selectionBorderColor:   'rgba(255, 255, 255, 0.3)',\n\n    /**\n     * Width of a line used in object/group selection\n     * @type Number\n     * @default\n     */\n    selectionLineWidth:     1,\n\n    /**\n     * Select only shapes that are fully contained in the dragged selection rectangle.\n     * @type Boolean\n     * @default\n     */\n    selectionFullyContained: false,\n\n    /**\n     * Default cursor value used when hovering over an object on canvas\n     * @type String\n     * @default\n     */\n    hoverCursor:            'move',\n\n    /**\n     * Default cursor value used when moving an object on canvas\n     * @type String\n     * @default\n     */\n    moveCursor:             'move',\n\n    /**\n     * Default cursor value used for the entire canvas\n     * @type String\n     * @default\n     */\n    defaultCursor:          'default',\n\n    /**\n     * Cursor value used during free drawing\n     * @type String\n     * @default\n     */\n    freeDrawingCursor:      'crosshair',\n\n    /**\n     * Cursor value used for disabled elements ( corners with disabled action )\n     * @type String\n     * @since 2.0.0\n     * @default\n     */\n    notAllowedCursor:         'not-allowed',\n\n    /**\n     * Default element class that's given to wrapper (div) element of canvas\n     * @type String\n     * @default\n     */\n    containerClass:         'canvas-container',\n\n    /**\n     * When true, object detection happens on per-pixel basis rather than on per-bounding-box\n     * @type Boolean\n     * @default\n     */\n    perPixelTargetFind:     false,\n\n    /**\n     * Number of pixels around target pixel to tolerate (consider active) during object detection\n     * @type Number\n     * @default\n     */\n    targetFindTolerance:    0,\n\n    /**\n     * When true, target detection is skipped. Target detection will return always undefined.\n     * click selection won't work anymore, events will fire with no targets.\n     * if something is selected before setting it to true, it will be deselected at the first click.\n     * area selection will still work. check the `selection` property too.\n     * if you deactivate both, you should look into staticCanvas.\n     * @type Boolean\n     * @default\n     */\n    skipTargetFind:         false,\n\n    /**\n     * When true, mouse events on canvas (mousedown/mousemove/mouseup) result in free drawing.\n     * After mousedown, mousemove creates a shape,\n     * and then mouseup finalizes it and adds an instance of `fabric.Path` onto canvas.\n     * @tutorial {@link http://fabricjs.com/fabric-intro-part-4#free_drawing}\n     * @type Boolean\n     * @default\n     */\n    isDrawingMode:          false,\n\n    /**\n     * Indicates whether objects should remain in current stack position when selected.\n     * When false objects are brought to top and rendered as part of the selection group\n     * @type Boolean\n     * @default\n     */\n    preserveObjectStacking: false,\n\n    /**\n     * Indicates the angle that an object will lock to while rotating.\n     * @type Number\n     * @since 1.6.7\n     * @default\n     */\n    snapAngle: 0,\n\n    /**\n     * Indicates the distance from the snapAngle the rotation will lock to the snapAngle.\n     * When `null`, the snapThreshold will default to the snapAngle.\n     * @type null|Number\n     * @since 1.6.7\n     * @default\n     */\n    snapThreshold: null,\n\n    /**\n     * Indicates if the right click on canvas can output the context menu or not\n     * @type Boolean\n     * @since 1.6.5\n     * @default\n     */\n    stopContextMenu: false,\n\n    /**\n     * Indicates if the canvas can fire right click events\n     * @type Boolean\n     * @since 1.6.5\n     * @default\n     */\n    fireRightClick: false,\n\n    /**\n     * Indicates if the canvas can fire middle click events\n     * @type Boolean\n     * @since 1.7.8\n     * @default\n     */\n    fireMiddleClick: false,\n\n    /**\n     * Keep track of the subTargets for Mouse Events\n     * @type fabric.Object[]\n     */\n    targets: [],\n\n    /**\n     * When the option is enabled, PointerEvent is used instead of MouseEvent.\n     * @type Boolean\n     * @default\n     */\n    enablePointerEvents: false,\n\n    /**\n     * Keep track of the hovered target\n     * @type fabric.Object\n     * @private\n     */\n    _hoveredTarget: null,\n\n    /**\n     * hold the list of nested targets hovered\n     * @type fabric.Object[]\n     * @private\n     */\n    _hoveredTargets: [],\n\n    /**\n     * @private\n     */\n    _initInteractive: function() {\n      this._currentTransform = null;\n      this._groupSelector = null;\n      this._initWrapperElement();\n      this._createUpperCanvas();\n      this._initEventListeners();\n\n      this._initRetinaScaling();\n\n      this.freeDrawingBrush = fabric.PencilBrush && new fabric.PencilBrush(this);\n\n      this.calcOffset();\n    },\n\n    /**\n     * Divides objects in two groups, one to render immediately\n     * and one to render as activeGroup.\n     * @return {Array} objects to render immediately and pushes the other in the activeGroup.\n     */\n    _chooseObjectsToRender: function() {\n      var activeObjects = this.getActiveObjects(),\n          object, objsToRender, activeGroupObjects;\n\n      if (activeObjects.length > 0 && !this.preserveObjectStacking) {\n        objsToRender = [];\n        activeGroupObjects = [];\n        for (var i = 0, length = this._objects.length; i < length; i++) {\n          object = this._objects[i];\n          if (activeObjects.indexOf(object) === -1 ) {\n            objsToRender.push(object);\n          }\n          else {\n            activeGroupObjects.push(object);\n          }\n        }\n        if (activeObjects.length > 1) {\n          this._activeObject._objects = activeGroupObjects;\n        }\n        objsToRender.push.apply(objsToRender, activeGroupObjects);\n      }\n      else {\n        objsToRender = this._objects;\n      }\n      return objsToRender;\n    },\n\n    /**\n     * Renders both the top canvas and the secondary container canvas.\n     * @return {fabric.Canvas} instance\n     * @chainable\n     */\n    renderAll: function () {\n      if (this.contextTopDirty && !this._groupSelector && !this.isDrawingMode) {\n        this.clearContext(this.contextTop);\n        this.contextTopDirty = false;\n      }\n      if (this.hasLostContext) {\n        this.renderTopLayer(this.contextTop);\n        this.hasLostContext = false;\n      }\n      var canvasToDrawOn = this.contextContainer;\n      this.renderCanvas(canvasToDrawOn, this._chooseObjectsToRender());\n      return this;\n    },\n\n    renderTopLayer: function(ctx) {\n      ctx.save();\n      if (this.isDrawingMode && this._isCurrentlyDrawing) {\n        this.freeDrawingBrush && this.freeDrawingBrush._render();\n        this.contextTopDirty = true;\n      }\n      // we render the top context - last object\n      if (this.selection && this._groupSelector) {\n        this._drawSelection(ctx);\n        this.contextTopDirty = true;\n      }\n      ctx.restore();\n    },\n\n    /**\n     * Method to render only the top canvas.\n     * Also used to render the group selection box.\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    renderTop: function () {\n      var ctx = this.contextTop;\n      this.clearContext(ctx);\n      this.renderTopLayer(ctx);\n      this.fire('after:render');\n      return this;\n    },\n\n    /**\n     * @private\n     */\n    _normalizePointer: function (object, pointer) {\n      var m = object.calcTransformMatrix(),\n          invertedM = fabric.util.invertTransform(m),\n          vptPointer = this.restorePointerVpt(pointer);\n      return fabric.util.transformPoint(vptPointer, invertedM);\n    },\n\n    /**\n     * Returns true if object is transparent at a certain location\n     * @param {fabric.Object} target Object to check\n     * @param {Number} x Left coordinate\n     * @param {Number} y Top coordinate\n     * @return {Boolean}\n     */\n    isTargetTransparent: function (target, x, y) {\n      // in case the target is the activeObject, we cannot execute this optimization\n      // because we need to draw controls too.\n      if (target.shouldCache() && target._cacheCanvas && target !== this._activeObject) {\n        var normalizedPointer = this._normalizePointer(target, {x: x, y: y}),\n            targetRelativeX = Math.max(target.cacheTranslationX + (normalizedPointer.x * target.zoomX), 0),\n            targetRelativeY = Math.max(target.cacheTranslationY + (normalizedPointer.y * target.zoomY), 0);\n\n        var isTransparent = fabric.util.isTransparent(\n          target._cacheContext, Math.round(targetRelativeX), Math.round(targetRelativeY), this.targetFindTolerance);\n\n        return isTransparent;\n      }\n\n      var ctx = this.contextCache,\n          originalColor = target.selectionBackgroundColor, v = this.viewportTransform;\n\n      target.selectionBackgroundColor = '';\n\n      this.clearContext(ctx);\n\n      ctx.save();\n      ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n      target.render(ctx);\n      ctx.restore();\n\n      target.selectionBackgroundColor = originalColor;\n\n      var isTransparent = fabric.util.isTransparent(\n        ctx, x, y, this.targetFindTolerance);\n\n      return isTransparent;\n    },\n\n    /**\n     * takes an event and determines if selection key has been pressed\n     * @private\n     * @param {Event} e Event object\n     */\n    _isSelectionKeyPressed: function(e) {\n      var selectionKeyPressed = false;\n\n      if (Array.isArray(this.selectionKey)) {\n        selectionKeyPressed = !!this.selectionKey.find(function(key) { return e[key] === true; });\n      }\n      else {\n        selectionKeyPressed = e[this.selectionKey];\n      }\n\n      return selectionKeyPressed;\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object\n     * @param {fabric.Object} target\n     */\n    _shouldClearSelection: function (e, target) {\n      var activeObjects = this.getActiveObjects(),\n          activeObject = this._activeObject;\n\n      return (\n        !target\n        ||\n        (target &&\n          activeObject &&\n          activeObjects.length > 1 &&\n          activeObjects.indexOf(target) === -1 &&\n          activeObject !== target &&\n          !this._isSelectionKeyPressed(e))\n        ||\n        (target && !target.evented)\n        ||\n        (target &&\n          !target.selectable &&\n          activeObject &&\n          activeObject !== target)\n      );\n    },\n\n    /**\n     * centeredScaling from object can't override centeredScaling from canvas.\n     * this should be fixed, since object setting should take precedence over canvas.\n     * also this should be something that will be migrated in the control properties.\n     * as ability to define the origin of the transformation that the control provide.\n     * @private\n     * @param {fabric.Object} target\n     * @param {String} action\n     * @param {Boolean} altKey\n     */\n    _shouldCenterTransform: function (target, action, altKey) {\n      if (!target) {\n        return;\n      }\n\n      var centerTransform;\n\n      if (action === 'scale' || action === 'scaleX' || action === 'scaleY' || action === 'resizing') {\n        centerTransform = this.centeredScaling || target.centeredScaling;\n      }\n      else if (action === 'rotate') {\n        centerTransform = this.centeredRotation || target.centeredRotation;\n      }\n\n      return centerTransform ? !altKey : altKey;\n    },\n\n    /**\n     * should disappear before release 4.0\n     * @private\n     */\n    _getOriginFromCorner: function(target, corner) {\n      var origin = {\n        x: target.originX,\n        y: target.originY\n      };\n\n      if (corner === 'ml' || corner === 'tl' || corner === 'bl') {\n        origin.x = 'right';\n      }\n      else if (corner === 'mr' || corner === 'tr' || corner === 'br') {\n        origin.x = 'left';\n      }\n\n      if (corner === 'tl' || corner === 'mt' || corner === 'tr') {\n        origin.y = 'bottom';\n      }\n      else if (corner === 'bl' || corner === 'mb' || corner === 'br') {\n        origin.y = 'top';\n      }\n      return origin;\n    },\n\n    /**\n     * @private\n     * @param {Boolean} alreadySelected true if target is already selected\n     * @param {String} corner a string representing the corner ml, mr, tl ...\n     * @param {Event} e Event object\n     * @param {fabric.Object} [target] inserted back to help overriding. Unused\n     */\n    _getActionFromCorner: function(alreadySelected, corner, e, target) {\n      if (!corner || !alreadySelected) {\n        return 'drag';\n      }\n      var control = target.controls[corner];\n      return control.getActionName(e, control, target);\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object\n     * @param {fabric.Object} target\n     */\n    _setupCurrentTransform: function (e, target, alreadySelected) {\n      if (!target) {\n        return;\n      }\n\n      var pointer = this.getPointer(e), corner = target.__corner,\n          control = target.controls[corner],\n          actionHandler = (alreadySelected && corner) ?\n            control.getActionHandler(e, target, control) : fabric.controlsUtils.dragHandler,\n          action = this._getActionFromCorner(alreadySelected, corner, e, target),\n          origin = this._getOriginFromCorner(target, corner),\n          altKey = e[this.centeredKey],\n          transform = {\n            target: target,\n            action: action,\n            actionHandler: actionHandler,\n            corner: corner,\n            scaleX: target.scaleX,\n            scaleY: target.scaleY,\n            skewX: target.skewX,\n            skewY: target.skewY,\n            // used by transation\n            offsetX: pointer.x - target.left,\n            offsetY: pointer.y - target.top,\n            originX: origin.x,\n            originY: origin.y,\n            ex: pointer.x,\n            ey: pointer.y,\n            lastX: pointer.x,\n            lastY: pointer.y,\n            // unsure they are useful anymore.\n            // left: target.left,\n            // top: target.top,\n            theta: degreesToRadians(target.angle),\n            // end of unsure\n            width: target.width * target.scaleX,\n            shiftKey: e.shiftKey,\n            altKey: altKey,\n            original: fabric.util.saveObjectTransform(target),\n          };\n\n      if (this._shouldCenterTransform(target, action, altKey)) {\n        transform.originX = 'center';\n        transform.originY = 'center';\n      }\n      transform.original.originX = origin.x;\n      transform.original.originY = origin.y;\n      this._currentTransform = transform;\n      this._beforeTransform(e);\n    },\n\n    /**\n     * Set the cursor type of the canvas element\n     * @param {String} value Cursor type of the canvas element.\n     * @see http://www.w3.org/TR/css3-ui/#cursor\n     */\n    setCursor: function (value) {\n      this.upperCanvasEl.style.cursor = value;\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx to draw the selection on\n     */\n    _drawSelection: function (ctx) {\n      var selector = this._groupSelector,\n          viewportStart = new fabric.Point(selector.ex, selector.ey),\n          start = fabric.util.transformPoint(viewportStart, this.viewportTransform),\n          viewportExtent = new fabric.Point(selector.ex + selector.left, selector.ey + selector.top),\n          extent = fabric.util.transformPoint(viewportExtent, this.viewportTransform),\n          minX = Math.min(start.x, extent.x),\n          minY = Math.min(start.y, extent.y),\n          maxX = Math.max(start.x, extent.x),\n          maxY = Math.max(start.y, extent.y),\n          strokeOffset = this.selectionLineWidth / 2;\n\n      if (this.selectionColor) {\n        ctx.fillStyle = this.selectionColor;\n        ctx.fillRect(minX, minY, maxX - minX, maxY - minY);\n      }\n\n      if (!this.selectionLineWidth || !this.selectionBorderColor) {\n        return;\n      }\n      ctx.lineWidth = this.selectionLineWidth;\n      ctx.strokeStyle = this.selectionBorderColor;\n\n      minX += strokeOffset;\n      minY += strokeOffset;\n      maxX -= strokeOffset;\n      maxY -= strokeOffset;\n      // selection border\n      fabric.Object.prototype._setLineDash.call(this, ctx, this.selectionDashArray);\n      ctx.strokeRect(minX, minY, maxX - minX, maxY - minY);\n    },\n\n    /**\n     * Method that determines what object we are clicking on\n     * the skipGroup parameter is for internal use, is needed for shift+click action\n     * 11/09/2018 TODO: would be cool if findTarget could discern between being a full target\n     * or the outside part of the corner.\n     * @param {Event} e mouse event\n     * @param {Boolean} skipGroup when true, activeGroup is skipped and only objects are traversed through\n     * @return {fabric.Object} the target found\n     */\n    findTarget: function (e, skipGroup) {\n      if (this.skipTargetFind) {\n        return;\n      }\n\n      var ignoreZoom = true,\n          pointer = this.getPointer(e, ignoreZoom),\n          activeObject = this._activeObject,\n          aObjects = this.getActiveObjects(),\n          activeTarget, activeTargetSubs,\n          isTouch = isTouchEvent(e),\n          shouldLookForActive = (aObjects.length > 1 && !skipGroup) || aObjects.length === 1;\n\n      // first check current group (if one exists)\n      // active group does not check sub targets like normal groups.\n      // if active group just exits.\n      this.targets = [];\n\n      // if we hit the corner of an activeObject, let's return that.\n      if (shouldLookForActive && activeObject._findTargetCorner(pointer, isTouch)) {\n        return activeObject;\n      }\n      if (aObjects.length > 1 && !skipGroup && activeObject === this._searchPossibleTargets([activeObject], pointer)) {\n        return activeObject;\n      }\n      if (aObjects.length === 1 &&\n        activeObject === this._searchPossibleTargets([activeObject], pointer)) {\n        if (!this.preserveObjectStacking) {\n          return activeObject;\n        }\n        else {\n          activeTarget = activeObject;\n          activeTargetSubs = this.targets;\n          this.targets = [];\n        }\n      }\n      var target = this._searchPossibleTargets(this._objects, pointer);\n      if (e[this.altSelectionKey] && target && activeTarget && target !== activeTarget) {\n        target = activeTarget;\n        this.targets = activeTargetSubs;\n      }\n      return target;\n    },\n\n    /**\n     * Checks point is inside the object.\n     * @param {Object} [pointer] x,y object of point coordinates we want to check.\n     * @param {fabric.Object} obj Object to test against\n     * @param {Object} [globalPointer] x,y object of point coordinates relative to canvas used to search per pixel target.\n     * @return {Boolean} true if point is contained within an area of given object\n     * @private\n     */\n    _checkTarget: function(pointer, obj, globalPointer) {\n      if (obj &&\n          obj.visible &&\n          obj.evented &&\n          // http://www.geog.ubc.ca/courses/klink/gis.notes/ncgia/u32.html\n          // http://idav.ucdavis.edu/~okreylos/TAship/Spring2000/PointInPolygon.html\n          obj.containsPoint(pointer)\n      ) {\n        if ((this.perPixelTargetFind || obj.perPixelTargetFind) && !obj.isEditing) {\n          var isTransparent = this.isTargetTransparent(obj, globalPointer.x, globalPointer.y);\n          if (!isTransparent) {\n            return true;\n          }\n        }\n        else {\n          return true;\n        }\n      }\n    },\n\n    /**\n     * Function used to search inside objects an object that contains pointer in bounding box or that contains pointerOnCanvas when painted\n     * @param {Array} [objects] objects array to look into\n     * @param {Object} [pointer] x,y object of point coordinates we want to check.\n     * @return {fabric.Object} object that contains pointer\n     * @private\n     */\n    _searchPossibleTargets: function(objects, pointer) {\n      // Cache all targets where their bounding box contains point.\n      var target, i = objects.length, subTarget;\n      // Do not check for currently grouped objects, since we check the parent group itself.\n      // until we call this function specifically to search inside the activeGroup\n      while (i--) {\n        var objToCheck = objects[i];\n        var pointerToUse = objToCheck.group ?\n          this._normalizePointer(objToCheck.group, pointer) : pointer;\n        if (this._checkTarget(pointerToUse, objToCheck, pointer)) {\n          target = objects[i];\n          if (target.subTargetCheck && target instanceof fabric.Group) {\n            subTarget = this._searchPossibleTargets(target._objects, pointer);\n            subTarget && this.targets.push(subTarget);\n          }\n          break;\n        }\n      }\n      return target;\n    },\n\n    /**\n     * Returns pointer coordinates without the effect of the viewport\n     * @param {Object} pointer with \"x\" and \"y\" number values\n     * @return {Object} object with \"x\" and \"y\" number values\n     */\n    restorePointerVpt: function(pointer) {\n      return fabric.util.transformPoint(\n        pointer,\n        fabric.util.invertTransform(this.viewportTransform)\n      );\n    },\n\n    /**\n     * Returns pointer coordinates relative to canvas.\n     * Can return coordinates with or without viewportTransform.\n     * ignoreZoom false gives back coordinates that represent\n     * the point clicked on canvas element.\n     * ignoreZoom true gives back coordinates after being processed\n     * by the viewportTransform ( sort of coordinates of what is displayed\n     * on the canvas where you are clicking.\n     * ignoreZoom true = HTMLElement coordinates relative to top,left\n     * ignoreZoom false, default = fabric space coordinates, the same used for shape position\n     * To interact with your shapes top and left you want to use ignoreZoom true\n     * most of the time, while ignoreZoom false will give you coordinates\n     * compatible with the object.oCoords system.\n     * of the time.\n     * @param {Event} e\n     * @param {Boolean} ignoreZoom\n     * @return {Object} object with \"x\" and \"y\" number values\n     */\n    getPointer: function (e, ignoreZoom) {\n      // return cached values if we are in the event processing chain\n      if (this._absolutePointer && !ignoreZoom) {\n        return this._absolutePointer;\n      }\n      if (this._pointer && ignoreZoom) {\n        return this._pointer;\n      }\n\n      var pointer = getPointer(e),\n          upperCanvasEl = this.upperCanvasEl,\n          bounds = upperCanvasEl.getBoundingClientRect(),\n          boundsWidth = bounds.width || 0,\n          boundsHeight = bounds.height || 0,\n          cssScale;\n\n      if (!boundsWidth || !boundsHeight ) {\n        if ('top' in bounds && 'bottom' in bounds) {\n          boundsHeight = Math.abs( bounds.top - bounds.bottom );\n        }\n        if ('right' in bounds && 'left' in bounds) {\n          boundsWidth = Math.abs( bounds.right - bounds.left );\n        }\n      }\n\n      this.calcOffset();\n      pointer.x = pointer.x - this._offset.left;\n      pointer.y = pointer.y - this._offset.top;\n      if (!ignoreZoom) {\n        pointer = this.restorePointerVpt(pointer);\n      }\n\n      var retinaScaling = this.getRetinaScaling();\n      if (retinaScaling !== 1) {\n        pointer.x /= retinaScaling;\n        pointer.y /= retinaScaling;\n      }\n\n      if (boundsWidth === 0 || boundsHeight === 0) {\n        // If bounds are not available (i.e. not visible), do not apply scale.\n        cssScale = { width: 1, height: 1 };\n      }\n      else {\n        cssScale = {\n          width: upperCanvasEl.width / boundsWidth,\n          height: upperCanvasEl.height / boundsHeight\n        };\n      }\n\n      return {\n        x: pointer.x * cssScale.width,\n        y: pointer.y * cssScale.height\n      };\n    },\n\n    /**\n     * @private\n     * @throws {CANVAS_INIT_ERROR} If canvas can not be initialized\n     */\n    _createUpperCanvas: function () {\n      var lowerCanvasClass = this.lowerCanvasEl.className.replace(/\\s*lower-canvas\\s*/, ''),\n          lowerCanvasEl = this.lowerCanvasEl, upperCanvasEl = this.upperCanvasEl;\n\n      // there is no need to create a new upperCanvas element if we have already one.\n      if (upperCanvasEl) {\n        upperCanvasEl.className = '';\n      }\n      else {\n        upperCanvasEl = this._createCanvasElement();\n        this.upperCanvasEl = upperCanvasEl;\n      }\n      fabric.util.addClass(upperCanvasEl, 'upper-canvas ' + lowerCanvasClass);\n\n      this.wrapperEl.appendChild(upperCanvasEl);\n\n      this._copyCanvasStyle(lowerCanvasEl, upperCanvasEl);\n      this._applyCanvasStyle(upperCanvasEl);\n      this.contextTop = upperCanvasEl.getContext('2d');\n    },\n\n    /**\n     * Returns context of top canvas where interactions are drawn\n     * @returns {CanvasRenderingContext2D}\n     */\n    getTopContext: function () {\n      return this.contextTop;\n    },\n\n    /**\n     * @private\n     */\n    _createCacheCanvas: function () {\n      this.cacheCanvasEl = this._createCanvasElement();\n      this.cacheCanvasEl.setAttribute('width', this.width);\n      this.cacheCanvasEl.setAttribute('height', this.height);\n      this.contextCache = this.cacheCanvasEl.getContext('2d');\n    },\n\n    /**\n     * @private\n     */\n    _initWrapperElement: function () {\n      this.wrapperEl = fabric.util.wrapElement(this.lowerCanvasEl, 'div', {\n        'class': this.containerClass\n      });\n      fabric.util.setStyle(this.wrapperEl, {\n        width: this.width + 'px',\n        height: this.height + 'px',\n        position: 'relative'\n      });\n      fabric.util.makeElementUnselectable(this.wrapperEl);\n    },\n\n    /**\n     * @private\n     * @param {HTMLElement} element canvas element to apply styles on\n     */\n    _applyCanvasStyle: function (element) {\n      var width = this.width || element.width,\n          height = this.height || element.height;\n\n      fabric.util.setStyle(element, {\n        position: 'absolute',\n        width: width + 'px',\n        height: height + 'px',\n        left: 0,\n        top: 0,\n        'touch-action': this.allowTouchScrolling ? 'manipulation' : 'none',\n        '-ms-touch-action': this.allowTouchScrolling ? 'manipulation' : 'none'\n      });\n      element.width = width;\n      element.height = height;\n      fabric.util.makeElementUnselectable(element);\n    },\n\n    /**\n     * Copy the entire inline style from one element (fromEl) to another (toEl)\n     * @private\n     * @param {Element} fromEl Element style is copied from\n     * @param {Element} toEl Element copied style is applied to\n     */\n    _copyCanvasStyle: function (fromEl, toEl) {\n      toEl.style.cssText = fromEl.style.cssText;\n    },\n\n    /**\n     * Returns context of canvas where object selection is drawn\n     * @return {CanvasRenderingContext2D}\n     */\n    getSelectionContext: function() {\n      return this.contextTop;\n    },\n\n    /**\n     * Returns &lt;canvas> element on which object selection is drawn\n     * @return {HTMLCanvasElement}\n     */\n    getSelectionElement: function () {\n      return this.upperCanvasEl;\n    },\n\n    /**\n     * Returns currently active object\n     * @return {fabric.Object} active object\n     */\n    getActiveObject: function () {\n      return this._activeObject;\n    },\n\n    /**\n     * Returns an array with the current selected objects\n     * @return {fabric.Object} active object\n     */\n    getActiveObjects: function () {\n      var active = this._activeObject;\n      if (active) {\n        if (active.type === 'activeSelection' && active._objects) {\n          return active._objects.slice(0);\n        }\n        else {\n          return [active];\n        }\n      }\n      return [];\n    },\n\n    /**\n     * @private\n     * @param {fabric.Object} obj Object that was removed\n     */\n    _onObjectRemoved: function(obj) {\n      // removing active object should fire \"selection:cleared\" events\n      if (obj === this._activeObject) {\n        this.fire('before:selection:cleared', { target: obj });\n        this._discardActiveObject();\n        this.fire('selection:cleared', { target: obj });\n        obj.fire('deselected');\n      }\n      if (obj === this._hoveredTarget){\n        this._hoveredTarget = null;\n        this._hoveredTargets = [];\n      }\n      this.callSuper('_onObjectRemoved', obj);\n    },\n\n    /**\n     * @private\n     * Compares the old activeObject with the current one and fires correct events\n     * @param {fabric.Object} obj old activeObject\n     */\n    _fireSelectionEvents: function(oldObjects, e) {\n      var somethingChanged = false, objects = this.getActiveObjects(),\n          added = [], removed = [];\n      oldObjects.forEach(function(oldObject) {\n        if (objects.indexOf(oldObject) === -1) {\n          somethingChanged = true;\n          oldObject.fire('deselected', {\n            e: e,\n            target: oldObject\n          });\n          removed.push(oldObject);\n        }\n      });\n      objects.forEach(function(object) {\n        if (oldObjects.indexOf(object) === -1) {\n          somethingChanged = true;\n          object.fire('selected', {\n            e: e,\n            target: object\n          });\n          added.push(object);\n        }\n      });\n      if (oldObjects.length > 0 && objects.length > 0) {\n        somethingChanged && this.fire('selection:updated', {\n          e: e,\n          selected: added,\n          deselected: removed,\n        });\n      }\n      else if (objects.length > 0) {\n        this.fire('selection:created', {\n          e: e,\n          selected: added,\n        });\n      }\n      else if (oldObjects.length > 0) {\n        this.fire('selection:cleared', {\n          e: e,\n          deselected: removed,\n        });\n      }\n    },\n\n    /**\n     * Sets given object as the only active object on canvas\n     * @param {fabric.Object} object Object to set as an active one\n     * @param {Event} [e] Event (passed along when firing \"object:selected\")\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    setActiveObject: function (object, e) {\n      var currentActives = this.getActiveObjects();\n      this._setActiveObject(object, e);\n      this._fireSelectionEvents(currentActives, e);\n      return this;\n    },\n\n    /**\n     * This is a private method for now.\n     * This is supposed to be equivalent to setActiveObject but without firing\n     * any event. There is commitment to have this stay this way.\n     * This is the functional part of setActiveObject.\n     * @private\n     * @param {Object} object to set as active\n     * @param {Event} [e] Event (passed along when firing \"object:selected\")\n     * @return {Boolean} true if the selection happened\n     */\n    _setActiveObject: function(object, e) {\n      if (this._activeObject === object) {\n        return false;\n      }\n      if (!this._discardActiveObject(e, object)) {\n        return false;\n      }\n      if (object.onSelect({ e: e })) {\n        return false;\n      }\n      this._activeObject = object;\n      return true;\n    },\n\n    /**\n     * This is a private method for now.\n     * This is supposed to be equivalent to discardActiveObject but without firing\n     * any events. There is commitment to have this stay this way.\n     * This is the functional part of discardActiveObject.\n     * @param {Event} [e] Event (passed along when firing \"object:deselected\")\n     * @param {Object} object to set as active\n     * @return {Boolean} true if the selection happened\n     * @private\n     */\n    _discardActiveObject: function(e, object) {\n      var obj = this._activeObject;\n      if (obj) {\n        // onDeselect return TRUE to cancel selection;\n        if (obj.onDeselect({ e: e, object: object })) {\n          return false;\n        }\n        this._activeObject = null;\n      }\n      return true;\n    },\n\n    /**\n     * Discards currently active object and fire events. If the function is called by fabric\n     * as a consequence of a mouse event, the event is passed as a parameter and\n     * sent to the fire function for the custom events. When used as a method the\n     * e param does not have any application.\n     * @param {event} e\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    discardActiveObject: function (e) {\n      var currentActives = this.getActiveObjects(), activeObject = this.getActiveObject();\n      if (currentActives.length) {\n        this.fire('before:selection:cleared', { target: activeObject, e: e });\n      }\n      this._discardActiveObject(e);\n      this._fireSelectionEvents(currentActives, e);\n      return this;\n    },\n\n    /**\n     * Clears a canvas element and removes all event listeners\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    dispose: function () {\n      var wrapper = this.wrapperEl;\n      this.removeListeners();\n      wrapper.removeChild(this.upperCanvasEl);\n      wrapper.removeChild(this.lowerCanvasEl);\n      this.contextCache = null;\n      this.contextTop = null;\n      ['upperCanvasEl', 'cacheCanvasEl'].forEach((function(element) {\n        fabric.util.cleanUpJsdomNode(this[element]);\n        this[element] = undefined;\n      }).bind(this));\n      if (wrapper.parentNode) {\n        wrapper.parentNode.replaceChild(this.lowerCanvasEl, this.wrapperEl);\n      }\n      delete this.wrapperEl;\n      fabric.StaticCanvas.prototype.dispose.call(this);\n      return this;\n    },\n\n    /**\n     * Clears all contexts (background, main, top) of an instance\n     * @return {fabric.Canvas} thisArg\n     * @chainable\n     */\n    clear: function () {\n      // this.discardActiveGroup();\n      this.discardActiveObject();\n      this.clearContext(this.contextTop);\n      return this.callSuper('clear');\n    },\n\n    /**\n     * Draws objects' controls (borders/controls)\n     * @param {CanvasRenderingContext2D} ctx Context to render controls on\n     */\n    drawControls: function(ctx) {\n      var activeObject = this._activeObject;\n\n      if (activeObject) {\n        activeObject._renderControls(ctx);\n      }\n    },\n\n    /**\n     * @private\n     */\n    _toObject: function(instance, methodName, propertiesToInclude) {\n      //If the object is part of the current selection group, it should\n      //be transformed appropriately\n      //i.e. it should be serialised as it would appear if the selection group\n      //were to be destroyed.\n      var originalProperties = this._realizeGroupTransformOnObject(instance),\n          object = this.callSuper('_toObject', instance, methodName, propertiesToInclude);\n      //Undo the damage we did by changing all of its properties\n      this._unwindGroupTransformOnObject(instance, originalProperties);\n      return object;\n    },\n\n    /**\n     * Realises an object's group transformation on it\n     * @private\n     * @param {fabric.Object} [instance] the object to transform (gets mutated)\n     * @returns the original values of instance which were changed\n     */\n    _realizeGroupTransformOnObject: function(instance) {\n      if (instance.group && instance.group.type === 'activeSelection' && this._activeObject === instance.group) {\n        var layoutProps = ['angle', 'flipX', 'flipY', 'left', 'scaleX', 'scaleY', 'skewX', 'skewY', 'top'];\n        //Copy all the positionally relevant properties across now\n        var originalValues = {};\n        layoutProps.forEach(function(prop) {\n          originalValues[prop] = instance[prop];\n        });\n        fabric.util.addTransformToObject(instance, this._activeObject.calcOwnMatrix());\n        return originalValues;\n      }\n      else {\n        return null;\n      }\n    },\n\n    /**\n     * Restores the changed properties of instance\n     * @private\n     * @param {fabric.Object} [instance] the object to un-transform (gets mutated)\n     * @param {Object} [originalValues] the original values of instance, as returned by _realizeGroupTransformOnObject\n     */\n    _unwindGroupTransformOnObject: function(instance, originalValues) {\n      if (originalValues) {\n        instance.set(originalValues);\n      }\n    },\n\n    /**\n     * @private\n     */\n    _setSVGObject: function(markup, instance, reviver) {\n      //If the object is in a selection group, simulate what would happen to that\n      //object when the group is deselected\n      var originalProperties = this._realizeGroupTransformOnObject(instance);\n      this.callSuper('_setSVGObject', markup, instance, reviver);\n      this._unwindGroupTransformOnObject(instance, originalProperties);\n    },\n\n    setViewportTransform: function (vpt) {\n      if (this.renderOnAddRemove && this._activeObject && this._activeObject.isEditing) {\n        this._activeObject.clearContextTop();\n      }\n      fabric.StaticCanvas.prototype.setViewportTransform.call(this, vpt);\n    }\n  });\n\n  // copying static properties manually to work around Opera's bug,\n  // where \"prototype\" property is enumerable and overrides existing prototype\n  for (var prop in fabric.StaticCanvas) {\n    if (prop !== 'prototype') {\n      fabric.Canvas[prop] = fabric.StaticCanvas[prop];\n    }\n  }\n})();\n\n\n(function() {\n\n  var addListener = fabric.util.addListener,\n      removeListener = fabric.util.removeListener,\n      RIGHT_CLICK = 3, MIDDLE_CLICK = 2, LEFT_CLICK = 1,\n      addEventOptions = { passive: false };\n\n  function checkClick(e, value) {\n    return e.button && (e.button === value - 1);\n  }\n\n  fabric.util.object.extend(fabric.Canvas.prototype, /** @lends fabric.Canvas.prototype */ {\n\n    /**\n     * Contains the id of the touch event that owns the fabric transform\n     * @type Number\n     * @private\n     */\n    mainTouchId: null,\n\n    /**\n     * Adds mouse listeners to canvas\n     * @private\n     */\n    _initEventListeners: function () {\n      // in case we initialized the class twice. This should not happen normally\n      // but in some kind of applications where the canvas element may be changed\n      // this is a workaround to having double listeners.\n      this.removeListeners();\n      this._bindEvents();\n      this.addOrRemove(addListener, 'add');\n    },\n\n    /**\n     * return an event prefix pointer or mouse.\n     * @private\n     */\n    _getEventPrefix: function () {\n      return this.enablePointerEvents ? 'pointer' : 'mouse';\n    },\n\n    addOrRemove: function(functor, eventjsFunctor) {\n      var canvasElement = this.upperCanvasEl,\n          eventTypePrefix = this._getEventPrefix();\n      functor(fabric.window, 'resize', this._onResize);\n      functor(canvasElement, eventTypePrefix + 'down', this._onMouseDown);\n      functor(canvasElement, eventTypePrefix + 'move', this._onMouseMove, addEventOptions);\n      functor(canvasElement, eventTypePrefix + 'out', this._onMouseOut);\n      functor(canvasElement, eventTypePrefix + 'enter', this._onMouseEnter);\n      functor(canvasElement, 'wheel', this._onMouseWheel);\n      functor(canvasElement, 'contextmenu', this._onContextMenu);\n      functor(canvasElement, 'dblclick', this._onDoubleClick);\n      functor(canvasElement, 'dragover', this._onDragOver);\n      functor(canvasElement, 'dragenter', this._onDragEnter);\n      functor(canvasElement, 'dragleave', this._onDragLeave);\n      functor(canvasElement, 'drop', this._onDrop);\n      if (!this.enablePointerEvents) {\n        functor(canvasElement, 'touchstart', this._onTouchStart, addEventOptions);\n      }\n      if (typeof eventjs !== 'undefined' && eventjsFunctor in eventjs) {\n        eventjs[eventjsFunctor](canvasElement, 'gesture', this._onGesture);\n        eventjs[eventjsFunctor](canvasElement, 'drag', this._onDrag);\n        eventjs[eventjsFunctor](canvasElement, 'orientation', this._onOrientationChange);\n        eventjs[eventjsFunctor](canvasElement, 'shake', this._onShake);\n        eventjs[eventjsFunctor](canvasElement, 'longpress', this._onLongPress);\n      }\n    },\n\n    /**\n     * Removes all event listeners\n     */\n    removeListeners: function() {\n      this.addOrRemove(removeListener, 'remove');\n      // if you dispose on a mouseDown, before mouse up, you need to clean document to...\n      var eventTypePrefix = this._getEventPrefix();\n      removeListener(fabric.document, eventTypePrefix + 'up', this._onMouseUp);\n      removeListener(fabric.document, 'touchend', this._onTouchEnd, addEventOptions);\n      removeListener(fabric.document, eventTypePrefix + 'move', this._onMouseMove, addEventOptions);\n      removeListener(fabric.document, 'touchmove', this._onMouseMove, addEventOptions);\n    },\n\n    /**\n     * @private\n     */\n    _bindEvents: function() {\n      if (this.eventsBound) {\n        // for any reason we pass here twice we do not want to bind events twice.\n        return;\n      }\n      this._onMouseDown = this._onMouseDown.bind(this);\n      this._onTouchStart = this._onTouchStart.bind(this);\n      this._onMouseMove = this._onMouseMove.bind(this);\n      this._onMouseUp = this._onMouseUp.bind(this);\n      this._onTouchEnd = this._onTouchEnd.bind(this);\n      this._onResize = this._onResize.bind(this);\n      this._onGesture = this._onGesture.bind(this);\n      this._onDrag = this._onDrag.bind(this);\n      this._onShake = this._onShake.bind(this);\n      this._onLongPress = this._onLongPress.bind(this);\n      this._onOrientationChange = this._onOrientationChange.bind(this);\n      this._onMouseWheel = this._onMouseWheel.bind(this);\n      this._onMouseOut = this._onMouseOut.bind(this);\n      this._onMouseEnter = this._onMouseEnter.bind(this);\n      this._onContextMenu = this._onContextMenu.bind(this);\n      this._onDoubleClick = this._onDoubleClick.bind(this);\n      this._onDragOver = this._onDragOver.bind(this);\n      this._onDragEnter = this._simpleEventHandler.bind(this, 'dragenter');\n      this._onDragLeave = this._simpleEventHandler.bind(this, 'dragleave');\n      this._onDrop = this._onDrop.bind(this);\n      this.eventsBound = true;\n    },\n\n    /**\n     * @private\n     * @param {Event} [e] Event object fired on Event.js gesture\n     * @param {Event} [self] Inner Event object\n     */\n    _onGesture: function(e, self) {\n      this.__onTransformGesture && this.__onTransformGesture(e, self);\n    },\n\n    /**\n     * @private\n     * @param {Event} [e] Event object fired on Event.js drag\n     * @param {Event} [self] Inner Event object\n     */\n    _onDrag: function(e, self) {\n      this.__onDrag && this.__onDrag(e, self);\n    },\n\n    /**\n     * @private\n     * @param {Event} [e] Event object fired on wheel event\n     */\n    _onMouseWheel: function(e) {\n      this.__onMouseWheel(e);\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousedown\n     */\n    _onMouseOut: function(e) {\n      var target = this._hoveredTarget;\n      this.fire('mouse:out', { target: target, e: e });\n      this._hoveredTarget = null;\n      target && target.fire('mouseout', { e: e });\n\n      var _this = this;\n      this._hoveredTargets.forEach(function(_target){\n        _this.fire('mouse:out', { target: _target, e: e });\n        _target && _target.fire('mouseout', { e: e });\n      });\n      this._hoveredTargets = [];\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mouseenter\n     */\n    _onMouseEnter: function(e) {\n      // This find target and consequent 'mouse:over' is used to\n      // clear old instances on hovered target.\n      // calling findTarget has the side effect of killing target.__corner.\n      // as a short term fix we are not firing this if we are currently transforming.\n      // as a long term fix we need to separate the action of finding a target with the\n      // side effects we added to it.\n      if (!this._currentTransform && !this.findTarget(e)) {\n        this.fire('mouse:over', { target: null, e: e });\n        this._hoveredTarget = null;\n        this._hoveredTargets = [];\n      }\n    },\n\n    /**\n     * @private\n     * @param {Event} [e] Event object fired on Event.js orientation change\n     * @param {Event} [self] Inner Event object\n     */\n    _onOrientationChange: function(e, self) {\n      this.__onOrientationChange && this.__onOrientationChange(e, self);\n    },\n\n    /**\n     * @private\n     * @param {Event} [e] Event object fired on Event.js shake\n     * @param {Event} [self] Inner Event object\n     */\n    _onShake: function(e, self) {\n      this.__onShake && this.__onShake(e, self);\n    },\n\n    /**\n     * @private\n     * @param {Event} [e] Event object fired on Event.js shake\n     * @param {Event} [self] Inner Event object\n     */\n    _onLongPress: function(e, self) {\n      this.__onLongPress && this.__onLongPress(e, self);\n    },\n\n    /**\n     * prevent default to allow drop event to be fired\n     * @private\n     * @param {Event} [e] Event object fired on Event.js shake\n     */\n    _onDragOver: function(e) {\n      e.preventDefault();\n      var target = this._simpleEventHandler('dragover', e);\n      this._fireEnterLeaveEvents(target, e);\n    },\n\n    /**\n     * `drop:before` is a an event that allow you to schedule logic\n     * before the `drop` event. Prefer `drop` event always, but if you need\n     * to run some drop-disabling logic on an event, since there is no way\n     * to handle event handlers ordering, use `drop:before`\n     * @param {Event} e\n     */\n    _onDrop: function (e) {\n      this._simpleEventHandler('drop:before', e);\n      return this._simpleEventHandler('drop', e);\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousedown\n     */\n    _onContextMenu: function (e) {\n      if (this.stopContextMenu) {\n        e.stopPropagation();\n        e.preventDefault();\n      }\n      return false;\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousedown\n     */\n    _onDoubleClick: function (e) {\n      this._cacheTransformEventData(e);\n      this._handleEvent(e, 'dblclick');\n      this._resetTransformEventData(e);\n    },\n\n    /**\n     * Return a the id of an event.\n     * returns either the pointerId or the identifier or 0 for the mouse event\n     * @private\n     * @param {Event} evt Event object\n     */\n    getPointerId: function(evt) {\n      var changedTouches = evt.changedTouches;\n\n      if (changedTouches) {\n        return changedTouches[0] && changedTouches[0].identifier;\n      }\n\n      if (this.enablePointerEvents) {\n        return evt.pointerId;\n      }\n\n      return -1;\n    },\n\n    /**\n     * Determines if an event has the id of the event that is considered main\n     * @private\n     * @param {evt} event Event object\n     */\n    _isMainEvent: function(evt) {\n      if (evt.isPrimary === true) {\n        return true;\n      }\n      if (evt.isPrimary === false) {\n        return false;\n      }\n      if (evt.type === 'touchend' && evt.touches.length === 0) {\n        return true;\n      }\n      if (evt.changedTouches) {\n        return evt.changedTouches[0].identifier === this.mainTouchId;\n      }\n      return true;\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousedown\n     */\n    _onTouchStart: function(e) {\n      e.preventDefault();\n      if (this.mainTouchId === null) {\n        this.mainTouchId = this.getPointerId(e);\n      }\n      this.__onMouseDown(e);\n      this._resetTransformEventData();\n      var canvasElement = this.upperCanvasEl,\n          eventTypePrefix = this._getEventPrefix();\n      addListener(fabric.document, 'touchend', this._onTouchEnd, addEventOptions);\n      addListener(fabric.document, 'touchmove', this._onMouseMove, addEventOptions);\n      // Unbind mousedown to prevent double triggers from touch devices\n      removeListener(canvasElement, eventTypePrefix + 'down', this._onMouseDown);\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousedown\n     */\n    _onMouseDown: function (e) {\n      this.__onMouseDown(e);\n      this._resetTransformEventData();\n      var canvasElement = this.upperCanvasEl,\n          eventTypePrefix = this._getEventPrefix();\n      removeListener(canvasElement, eventTypePrefix + 'move', this._onMouseMove, addEventOptions);\n      addListener(fabric.document, eventTypePrefix + 'up', this._onMouseUp);\n      addListener(fabric.document, eventTypePrefix + 'move', this._onMouseMove, addEventOptions);\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousedown\n     */\n    _onTouchEnd: function(e) {\n      if (e.touches.length > 0) {\n        // if there are still touches stop here\n        return;\n      }\n      this.__onMouseUp(e);\n      this._resetTransformEventData();\n      this.mainTouchId = null;\n      var eventTypePrefix = this._getEventPrefix();\n      removeListener(fabric.document, 'touchend', this._onTouchEnd, addEventOptions);\n      removeListener(fabric.document, 'touchmove', this._onMouseMove, addEventOptions);\n      var _this = this;\n      if (this._willAddMouseDown) {\n        clearTimeout(this._willAddMouseDown);\n      }\n      this._willAddMouseDown = setTimeout(function() {\n        // Wait 400ms before rebinding mousedown to prevent double triggers\n        // from touch devices\n        addListener(_this.upperCanvasEl, eventTypePrefix + 'down', _this._onMouseDown);\n        _this._willAddMouseDown = 0;\n      }, 400);\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mouseup\n     */\n    _onMouseUp: function (e) {\n      this.__onMouseUp(e);\n      this._resetTransformEventData();\n      var canvasElement = this.upperCanvasEl,\n          eventTypePrefix = this._getEventPrefix();\n      if (this._isMainEvent(e)) {\n        removeListener(fabric.document, eventTypePrefix + 'up', this._onMouseUp);\n        removeListener(fabric.document, eventTypePrefix + 'move', this._onMouseMove, addEventOptions);\n        addListener(canvasElement, eventTypePrefix + 'move', this._onMouseMove, addEventOptions);\n      }\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousemove\n     */\n    _onMouseMove: function (e) {\n      !this.allowTouchScrolling && e.preventDefault && e.preventDefault();\n      this.__onMouseMove(e);\n    },\n\n    /**\n     * @private\n     */\n    _onResize: function () {\n      this.calcOffset();\n    },\n\n    /**\n     * Decides whether the canvas should be redrawn in mouseup and mousedown events.\n     * @private\n     * @param {Object} target\n     */\n    _shouldRender: function(target) {\n      var activeObject = this._activeObject;\n\n      if (\n        !!activeObject !== !!target ||\n        (activeObject && target && (activeObject !== target))\n      ) {\n        // this covers: switch of target, from target to no target, selection of target\n        // multiSelection with key and mouse\n        return true;\n      }\n      else if (activeObject && activeObject.isEditing) {\n        // if we mouse up/down over a editing textbox a cursor change,\n        // there is no need to re render\n        return false;\n      }\n      return false;\n    },\n\n    /**\n     * Method that defines the actions when mouse is released on canvas.\n     * The method resets the currentTransform parameters, store the image corner\n     * position in the image object and render the canvas on top.\n     * @private\n     * @param {Event} e Event object fired on mouseup\n     */\n    __onMouseUp: function (e) {\n      var target, transform = this._currentTransform,\n          groupSelector = this._groupSelector, shouldRender = false,\n          isClick = (!groupSelector || (groupSelector.left === 0 && groupSelector.top === 0));\n      this._cacheTransformEventData(e);\n      target = this._target;\n      this._handleEvent(e, 'up:before');\n      // if right/middle click just fire events and return\n      // target undefined will make the _handleEvent search the target\n      if (checkClick(e, RIGHT_CLICK)) {\n        if (this.fireRightClick) {\n          this._handleEvent(e, 'up', RIGHT_CLICK, isClick);\n        }\n        return;\n      }\n\n      if (checkClick(e, MIDDLE_CLICK)) {\n        if (this.fireMiddleClick) {\n          this._handleEvent(e, 'up', MIDDLE_CLICK, isClick);\n        }\n        this._resetTransformEventData();\n        return;\n      }\n\n      if (this.isDrawingMode && this._isCurrentlyDrawing) {\n        this._onMouseUpInDrawingMode(e);\n        return;\n      }\n\n      if (!this._isMainEvent(e)) {\n        return;\n      }\n      if (transform) {\n        this._finalizeCurrentTransform(e);\n        shouldRender = transform.actionPerformed;\n      }\n      if (!isClick) {\n        var targetWasActive = target === this._activeObject;\n        this._maybeGroupObjects(e);\n        if (!shouldRender) {\n          shouldRender = (\n            this._shouldRender(target) ||\n            (!targetWasActive && target === this._activeObject)\n          );\n        }\n      }\n      var corner, pointer;\n      if (target) {\n        corner = target._findTargetCorner(\n          this.getPointer(e, true),\n          fabric.util.isTouchEvent(e)\n        );\n        if (target.selectable && target !== this._activeObject && target.activeOn === 'up') {\n          this.setActiveObject(target, e);\n          shouldRender = true;\n        }\n        else {\n          var control = target.controls[corner],\n              mouseUpHandler = control && control.getMouseUpHandler(e, target, control);\n          if (mouseUpHandler) {\n            pointer = this.getPointer(e);\n            mouseUpHandler(e, transform, pointer.x, pointer.y);\n          }\n        }\n        target.isMoving = false;\n      }\n      // if we are ending up a transform on a different control or a new object\n      // fire the original mouse up from the corner that started the transform\n      if (transform && (transform.target !== target || transform.corner !== corner)) {\n        var originalControl = transform.target && transform.target.controls[transform.corner],\n            originalMouseUpHandler = originalControl && originalControl.getMouseUpHandler(e, target, control);\n        pointer = pointer || this.getPointer(e);\n        originalMouseUpHandler && originalMouseUpHandler(e, transform, pointer.x, pointer.y);\n      }\n      this._setCursorFromEvent(e, target);\n      this._handleEvent(e, 'up', LEFT_CLICK, isClick);\n      this._groupSelector = null;\n      this._currentTransform = null;\n      // reset the target information about which corner is selected\n      target && (target.__corner = 0);\n      if (shouldRender) {\n        this.requestRenderAll();\n      }\n      else if (!isClick) {\n        this.renderTop();\n      }\n    },\n\n    /**\n     * @private\n     * Handle event firing for target and subtargets\n     * @param {Event} e event from mouse\n     * @param {String} eventType event to fire (up, down or move)\n     * @return {Fabric.Object} target return the the target found, for internal reasons.\n     */\n    _simpleEventHandler: function(eventType, e) {\n      var target = this.findTarget(e),\n          targets = this.targets,\n          options = {\n            e: e,\n            target: target,\n            subTargets: targets,\n          };\n      this.fire(eventType, options);\n      target && target.fire(eventType, options);\n      if (!targets) {\n        return target;\n      }\n      for (var i = 0; i < targets.length; i++) {\n        targets[i].fire(eventType, options);\n      }\n      return target;\n    },\n\n    /**\n     * @private\n     * Handle event firing for target and subtargets\n     * @param {Event} e event from mouse\n     * @param {String} eventType event to fire (up, down or move)\n     * @param {fabric.Object} targetObj receiving event\n     * @param {Number} [button] button used in the event 1 = left, 2 = middle, 3 = right\n     * @param {Boolean} isClick for left button only, indicates that the mouse up happened without move.\n     */\n    _handleEvent: function(e, eventType, button, isClick) {\n      var target = this._target,\n          targets = this.targets || [],\n          options = {\n            e: e,\n            target: target,\n            subTargets: targets,\n            button: button || LEFT_CLICK,\n            isClick: isClick || false,\n            pointer: this._pointer,\n            absolutePointer: this._absolutePointer,\n            transform: this._currentTransform\n          };\n      if (eventType === 'up') {\n        options.currentTarget = this.findTarget(e);\n        options.currentSubTargets = this.targets;\n      }\n      this.fire('mouse:' + eventType, options);\n      target && target.fire('mouse' + eventType, options);\n      for (var i = 0; i < targets.length; i++) {\n        targets[i].fire('mouse' + eventType, options);\n      }\n    },\n\n    /**\n     * @private\n     * @param {Event} e send the mouse event that generate the finalize down, so it can be used in the event\n     */\n    _finalizeCurrentTransform: function(e) {\n\n      var transform = this._currentTransform,\n          target = transform.target,\n          options = {\n            e: e,\n            target: target,\n            transform: transform,\n            action: transform.action,\n          };\n\n      if (target._scaling) {\n        target._scaling = false;\n      }\n\n      target.setCoords();\n\n      if (transform.actionPerformed || (this.stateful && target.hasStateChanged())) {\n        this._fire('modified', options);\n      }\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousedown\n     */\n    _onMouseDownInDrawingMode: function(e) {\n      this._isCurrentlyDrawing = true;\n      if (this.getActiveObject()) {\n        this.discardActiveObject(e).requestRenderAll();\n      }\n      var pointer = this.getPointer(e);\n      this.freeDrawingBrush.onMouseDown(pointer, { e: e, pointer: pointer });\n      this._handleEvent(e, 'down');\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mousemove\n     */\n    _onMouseMoveInDrawingMode: function(e) {\n      if (this._isCurrentlyDrawing) {\n        var pointer = this.getPointer(e);\n        this.freeDrawingBrush.onMouseMove(pointer, { e: e, pointer: pointer });\n      }\n      this.setCursor(this.freeDrawingCursor);\n      this._handleEvent(e, 'move');\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object fired on mouseup\n     */\n    _onMouseUpInDrawingMode: function(e) {\n      var pointer = this.getPointer(e);\n      this._isCurrentlyDrawing = this.freeDrawingBrush.onMouseUp({ e: e, pointer: pointer });\n      this._handleEvent(e, 'up');\n    },\n\n    /**\n     * Method that defines the actions when mouse is clicked on canvas.\n     * The method inits the currentTransform parameters and renders all the\n     * canvas so the current image can be placed on the top canvas and the rest\n     * in on the container one.\n     * @private\n     * @param {Event} e Event object fired on mousedown\n     */\n    __onMouseDown: function (e) {\n      this._cacheTransformEventData(e);\n      this._handleEvent(e, 'down:before');\n      var target = this._target;\n      // if right click just fire events\n      if (checkClick(e, RIGHT_CLICK)) {\n        if (this.fireRightClick) {\n          this._handleEvent(e, 'down', RIGHT_CLICK);\n        }\n        return;\n      }\n\n      if (checkClick(e, MIDDLE_CLICK)) {\n        if (this.fireMiddleClick) {\n          this._handleEvent(e, 'down', MIDDLE_CLICK);\n        }\n        return;\n      }\n\n      if (this.isDrawingMode) {\n        this._onMouseDownInDrawingMode(e);\n        return;\n      }\n\n      if (!this._isMainEvent(e)) {\n        return;\n      }\n\n      // ignore if some object is being transformed at this moment\n      if (this._currentTransform) {\n        return;\n      }\n\n      var pointer = this._pointer;\n      // save pointer for check in __onMouseUp event\n      this._previousPointer = pointer;\n      var shouldRender = this._shouldRender(target),\n          shouldGroup = this._shouldGroup(e, target);\n      if (this._shouldClearSelection(e, target)) {\n        this.discardActiveObject(e);\n      }\n      else if (shouldGroup) {\n        this._handleGrouping(e, target);\n        target = this._activeObject;\n      }\n\n      if (this.selection && (!target ||\n        (!target.selectable && !target.isEditing && target !== this._activeObject))) {\n        this._groupSelector = {\n          ex: this._absolutePointer.x,\n          ey: this._absolutePointer.y,\n          top: 0,\n          left: 0\n        };\n      }\n\n      if (target) {\n        var alreadySelected = target === this._activeObject;\n        if (target.selectable && target.activeOn === 'down') {\n          this.setActiveObject(target, e);\n        }\n        var corner = target._findTargetCorner(\n          this.getPointer(e, true),\n          fabric.util.isTouchEvent(e)\n        );\n        target.__corner = corner;\n        if (target === this._activeObject && (corner || !shouldGroup)) {\n          this._setupCurrentTransform(e, target, alreadySelected);\n          var control = target.controls[corner],\n              pointer = this.getPointer(e),\n              mouseDownHandler = control && control.getMouseDownHandler(e, target, control);\n          if (mouseDownHandler) {\n            mouseDownHandler(e, this._currentTransform, pointer.x, pointer.y);\n          }\n        }\n      }\n      this._handleEvent(e, 'down');\n      // we must renderAll so that we update the visuals\n      (shouldRender || shouldGroup) && this.requestRenderAll();\n    },\n\n    /**\n     * reset cache form common information needed during event processing\n     * @private\n     */\n    _resetTransformEventData: function() {\n      this._target = null;\n      this._pointer = null;\n      this._absolutePointer = null;\n    },\n\n    /**\n     * Cache common information needed during event processing\n     * @private\n     * @param {Event} e Event object fired on event\n     */\n    _cacheTransformEventData: function(e) {\n      // reset in order to avoid stale caching\n      this._resetTransformEventData();\n      this._pointer = this.getPointer(e, true);\n      this._absolutePointer = this.restorePointerVpt(this._pointer);\n      this._target = this._currentTransform ? this._currentTransform.target : this.findTarget(e) || null;\n    },\n\n    /**\n     * @private\n     */\n    _beforeTransform: function(e) {\n      var t = this._currentTransform;\n      this.stateful && t.target.saveState();\n      this.fire('before:transform', {\n        e: e,\n        transform: t,\n      });\n    },\n\n    /**\n     * Method that defines the actions when mouse is hovering the canvas.\n     * The currentTransform parameter will define whether the user is rotating/scaling/translating\n     * an image or neither of them (only hovering). A group selection is also possible and would cancel\n     * all any other type of action.\n     * In case of an image transformation only the top canvas will be rendered.\n     * @private\n     * @param {Event} e Event object fired on mousemove\n     */\n    __onMouseMove: function (e) {\n      this._handleEvent(e, 'move:before');\n      this._cacheTransformEventData(e);\n      var target, pointer;\n\n      if (this.isDrawingMode) {\n        this._onMouseMoveInDrawingMode(e);\n        return;\n      }\n\n      if (!this._isMainEvent(e)) {\n        return;\n      }\n\n      var groupSelector = this._groupSelector;\n\n      // We initially clicked in an empty area, so we draw a box for multiple selection\n      if (groupSelector) {\n        pointer = this._absolutePointer;\n\n        groupSelector.left = pointer.x - groupSelector.ex;\n        groupSelector.top = pointer.y - groupSelector.ey;\n\n        this.renderTop();\n      }\n      else if (!this._currentTransform) {\n        target = this.findTarget(e) || null;\n        this._setCursorFromEvent(e, target);\n        this._fireOverOutEvents(target, e);\n      }\n      else {\n        this._transformObject(e);\n      }\n      this._handleEvent(e, 'move');\n      this._resetTransformEventData();\n    },\n\n    /**\n     * Manage the mouseout, mouseover events for the fabric object on the canvas\n     * @param {Fabric.Object} target the target where the target from the mousemove event\n     * @param {Event} e Event object fired on mousemove\n     * @private\n     */\n    _fireOverOutEvents: function(target, e) {\n      var _hoveredTarget = this._hoveredTarget,\n          _hoveredTargets = this._hoveredTargets, targets = this.targets,\n          length = Math.max(_hoveredTargets.length, targets.length);\n\n      this.fireSyntheticInOutEvents(target, e, {\n        oldTarget: _hoveredTarget,\n        evtOut: 'mouseout',\n        canvasEvtOut: 'mouse:out',\n        evtIn: 'mouseover',\n        canvasEvtIn: 'mouse:over',\n      });\n      for (var i = 0; i < length; i++){\n        this.fireSyntheticInOutEvents(targets[i], e, {\n          oldTarget: _hoveredTargets[i],\n          evtOut: 'mouseout',\n          evtIn: 'mouseover',\n        });\n      }\n      this._hoveredTarget = target;\n      this._hoveredTargets = this.targets.concat();\n    },\n\n    /**\n     * Manage the dragEnter, dragLeave events for the fabric objects on the canvas\n     * @param {Fabric.Object} target the target where the target from the onDrag event\n     * @param {Event} e Event object fired on ondrag\n     * @private\n     */\n    _fireEnterLeaveEvents: function(target, e) {\n      var _draggedoverTarget = this._draggedoverTarget,\n          _hoveredTargets = this._hoveredTargets, targets = this.targets,\n          length = Math.max(_hoveredTargets.length, targets.length);\n\n      this.fireSyntheticInOutEvents(target, e, {\n        oldTarget: _draggedoverTarget,\n        evtOut: 'dragleave',\n        evtIn: 'dragenter',\n      });\n      for (var i = 0; i < length; i++) {\n        this.fireSyntheticInOutEvents(targets[i], e, {\n          oldTarget: _hoveredTargets[i],\n          evtOut: 'dragleave',\n          evtIn: 'dragenter',\n        });\n      }\n      this._draggedoverTarget = target;\n    },\n\n    /**\n     * Manage the synthetic in/out events for the fabric objects on the canvas\n     * @param {Fabric.Object} target the target where the target from the supported events\n     * @param {Event} e Event object fired\n     * @param {Object} config configuration for the function to work\n     * @param {String} config.targetName property on the canvas where the old target is stored\n     * @param {String} [config.canvasEvtOut] name of the event to fire at canvas level for out\n     * @param {String} config.evtOut name of the event to fire for out\n     * @param {String} [config.canvasEvtIn] name of the event to fire at canvas level for in\n     * @param {String} config.evtIn name of the event to fire for in\n     * @private\n     */\n    fireSyntheticInOutEvents: function(target, e, config) {\n      var inOpt, outOpt, oldTarget = config.oldTarget, outFires, inFires,\n          targetChanged = oldTarget !== target, canvasEvtIn = config.canvasEvtIn, canvasEvtOut = config.canvasEvtOut;\n      if (targetChanged) {\n        inOpt = { e: e, target: target, previousTarget: oldTarget };\n        outOpt = { e: e, target: oldTarget, nextTarget: target };\n      }\n      inFires = target && targetChanged;\n      outFires = oldTarget && targetChanged;\n      if (outFires) {\n        canvasEvtOut && this.fire(canvasEvtOut, outOpt);\n        oldTarget.fire(config.evtOut, outOpt);\n      }\n      if (inFires) {\n        canvasEvtIn && this.fire(canvasEvtIn, inOpt);\n        target.fire(config.evtIn, inOpt);\n      }\n    },\n\n    /**\n     * Method that defines actions when an Event Mouse Wheel\n     * @param {Event} e Event object fired on mouseup\n     */\n    __onMouseWheel: function(e) {\n      this._cacheTransformEventData(e);\n      this._handleEvent(e, 'wheel');\n      this._resetTransformEventData();\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event fired on mousemove\n     */\n    _transformObject: function(e) {\n      var pointer = this.getPointer(e),\n          transform = this._currentTransform;\n\n      transform.reset = false;\n      transform.shiftKey = e.shiftKey;\n      transform.altKey = e[this.centeredKey];\n\n      this._performTransformAction(e, transform, pointer);\n      transform.actionPerformed && this.requestRenderAll();\n    },\n\n    /**\n     * @private\n     */\n    _performTransformAction: function(e, transform, pointer) {\n      var x = pointer.x,\n          y = pointer.y,\n          action = transform.action,\n          actionPerformed = false,\n          actionHandler = transform.actionHandler;\n          // this object could be created from the function in the control handlers\n\n\n      if (actionHandler) {\n        actionPerformed = actionHandler(e, transform, x, y);\n      }\n      if (action === 'drag' && actionPerformed) {\n        transform.target.isMoving = true;\n        this.setCursor(transform.target.moveCursor || this.moveCursor);\n      }\n      transform.actionPerformed = transform.actionPerformed || actionPerformed;\n    },\n\n    /**\n     * @private\n     */\n    _fire: fabric.controlsUtils.fireEvent,\n\n    /**\n     * Sets the cursor depending on where the canvas is being hovered.\n     * Note: very buggy in Opera\n     * @param {Event} e Event object\n     * @param {Object} target Object that the mouse is hovering, if so.\n     */\n    _setCursorFromEvent: function (e, target) {\n      if (!target) {\n        this.setCursor(this.defaultCursor);\n        return false;\n      }\n      var hoverCursor = target.hoverCursor || this.hoverCursor,\n          activeSelection = this._activeObject && this._activeObject.type === 'activeSelection' ?\n            this._activeObject : null,\n          // only show proper corner when group selection is not active\n          corner = (!activeSelection || !activeSelection.contains(target))\n          // here we call findTargetCorner always with undefined for the touch parameter.\n          // we assume that if you are using a cursor you do not need to interact with\n          // the bigger touch area.\n                    && target._findTargetCorner(this.getPointer(e, true));\n\n      if (!corner) {\n        if (target.subTargetCheck){\n          // hoverCursor should come from top-most subTarget,\n          // so we walk the array backwards\n          this.targets.concat().reverse().map(function(_target){\n            hoverCursor = _target.hoverCursor || hoverCursor;\n          });\n        }\n        this.setCursor(hoverCursor);\n      }\n      else {\n        this.setCursor(this.getCornerCursor(corner, target, e));\n      }\n    },\n\n    /**\n     * @private\n     */\n    getCornerCursor: function(corner, target, e) {\n      var control = target.controls[corner];\n      return control.cursorStyleHandler(e, control, target);\n    }\n  });\n})();\n\n\n(function() {\n\n  var min = Math.min,\n      max = Math.max;\n\n  fabric.util.object.extend(fabric.Canvas.prototype, /** @lends fabric.Canvas.prototype */ {\n\n    /**\n     * @private\n     * @param {Event} e Event object\n     * @param {fabric.Object} target\n     * @return {Boolean}\n     */\n    _shouldGroup: function(e, target) {\n      var activeObject = this._activeObject;\n      return activeObject && this._isSelectionKeyPressed(e) && target && target.selectable && this.selection &&\n            (activeObject !== target || activeObject.type === 'activeSelection') && !target.onSelect({ e: e });\n    },\n\n    /**\n     * @private\n     * @param {Event} e Event object\n     * @param {fabric.Object} target\n     */\n    _handleGrouping: function (e, target) {\n      var activeObject = this._activeObject;\n      // avoid multi select when shift click on a corner\n      if (activeObject.__corner) {\n        return;\n      }\n      if (target === activeObject) {\n        // if it's a group, find target again, using activeGroup objects\n        target = this.findTarget(e, true);\n        // if even object is not found or we are on activeObjectCorner, bail out\n        if (!target || !target.selectable) {\n          return;\n        }\n      }\n      if (activeObject && activeObject.type === 'activeSelection') {\n        this._updateActiveSelection(target, e);\n      }\n      else {\n        this._createActiveSelection(target, e);\n      }\n    },\n\n    /**\n     * @private\n     */\n    _updateActiveSelection: function(target, e) {\n      var activeSelection = this._activeObject,\n          currentActiveObjects = activeSelection._objects.slice(0);\n      if (activeSelection.contains(target)) {\n        activeSelection.removeWithUpdate(target);\n        this._hoveredTarget = target;\n        this._hoveredTargets = this.targets.concat();\n        if (activeSelection.size() === 1) {\n          // activate last remaining object\n          this._setActiveObject(activeSelection.item(0), e);\n        }\n      }\n      else {\n        activeSelection.addWithUpdate(target);\n        this._hoveredTarget = activeSelection;\n        this._hoveredTargets = this.targets.concat();\n      }\n      this._fireSelectionEvents(currentActiveObjects, e);\n    },\n\n    /**\n     * @private\n     */\n    _createActiveSelection: function(target, e) {\n      var currentActives = this.getActiveObjects(), group = this._createGroup(target);\n      this._hoveredTarget = group;\n      // ISSUE 4115: should we consider subTargets here?\n      // this._hoveredTargets = [];\n      // this._hoveredTargets = this.targets.concat();\n      this._setActiveObject(group, e);\n      this._fireSelectionEvents(currentActives, e);\n    },\n\n    /**\n     * @private\n     * @param {Object} target\n     */\n    _createGroup: function(target) {\n      var objects = this._objects,\n          isActiveLower = objects.indexOf(this._activeObject) < objects.indexOf(target),\n          groupObjects = isActiveLower\n            ? [this._activeObject, target]\n            : [target, this._activeObject];\n      this._activeObject.isEditing && this._activeObject.exitEditing();\n      return new fabric.ActiveSelection(groupObjects, {\n        canvas: this\n      });\n    },\n\n    /**\n     * @private\n     * @param {Event} e mouse event\n     */\n    _groupSelectedObjects: function (e) {\n\n      var group = this._collectObjects(e),\n          aGroup;\n\n      // do not create group for 1 element only\n      if (group.length === 1) {\n        this.setActiveObject(group[0], e);\n      }\n      else if (group.length > 1) {\n        aGroup = new fabric.ActiveSelection(group.reverse(), {\n          canvas: this\n        });\n        this.setActiveObject(aGroup, e);\n      }\n    },\n\n    /**\n     * @private\n     */\n    _collectObjects: function(e) {\n      var group = [],\n          currentObject,\n          x1 = this._groupSelector.ex,\n          y1 = this._groupSelector.ey,\n          x2 = x1 + this._groupSelector.left,\n          y2 = y1 + this._groupSelector.top,\n          selectionX1Y1 = new fabric.Point(min(x1, x2), min(y1, y2)),\n          selectionX2Y2 = new fabric.Point(max(x1, x2), max(y1, y2)),\n          allowIntersect = !this.selectionFullyContained,\n          isClick = x1 === x2 && y1 === y2;\n      // we iterate reverse order to collect top first in case of click.\n      for (var i = this._objects.length; i--; ) {\n        currentObject = this._objects[i];\n\n        if (!currentObject || !currentObject.selectable || !currentObject.visible) {\n          continue;\n        }\n\n        if ((allowIntersect && currentObject.intersectsWithRect(selectionX1Y1, selectionX2Y2, true)) ||\n            currentObject.isContainedWithinRect(selectionX1Y1, selectionX2Y2, true) ||\n            (allowIntersect && currentObject.containsPoint(selectionX1Y1, null, true)) ||\n            (allowIntersect && currentObject.containsPoint(selectionX2Y2, null, true))\n        ) {\n          group.push(currentObject);\n          // only add one object if it's a click\n          if (isClick) {\n            break;\n          }\n        }\n      }\n\n      if (group.length > 1) {\n        group = group.filter(function(object) {\n          return !object.onSelect({ e: e });\n        });\n      }\n\n      return group;\n    },\n\n    /**\n     * @private\n     */\n    _maybeGroupObjects: function(e) {\n      if (this.selection && this._groupSelector) {\n        this._groupSelectedObjects(e);\n      }\n      this.setCursor(this.defaultCursor);\n      // clear selection and current transformation\n      this._groupSelector = null;\n    }\n  });\n\n})();\n\n\n(function () {\n  fabric.util.object.extend(fabric.StaticCanvas.prototype, /** @lends fabric.StaticCanvas.prototype */ {\n\n    /**\n     * Exports canvas element to a dataurl image. Note that when multiplier is used, cropping is scaled appropriately\n     * @param {Object} [options] Options object\n     * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n     * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n     * @param {Number} [options.multiplier=1] Multiplier to scale by, to have consistent\n     * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n     * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n     * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n     * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n     * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 2.0.0\n     * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\n     * @see {@link http://jsfiddle.net/fabricjs/NfZVb/|jsFiddle demo}\n     * @example <caption>Generate jpeg dataURL with lower quality</caption>\n     * var dataURL = canvas.toDataURL({\n     *   format: 'jpeg',\n     *   quality: 0.8\n     * });\n     * @example <caption>Generate cropped png dataURL (clipping of canvas)</caption>\n     * var dataURL = canvas.toDataURL({\n     *   format: 'png',\n     *   left: 100,\n     *   top: 100,\n     *   width: 200,\n     *   height: 200\n     * });\n     * @example <caption>Generate double scaled png dataURL</caption>\n     * var dataURL = canvas.toDataURL({\n     *   format: 'png',\n     *   multiplier: 2\n     * });\n     */\n    toDataURL: function (options) {\n      options || (options = { });\n\n      var format = options.format || 'png',\n          quality = options.quality || 1,\n          multiplier = (options.multiplier || 1) * (options.enableRetinaScaling ? this.getRetinaScaling() : 1),\n          canvasEl = this.toCanvasElement(multiplier, options);\n      return fabric.util.toDataURL(canvasEl, format, quality);\n    },\n\n    /**\n     * Create a new HTMLCanvas element painted with the current canvas content.\n     * No need to resize the actual one or repaint it.\n     * Will transfer object ownership to a new canvas, paint it, and set everything back.\n     * This is an intermediary step used to get to a dataUrl but also it is useful to\n     * create quick image copies of a canvas without passing for the dataUrl string\n     * @param {Number} [multiplier] a zoom factor.\n     * @param {Object} [cropping] Cropping informations\n     * @param {Number} [cropping.left] Cropping left offset.\n     * @param {Number} [cropping.top] Cropping top offset.\n     * @param {Number} [cropping.width] Cropping width.\n     * @param {Number} [cropping.height] Cropping height.\n     */\n    toCanvasElement: function(multiplier, cropping) {\n      multiplier = multiplier || 1;\n      cropping = cropping || { };\n      var scaledWidth = (cropping.width || this.width) * multiplier,\n          scaledHeight = (cropping.height || this.height) * multiplier,\n          zoom = this.getZoom(),\n          originalWidth = this.width,\n          originalHeight = this.height,\n          newZoom = zoom * multiplier,\n          vp = this.viewportTransform,\n          translateX = (vp[4] - (cropping.left || 0)) * multiplier,\n          translateY = (vp[5] - (cropping.top || 0)) * multiplier,\n          originalInteractive = this.interactive,\n          newVp = [newZoom, 0, 0, newZoom, translateX, translateY],\n          originalRetina = this.enableRetinaScaling,\n          canvasEl = fabric.util.createCanvasElement(),\n          originalContextTop = this.contextTop;\n      canvasEl.width = scaledWidth;\n      canvasEl.height = scaledHeight;\n      this.contextTop = null;\n      this.enableRetinaScaling = false;\n      this.interactive = false;\n      this.viewportTransform = newVp;\n      this.width = scaledWidth;\n      this.height = scaledHeight;\n      this.calcViewportBoundaries();\n      this.renderCanvas(canvasEl.getContext('2d'), this._objects);\n      this.viewportTransform = vp;\n      this.width = originalWidth;\n      this.height = originalHeight;\n      this.calcViewportBoundaries();\n      this.interactive = originalInteractive;\n      this.enableRetinaScaling = originalRetina;\n      this.contextTop = originalContextTop;\n      return canvasEl;\n    },\n  });\n\n})();\n\n\nfabric.util.object.extend(fabric.StaticCanvas.prototype, /** @lends fabric.StaticCanvas.prototype */ {\n  /**\n   * Populates canvas with data from the specified JSON.\n   * JSON format must conform to the one of {@link fabric.Canvas#toJSON}\n   * @param {String|Object} json JSON string or object\n   * @param {Function} callback Callback, invoked when json is parsed\n   *                            and corresponding objects (e.g: {@link fabric.Image})\n   *                            are initialized\n   * @param {Function} [reviver] Method for further parsing of JSON elements, called after each fabric object created.\n   * @return {fabric.Canvas} instance\n   * @chainable\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#deserialization}\n   * @see {@link http://jsfiddle.net/fabricjs/fmgXt/|jsFiddle demo}\n   * @example <caption>loadFromJSON</caption>\n   * canvas.loadFromJSON(json, canvas.renderAll.bind(canvas));\n   * @example <caption>loadFromJSON with reviver</caption>\n   * canvas.loadFromJSON(json, canvas.renderAll.bind(canvas), function(o, object) {\n   *   // `o` = json object\n   *   // `object` = fabric.Object instance\n   *   // ... do some stuff ...\n   * });\n   */\n  loadFromJSON: function (json, callback, reviver) {\n    if (!json) {\n      return;\n    }\n\n    // serialize if it wasn't already\n    var serialized = (typeof json === 'string')\n      ? JSON.parse(json)\n      : fabric.util.object.clone(json);\n\n    var _this = this,\n        clipPath = serialized.clipPath,\n        renderOnAddRemove = this.renderOnAddRemove;\n\n    this.renderOnAddRemove = false;\n\n    delete serialized.clipPath;\n\n    this._enlivenObjects(serialized.objects, function (enlivenedObjects) {\n      _this.clear();\n      _this._setBgOverlay(serialized, function () {\n        if (clipPath) {\n          _this._enlivenObjects([clipPath], function (enlivenedCanvasClip) {\n            _this.clipPath = enlivenedCanvasClip[0];\n            _this.__setupCanvas.call(_this, serialized, enlivenedObjects, renderOnAddRemove, callback);\n          });\n        }\n        else {\n          _this.__setupCanvas.call(_this, serialized, enlivenedObjects, renderOnAddRemove, callback);\n        }\n      });\n    }, reviver);\n    return this;\n  },\n\n  /**\n   * @private\n   * @param {Object} serialized Object with background and overlay information\n   * @param {Array} restored canvas objects\n   * @param {Function} cached renderOnAddRemove callback\n   * @param {Function} callback Invoked after all background and overlay images/patterns loaded\n   */\n  __setupCanvas: function(serialized, enlivenedObjects, renderOnAddRemove, callback) {\n    var _this = this;\n    enlivenedObjects.forEach(function(obj, index) {\n      // we splice the array just in case some custom classes restored from JSON\n      // will add more object to canvas at canvas init.\n      _this.insertAt(obj, index);\n    });\n    this.renderOnAddRemove = renderOnAddRemove;\n    // remove parts i cannot set as options\n    delete serialized.objects;\n    delete serialized.backgroundImage;\n    delete serialized.overlayImage;\n    delete serialized.background;\n    delete serialized.overlay;\n    // this._initOptions does too many things to just\n    // call it. Normally loading an Object from JSON\n    // create the Object instance. Here the Canvas is\n    // already an instance and we are just loading things over it\n    this._setOptions(serialized);\n    this.renderAll();\n    callback && callback();\n  },\n\n  /**\n   * @private\n   * @param {Object} serialized Object with background and overlay information\n   * @param {Function} callback Invoked after all background and overlay images/patterns loaded\n   */\n  _setBgOverlay: function(serialized, callback) {\n    var loaded = {\n      backgroundColor: false,\n      overlayColor: false,\n      backgroundImage: false,\n      overlayImage: false\n    };\n\n    if (!serialized.backgroundImage && !serialized.overlayImage && !serialized.background && !serialized.overlay) {\n      callback && callback();\n      return;\n    }\n\n    var cbIfLoaded = function () {\n      if (loaded.backgroundImage && loaded.overlayImage && loaded.backgroundColor && loaded.overlayColor) {\n        callback && callback();\n      }\n    };\n\n    this.__setBgOverlay('backgroundImage', serialized.backgroundImage, loaded, cbIfLoaded);\n    this.__setBgOverlay('overlayImage', serialized.overlayImage, loaded, cbIfLoaded);\n    this.__setBgOverlay('backgroundColor', serialized.background, loaded, cbIfLoaded);\n    this.__setBgOverlay('overlayColor', serialized.overlay, loaded, cbIfLoaded);\n  },\n\n  /**\n   * @private\n   * @param {String} property Property to set (backgroundImage, overlayImage, backgroundColor, overlayColor)\n   * @param {(Object|String)} value Value to set\n   * @param {Object} loaded Set loaded property to true if property is set\n   * @param {Object} callback Callback function to invoke after property is set\n   */\n  __setBgOverlay: function(property, value, loaded, callback) {\n    var _this = this;\n\n    if (!value) {\n      loaded[property] = true;\n      callback && callback();\n      return;\n    }\n\n    if (property === 'backgroundImage' || property === 'overlayImage') {\n      fabric.util.enlivenObjects([value], function(enlivedObject){\n        _this[property] = enlivedObject[0];\n        loaded[property] = true;\n        callback && callback();\n      });\n    }\n    else {\n      this['set' + fabric.util.string.capitalize(property, true)](value, function() {\n        loaded[property] = true;\n        callback && callback();\n      });\n    }\n  },\n\n  /**\n   * @private\n   * @param {Array} objects\n   * @param {Function} callback\n   * @param {Function} [reviver]\n   */\n  _enlivenObjects: function (objects, callback, reviver) {\n    if (!objects || objects.length === 0) {\n      callback && callback([]);\n      return;\n    }\n\n    fabric.util.enlivenObjects(objects, function(enlivenedObjects) {\n      callback && callback(enlivenedObjects);\n    }, null, reviver);\n  },\n\n  /**\n   * @private\n   * @param {String} format\n   * @param {Function} callback\n   */\n  _toDataURL: function (format, callback) {\n    this.clone(function (clone) {\n      callback(clone.toDataURL(format));\n    });\n  },\n\n  /**\n   * @private\n   * @param {String} format\n   * @param {Number} multiplier\n   * @param {Function} callback\n   */\n  _toDataURLWithMultiplier: function (format, multiplier, callback) {\n    this.clone(function (clone) {\n      callback(clone.toDataURLWithMultiplier(format, multiplier));\n    });\n  },\n\n  /**\n   * Clones canvas instance\n   * @param {Object} [callback] Receives cloned instance as a first argument\n   * @param {Array} [properties] Array of properties to include in the cloned canvas and children\n   */\n  clone: function (callback, properties) {\n    var data = JSON.stringify(this.toJSON(properties));\n    this.cloneWithoutData(function(clone) {\n      clone.loadFromJSON(data, function() {\n        callback && callback(clone);\n      });\n    });\n  },\n\n  /**\n   * Clones canvas instance without cloning existing data.\n   * This essentially copies canvas dimensions, clipping properties, etc.\n   * but leaves data empty (so that you can populate it with your own)\n   * @param {Object} [callback] Receives cloned instance as a first argument\n   */\n  cloneWithoutData: function(callback) {\n    var el = fabric.util.createCanvasElement();\n\n    el.width = this.width;\n    el.height = this.height;\n\n    var clone = new fabric.Canvas(el);\n    if (this.backgroundImage) {\n      clone.setBackgroundImage(this.backgroundImage.src, function() {\n        clone.renderAll();\n        callback && callback(clone);\n      });\n      clone.backgroundImageOpacity = this.backgroundImageOpacity;\n      clone.backgroundImageStretch = this.backgroundImageStretch;\n    }\n    else {\n      callback && callback(clone);\n    }\n  }\n});\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      extend = fabric.util.object.extend,\n      clone = fabric.util.object.clone,\n      toFixed = fabric.util.toFixed,\n      capitalize = fabric.util.string.capitalize,\n      degreesToRadians = fabric.util.degreesToRadians,\n      objectCaching = !fabric.isLikelyNode,\n      ALIASING_LIMIT = 2;\n\n  if (fabric.Object) {\n    return;\n  }\n\n  /**\n   * Root object class from which all 2d shape classes inherit from\n   * @class fabric.Object\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#objects}\n   * @see {@link fabric.Object#initialize} for constructor definition\n   *\n   * @fires added\n   * @fires removed\n   *\n   * @fires selected\n   * @fires deselected\n   * @fires modified\n   * @fires modified\n   * @fires moved\n   * @fires scaled\n   * @fires rotated\n   * @fires skewed\n   *\n   * @fires rotating\n   * @fires scaling\n   * @fires moving\n   * @fires skewing\n   *\n   * @fires mousedown\n   * @fires mouseup\n   * @fires mouseover\n   * @fires mouseout\n   * @fires mousewheel\n   * @fires mousedblclick\n   *\n   * @fires dragover\n   * @fires dragenter\n   * @fires dragleave\n   * @fires drop\n   */\n  fabric.Object = fabric.util.createClass(fabric.CommonMethods, /** @lends fabric.Object.prototype */ {\n\n    /**\n     * Type of an object (rect, circle, path, etc.).\n     * Note that this property is meant to be read-only and not meant to be modified.\n     * If you modify, certain parts of Fabric (such as JSON loading) won't work correctly.\n     * @type String\n     * @default\n     */\n    type:                     'object',\n\n    /**\n     * Horizontal origin of transformation of an object (one of \"left\", \"right\", \"center\")\n     * See http://jsfiddle.net/1ow02gea/244/ on how originX/originY affect objects in groups\n     * @type String\n     * @default\n     */\n    originX:                  'left',\n\n    /**\n     * Vertical origin of transformation of an object (one of \"top\", \"bottom\", \"center\")\n     * See http://jsfiddle.net/1ow02gea/244/ on how originX/originY affect objects in groups\n     * @type String\n     * @default\n     */\n    originY:                  'top',\n\n    /**\n     * Top position of an object. Note that by default it's relative to object top. You can change this by setting originY={top/center/bottom}\n     * @type Number\n     * @default\n     */\n    top:                      0,\n\n    /**\n     * Left position of an object. Note that by default it's relative to object left. You can change this by setting originX={left/center/right}\n     * @type Number\n     * @default\n     */\n    left:                     0,\n\n    /**\n     * Object width\n     * @type Number\n     * @default\n     */\n    width:                    0,\n\n    /**\n     * Object height\n     * @type Number\n     * @default\n     */\n    height:                   0,\n\n    /**\n     * Object scale factor (horizontal)\n     * @type Number\n     * @default\n     */\n    scaleX:                   1,\n\n    /**\n     * Object scale factor (vertical)\n     * @type Number\n     * @default\n     */\n    scaleY:                   1,\n\n    /**\n     * When true, an object is rendered as flipped horizontally\n     * @type Boolean\n     * @default\n     */\n    flipX:                    false,\n\n    /**\n     * When true, an object is rendered as flipped vertically\n     * @type Boolean\n     * @default\n     */\n    flipY:                    false,\n\n    /**\n     * Opacity of an object\n     * @type Number\n     * @default\n     */\n    opacity:                  1,\n\n    /**\n     * Angle of rotation of an object (in degrees)\n     * @type Number\n     * @default\n     */\n    angle:                    0,\n\n    /**\n     * Angle of skew on x axes of an object (in degrees)\n     * @type Number\n     * @default\n     */\n    skewX:                    0,\n\n    /**\n     * Angle of skew on y axes of an object (in degrees)\n     * @type Number\n     * @default\n     */\n    skewY:                    0,\n\n    /**\n     * Size of object's controlling corners (in pixels)\n     * @type Number\n     * @default\n     */\n    cornerSize:               13,\n\n    /**\n     * Size of object's controlling corners when touch interaction is detected\n     * @type Number\n     * @default\n     */\n    touchCornerSize:               24,\n\n    /**\n     * When true, object's controlling corners are rendered as transparent inside (i.e. stroke instead of fill)\n     * @type Boolean\n     * @default\n     */\n    transparentCorners:       true,\n\n    /**\n     * Default cursor value used when hovering over this object on canvas\n     * @type String\n     * @default\n     */\n    hoverCursor:              null,\n\n    /**\n     * Default cursor value used when moving this object on canvas\n     * @type String\n     * @default\n     */\n    moveCursor:               null,\n\n    /**\n     * Padding between object and its controlling borders (in pixels)\n     * @type Number\n     * @default\n     */\n    padding:                  0,\n\n    /**\n     * Color of controlling borders of an object (when it's active)\n     * @type String\n     * @default\n     */\n    borderColor:              'rgb(178,204,255)',\n\n    /**\n     * Array specifying dash pattern of an object's borders (hasBorder must be true)\n     * @since 1.6.2\n     * @type Array\n     */\n    borderDashArray:          null,\n\n    /**\n     * Color of controlling corners of an object (when it's active)\n     * @type String\n     * @default\n     */\n    cornerColor:              'rgb(178,204,255)',\n\n    /**\n     * Color of controlling corners of an object (when it's active and transparentCorners false)\n     * @since 1.6.2\n     * @type String\n     * @default\n     */\n    cornerStrokeColor:        null,\n\n    /**\n     * Specify style of control, 'rect' or 'circle'\n     * @since 1.6.2\n     * @type String\n     */\n    cornerStyle:          'rect',\n\n    /**\n     * Array specifying dash pattern of an object's control (hasBorder must be true)\n     * @since 1.6.2\n     * @type Array\n     */\n    cornerDashArray:          null,\n\n    /**\n     * When true, this object will use center point as the origin of transformation\n     * when being scaled via the controls.\n     * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\n     * @since 1.3.4\n     * @type Boolean\n     * @default\n     */\n    centeredScaling:          false,\n\n    /**\n     * When true, this object will use center point as the origin of transformation\n     * when being rotated via the controls.\n     * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\n     * @since 1.3.4\n     * @type Boolean\n     * @default\n     */\n    centeredRotation:         true,\n\n    /**\n     * Color of object's fill\n     * takes css colors https://www.w3.org/TR/css-color-3/\n     * @type String\n     * @default\n     */\n    fill:                     'rgb(0,0,0)',\n\n    /**\n     * Fill rule used to fill an object\n     * accepted values are nonzero, evenodd\n     * <b>Backwards incompatibility note:</b> This property was used for setting globalCompositeOperation until v1.4.12 (use `fabric.Object#globalCompositeOperation` instead)\n     * @type String\n     * @default\n     */\n    fillRule:                 'nonzero',\n\n    /**\n     * Composite rule used for canvas globalCompositeOperation\n     * @type String\n     * @default\n     */\n    globalCompositeOperation: 'source-over',\n\n    /**\n     * Background color of an object.\n     * takes css colors https://www.w3.org/TR/css-color-3/\n     * @type String\n     * @default\n     */\n    backgroundColor:          '',\n\n    /**\n     * Selection Background color of an object. colored layer behind the object when it is active.\n     * does not mix good with globalCompositeOperation methods.\n     * @type String\n     * @default\n     */\n    selectionBackgroundColor:          '',\n\n    /**\n     * When defined, an object is rendered via stroke and this property specifies its color\n     * takes css colors https://www.w3.org/TR/css-color-3/\n     * @type String\n     * @default\n     */\n    stroke:                   null,\n\n    /**\n     * Width of a stroke used to render this object\n     * @type Number\n     * @default\n     */\n    strokeWidth:              1,\n\n    /**\n     * Array specifying dash pattern of an object's stroke (stroke must be defined)\n     * @type Array\n     */\n    strokeDashArray:          null,\n\n    /**\n     * Line offset of an object's stroke\n     * @type Number\n     * @default\n     */\n    strokeDashOffset: 0,\n\n    /**\n     * Line endings style of an object's stroke (one of \"butt\", \"round\", \"square\")\n     * @type String\n     * @default\n     */\n    strokeLineCap:            'butt',\n\n    /**\n     * Corner style of an object's stroke (one of \"bevel\", \"round\", \"miter\")\n     * @type String\n     * @default\n     */\n    strokeLineJoin:           'miter',\n\n    /**\n     * Maximum miter length (used for strokeLineJoin = \"miter\") of an object's stroke\n     * @type Number\n     * @default\n     */\n    strokeMiterLimit:         4,\n\n    /**\n     * Shadow object representing shadow of this shape\n     * @type fabric.Shadow\n     * @default\n     */\n    shadow:                   null,\n\n    /**\n     * Opacity of object's controlling borders when object is active and moving\n     * @type Number\n     * @default\n     */\n    borderOpacityWhenMoving:  0.4,\n\n    /**\n     * Scale factor of object's controlling borders\n     * bigger number will make a thicker border\n     * border is 1, so this is basically a border thickness\n     * since there is no way to change the border itself.\n     * @type Number\n     * @default\n     */\n    borderScaleFactor:        1,\n\n    /**\n     * Minimum allowed scale value of an object\n     * @type Number\n     * @default\n     */\n    minScaleLimit:            0,\n\n    /**\n     * When set to `false`, an object can not be selected for modification (using either point-click-based or group-based selection).\n     * But events still fire on it.\n     * @type Boolean\n     * @default\n     */\n    selectable:               true,\n\n    /**\n     * When set to `false`, an object can not be a target of events. All events propagate through it. Introduced in v1.3.4\n     * @type Boolean\n     * @default\n     */\n    evented:                  true,\n\n    /**\n     * When set to `false`, an object is not rendered on canvas\n     * @type Boolean\n     * @default\n     */\n    visible:                  true,\n\n    /**\n     * When set to `false`, object's controls are not displayed and can not be used to manipulate object\n     * @type Boolean\n     * @default\n     */\n    hasControls:              true,\n\n    /**\n     * When set to `false`, object's controlling borders are not rendered\n     * @type Boolean\n     * @default\n     */\n    hasBorders:               true,\n\n    /**\n     * When set to `true`, objects are \"found\" on canvas on per-pixel basis rather than according to bounding box\n     * @type Boolean\n     * @default\n     */\n    perPixelTargetFind:       false,\n\n    /**\n     * When `false`, default object's values are not included in its serialization\n     * @type Boolean\n     * @default\n     */\n    includeDefaultValues:     true,\n\n    /**\n     * When `true`, object horizontal movement is locked\n     * @type Boolean\n     * @default\n     */\n    lockMovementX:            false,\n\n    /**\n     * When `true`, object vertical movement is locked\n     * @type Boolean\n     * @default\n     */\n    lockMovementY:            false,\n\n    /**\n     * When `true`, object rotation is locked\n     * @type Boolean\n     * @default\n     */\n    lockRotation:             false,\n\n    /**\n     * When `true`, object horizontal scaling is locked\n     * @type Boolean\n     * @default\n     */\n    lockScalingX:             false,\n\n    /**\n     * When `true`, object vertical scaling is locked\n     * @type Boolean\n     * @default\n     */\n    lockScalingY:             false,\n\n    /**\n     * When `true`, object horizontal skewing is locked\n     * @type Boolean\n     * @default\n     */\n    lockSkewingX:             false,\n\n    /**\n     * When `true`, object vertical skewing is locked\n     * @type Boolean\n     * @default\n     */\n    lockSkewingY:             false,\n\n    /**\n     * When `true`, object cannot be flipped by scaling into negative values\n     * @type Boolean\n     * @default\n     */\n    lockScalingFlip:          false,\n\n    /**\n     * When `true`, object is not exported in OBJECT/JSON\n     * @since 1.6.3\n     * @type Boolean\n     * @default\n     */\n    excludeFromExport:        false,\n\n    /**\n     * When `true`, object is cached on an additional canvas.\n     * When `false`, object is not cached unless necessary ( clipPath )\n     * default to true\n     * @since 1.7.0\n     * @type Boolean\n     * @default true\n     */\n    objectCaching:            objectCaching,\n\n    /**\n     * When `true`, object properties are checked for cache invalidation. In some particular\n     * situation you may want this to be disabled ( spray brush, very big, groups)\n     * or if your application does not allow you to modify properties for groups child you want\n     * to disable it for groups.\n     * default to false\n     * since 1.7.0\n     * @type Boolean\n     * @default false\n     */\n    statefullCache:            false,\n\n    /**\n     * When `true`, cache does not get updated during scaling. The picture will get blocky if scaled\n     * too much and will be redrawn with correct details at the end of scaling.\n     * this setting is performance and application dependant.\n     * default to true\n     * since 1.7.0\n     * @type Boolean\n     * @default true\n     */\n    noScaleCache:              true,\n\n    /**\n     * When `false`, the stoke width will scale with the object.\n     * When `true`, the stroke will always match the exact pixel size entered for stroke width.\n     * this Property does not work on Text classes or drawing call that uses strokeText,fillText methods\n     * default to false\n     * @since 2.6.0\n     * @type Boolean\n     * @default false\n     * @type Boolean\n     * @default false\n     */\n    strokeUniform:              false,\n\n    /**\n     * When set to `true`, object's cache will be rerendered next render call.\n     * since 1.7.0\n     * @type Boolean\n     * @default true\n     */\n    dirty:                true,\n\n    /**\n     * keeps the value of the last hovered corner during mouse move.\n     * 0 is no corner, or 'mt', 'ml', 'mtr' etc..\n     * It should be private, but there is no harm in using it as\n     * a read-only property.\n     * @type number|string|any\n     * @default 0\n     */\n    __corner: 0,\n\n    /**\n     * Determines if the fill or the stroke is drawn first (one of \"fill\" or \"stroke\")\n     * @type String\n     * @default\n     */\n    paintFirst:           'fill',\n\n    /**\n     * When 'down', object is set to active on mousedown/touchstart\n     * When 'up', object is set to active on mouseup/touchend\n     * Experimental. Let's see if this breaks anything before supporting officially\n     * @private\n     * since 4.4.0\n     * @type String\n     * @default 'down'\n     */\n    activeOn:           'down',\n\n    /**\n     * List of properties to consider when checking if state\n     * of an object is changed (fabric.Object#hasStateChanged)\n     * as well as for history (undo/redo) purposes\n     * @type Array\n     */\n    stateProperties: (\n      'top left width height scaleX scaleY flipX flipY originX originY transformMatrix ' +\n      'stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit ' +\n      'angle opacity fill globalCompositeOperation shadow visible backgroundColor ' +\n      'skewX skewY fillRule paintFirst clipPath strokeUniform'\n    ).split(' '),\n\n    /**\n     * List of properties to consider when checking if cache needs refresh\n     * Those properties are checked by statefullCache ON ( or lazy mode if we want ) or from single\n     * calls to Object.set(key, value). If the key is in this list, the object is marked as dirty\n     * and refreshed at the next render\n     * @type Array\n     */\n    cacheProperties: (\n      'fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform' +\n      ' strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath'\n    ).split(' '),\n\n    /**\n     * List of properties to consider for animating colors.\n     * @type Array\n     */\n    colorProperties: (\n      'fill stroke backgroundColor'\n    ).split(' '),\n\n    /**\n     * a fabricObject that, without stroke define a clipping area with their shape. filled in black\n     * the clipPath object gets used when the object has rendered, and the context is placed in the center\n     * of the object cacheCanvas.\n     * If you want 0,0 of a clipPath to align with an object center, use clipPath.originX/Y to 'center'\n     * @type fabric.Object\n     */\n    clipPath: undefined,\n\n    /**\n     * Meaningful ONLY when the object is used as clipPath.\n     * if true, the clipPath will make the object clip to the outside of the clipPath\n     * since 2.4.0\n     * @type boolean\n     * @default false\n     */\n    inverted: false,\n\n    /**\n     * Meaningful ONLY when the object is used as clipPath.\n     * if true, the clipPath will have its top and left relative to canvas, and will\n     * not be influenced by the object transform. This will make the clipPath relative\n     * to the canvas, but clipping just a particular object.\n     * WARNING this is beta, this feature may change or be renamed.\n     * since 2.4.0\n     * @type boolean\n     * @default false\n     */\n    absolutePositioned: false,\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     */\n    initialize: function(options) {\n      if (options) {\n        this.setOptions(options);\n      }\n    },\n\n    /**\n     * Create a the canvas used to keep the cached copy of the object\n     * @private\n     */\n    _createCacheCanvas: function() {\n      this._cacheProperties = {};\n      this._cacheCanvas = fabric.util.createCanvasElement();\n      this._cacheContext = this._cacheCanvas.getContext('2d');\n      this._updateCacheCanvas();\n      // if canvas gets created, is empty, so dirty.\n      this.dirty = true;\n    },\n\n    /**\n     * Limit the cache dimensions so that X * Y do not cross fabric.perfLimitSizeTotal\n     * and each side do not cross fabric.cacheSideLimit\n     * those numbers are configurable so that you can get as much detail as you want\n     * making bargain with performances.\n     * @param {Object} dims\n     * @param {Object} dims.width width of canvas\n     * @param {Object} dims.height height of canvas\n     * @param {Object} dims.zoomX zoomX zoom value to unscale the canvas before drawing cache\n     * @param {Object} dims.zoomY zoomY zoom value to unscale the canvas before drawing cache\n     * @return {Object}.width width of canvas\n     * @return {Object}.height height of canvas\n     * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n     * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n     */\n    _limitCacheSize: function(dims) {\n      var perfLimitSizeTotal = fabric.perfLimitSizeTotal,\n          width = dims.width, height = dims.height,\n          max = fabric.maxCacheSideLimit, min = fabric.minCacheSideLimit;\n      if (width <= max && height <= max && width * height <= perfLimitSizeTotal) {\n        if (width < min) {\n          dims.width = min;\n        }\n        if (height < min) {\n          dims.height = min;\n        }\n        return dims;\n      }\n      var ar = width / height, limitedDims = fabric.util.limitDimsByArea(ar, perfLimitSizeTotal),\n          capValue = fabric.util.capValue,\n          x = capValue(min, limitedDims.x, max),\n          y = capValue(min, limitedDims.y, max);\n      if (width > x) {\n        dims.zoomX /= width / x;\n        dims.width = x;\n        dims.capped = true;\n      }\n      if (height > y) {\n        dims.zoomY /= height / y;\n        dims.height = y;\n        dims.capped = true;\n      }\n      return dims;\n    },\n\n    /**\n     * Return the dimension and the zoom level needed to create a cache canvas\n     * big enough to host the object to be cached.\n     * @private\n     * @return {Object}.x width of object to be cached\n     * @return {Object}.y height of object to be cached\n     * @return {Object}.width width of canvas\n     * @return {Object}.height height of canvas\n     * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n     * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n     */\n    _getCacheCanvasDimensions: function() {\n      var objectScale = this.getTotalObjectScaling(),\n          // caculate dimensions without skewing\n          dim = this._getTransformedDimensions(0, 0),\n          neededX = dim.x * objectScale.scaleX / this.scaleX,\n          neededY = dim.y * objectScale.scaleY / this.scaleY;\n      return {\n        // for sure this ALIASING_LIMIT is slightly creating problem\n        // in situation in which the cache canvas gets an upper limit\n        // also objectScale contains already scaleX and scaleY\n        width: Math.ceil(neededX + ALIASING_LIMIT),\n        height: Math.ceil(neededY + ALIASING_LIMIT),\n        zoomX: objectScale.scaleX,\n        zoomY: objectScale.scaleY,\n        x: neededX,\n        y: neededY\n      };\n    },\n\n    /**\n     * Update width and height of the canvas for cache\n     * returns true or false if canvas needed resize.\n     * @private\n     * @return {Boolean} true if the canvas has been resized\n     */\n    _updateCacheCanvas: function() {\n      var targetCanvas = this.canvas;\n      if (this.noScaleCache && targetCanvas && targetCanvas._currentTransform) {\n        var target = targetCanvas._currentTransform.target,\n            action = targetCanvas._currentTransform.action;\n        if (this === target && action.slice && action.slice(0, 5) === 'scale') {\n          return false;\n        }\n      }\n      var canvas = this._cacheCanvas,\n          dims = this._limitCacheSize(this._getCacheCanvasDimensions()),\n          width = dims.width, height = dims.height, drawingWidth, drawingHeight,\n          zoomX = dims.zoomX, zoomY = dims.zoomY,\n          dimensionsChanged = width !== this.cacheWidth || height !== this.cacheHeight,\n          zoomChanged = this.zoomX !== zoomX || this.zoomY !== zoomY,\n          shouldRedraw = dimensionsChanged || zoomChanged;\n\n      if (shouldRedraw) {\n        if (dimensionsChanged) {\n          canvas.width = width;\n          canvas.height = height;\n        }\n        else {\n          this._cacheContext.setTransform(1, 0, 0, 1, 0, 0);\n          this._cacheContext.clearRect(0, 0, canvas.width, canvas.height);\n        }\n        drawingWidth = dims.x / 2;\n        drawingHeight = dims.y / 2;\n        this.cacheTranslationX = Math.round(canvas.width / 2 - drawingWidth) + drawingWidth;\n        this.cacheTranslationY = Math.round(canvas.height / 2 - drawingHeight) + drawingHeight;\n        this.cacheWidth = width;\n        this.cacheHeight = height;\n        this._cacheContext.translate(this.cacheTranslationX, this.cacheTranslationY);\n        this._cacheContext.scale(zoomX, zoomY);\n        this.zoomX = zoomX;\n        this.zoomY = zoomY;\n        return true;\n      }\n      return false;\n    },\n\n    /**\n     * Sets object's properties from options\n     * @param {Object} [options] Options object\n     */\n    setOptions: function(options) {\n      this._setOptions(options);\n      this._initGradient(options.fill, 'fill');\n      this._initGradient(options.stroke, 'stroke');\n      this._initPattern(options.fill, 'fill');\n      this._initPattern(options.stroke, 'stroke');\n    },\n\n    /**\n     * Transforms context when rendering an object\n     * @param {CanvasRenderingContext2D} ctx Context\n     */\n    transform: function(ctx) {\n      var needFullTransform = (this.group && !this.group._transformDone) ||\n         (this.group && this.canvas && ctx === this.canvas.contextTop);\n      var m = this.calcTransformMatrix(!needFullTransform);\n      ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n    },\n\n    /**\n     * Returns an object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS,\n\n          object = {\n            type:                     this.type,\n            version:                  fabric.version,\n            originX:                  this.originX,\n            originY:                  this.originY,\n            left:                     toFixed(this.left, NUM_FRACTION_DIGITS),\n            top:                      toFixed(this.top, NUM_FRACTION_DIGITS),\n            width:                    toFixed(this.width, NUM_FRACTION_DIGITS),\n            height:                   toFixed(this.height, NUM_FRACTION_DIGITS),\n            fill:                     (this.fill && this.fill.toObject) ? this.fill.toObject() : this.fill,\n            stroke:                   (this.stroke && this.stroke.toObject) ? this.stroke.toObject() : this.stroke,\n            strokeWidth:              toFixed(this.strokeWidth, NUM_FRACTION_DIGITS),\n            strokeDashArray:          this.strokeDashArray ? this.strokeDashArray.concat() : this.strokeDashArray,\n            strokeLineCap:            this.strokeLineCap,\n            strokeDashOffset:         this.strokeDashOffset,\n            strokeLineJoin:           this.strokeLineJoin,\n            strokeUniform:            this.strokeUniform,\n            strokeMiterLimit:         toFixed(this.strokeMiterLimit, NUM_FRACTION_DIGITS),\n            scaleX:                   toFixed(this.scaleX, NUM_FRACTION_DIGITS),\n            scaleY:                   toFixed(this.scaleY, NUM_FRACTION_DIGITS),\n            angle:                    toFixed(this.angle, NUM_FRACTION_DIGITS),\n            flipX:                    this.flipX,\n            flipY:                    this.flipY,\n            opacity:                  toFixed(this.opacity, NUM_FRACTION_DIGITS),\n            shadow:                   (this.shadow && this.shadow.toObject) ? this.shadow.toObject() : this.shadow,\n            visible:                  this.visible,\n            backgroundColor:          this.backgroundColor,\n            fillRule:                 this.fillRule,\n            paintFirst:               this.paintFirst,\n            globalCompositeOperation: this.globalCompositeOperation,\n            skewX:                    toFixed(this.skewX, NUM_FRACTION_DIGITS),\n            skewY:                    toFixed(this.skewY, NUM_FRACTION_DIGITS),\n          };\n\n      if (this.clipPath && !this.clipPath.excludeFromExport) {\n        object.clipPath = this.clipPath.toObject(propertiesToInclude);\n        object.clipPath.inverted = this.clipPath.inverted;\n        object.clipPath.absolutePositioned = this.clipPath.absolutePositioned;\n      }\n\n      fabric.util.populateWithProperties(this, object, propertiesToInclude);\n      if (!this.includeDefaultValues) {\n        object = this._removeDefaultValues(object);\n      }\n\n      return object;\n    },\n\n    /**\n     * Returns (dataless) object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} Object representation of an instance\n     */\n    toDatalessObject: function(propertiesToInclude) {\n      // will be overwritten by subclasses\n      return this.toObject(propertiesToInclude);\n    },\n\n    /**\n     * @private\n     * @param {Object} object\n     */\n    _removeDefaultValues: function(object) {\n      var prototype = fabric.util.getKlass(object.type).prototype,\n          stateProperties = prototype.stateProperties;\n      stateProperties.forEach(function(prop) {\n        if (prop === 'left' || prop === 'top') {\n          return;\n        }\n        if (object[prop] === prototype[prop]) {\n          delete object[prop];\n        }\n        // basically a check for [] === []\n        if (Array.isArray(object[prop]) && Array.isArray(prototype[prop])\n          && object[prop].length === 0 && prototype[prop].length === 0) {\n          delete object[prop];\n        }\n      });\n\n      return object;\n    },\n\n    /**\n     * Returns a string representation of an instance\n     * @return {String}\n     */\n    toString: function() {\n      return '#<fabric.' + capitalize(this.type) + '>';\n    },\n\n    /**\n     * Return the object scale factor counting also the group scaling\n     * @return {Object} object with scaleX and scaleY properties\n     */\n    getObjectScaling: function() {\n      // if the object is a top level one, on the canvas, we go for simple aritmetic\n      // otherwise the complex method with angles will return approximations and decimals\n      // and will likely kill the cache when not needed\n      // https://github.com/fabricjs/fabric.js/issues/7157\n      if (!this.group) {\n        return {\n          scaleX: this.scaleX,\n          scaleY: this.scaleY,\n        };\n      }\n      // if we are inside a group total zoom calculation is complex, we defer to generic matrices\n      var options = fabric.util.qrDecompose(this.calcTransformMatrix());\n      return { scaleX: Math.abs(options.scaleX), scaleY: Math.abs(options.scaleY) };\n    },\n\n    /**\n     * Return the object scale factor counting also the group scaling, zoom and retina\n     * @return {Object} object with scaleX and scaleY properties\n     */\n    getTotalObjectScaling: function() {\n      var scale = this.getObjectScaling(), scaleX = scale.scaleX, scaleY = scale.scaleY;\n      if (this.canvas) {\n        var zoom = this.canvas.getZoom();\n        var retina = this.canvas.getRetinaScaling();\n        scaleX *= zoom * retina;\n        scaleY *= zoom * retina;\n      }\n      return { scaleX: scaleX, scaleY: scaleY };\n    },\n\n    /**\n     * Return the object opacity counting also the group property\n     * @return {Number}\n     */\n    getObjectOpacity: function() {\n      var opacity = this.opacity;\n      if (this.group) {\n        opacity *= this.group.getObjectOpacity();\n      }\n      return opacity;\n    },\n\n    /**\n     * @private\n     * @param {String} key\n     * @param {*} value\n     * @return {fabric.Object} thisArg\n     */\n    _set: function(key, value) {\n      var shouldConstrainValue = (key === 'scaleX' || key === 'scaleY'),\n          isChanged = this[key] !== value, groupNeedsUpdate = false;\n\n      if (shouldConstrainValue) {\n        value = this._constrainScale(value);\n      }\n      if (key === 'scaleX' && value < 0) {\n        this.flipX = !this.flipX;\n        value *= -1;\n      }\n      else if (key === 'scaleY' && value < 0) {\n        this.flipY = !this.flipY;\n        value *= -1;\n      }\n      else if (key === 'shadow' && value && !(value instanceof fabric.Shadow)) {\n        value = new fabric.Shadow(value);\n      }\n      else if (key === 'dirty' && this.group) {\n        this.group.set('dirty', value);\n      }\n\n      this[key] = value;\n\n      if (isChanged) {\n        groupNeedsUpdate = this.group && this.group.isOnACache();\n        if (this.cacheProperties.indexOf(key) > -1) {\n          this.dirty = true;\n          groupNeedsUpdate && this.group.set('dirty', true);\n        }\n        else if (groupNeedsUpdate && this.stateProperties.indexOf(key) > -1) {\n          this.group.set('dirty', true);\n        }\n      }\n      return this;\n    },\n\n    /**\n     * This callback function is called by the parent group of an object every\n     * time a non-delegated property changes on the group. It is passed the key\n     * and value as parameters. Not adding in this function's signature to avoid\n     * Travis build error about unused variables.\n     */\n    setOnGroup: function() {\n      // implemented by sub-classes, as needed.\n    },\n\n    /**\n     * Retrieves viewportTransform from Object's canvas if possible\n     * @method getViewportTransform\n     * @memberOf fabric.Object.prototype\n     * @return {Array}\n     */\n    getViewportTransform: function() {\n      if (this.canvas && this.canvas.viewportTransform) {\n        return this.canvas.viewportTransform;\n      }\n      return fabric.iMatrix.concat();\n    },\n\n    /*\n     * @private\n     * return if the object would be visible in rendering\n     * @memberOf fabric.Object.prototype\n     * @return {Boolean}\n     */\n    isNotVisible: function() {\n      return this.opacity === 0 ||\n        (!this.width && !this.height && this.strokeWidth === 0) ||\n        !this.visible;\n    },\n\n    /**\n     * Renders an object on a specified context\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    render: function(ctx) {\n      // do not render if width/height are zeros or object is not visible\n      if (this.isNotVisible()) {\n        return;\n      }\n      if (this.canvas && this.canvas.skipOffscreen && !this.group && !this.isOnScreen()) {\n        return;\n      }\n      ctx.save();\n      this._setupCompositeOperation(ctx);\n      this.drawSelectionBackground(ctx);\n      this.transform(ctx);\n      this._setOpacity(ctx);\n      this._setShadow(ctx, this);\n      if (this.shouldCache()) {\n        this.renderCache();\n        this.drawCacheOnCanvas(ctx);\n      }\n      else {\n        this._removeCacheCanvas();\n        this.dirty = false;\n        this.drawObject(ctx);\n        if (this.objectCaching && this.statefullCache) {\n          this.saveState({ propertySet: 'cacheProperties' });\n        }\n      }\n      ctx.restore();\n    },\n\n    renderCache: function(options) {\n      options = options || {};\n      if (!this._cacheCanvas || !this._cacheContext) {\n        this._createCacheCanvas();\n      }\n      if (this.isCacheDirty()) {\n        this.statefullCache && this.saveState({ propertySet: 'cacheProperties' });\n        this.drawObject(this._cacheContext, options.forClipping);\n        this.dirty = false;\n      }\n    },\n\n    /**\n     * Remove cacheCanvas and its dimensions from the objects\n     */\n    _removeCacheCanvas: function() {\n      this._cacheCanvas = null;\n      this._cacheContext = null;\n      this.cacheWidth = 0;\n      this.cacheHeight = 0;\n    },\n\n    /**\n     * return true if the object will draw a stroke\n     * Does not consider text styles. This is just a shortcut used at rendering time\n     * We want it to be an approximation and be fast.\n     * wrote to avoid extra caching, it has to return true when stroke happens,\n     * can guess when it will not happen at 100% chance, does not matter if it misses\n     * some use case where the stroke is invisible.\n     * @since 3.0.0\n     * @returns Boolean\n     */\n    hasStroke: function() {\n      return this.stroke && this.stroke !== 'transparent' && this.strokeWidth !== 0;\n    },\n\n    /**\n     * return true if the object will draw a fill\n     * Does not consider text styles. This is just a shortcut used at rendering time\n     * We want it to be an approximation and be fast.\n     * wrote to avoid extra caching, it has to return true when fill happens,\n     * can guess when it will not happen at 100% chance, does not matter if it misses\n     * some use case where the fill is invisible.\n     * @since 3.0.0\n     * @returns Boolean\n     */\n    hasFill: function() {\n      return this.fill && this.fill !== 'transparent';\n    },\n\n    /**\n     * When set to `true`, force the object to have its own cache, even if it is inside a group\n     * it may be needed when your object behave in a particular way on the cache and always needs\n     * its own isolated canvas to render correctly.\n     * Created to be overridden\n     * since 1.7.12\n     * @returns Boolean\n     */\n    needsItsOwnCache: function() {\n      if (this.paintFirst === 'stroke' &&\n        this.hasFill() && this.hasStroke() && typeof this.shadow === 'object') {\n        return true;\n      }\n      if (this.clipPath) {\n        return true;\n      }\n      return false;\n    },\n\n    /**\n     * Decide if the object should cache or not. Create its own cache level\n     * objectCaching is a global flag, wins over everything\n     * needsItsOwnCache should be used when the object drawing method requires\n     * a cache step. None of the fabric classes requires it.\n     * Generally you do not cache objects in groups because the group outside is cached.\n     * Read as: cache if is needed, or if the feature is enabled but we are not already caching.\n     * @return {Boolean}\n     */\n    shouldCache: function() {\n      this.ownCaching = this.needsItsOwnCache() || (\n        this.objectCaching &&\n        (!this.group || !this.group.isOnACache())\n      );\n      return this.ownCaching;\n    },\n\n    /**\n     * Check if this object or a child object will cast a shadow\n     * used by Group.shouldCache to know if child has a shadow recursively\n     * @return {Boolean}\n     */\n    willDrawShadow: function() {\n      return !!this.shadow && (this.shadow.offsetX !== 0 || this.shadow.offsetY !== 0);\n    },\n\n    /**\n     * Execute the drawing operation for an object clipPath\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {fabric.Object} clipPath\n     */\n    drawClipPathOnCache: function(ctx, clipPath) {\n      ctx.save();\n      // DEBUG: uncomment this line, comment the following\n      // ctx.globalAlpha = 0.4\n      if (clipPath.inverted) {\n        ctx.globalCompositeOperation = 'destination-out';\n      }\n      else {\n        ctx.globalCompositeOperation = 'destination-in';\n      }\n      //ctx.scale(1 / 2, 1 / 2);\n      if (clipPath.absolutePositioned) {\n        var m = fabric.util.invertTransform(this.calcTransformMatrix());\n        ctx.transform(m[0], m[1], m[2], m[3], m[4], m[5]);\n      }\n      clipPath.transform(ctx);\n      ctx.scale(1 / clipPath.zoomX, 1 / clipPath.zoomY);\n      ctx.drawImage(clipPath._cacheCanvas, -clipPath.cacheTranslationX, -clipPath.cacheTranslationY);\n      ctx.restore();\n    },\n\n    /**\n     * Execute the drawing operation for an object on a specified context\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    drawObject: function(ctx, forClipping) {\n      var originalFill = this.fill, originalStroke = this.stroke;\n      if (forClipping) {\n        this.fill = 'black';\n        this.stroke = '';\n        this._setClippingProperties(ctx);\n      }\n      else {\n        this._renderBackground(ctx);\n      }\n      this._render(ctx);\n      this._drawClipPath(ctx, this.clipPath);\n      this.fill = originalFill;\n      this.stroke = originalStroke;\n    },\n\n    /**\n     * Prepare clipPath state and cache and draw it on instance's cache\n     * @param {CanvasRenderingContext2D} ctx\n     * @param {fabric.Object} clipPath\n     */\n    _drawClipPath: function (ctx, clipPath) {\n      if (!clipPath) { return; }\n      // needed to setup a couple of variables\n      // path canvas gets overridden with this one.\n      // TODO find a better solution?\n      clipPath.canvas = this.canvas;\n      clipPath.shouldCache();\n      clipPath._transformDone = true;\n      clipPath.renderCache({ forClipping: true });\n      this.drawClipPathOnCache(ctx, clipPath);\n    },\n\n    /**\n     * Paint the cached copy of the object on the target context.\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    drawCacheOnCanvas: function(ctx) {\n      ctx.scale(1 / this.zoomX, 1 / this.zoomY);\n      ctx.drawImage(this._cacheCanvas, -this.cacheTranslationX, -this.cacheTranslationY);\n    },\n\n    /**\n     * Check if cache is dirty\n     * @param {Boolean} skipCanvas skip canvas checks because this object is painted\n     * on parent canvas.\n     */\n    isCacheDirty: function(skipCanvas) {\n      if (this.isNotVisible()) {\n        return false;\n      }\n      if (this._cacheCanvas && this._cacheContext && !skipCanvas && this._updateCacheCanvas()) {\n        // in this case the context is already cleared.\n        return true;\n      }\n      else {\n        if (this.dirty ||\n          (this.clipPath && this.clipPath.absolutePositioned) ||\n          (this.statefullCache && this.hasStateChanged('cacheProperties'))\n        ) {\n          if (this._cacheCanvas && this._cacheContext && !skipCanvas) {\n            var width = this.cacheWidth / this.zoomX;\n            var height = this.cacheHeight / this.zoomY;\n            this._cacheContext.clearRect(-width / 2, -height / 2, width, height);\n          }\n          return true;\n        }\n      }\n      return false;\n    },\n\n    /**\n     * Draws a background for the object big as its untransformed dimensions\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderBackground: function(ctx) {\n      if (!this.backgroundColor) {\n        return;\n      }\n      var dim = this._getNonTransformedDimensions();\n      ctx.fillStyle = this.backgroundColor;\n\n      ctx.fillRect(\n        -dim.x / 2,\n        -dim.y / 2,\n        dim.x,\n        dim.y\n      );\n      // if there is background color no other shadows\n      // should be casted\n      this._removeShadow(ctx);\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _setOpacity: function(ctx) {\n      if (this.group && !this.group._transformDone) {\n        ctx.globalAlpha = this.getObjectOpacity();\n      }\n      else {\n        ctx.globalAlpha *= this.opacity;\n      }\n    },\n\n    _setStrokeStyles: function(ctx, decl) {\n      var stroke = decl.stroke;\n      if (stroke) {\n        ctx.lineWidth = decl.strokeWidth;\n        ctx.lineCap = decl.strokeLineCap;\n        ctx.lineDashOffset = decl.strokeDashOffset;\n        ctx.lineJoin = decl.strokeLineJoin;\n        ctx.miterLimit = decl.strokeMiterLimit;\n        if (stroke.toLive) {\n          if (stroke.gradientUnits === 'percentage' || stroke.gradientTransform || stroke.patternTransform) {\n            // need to transform gradient in a pattern.\n            // this is a slow process. If you are hitting this codepath, and the object\n            // is not using caching, you should consider switching it on.\n            // we need a canvas as big as the current object caching canvas.\n            this._applyPatternForTransformedGradient(ctx, stroke);\n          }\n          else {\n            // is a simple gradient or pattern\n            ctx.strokeStyle = stroke.toLive(ctx, this);\n            this._applyPatternGradientTransform(ctx, stroke);\n          }\n        }\n        else {\n          // is a color\n          ctx.strokeStyle = decl.stroke;\n        }\n      }\n    },\n\n    _setFillStyles: function(ctx, decl) {\n      var fill = decl.fill;\n      if (fill) {\n        if (fill.toLive) {\n          ctx.fillStyle = fill.toLive(ctx, this);\n          this._applyPatternGradientTransform(ctx, decl.fill);\n        }\n        else {\n          ctx.fillStyle = fill;\n        }\n      }\n    },\n\n    _setClippingProperties: function(ctx) {\n      ctx.globalAlpha = 1;\n      ctx.strokeStyle = 'transparent';\n      ctx.fillStyle = '#000000';\n    },\n\n    /**\n     * @private\n     * Sets line dash\n     * @param {CanvasRenderingContext2D} ctx Context to set the dash line on\n     * @param {Array} dashArray array representing dashes\n     */\n    _setLineDash: function(ctx, dashArray) {\n      if (!dashArray || dashArray.length === 0) {\n        return;\n      }\n      // Spec requires the concatenation of two copies the dash list when the number of elements is odd\n      if (1 & dashArray.length) {\n        dashArray.push.apply(dashArray, dashArray);\n      }\n      ctx.setLineDash(dashArray);\n    },\n\n    /**\n     * Renders controls and borders for the object\n     * the context here is not transformed\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {Object} [styleOverride] properties to override the object style\n     */\n    _renderControls: function(ctx, styleOverride) {\n      var vpt = this.getViewportTransform(),\n          matrix = this.calcTransformMatrix(),\n          options, drawBorders, drawControls;\n      styleOverride = styleOverride || { };\n      drawBorders = typeof styleOverride.hasBorders !== 'undefined' ? styleOverride.hasBorders : this.hasBorders;\n      drawControls = typeof styleOverride.hasControls !== 'undefined' ? styleOverride.hasControls : this.hasControls;\n      matrix = fabric.util.multiplyTransformMatrices(vpt, matrix);\n      options = fabric.util.qrDecompose(matrix);\n      ctx.save();\n      ctx.translate(options.translateX, options.translateY);\n      ctx.lineWidth = 1 * this.borderScaleFactor;\n      if (!this.group) {\n        ctx.globalAlpha = this.isMoving ? this.borderOpacityWhenMoving : 1;\n      }\n      if (this.flipX) {\n        options.angle -= 180;\n      }\n      ctx.rotate(degreesToRadians(this.group ? options.angle : this.angle));\n      if (styleOverride.forActiveSelection || this.group) {\n        drawBorders && this.drawBordersInGroup(ctx, options, styleOverride);\n      }\n      else {\n        drawBorders && this.drawBorders(ctx, styleOverride);\n      }\n      drawControls && this.drawControls(ctx, styleOverride);\n      ctx.restore();\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _setShadow: function(ctx) {\n      if (!this.shadow) {\n        return;\n      }\n\n      var shadow = this.shadow, canvas = this.canvas, scaling,\n          multX = (canvas && canvas.viewportTransform[0]) || 1,\n          multY = (canvas && canvas.viewportTransform[3]) || 1;\n      if (shadow.nonScaling) {\n        scaling = { scaleX: 1, scaleY: 1 };\n      }\n      else {\n        scaling = this.getObjectScaling();\n      }\n      if (canvas && canvas._isRetinaScaling()) {\n        multX *= fabric.devicePixelRatio;\n        multY *= fabric.devicePixelRatio;\n      }\n      ctx.shadowColor = shadow.color;\n      ctx.shadowBlur = shadow.blur * fabric.browserShadowBlurConstant *\n        (multX + multY) * (scaling.scaleX + scaling.scaleY) / 4;\n      ctx.shadowOffsetX = shadow.offsetX * multX * scaling.scaleX;\n      ctx.shadowOffsetY = shadow.offsetY * multY * scaling.scaleY;\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _removeShadow: function(ctx) {\n      if (!this.shadow) {\n        return;\n      }\n\n      ctx.shadowColor = '';\n      ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {Object} filler fabric.Pattern or fabric.Gradient\n     * @return {Object} offset.offsetX offset for text rendering\n     * @return {Object} offset.offsetY offset for text rendering\n     */\n    _applyPatternGradientTransform: function(ctx, filler) {\n      if (!filler || !filler.toLive) {\n        return { offsetX: 0, offsetY: 0 };\n      }\n      var t = filler.gradientTransform || filler.patternTransform;\n      var offsetX = -this.width / 2 + filler.offsetX || 0,\n          offsetY = -this.height / 2 + filler.offsetY || 0;\n\n      if (filler.gradientUnits === 'percentage') {\n        ctx.transform(this.width, 0, 0, this.height, offsetX, offsetY);\n      }\n      else {\n        ctx.transform(1, 0, 0, 1, offsetX, offsetY);\n      }\n      if (t) {\n        ctx.transform(t[0], t[1], t[2], t[3], t[4], t[5]);\n      }\n      return { offsetX: offsetX, offsetY: offsetY };\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderPaintInOrder: function(ctx) {\n      if (this.paintFirst === 'stroke') {\n        this._renderStroke(ctx);\n        this._renderFill(ctx);\n      }\n      else {\n        this._renderFill(ctx);\n        this._renderStroke(ctx);\n      }\n    },\n\n    /**\n     * @private\n     * function that actually render something on the context.\n     * empty here to allow Obects to work on tests to benchmark fabric functionalites\n     * not related to rendering\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(/* ctx */) {\n\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderFill: function(ctx) {\n      if (!this.fill) {\n        return;\n      }\n\n      ctx.save();\n      this._setFillStyles(ctx, this);\n      if (this.fillRule === 'evenodd') {\n        ctx.fill('evenodd');\n      }\n      else {\n        ctx.fill();\n      }\n      ctx.restore();\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderStroke: function(ctx) {\n      if (!this.stroke || this.strokeWidth === 0) {\n        return;\n      }\n\n      if (this.shadow && !this.shadow.affectStroke) {\n        this._removeShadow(ctx);\n      }\n\n      ctx.save();\n      if (this.strokeUniform && this.group) {\n        var scaling = this.getObjectScaling();\n        ctx.scale(1 / scaling.scaleX, 1 / scaling.scaleY);\n      }\n      else if (this.strokeUniform) {\n        ctx.scale(1 / this.scaleX, 1 / this.scaleY);\n      }\n      this._setLineDash(ctx, this.strokeDashArray);\n      this._setStrokeStyles(ctx, this);\n      ctx.stroke();\n      ctx.restore();\n    },\n\n    /**\n     * This function try to patch the missing gradientTransform on canvas gradients.\n     * transforming a context to transform the gradient, is going to transform the stroke too.\n     * we want to transform the gradient but not the stroke operation, so we create\n     * a transformed gradient on a pattern and then we use the pattern instead of the gradient.\n     * this method has drwabacks: is slow, is in low resolution, needs a patch for when the size\n     * is limited.\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {fabric.Gradient} filler a fabric gradient instance\n     */\n    _applyPatternForTransformedGradient: function(ctx, filler) {\n      var dims = this._limitCacheSize(this._getCacheCanvasDimensions()),\n          pCanvas = fabric.util.createCanvasElement(), pCtx, retinaScaling = this.canvas.getRetinaScaling(),\n          width = dims.x / this.scaleX / retinaScaling, height = dims.y / this.scaleY / retinaScaling;\n      pCanvas.width = Math.ceil(width);\n      pCanvas.height = Math.ceil(height);\n      pCtx = pCanvas.getContext('2d');\n      pCtx.beginPath(); pCtx.moveTo(0, 0); pCtx.lineTo(width, 0); pCtx.lineTo(width, height);\n      pCtx.lineTo(0, height); pCtx.closePath();\n      pCtx.translate(width / 2, height / 2);\n      pCtx.scale(\n        dims.zoomX / this.scaleX / retinaScaling,\n        dims.zoomY / this.scaleY / retinaScaling\n      );\n      this._applyPatternGradientTransform(pCtx, filler);\n      pCtx.fillStyle = filler.toLive(ctx);\n      pCtx.fill();\n      ctx.translate(-this.width / 2 - this.strokeWidth / 2, -this.height / 2 - this.strokeWidth / 2);\n      ctx.scale(\n        retinaScaling * this.scaleX / dims.zoomX,\n        retinaScaling * this.scaleY / dims.zoomY\n      );\n      ctx.strokeStyle = pCtx.createPattern(pCanvas, 'no-repeat');\n    },\n\n    /**\n     * This function is an helper for svg import. it returns the center of the object in the svg\n     * untransformed coordinates\n     * @private\n     * @return {Object} center point from element coordinates\n     */\n    _findCenterFromElement: function() {\n      return { x: this.left + this.width / 2, y: this.top + this.height / 2 };\n    },\n\n    /**\n     * This function is an helper for svg import. it decompose the transformMatrix\n     * and assign properties to object.\n     * untransformed coordinates\n     * @private\n     * @chainable\n     */\n    _assignTransformMatrixProps: function() {\n      if (this.transformMatrix) {\n        var options = fabric.util.qrDecompose(this.transformMatrix);\n        this.flipX = false;\n        this.flipY = false;\n        this.set('scaleX', options.scaleX);\n        this.set('scaleY', options.scaleY);\n        this.angle = options.angle;\n        this.skewX = options.skewX;\n        this.skewY = 0;\n      }\n    },\n\n    /**\n     * This function is an helper for svg import. it removes the transform matrix\n     * and set to object properties that fabricjs can handle\n     * @private\n     * @param {Object} preserveAspectRatioOptions\n     * @return {thisArg}\n     */\n    _removeTransformMatrix: function(preserveAspectRatioOptions) {\n      var center = this._findCenterFromElement();\n      if (this.transformMatrix) {\n        this._assignTransformMatrixProps();\n        center = fabric.util.transformPoint(center, this.transformMatrix);\n      }\n      this.transformMatrix = null;\n      if (preserveAspectRatioOptions) {\n        this.scaleX *= preserveAspectRatioOptions.scaleX;\n        this.scaleY *= preserveAspectRatioOptions.scaleY;\n        this.cropX = preserveAspectRatioOptions.cropX;\n        this.cropY = preserveAspectRatioOptions.cropY;\n        center.x += preserveAspectRatioOptions.offsetLeft;\n        center.y += preserveAspectRatioOptions.offsetTop;\n        this.width = preserveAspectRatioOptions.width;\n        this.height = preserveAspectRatioOptions.height;\n      }\n      this.setPositionByOrigin(center, 'center', 'center');\n    },\n\n    /**\n     * Clones an instance, using a callback method will work for every object.\n     * @param {Function} callback Callback is invoked with a clone as a first argument\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     */\n    clone: function(callback, propertiesToInclude) {\n      var objectForm = this.toObject(propertiesToInclude);\n      if (this.constructor.fromObject) {\n        this.constructor.fromObject(objectForm, callback);\n      }\n      else {\n        fabric.Object._fromObject('Object', objectForm, callback);\n      }\n    },\n\n    /**\n     * Creates an instance of fabric.Image out of an object\n     * makes use of toCanvasElement.\n     * Once this method was based on toDataUrl and loadImage, so it also had a quality\n     * and format option. toCanvasElement is faster and produce no loss of quality.\n     * If you need to get a real Jpeg or Png from an object, using toDataURL is the right way to do it.\n     * toCanvasElement and then toBlob from the obtained canvas is also a good option.\n     * This method is sync now, but still support the callback because we did not want to break.\n     * When fabricJS 5.0 will be planned, this will probably be changed to not have a callback.\n     * @param {Function} callback callback, invoked with an instance as a first argument\n     * @param {Object} [options] for clone as image, passed to toDataURL\n     * @param {Number} [options.multiplier=1] Multiplier to scale by\n     * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n     * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n     * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n     * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n     * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n     * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n     * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n     * @return {fabric.Object} thisArg\n     */\n    cloneAsImage: function(callback, options) {\n      var canvasEl = this.toCanvasElement(options);\n      if (callback) {\n        callback(new fabric.Image(canvasEl));\n      }\n      return this;\n    },\n\n    /**\n     * Converts an object into a HTMLCanvas element\n     * @param {Object} options Options object\n     * @param {Number} [options.multiplier=1] Multiplier to scale by\n     * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n     * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n     * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n     * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n     * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n     * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n     * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n     * @return {HTMLCanvasElement} Returns DOM element <canvas> with the fabric.Object\n     */\n    toCanvasElement: function(options) {\n      options || (options = { });\n\n      var utils = fabric.util, origParams = utils.saveObjectTransform(this),\n          originalGroup = this.group,\n          originalShadow = this.shadow, abs = Math.abs,\n          multiplier = (options.multiplier || 1) * (options.enableRetinaScaling ? fabric.devicePixelRatio : 1);\n      delete this.group;\n      if (options.withoutTransform) {\n        utils.resetObjectTransform(this);\n      }\n      if (options.withoutShadow) {\n        this.shadow = null;\n      }\n\n      var el = fabric.util.createCanvasElement(),\n          // skip canvas zoom and calculate with setCoords now.\n          boundingRect = this.getBoundingRect(true, true),\n          shadow = this.shadow, scaling,\n          shadowOffset = { x: 0, y: 0 }, shadowBlur,\n          width, height;\n\n      if (shadow) {\n        shadowBlur = shadow.blur;\n        if (shadow.nonScaling) {\n          scaling = { scaleX: 1, scaleY: 1 };\n        }\n        else {\n          scaling = this.getObjectScaling();\n        }\n        // consider non scaling shadow.\n        shadowOffset.x = 2 * Math.round(abs(shadow.offsetX) + shadowBlur) * (abs(scaling.scaleX));\n        shadowOffset.y = 2 * Math.round(abs(shadow.offsetY) + shadowBlur) * (abs(scaling.scaleY));\n      }\n      width = boundingRect.width + shadowOffset.x;\n      height = boundingRect.height + shadowOffset.y;\n      // if the current width/height is not an integer\n      // we need to make it so.\n      el.width = Math.ceil(width);\n      el.height = Math.ceil(height);\n      var canvas = new fabric.StaticCanvas(el, {\n        enableRetinaScaling: false,\n        renderOnAddRemove: false,\n        skipOffscreen: false,\n      });\n      if (options.format === 'jpeg') {\n        canvas.backgroundColor = '#fff';\n      }\n      this.setPositionByOrigin(new fabric.Point(canvas.width / 2, canvas.height / 2), 'center', 'center');\n\n      var originalCanvas = this.canvas;\n      canvas.add(this);\n      var canvasEl = canvas.toCanvasElement(multiplier || 1, options);\n      this.shadow = originalShadow;\n      this.set('canvas', originalCanvas);\n      if (originalGroup) {\n        this.group = originalGroup;\n      }\n      this.set(origParams).setCoords();\n      // canvas.dispose will call image.dispose that will nullify the elements\n      // since this canvas is a simple element for the process, we remove references\n      // to objects in this way in order to avoid object trashing.\n      canvas._objects = [];\n      canvas.dispose();\n      canvas = null;\n\n      return canvasEl;\n    },\n\n    /**\n     * Converts an object into a data-url-like string\n     * @param {Object} options Options object\n     * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\n     * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\n     * @param {Number} [options.multiplier=1] Multiplier to scale by\n     * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\n     * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\n     * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\n     * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\n     * @param {Boolean} [options.enableRetinaScaling] Enable retina scaling for clone image. Introduce in 1.6.4\n     * @param {Boolean} [options.withoutTransform] Remove current object transform ( no scale , no angle, no flip, no skew ). Introduced in 2.3.4\n     * @param {Boolean} [options.withoutShadow] Remove current object shadow. Introduced in 2.4.2\n     * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\n     */\n    toDataURL: function(options) {\n      options || (options = { });\n      return fabric.util.toDataURL(this.toCanvasElement(options), options.format || 'png', options.quality || 1);\n    },\n\n    /**\n     * Returns true if specified type is identical to the type of an instance\n     * @param {String} type Type to check against\n     * @return {Boolean}\n     */\n    isType: function(type) {\n      return arguments.length > 1 ? Array.from(arguments).includes(this.type) : this.type === type;\n    },\n\n    /**\n     * Returns complexity of an instance\n     * @return {Number} complexity of this instance (is 1 unless subclassed)\n     */\n    complexity: function() {\n      return 1;\n    },\n\n    /**\n     * Returns a JSON representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} JSON\n     */\n    toJSON: function(propertiesToInclude) {\n      // delegate, not alias\n      return this.toObject(propertiesToInclude);\n    },\n\n    /**\n     * Sets \"angle\" of an instance with centered rotation\n     * @param {Number} angle Angle value (in degrees)\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    rotate: function(angle) {\n      var shouldCenterOrigin = (this.originX !== 'center' || this.originY !== 'center') && this.centeredRotation;\n\n      if (shouldCenterOrigin) {\n        this._setOriginToCenter();\n      }\n\n      this.set('angle', angle);\n\n      if (shouldCenterOrigin) {\n        this._resetOrigin();\n      }\n\n      return this;\n    },\n\n    /**\n     * Centers object horizontally on canvas to which it was added last.\n     * You might need to call `setCoords` on an object after centering, to update controls area.\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    centerH: function () {\n      this.canvas && this.canvas.centerObjectH(this);\n      return this;\n    },\n\n    /**\n     * Centers object horizontally on current viewport of canvas to which it was added last.\n     * You might need to call `setCoords` on an object after centering, to update controls area.\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    viewportCenterH: function () {\n      this.canvas && this.canvas.viewportCenterObjectH(this);\n      return this;\n    },\n\n    /**\n     * Centers object vertically on canvas to which it was added last.\n     * You might need to call `setCoords` on an object after centering, to update controls area.\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    centerV: function () {\n      this.canvas && this.canvas.centerObjectV(this);\n      return this;\n    },\n\n    /**\n     * Centers object vertically on current viewport of canvas to which it was added last.\n     * You might need to call `setCoords` on an object after centering, to update controls area.\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    viewportCenterV: function () {\n      this.canvas && this.canvas.viewportCenterObjectV(this);\n      return this;\n    },\n\n    /**\n     * Centers object vertically and horizontally on canvas to which is was added last\n     * You might need to call `setCoords` on an object after centering, to update controls area.\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    center: function () {\n      this.canvas && this.canvas.centerObject(this);\n      return this;\n    },\n\n    /**\n     * Centers object on current viewport of canvas to which it was added last.\n     * You might need to call `setCoords` on an object after centering, to update controls area.\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    viewportCenter: function () {\n      this.canvas && this.canvas.viewportCenterObject(this);\n      return this;\n    },\n\n    /**\n     * Returns coordinates of a pointer relative to an object\n     * @param {Event} e Event to operate upon\n     * @param {Object} [pointer] Pointer to operate upon (instead of event)\n     * @return {Object} Coordinates of a pointer (x, y)\n     */\n    getLocalPointer: function(e, pointer) {\n      pointer = pointer || this.canvas.getPointer(e);\n      var pClicked = new fabric.Point(pointer.x, pointer.y),\n          objectLeftTop = this._getLeftTopCoords();\n      if (this.angle) {\n        pClicked = fabric.util.rotatePoint(\n          pClicked, objectLeftTop, degreesToRadians(-this.angle));\n      }\n      return {\n        x: pClicked.x - objectLeftTop.x,\n        y: pClicked.y - objectLeftTop.y\n      };\n    },\n\n    /**\n     * Sets canvas globalCompositeOperation for specific object\n     * custom composition operation for the particular object can be specified using globalCompositeOperation property\n     * @param {CanvasRenderingContext2D} ctx Rendering canvas context\n     */\n    _setupCompositeOperation: function (ctx) {\n      if (this.globalCompositeOperation) {\n        ctx.globalCompositeOperation = this.globalCompositeOperation;\n      }\n    },\n\n    /**\n     * cancel instance's running animations\n     * override if necessary to dispose artifacts such as `clipPath`\n     */\n    dispose: function () {\n      if (fabric.runningAnimations) {\n        fabric.runningAnimations.cancelByTarget(this);\n      }\n    }\n  });\n\n  fabric.util.createAccessors && fabric.util.createAccessors(fabric.Object);\n\n  extend(fabric.Object.prototype, fabric.Observable);\n\n  /**\n   * Defines the number of fraction digits to use when serializing object values.\n   * You can use it to increase/decrease precision of such values like left, top, scaleX, scaleY, etc.\n   * @static\n   * @memberOf fabric.Object\n   * @constant\n   * @type Number\n   */\n  fabric.Object.NUM_FRACTION_DIGITS = 2;\n\n  /**\n   * Defines which properties should be enlivened from the object passed to {@link fabric.Object._fromObject}\n   * @static\n   * @memberOf fabric.Object\n   * @constant\n   * @type string[]\n   */\n  fabric.Object.ENLIVEN_PROPS = ['clipPath'];\n\n  fabric.Object._fromObject = function(className, object, callback, extraParam) {\n    var klass = fabric[className];\n    object = clone(object, true);\n    fabric.util.enlivenPatterns([object.fill, object.stroke], function(patterns) {\n      if (typeof patterns[0] !== 'undefined') {\n        object.fill = patterns[0];\n      }\n      if (typeof patterns[1] !== 'undefined') {\n        object.stroke = patterns[1];\n      }\n      fabric.util.enlivenObjectEnlivables(object, object, function () {\n        var instance = extraParam ? new klass(object[extraParam], object) : new klass(object);\n        callback && callback(instance);\n      });\n    });\n  };\n\n  /**\n   * Unique id used internally when creating SVG elements\n   * @static\n   * @memberOf fabric.Object\n   * @type Number\n   */\n  fabric.Object.__uid = 0;\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function() {\n\n  var degreesToRadians = fabric.util.degreesToRadians,\n      originXOffset = {\n        left: -0.5,\n        center: 0,\n        right: 0.5\n      },\n      originYOffset = {\n        top: -0.5,\n        center: 0,\n        bottom: 0.5\n      };\n\n  fabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\n\n    /**\n     * Translates the coordinates from a set of origin to another (based on the object's dimensions)\n     * @param {fabric.Point} point The point which corresponds to the originX and originY params\n     * @param {String} fromOriginX Horizontal origin: 'left', 'center' or 'right'\n     * @param {String} fromOriginY Vertical origin: 'top', 'center' or 'bottom'\n     * @param {String} toOriginX Horizontal origin: 'left', 'center' or 'right'\n     * @param {String} toOriginY Vertical origin: 'top', 'center' or 'bottom'\n     * @return {fabric.Point}\n     */\n    translateToGivenOrigin: function(point, fromOriginX, fromOriginY, toOriginX, toOriginY) {\n      var x = point.x,\n          y = point.y,\n          offsetX, offsetY, dim;\n\n      if (typeof fromOriginX === 'string') {\n        fromOriginX = originXOffset[fromOriginX];\n      }\n      else {\n        fromOriginX -= 0.5;\n      }\n\n      if (typeof toOriginX === 'string') {\n        toOriginX = originXOffset[toOriginX];\n      }\n      else {\n        toOriginX -= 0.5;\n      }\n\n      offsetX = toOriginX - fromOriginX;\n\n      if (typeof fromOriginY === 'string') {\n        fromOriginY = originYOffset[fromOriginY];\n      }\n      else {\n        fromOriginY -= 0.5;\n      }\n\n      if (typeof toOriginY === 'string') {\n        toOriginY = originYOffset[toOriginY];\n      }\n      else {\n        toOriginY -= 0.5;\n      }\n\n      offsetY = toOriginY - fromOriginY;\n\n      if (offsetX || offsetY) {\n        dim = this._getTransformedDimensions();\n        x = point.x + offsetX * dim.x;\n        y = point.y + offsetY * dim.y;\n      }\n\n      return new fabric.Point(x, y);\n    },\n\n    /**\n     * Translates the coordinates from origin to center coordinates (based on the object's dimensions)\n     * @param {fabric.Point} point The point which corresponds to the originX and originY params\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n     * @return {fabric.Point}\n     */\n    translateToCenterPoint: function(point, originX, originY) {\n      var p = this.translateToGivenOrigin(point, originX, originY, 'center', 'center');\n      if (this.angle) {\n        return fabric.util.rotatePoint(p, point, degreesToRadians(this.angle));\n      }\n      return p;\n    },\n\n    /**\n     * Translates the coordinates from center to origin coordinates (based on the object's dimensions)\n     * @param {fabric.Point} center The point which corresponds to center of the object\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n     * @return {fabric.Point}\n     */\n    translateToOriginPoint: function(center, originX, originY) {\n      var p = this.translateToGivenOrigin(center, 'center', 'center', originX, originY);\n      if (this.angle) {\n        return fabric.util.rotatePoint(p, center, degreesToRadians(this.angle));\n      }\n      return p;\n    },\n\n    /**\n     * Returns the real center coordinates of the object\n     * @return {fabric.Point}\n     */\n    getCenterPoint: function() {\n      var leftTop = new fabric.Point(this.left, this.top);\n      return this.translateToCenterPoint(leftTop, this.originX, this.originY);\n    },\n\n    /**\n     * Returns the coordinates of the object based on center coordinates\n     * @param {fabric.Point} point The point which corresponds to the originX and originY params\n     * @return {fabric.Point}\n     */\n    // getOriginPoint: function(center) {\n    //   return this.translateToOriginPoint(center, this.originX, this.originY);\n    // },\n\n    /**\n     * Returns the coordinates of the object as if it has a different origin\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n     * @return {fabric.Point}\n     */\n    getPointByOrigin: function(originX, originY) {\n      var center = this.getCenterPoint();\n      return this.translateToOriginPoint(center, originX, originY);\n    },\n\n    /**\n     * Returns the point in local coordinates\n     * @param {fabric.Point} point The point relative to the global coordinate system\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n     * @return {fabric.Point}\n     */\n    toLocalPoint: function(point, originX, originY) {\n      var center = this.getCenterPoint(),\n          p, p2;\n\n      if (typeof originX !== 'undefined' && typeof originY !== 'undefined' ) {\n        p = this.translateToGivenOrigin(center, 'center', 'center', originX, originY);\n      }\n      else {\n        p = new fabric.Point(this.left, this.top);\n      }\n\n      p2 = new fabric.Point(point.x, point.y);\n      if (this.angle) {\n        p2 = fabric.util.rotatePoint(p2, center, -degreesToRadians(this.angle));\n      }\n      return p2.subtractEquals(p);\n    },\n\n    /**\n     * Returns the point in global coordinates\n     * @param {fabric.Point} The point relative to the local coordinate system\n     * @return {fabric.Point}\n     */\n    // toGlobalPoint: function(point) {\n    //   return fabric.util.rotatePoint(point, this.getCenterPoint(), degreesToRadians(this.angle)).addEquals(new fabric.Point(this.left, this.top));\n    // },\n\n    /**\n     * Sets the position of the object taking into consideration the object's origin\n     * @param {fabric.Point} pos The new position of the object\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\n     * @return {void}\n     */\n    setPositionByOrigin: function(pos, originX, originY) {\n      var center = this.translateToCenterPoint(pos, originX, originY),\n          position = this.translateToOriginPoint(center, this.originX, this.originY);\n      this.set('left', position.x);\n      this.set('top', position.y);\n    },\n\n    /**\n     * @param {String} to One of 'left', 'center', 'right'\n     */\n    adjustPosition: function(to) {\n      var angle = degreesToRadians(this.angle),\n          hypotFull = this.getScaledWidth(),\n          xFull = fabric.util.cos(angle) * hypotFull,\n          yFull = fabric.util.sin(angle) * hypotFull,\n          offsetFrom, offsetTo;\n\n      //TODO: this function does not consider mixed situation like top, center.\n      if (typeof this.originX === 'string') {\n        offsetFrom = originXOffset[this.originX];\n      }\n      else {\n        offsetFrom = this.originX - 0.5;\n      }\n      if (typeof to === 'string') {\n        offsetTo = originXOffset[to];\n      }\n      else {\n        offsetTo = to - 0.5;\n      }\n      this.left += xFull * (offsetTo - offsetFrom);\n      this.top += yFull * (offsetTo - offsetFrom);\n      this.setCoords();\n      this.originX = to;\n    },\n\n    /**\n     * Sets the origin/position of the object to it's center point\n     * @private\n     * @return {void}\n     */\n    _setOriginToCenter: function() {\n      this._originalOriginX = this.originX;\n      this._originalOriginY = this.originY;\n\n      var center = this.getCenterPoint();\n\n      this.originX = 'center';\n      this.originY = 'center';\n\n      this.left = center.x;\n      this.top = center.y;\n    },\n\n    /**\n     * Resets the origin/position of the object to it's original origin\n     * @private\n     * @return {void}\n     */\n    _resetOrigin: function() {\n      var originPoint = this.translateToOriginPoint(\n        this.getCenterPoint(),\n        this._originalOriginX,\n        this._originalOriginY);\n\n      this.originX = this._originalOriginX;\n      this.originY = this._originalOriginY;\n\n      this.left = originPoint.x;\n      this.top = originPoint.y;\n\n      this._originalOriginX = null;\n      this._originalOriginY = null;\n    },\n\n    /**\n     * @private\n     */\n    _getLeftTopCoords: function() {\n      return this.translateToOriginPoint(this.getCenterPoint(), 'left', 'top');\n    },\n  });\n\n})();\n\n\n(function() {\n\n  function arrayFromCoords(coords) {\n    return [\n      new fabric.Point(coords.tl.x, coords.tl.y),\n      new fabric.Point(coords.tr.x, coords.tr.y),\n      new fabric.Point(coords.br.x, coords.br.y),\n      new fabric.Point(coords.bl.x, coords.bl.y)\n    ];\n  }\n\n  var util = fabric.util,\n      degreesToRadians = util.degreesToRadians,\n      multiplyMatrices = util.multiplyTransformMatrices,\n      transformPoint = util.transformPoint;\n\n  util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\n\n    /**\n     * Describe object's corner position in canvas element coordinates.\n     * properties are depending on control keys and padding the main controls.\n     * each property is an object with x, y and corner.\n     * The `corner` property contains in a similar manner the 4 points of the\n     * interactive area of the corner.\n     * The coordinates depends from the controls positionHandler and are used\n     * to draw and locate controls\n     * @memberOf fabric.Object.prototype\n     */\n    oCoords: null,\n\n    /**\n     * Describe object's corner position in canvas object absolute coordinates\n     * properties are tl,tr,bl,br and describe the four main corner.\n     * each property is an object with x, y, instance of Fabric.Point.\n     * The coordinates depends from this properties: width, height, scaleX, scaleY\n     * skewX, skewY, angle, strokeWidth, top, left.\n     * Those coordinates are useful to understand where an object is. They get updated\n     * with oCoords but they do not need to be updated when zoom or panning change.\n     * The coordinates get updated with @method setCoords.\n     * You can calculate them without updating with @method calcACoords();\n     * @memberOf fabric.Object.prototype\n     */\n    aCoords: null,\n\n    /**\n     * Describe object's corner position in canvas element coordinates.\n     * includes padding. Used of object detection.\n     * set and refreshed with setCoords.\n     * @memberOf fabric.Object.prototype\n     */\n    lineCoords: null,\n\n    /**\n     * storage for object transform matrix\n     */\n    ownMatrixCache: null,\n\n    /**\n     * storage for object full transform matrix\n     */\n    matrixCache: null,\n\n    /**\n     * custom controls interface\n     * controls are added by default_controls.js\n     */\n    controls: { },\n\n    /**\n     * return correct set of coordinates for intersection\n     * this will return either aCoords or lineCoords.\n     * @param {Boolean} absolute will return aCoords if true or lineCoords\n     * @return {Object} {tl, tr, br, bl} points\n     */\n    _getCoords: function(absolute, calculate) {\n      if (calculate) {\n        return (absolute ? this.calcACoords() : this.calcLineCoords());\n      }\n      if (!this.aCoords || !this.lineCoords) {\n        this.setCoords(true);\n      }\n      return (absolute ? this.aCoords : this.lineCoords);\n    },\n\n    /**\n     * return correct set of coordinates for intersection\n     * this will return either aCoords or lineCoords.\n     * The coords are returned in an array.\n     * @return {Array} [tl, tr, br, bl] of points\n     */\n    getCoords: function(absolute, calculate) {\n      return arrayFromCoords(this._getCoords(absolute, calculate));\n    },\n\n    /**\n     * Checks if object intersects with an area formed by 2 points\n     * @param {Object} pointTL top-left point of area\n     * @param {Object} pointBR bottom-right point of area\n     * @param {Boolean} [absolute] use coordinates without viewportTransform\n     * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n     * @return {Boolean} true if object intersects with an area formed by 2 points\n     */\n    intersectsWithRect: function(pointTL, pointBR, absolute, calculate) {\n      var coords = this.getCoords(absolute, calculate),\n          intersection = fabric.Intersection.intersectPolygonRectangle(\n            coords,\n            pointTL,\n            pointBR\n          );\n      return intersection.status === 'Intersection';\n    },\n\n    /**\n     * Checks if object intersects with another object\n     * @param {Object} other Object to test\n     * @param {Boolean} [absolute] use coordinates without viewportTransform\n     * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n     * @return {Boolean} true if object intersects with another object\n     */\n    intersectsWithObject: function(other, absolute, calculate) {\n      var intersection = fabric.Intersection.intersectPolygonPolygon(\n        this.getCoords(absolute, calculate),\n        other.getCoords(absolute, calculate)\n      );\n\n      return intersection.status === 'Intersection'\n        || other.isContainedWithinObject(this, absolute, calculate)\n        || this.isContainedWithinObject(other, absolute, calculate);\n    },\n\n    /**\n     * Checks if object is fully contained within area of another object\n     * @param {Object} other Object to test\n     * @param {Boolean} [absolute] use coordinates without viewportTransform\n     * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n     * @return {Boolean} true if object is fully contained within area of another object\n     */\n    isContainedWithinObject: function(other, absolute, calculate) {\n      var points = this.getCoords(absolute, calculate),\n          otherCoords = absolute ? other.aCoords : other.lineCoords,\n          i = 0, lines = other._getImageLines(otherCoords);\n      for (; i < 4; i++) {\n        if (!other.containsPoint(points[i], lines)) {\n          return false;\n        }\n      }\n      return true;\n    },\n\n    /**\n     * Checks if object is fully contained within area formed by 2 points\n     * @param {Object} pointTL top-left point of area\n     * @param {Object} pointBR bottom-right point of area\n     * @param {Boolean} [absolute] use coordinates without viewportTransform\n     * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n     * @return {Boolean} true if object is fully contained within area formed by 2 points\n     */\n    isContainedWithinRect: function(pointTL, pointBR, absolute, calculate) {\n      var boundingRect = this.getBoundingRect(absolute, calculate);\n\n      return (\n        boundingRect.left >= pointTL.x &&\n        boundingRect.left + boundingRect.width <= pointBR.x &&\n        boundingRect.top >= pointTL.y &&\n        boundingRect.top + boundingRect.height <= pointBR.y\n      );\n    },\n\n    /**\n     * Checks if point is inside the object\n     * @param {fabric.Point} point Point to check against\n     * @param {Object} [lines] object returned from @method _getImageLines\n     * @param {Boolean} [absolute] use coordinates without viewportTransform\n     * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n     * @return {Boolean} true if point is inside the object\n     */\n    containsPoint: function(point, lines, absolute, calculate) {\n      var coords = this._getCoords(absolute, calculate),\n          lines = lines || this._getImageLines(coords),\n          xPoints = this._findCrossPoints(point, lines);\n      // if xPoints is odd then point is inside the object\n      return (xPoints !== 0 && xPoints % 2 === 1);\n    },\n\n    /**\n     * Checks if object is contained within the canvas with current viewportTransform\n     * the check is done stopping at first point that appears on screen\n     * @param {Boolean} [calculate] use coordinates of current position instead of .aCoords\n     * @return {Boolean} true if object is fully or partially contained within canvas\n     */\n    isOnScreen: function(calculate) {\n      if (!this.canvas) {\n        return false;\n      }\n      var pointTL = this.canvas.vptCoords.tl, pointBR = this.canvas.vptCoords.br;\n      var points = this.getCoords(true, calculate);\n      // if some point is on screen, the object is on screen.\n      if (points.some(function(point) {\n        return point.x <= pointBR.x && point.x >= pointTL.x &&\n        point.y <= pointBR.y && point.y >= pointTL.y;\n      })) {\n        return true;\n      }\n      // no points on screen, check intersection with absolute coordinates\n      if (this.intersectsWithRect(pointTL, pointBR, true, calculate)) {\n        return true;\n      }\n      return this._containsCenterOfCanvas(pointTL, pointBR, calculate);\n    },\n\n    /**\n     * Checks if the object contains the midpoint between canvas extremities\n     * Does not make sense outside the context of isOnScreen and isPartiallyOnScreen\n     * @private\n     * @param {Fabric.Point} pointTL Top Left point\n     * @param {Fabric.Point} pointBR Top Right point\n     * @param {Boolean} calculate use coordinates of current position instead of .oCoords\n     * @return {Boolean} true if the object contains the point\n     */\n    _containsCenterOfCanvas: function(pointTL, pointBR, calculate) {\n      // worst case scenario the object is so big that contains the screen\n      var centerPoint = { x: (pointTL.x + pointBR.x) / 2, y: (pointTL.y + pointBR.y) / 2 };\n      if (this.containsPoint(centerPoint, null, true, calculate)) {\n        return true;\n      }\n      return false;\n    },\n\n    /**\n     * Checks if object is partially contained within the canvas with current viewportTransform\n     * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords\n     * @return {Boolean} true if object is partially contained within canvas\n     */\n    isPartiallyOnScreen: function(calculate) {\n      if (!this.canvas) {\n        return false;\n      }\n      var pointTL = this.canvas.vptCoords.tl, pointBR = this.canvas.vptCoords.br;\n      if (this.intersectsWithRect(pointTL, pointBR, true, calculate)) {\n        return true;\n      }\n      var allPointsAreOutside = this.getCoords(true, calculate).every(function(point) {\n        return (point.x >= pointBR.x || point.x <= pointTL.x) &&\n        (point.y >= pointBR.y || point.y <= pointTL.y);\n      });\n      return allPointsAreOutside && this._containsCenterOfCanvas(pointTL, pointBR, calculate);\n    },\n\n    /**\n     * Method that returns an object with the object edges in it, given the coordinates of the corners\n     * @private\n     * @param {Object} oCoords Coordinates of the object corners\n     */\n    _getImageLines: function(oCoords) {\n\n      var lines = {\n        topline: {\n          o: oCoords.tl,\n          d: oCoords.tr\n        },\n        rightline: {\n          o: oCoords.tr,\n          d: oCoords.br\n        },\n        bottomline: {\n          o: oCoords.br,\n          d: oCoords.bl\n        },\n        leftline: {\n          o: oCoords.bl,\n          d: oCoords.tl\n        }\n      };\n\n      // // debugging\n      // if (this.canvas.contextTop) {\n      //   this.canvas.contextTop.fillRect(lines.bottomline.d.x, lines.bottomline.d.y, 2, 2);\n      //   this.canvas.contextTop.fillRect(lines.bottomline.o.x, lines.bottomline.o.y, 2, 2);\n      //\n      //   this.canvas.contextTop.fillRect(lines.leftline.d.x, lines.leftline.d.y, 2, 2);\n      //   this.canvas.contextTop.fillRect(lines.leftline.o.x, lines.leftline.o.y, 2, 2);\n      //\n      //   this.canvas.contextTop.fillRect(lines.topline.d.x, lines.topline.d.y, 2, 2);\n      //   this.canvas.contextTop.fillRect(lines.topline.o.x, lines.topline.o.y, 2, 2);\n      //\n      //   this.canvas.contextTop.fillRect(lines.rightline.d.x, lines.rightline.d.y, 2, 2);\n      //   this.canvas.contextTop.fillRect(lines.rightline.o.x, lines.rightline.o.y, 2, 2);\n      // }\n\n      return lines;\n    },\n\n    /**\n     * Helper method to determine how many cross points are between the 4 object edges\n     * and the horizontal line determined by a point on canvas\n     * @private\n     * @param {fabric.Point} point Point to check\n     * @param {Object} lines Coordinates of the object being evaluated\n     */\n    // remove yi, not used but left code here just in case.\n    _findCrossPoints: function(point, lines) {\n      var b1, b2, a1, a2, xi, // yi,\n          xcount = 0,\n          iLine;\n\n      for (var lineKey in lines) {\n        iLine = lines[lineKey];\n        // optimisation 1: line below point. no cross\n        if ((iLine.o.y < point.y) && (iLine.d.y < point.y)) {\n          continue;\n        }\n        // optimisation 2: line above point. no cross\n        if ((iLine.o.y >= point.y) && (iLine.d.y >= point.y)) {\n          continue;\n        }\n        // optimisation 3: vertical line case\n        if ((iLine.o.x === iLine.d.x) && (iLine.o.x >= point.x)) {\n          xi = iLine.o.x;\n          // yi = point.y;\n        }\n        // calculate the intersection point\n        else {\n          b1 = 0;\n          b2 = (iLine.d.y - iLine.o.y) / (iLine.d.x - iLine.o.x);\n          a1 = point.y - b1 * point.x;\n          a2 = iLine.o.y - b2 * iLine.o.x;\n\n          xi = -(a1 - a2) / (b1 - b2);\n          // yi = a1 + b1 * xi;\n        }\n        // dont count xi < point.x cases\n        if (xi >= point.x) {\n          xcount += 1;\n        }\n        // optimisation 4: specific for square images\n        if (xcount === 2) {\n          break;\n        }\n      }\n      return xcount;\n    },\n\n    /**\n     * Returns coordinates of object's bounding rectangle (left, top, width, height)\n     * the box is intended as aligned to axis of canvas.\n     * @param {Boolean} [absolute] use coordinates without viewportTransform\n     * @param {Boolean} [calculate] use coordinates of current position instead of .oCoords / .aCoords\n     * @return {Object} Object with left, top, width, height properties\n     */\n    getBoundingRect: function(absolute, calculate) {\n      var coords = this.getCoords(absolute, calculate);\n      return util.makeBoundingBoxFromPoints(coords);\n    },\n\n    /**\n     * Returns width of an object's bounding box counting transformations\n     * before 2.0 it was named getWidth();\n     * @return {Number} width value\n     */\n    getScaledWidth: function() {\n      return this._getTransformedDimensions().x;\n    },\n\n    /**\n     * Returns height of an object bounding box counting transformations\n     * before 2.0 it was named getHeight();\n     * @return {Number} height value\n     */\n    getScaledHeight: function() {\n      return this._getTransformedDimensions().y;\n    },\n\n    /**\n     * Makes sure the scale is valid and modifies it if necessary\n     * @private\n     * @param {Number} value\n     * @return {Number}\n     */\n    _constrainScale: function(value) {\n      if (Math.abs(value) < this.minScaleLimit) {\n        if (value < 0) {\n          return -this.minScaleLimit;\n        }\n        else {\n          return this.minScaleLimit;\n        }\n      }\n      else if (value === 0) {\n        return 0.0001;\n      }\n      return value;\n    },\n\n    /**\n     * Scales an object (equally by x and y)\n     * @param {Number} value Scale factor\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    scale: function(value) {\n      this._set('scaleX', value);\n      this._set('scaleY', value);\n      return this.setCoords();\n    },\n\n    /**\n     * Scales an object to a given width, with respect to bounding box (scaling by x/y equally)\n     * @param {Number} value New width value\n     * @param {Boolean} absolute ignore viewport\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    scaleToWidth: function(value, absolute) {\n      // adjust to bounding rect factor so that rotated shapes would fit as well\n      var boundingRectFactor = this.getBoundingRect(absolute).width / this.getScaledWidth();\n      return this.scale(value / this.width / boundingRectFactor);\n    },\n\n    /**\n     * Scales an object to a given height, with respect to bounding box (scaling by x/y equally)\n     * @param {Number} value New height value\n     * @param {Boolean} absolute ignore viewport\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    scaleToHeight: function(value, absolute) {\n      // adjust to bounding rect factor so that rotated shapes would fit as well\n      var boundingRectFactor = this.getBoundingRect(absolute).height / this.getScaledHeight();\n      return this.scale(value / this.height / boundingRectFactor);\n    },\n\n    calcLineCoords: function() {\n      var vpt = this.getViewportTransform(),\n          padding = this.padding, angle = degreesToRadians(this.angle),\n          cos = util.cos(angle), sin = util.sin(angle),\n          cosP = cos * padding, sinP = sin * padding, cosPSinP = cosP + sinP,\n          cosPMinusSinP = cosP - sinP, aCoords = this.calcACoords();\n\n      var lineCoords = {\n        tl: transformPoint(aCoords.tl, vpt),\n        tr: transformPoint(aCoords.tr, vpt),\n        bl: transformPoint(aCoords.bl, vpt),\n        br: transformPoint(aCoords.br, vpt),\n      };\n\n      if (padding) {\n        lineCoords.tl.x -= cosPMinusSinP;\n        lineCoords.tl.y -= cosPSinP;\n        lineCoords.tr.x += cosPSinP;\n        lineCoords.tr.y -= cosPMinusSinP;\n        lineCoords.bl.x -= cosPSinP;\n        lineCoords.bl.y += cosPMinusSinP;\n        lineCoords.br.x += cosPMinusSinP;\n        lineCoords.br.y += cosPSinP;\n      }\n\n      return lineCoords;\n    },\n\n    calcOCoords: function() {\n      var rotateMatrix = this._calcRotateMatrix(),\n          translateMatrix = this._calcTranslateMatrix(),\n          vpt = this.getViewportTransform(),\n          startMatrix = multiplyMatrices(vpt, translateMatrix),\n          finalMatrix = multiplyMatrices(startMatrix, rotateMatrix),\n          finalMatrix = multiplyMatrices(finalMatrix, [1 / vpt[0], 0, 0, 1 / vpt[3], 0, 0]),\n          dim = this._calculateCurrentDimensions(),\n          coords = {};\n      this.forEachControl(function(control, key, fabricObject) {\n        coords[key] = control.positionHandler(dim, finalMatrix, fabricObject);\n      });\n\n      // debug code\n      // var canvas = this.canvas;\n      // setTimeout(function() {\n      //   canvas.contextTop.clearRect(0, 0, 700, 700);\n      //   canvas.contextTop.fillStyle = 'green';\n      //   Object.keys(coords).forEach(function(key) {\n      //     var control = coords[key];\n      //     canvas.contextTop.fillRect(control.x, control.y, 3, 3);\n      //   });\n      // }, 50);\n      return coords;\n    },\n\n    calcACoords: function() {\n      var rotateMatrix = this._calcRotateMatrix(),\n          translateMatrix = this._calcTranslateMatrix(),\n          finalMatrix = multiplyMatrices(translateMatrix, rotateMatrix),\n          dim = this._getTransformedDimensions(),\n          w = dim.x / 2, h = dim.y / 2;\n      return {\n        // corners\n        tl: transformPoint({ x: -w, y: -h }, finalMatrix),\n        tr: transformPoint({ x: w, y: -h }, finalMatrix),\n        bl: transformPoint({ x: -w, y: h }, finalMatrix),\n        br: transformPoint({ x: w, y: h }, finalMatrix)\n      };\n    },\n\n    /**\n     * Sets corner and controls position coordinates based on current angle, width and height, left and top.\n     * oCoords are used to find the corners\n     * aCoords are used to quickly find an object on the canvas\n     * lineCoords are used to quickly find object during pointer events.\n     * See {@link https://github.com/fabricjs/fabric.js/wiki/When-to-call-setCoords} and {@link http://fabricjs.com/fabric-gotchas}\n     *\n     * @param {Boolean} [skipCorners] skip calculation of oCoords.\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    setCoords: function(skipCorners) {\n      this.aCoords = this.calcACoords();\n      // in case we are in a group, for how the inner group target check works,\n      // lineCoords are exactly aCoords. Since the vpt gets absorbed by the normalized pointer.\n      this.lineCoords = this.group ? this.aCoords : this.calcLineCoords();\n      if (skipCorners) {\n        return this;\n      }\n      // set coordinates of the draggable boxes in the corners used to scale/rotate the image\n      this.oCoords = this.calcOCoords();\n      this._setCornerCoords && this._setCornerCoords();\n      return this;\n    },\n\n    /**\n     * calculate rotation matrix of an object\n     * @return {Array} rotation matrix for the object\n     */\n    _calcRotateMatrix: function() {\n      return util.calcRotateMatrix(this);\n    },\n\n    /**\n     * calculate the translation matrix for an object transform\n     * @return {Array} rotation matrix for the object\n     */\n    _calcTranslateMatrix: function() {\n      var center = this.getCenterPoint();\n      return [1, 0, 0, 1, center.x, center.y];\n    },\n\n    transformMatrixKey: function(skipGroup) {\n      var sep = '_', prefix = '';\n      if (!skipGroup && this.group) {\n        prefix = this.group.transformMatrixKey(skipGroup) + sep;\n      };\n      return prefix + this.top + sep + this.left + sep + this.scaleX + sep + this.scaleY +\n        sep + this.skewX + sep + this.skewY + sep + this.angle + sep + this.originX + sep + this.originY +\n        sep + this.width + sep + this.height + sep + this.strokeWidth + this.flipX + this.flipY;\n    },\n\n    /**\n     * calculate transform matrix that represents the current transformations from the\n     * object's properties.\n     * @param {Boolean} [skipGroup] return transform matrix for object not counting parent transformations\n     * There are some situation in which this is useful to avoid the fake rotation.\n     * @return {Array} transform matrix for the object\n     */\n    calcTransformMatrix: function(skipGroup) {\n      var matrix = this.calcOwnMatrix();\n      if (skipGroup || !this.group) {\n        return matrix;\n      }\n      var key = this.transformMatrixKey(skipGroup), cache = this.matrixCache || (this.matrixCache = {});\n      if (cache.key === key) {\n        return cache.value;\n      }\n      if (this.group) {\n        matrix = multiplyMatrices(this.group.calcTransformMatrix(false), matrix);\n      }\n      cache.key = key;\n      cache.value = matrix;\n      return matrix;\n    },\n\n    /**\n     * calculate transform matrix that represents the current transformations from the\n     * object's properties, this matrix does not include the group transformation\n     * @return {Array} transform matrix for the object\n     */\n    calcOwnMatrix: function() {\n      var key = this.transformMatrixKey(true), cache = this.ownMatrixCache || (this.ownMatrixCache = {});\n      if (cache.key === key) {\n        return cache.value;\n      }\n      var tMatrix = this._calcTranslateMatrix(),\n          options = {\n            angle: this.angle,\n            translateX: tMatrix[4],\n            translateY: tMatrix[5],\n            scaleX: this.scaleX,\n            scaleY: this.scaleY,\n            skewX: this.skewX,\n            skewY: this.skewY,\n            flipX: this.flipX,\n            flipY: this.flipY,\n          };\n      cache.key = key;\n      cache.value = util.composeMatrix(options);\n      return cache.value;\n    },\n\n    /*\n     * Calculate object dimensions from its properties\n     * @private\n     * @return {Object} .x width dimension\n     * @return {Object} .y height dimension\n     */\n    _getNonTransformedDimensions: function() {\n      var strokeWidth = this.strokeWidth,\n          w = this.width + strokeWidth,\n          h = this.height + strokeWidth;\n      return { x: w, y: h };\n    },\n\n    /*\n     * Calculate object bounding box dimensions from its properties scale, skew.\n     * @param {Number} skewX, a value to override current skewX\n     * @param {Number} skewY, a value to override current skewY\n     * @private\n     * @return {Object} .x width dimension\n     * @return {Object} .y height dimension\n     */\n    _getTransformedDimensions: function(skewX, skewY) {\n      if (typeof skewX === 'undefined') {\n        skewX = this.skewX;\n      }\n      if (typeof skewY === 'undefined') {\n        skewY = this.skewY;\n      }\n      var dimensions, dimX, dimY,\n          noSkew = skewX === 0 && skewY === 0;\n\n      if (this.strokeUniform) {\n        dimX = this.width;\n        dimY = this.height;\n      }\n      else {\n        dimensions = this._getNonTransformedDimensions();\n        dimX = dimensions.x;\n        dimY = dimensions.y;\n      }\n      if (noSkew) {\n        return this._finalizeDimensions(dimX * this.scaleX, dimY * this.scaleY);\n      }\n      var bbox = util.sizeAfterTransform(dimX, dimY, {\n        scaleX: this.scaleX,\n        scaleY: this.scaleY,\n        skewX: skewX,\n        skewY: skewY,\n      });\n      return this._finalizeDimensions(bbox.x, bbox.y);\n    },\n\n    /*\n     * Calculate object bounding box dimensions from its properties scale, skew.\n     * @param Number width width of the bbox\n     * @param Number height height of the bbox\n     * @private\n     * @return {Object} .x finalized width dimension\n     * @return {Object} .y finalized height dimension\n     */\n    _finalizeDimensions: function(width, height) {\n      return this.strokeUniform ?\n        { x: width + this.strokeWidth, y: height + this.strokeWidth }\n        :\n        { x: width, y: height };\n    },\n\n    /*\n     * Calculate object dimensions for controls box, including padding and canvas zoom.\n     * and active selection\n     * private\n     */\n    _calculateCurrentDimensions: function()  {\n      var vpt = this.getViewportTransform(),\n          dim = this._getTransformedDimensions(),\n          p = transformPoint(dim, vpt, true);\n      return p.scalarAdd(2 * this.padding);\n    },\n  });\n})();\n\n\nfabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\n\n  /**\n   * Moves an object to the bottom of the stack of drawn objects\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  sendToBack: function() {\n    if (this.group) {\n      fabric.StaticCanvas.prototype.sendToBack.call(this.group, this);\n    }\n    else if (this.canvas) {\n      this.canvas.sendToBack(this);\n    }\n    return this;\n  },\n\n  /**\n   * Moves an object to the top of the stack of drawn objects\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  bringToFront: function() {\n    if (this.group) {\n      fabric.StaticCanvas.prototype.bringToFront.call(this.group, this);\n    }\n    else if (this.canvas) {\n      this.canvas.bringToFront(this);\n    }\n    return this;\n  },\n\n  /**\n   * Moves an object down in stack of drawn objects\n   * @param {Boolean} [intersecting] If `true`, send object behind next lower intersecting object\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  sendBackwards: function(intersecting) {\n    if (this.group) {\n      fabric.StaticCanvas.prototype.sendBackwards.call(this.group, this, intersecting);\n    }\n    else if (this.canvas) {\n      this.canvas.sendBackwards(this, intersecting);\n    }\n    return this;\n  },\n\n  /**\n   * Moves an object up in stack of drawn objects\n   * @param {Boolean} [intersecting] If `true`, send object in front of next upper intersecting object\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  bringForward: function(intersecting) {\n    if (this.group) {\n      fabric.StaticCanvas.prototype.bringForward.call(this.group, this, intersecting);\n    }\n    else if (this.canvas) {\n      this.canvas.bringForward(this, intersecting);\n    }\n    return this;\n  },\n\n  /**\n   * Moves an object to specified level in stack of drawn objects\n   * @param {Number} index New position of object\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  moveTo: function(index) {\n    if (this.group && this.group.type !== 'activeSelection') {\n      fabric.StaticCanvas.prototype.moveTo.call(this.group, this, index);\n    }\n    else if (this.canvas) {\n      this.canvas.moveTo(this, index);\n    }\n    return this;\n  }\n});\n\n\n/* _TO_SVG_START_ */\n(function() {\n  function getSvgColorString(prop, value) {\n    if (!value) {\n      return prop + ': none; ';\n    }\n    else if (value.toLive) {\n      return prop + ': url(#SVGID_' + value.id + '); ';\n    }\n    else {\n      var color = new fabric.Color(value),\n          str = prop + ': ' + color.toRgb() + '; ',\n          opacity = color.getAlpha();\n      if (opacity !== 1) {\n        //change the color in rgb + opacity\n        str += prop + '-opacity: ' + opacity.toString() + '; ';\n      }\n      return str;\n    }\n  }\n\n  var toFixed = fabric.util.toFixed;\n\n  fabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\n    /**\n     * Returns styles-string for svg-export\n     * @param {Boolean} skipShadow a boolean to skip shadow filter output\n     * @return {String}\n     */\n    getSvgStyles: function(skipShadow) {\n\n      var fillRule = this.fillRule ? this.fillRule : 'nonzero',\n          strokeWidth = this.strokeWidth ? this.strokeWidth : '0',\n          strokeDashArray = this.strokeDashArray ? this.strokeDashArray.join(' ') : 'none',\n          strokeDashOffset = this.strokeDashOffset ? this.strokeDashOffset : '0',\n          strokeLineCap = this.strokeLineCap ? this.strokeLineCap : 'butt',\n          strokeLineJoin = this.strokeLineJoin ? this.strokeLineJoin : 'miter',\n          strokeMiterLimit = this.strokeMiterLimit ? this.strokeMiterLimit : '4',\n          opacity = typeof this.opacity !== 'undefined' ? this.opacity : '1',\n          visibility = this.visible ? '' : ' visibility: hidden;',\n          filter = skipShadow ? '' : this.getSvgFilter(),\n          fill = getSvgColorString('fill', this.fill),\n          stroke = getSvgColorString('stroke', this.stroke);\n\n      return [\n        stroke,\n        'stroke-width: ', strokeWidth, '; ',\n        'stroke-dasharray: ', strokeDashArray, '; ',\n        'stroke-linecap: ', strokeLineCap, '; ',\n        'stroke-dashoffset: ', strokeDashOffset, '; ',\n        'stroke-linejoin: ', strokeLineJoin, '; ',\n        'stroke-miterlimit: ', strokeMiterLimit, '; ',\n        fill,\n        'fill-rule: ', fillRule, '; ',\n        'opacity: ', opacity, ';',\n        filter,\n        visibility\n      ].join('');\n    },\n\n    /**\n     * Returns styles-string for svg-export\n     * @param {Object} style the object from which to retrieve style properties\n     * @param {Boolean} useWhiteSpace a boolean to include an additional attribute in the style.\n     * @return {String}\n     */\n    getSvgSpanStyles: function(style, useWhiteSpace) {\n      var term = '; ';\n      var fontFamily = style.fontFamily ?\n        'font-family: ' + (((style.fontFamily.indexOf('\\'') === -1 && style.fontFamily.indexOf('\"') === -1) ?\n          '\\'' + style.fontFamily  + '\\'' : style.fontFamily)) + term : '';\n      var strokeWidth = style.strokeWidth ? 'stroke-width: ' + style.strokeWidth + term : '',\n          fontFamily = fontFamily,\n          fontSize = style.fontSize ? 'font-size: ' + style.fontSize + 'px' + term : '',\n          fontStyle = style.fontStyle ? 'font-style: ' + style.fontStyle + term : '',\n          fontWeight = style.fontWeight ? 'font-weight: ' + style.fontWeight + term : '',\n          fill = style.fill ? getSvgColorString('fill', style.fill) : '',\n          stroke = style.stroke ? getSvgColorString('stroke', style.stroke) : '',\n          textDecoration = this.getSvgTextDecoration(style),\n          deltaY = style.deltaY ? 'baseline-shift: ' + (-style.deltaY) + '; ' : '';\n      if (textDecoration) {\n        textDecoration = 'text-decoration: ' + textDecoration + term;\n      }\n\n      return [\n        stroke,\n        strokeWidth,\n        fontFamily,\n        fontSize,\n        fontStyle,\n        fontWeight,\n        textDecoration,\n        fill,\n        deltaY,\n        useWhiteSpace ? 'white-space: pre; ' : ''\n      ].join('');\n    },\n\n    /**\n     * Returns text-decoration property for svg-export\n     * @param {Object} style the object from which to retrieve style properties\n     * @return {String}\n     */\n    getSvgTextDecoration: function(style) {\n      return ['overline', 'underline', 'line-through'].filter(function(decoration) {\n        return style[decoration.replace('-', '')];\n      }).join(' ');\n    },\n\n    /**\n     * Returns filter for svg shadow\n     * @return {String}\n     */\n    getSvgFilter: function() {\n      return this.shadow ? 'filter: url(#SVGID_' + this.shadow.id + ');' : '';\n    },\n\n    /**\n     * Returns id attribute for svg output\n     * @return {String}\n     */\n    getSvgCommons: function() {\n      return [\n        this.id ? 'id=\"' + this.id + '\" ' : '',\n        this.clipPath ? 'clip-path=\"url(#' + this.clipPath.clipPathId + ')\" ' : '',\n      ].join('');\n    },\n\n    /**\n     * Returns transform-string for svg-export\n     * @param {Boolean} use the full transform or the single object one.\n     * @return {String}\n     */\n    getSvgTransform: function(full, additionalTransform) {\n      var transform = full ? this.calcTransformMatrix() : this.calcOwnMatrix(),\n          svgTransform = 'transform=\"' + fabric.util.matrixToSVG(transform);\n      return svgTransform +\n        (additionalTransform || '') + '\" ';\n    },\n\n    _setSVGBg: function(textBgRects) {\n      if (this.backgroundColor) {\n        var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS;\n        textBgRects.push(\n          '\\t\\t<rect ',\n          this._getFillAttributes(this.backgroundColor),\n          ' x=\"',\n          toFixed(-this.width / 2, NUM_FRACTION_DIGITS),\n          '\" y=\"',\n          toFixed(-this.height / 2, NUM_FRACTION_DIGITS),\n          '\" width=\"',\n          toFixed(this.width, NUM_FRACTION_DIGITS),\n          '\" height=\"',\n          toFixed(this.height, NUM_FRACTION_DIGITS),\n          '\"></rect>\\n');\n      }\n    },\n\n    /**\n     * Returns svg representation of an instance\n     * @param {Function} [reviver] Method for further parsing of svg representation.\n     * @return {String} svg representation of an instance\n     */\n    toSVG: function(reviver) {\n      return this._createBaseSVGMarkup(this._toSVG(reviver), { reviver: reviver });\n    },\n\n    /**\n     * Returns svg clipPath representation of an instance\n     * @param {Function} [reviver] Method for further parsing of svg representation.\n     * @return {String} svg representation of an instance\n     */\n    toClipPathSVG: function(reviver) {\n      return '\\t' + this._createBaseClipPathSVGMarkup(this._toSVG(reviver), { reviver: reviver });\n    },\n\n    /**\n     * @private\n     */\n    _createBaseClipPathSVGMarkup: function(objectMarkup, options) {\n      options = options || {};\n      var reviver = options.reviver,\n          additionalTransform = options.additionalTransform || '',\n          commonPieces = [\n            this.getSvgTransform(true, additionalTransform),\n            this.getSvgCommons(),\n          ].join(''),\n          // insert commons in the markup, style and svgCommons\n          index = objectMarkup.indexOf('COMMON_PARTS');\n      objectMarkup[index] = commonPieces;\n      return reviver ? reviver(objectMarkup.join('')) : objectMarkup.join('');\n    },\n\n    /**\n     * @private\n     */\n    _createBaseSVGMarkup: function(objectMarkup, options) {\n      options = options || {};\n      var noStyle = options.noStyle,\n          reviver = options.reviver,\n          styleInfo = noStyle ? '' : 'style=\"' + this.getSvgStyles() + '\" ',\n          shadowInfo = options.withShadow ? 'style=\"' + this.getSvgFilter() + '\" ' : '',\n          clipPath = this.clipPath,\n          vectorEffect = this.strokeUniform ? 'vector-effect=\"non-scaling-stroke\" ' : '',\n          absoluteClipPath = clipPath && clipPath.absolutePositioned,\n          stroke = this.stroke, fill = this.fill, shadow = this.shadow,\n          commonPieces, markup = [], clipPathMarkup,\n          // insert commons in the markup, style and svgCommons\n          index = objectMarkup.indexOf('COMMON_PARTS'),\n          additionalTransform = options.additionalTransform;\n      if (clipPath) {\n        clipPath.clipPathId = 'CLIPPATH_' + fabric.Object.__uid++;\n        clipPathMarkup = '<clipPath id=\"' + clipPath.clipPathId + '\" >\\n' +\n          clipPath.toClipPathSVG(reviver) +\n          '</clipPath>\\n';\n      }\n      if (absoluteClipPath) {\n        markup.push(\n          '<g ', shadowInfo, this.getSvgCommons(), ' >\\n'\n        );\n      }\n      markup.push(\n        '<g ',\n        this.getSvgTransform(false),\n        !absoluteClipPath ? shadowInfo + this.getSvgCommons() : '',\n        ' >\\n'\n      );\n      commonPieces = [\n        styleInfo,\n        vectorEffect,\n        noStyle ? '' : this.addPaintOrder(), ' ',\n        additionalTransform ? 'transform=\"' + additionalTransform + '\" ' : '',\n      ].join('');\n      objectMarkup[index] = commonPieces;\n      if (fill && fill.toLive) {\n        markup.push(fill.toSVG(this));\n      }\n      if (stroke && stroke.toLive) {\n        markup.push(stroke.toSVG(this));\n      }\n      if (shadow) {\n        markup.push(shadow.toSVG(this));\n      }\n      if (clipPath) {\n        markup.push(clipPathMarkup);\n      }\n      markup.push(objectMarkup.join(''));\n      markup.push('</g>\\n');\n      absoluteClipPath && markup.push('</g>\\n');\n      return reviver ? reviver(markup.join('')) : markup.join('');\n    },\n\n    addPaintOrder: function() {\n      return this.paintFirst !== 'fill' ? ' paint-order=\"' + this.paintFirst + '\" ' : '';\n    }\n  });\n})();\n/* _TO_SVG_END_ */\n\n\n(function() {\n\n  var extend = fabric.util.object.extend,\n      originalSet = 'stateProperties';\n\n  /*\n    Depends on `stateProperties`\n  */\n  function saveProps(origin, destination, props) {\n    var tmpObj = { }, deep = true;\n    props.forEach(function(prop) {\n      tmpObj[prop] = origin[prop];\n    });\n\n    extend(origin[destination], tmpObj, deep);\n  }\n\n  function _isEqual(origValue, currentValue, firstPass) {\n    if (origValue === currentValue) {\n      // if the objects are identical, return\n      return true;\n    }\n    else if (Array.isArray(origValue)) {\n      if (!Array.isArray(currentValue) || origValue.length !== currentValue.length) {\n        return false;\n      }\n      for (var i = 0, len = origValue.length; i < len; i++) {\n        if (!_isEqual(origValue[i], currentValue[i])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    else if (origValue && typeof origValue === 'object') {\n      var keys = Object.keys(origValue), key;\n      if (!currentValue ||\n          typeof currentValue !== 'object' ||\n          (!firstPass && keys.length !== Object.keys(currentValue).length)\n      ) {\n        return false;\n      }\n      for (var i = 0, len = keys.length; i < len; i++) {\n        key = keys[i];\n        // since clipPath is in the statefull cache list and the clipPath objects\n        // would be iterated as an object, this would lead to possible infinite recursion\n        // we do not want to compare those.\n        if (key === 'canvas' || key === 'group') {\n          continue;\n        }\n        if (!_isEqual(origValue[key], currentValue[key])) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n\n  fabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\n\n    /**\n     * Returns true if object state (one of its state properties) was changed\n     * @param {String} [propertySet] optional name for the set of property we want to save\n     * @return {Boolean} true if instance' state has changed since `{@link fabric.Object#saveState}` was called\n     */\n    hasStateChanged: function(propertySet) {\n      propertySet = propertySet || originalSet;\n      var dashedPropertySet = '_' + propertySet;\n      if (Object.keys(this[dashedPropertySet]).length < this[propertySet].length) {\n        return true;\n      }\n      return !_isEqual(this[dashedPropertySet], this, true);\n    },\n\n    /**\n     * Saves state of an object\n     * @param {Object} [options] Object with additional `stateProperties` array to include when saving state\n     * @return {fabric.Object} thisArg\n     */\n    saveState: function(options) {\n      var propertySet = options && options.propertySet || originalSet,\n          destination = '_' + propertySet;\n      if (!this[destination]) {\n        return this.setupState(options);\n      }\n      saveProps(this, destination, this[propertySet]);\n      if (options && options.stateProperties) {\n        saveProps(this, destination, options.stateProperties);\n      }\n      return this;\n    },\n\n    /**\n     * Setups state of an object\n     * @param {Object} [options] Object with additional `stateProperties` array to include when saving state\n     * @return {fabric.Object} thisArg\n     */\n    setupState: function(options) {\n      options = options || { };\n      var propertySet = options.propertySet || originalSet;\n      options.propertySet = propertySet;\n      this['_' + propertySet] = { };\n      this.saveState(options);\n      return this;\n    }\n  });\n})();\n\n\n(function() {\n\n  var degreesToRadians = fabric.util.degreesToRadians;\n\n  fabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\n    /**\n     * Determines which corner has been clicked\n     * @private\n     * @param {Object} pointer The pointer indicating the mouse position\n     * @return {String|Boolean} corner code (tl, tr, bl, br, etc.), or false if nothing is found\n     */\n    _findTargetCorner: function(pointer, forTouch) {\n      // objects in group, anykind, are not self modificable,\n      // must not return an hovered corner.\n      if (!this.hasControls || this.group || (!this.canvas || this.canvas._activeObject !== this)) {\n        return false;\n      }\n\n      var ex = pointer.x,\n          ey = pointer.y,\n          xPoints,\n          lines, keys = Object.keys(this.oCoords),\n          j = keys.length - 1, i;\n      this.__corner = 0;\n\n      // cycle in reverse order so we pick first the one on top\n      for (; j >= 0; j--) {\n        i = keys[j];\n        if (!this.isControlVisible(i)) {\n          continue;\n        }\n\n        lines = this._getImageLines(forTouch ? this.oCoords[i].touchCorner : this.oCoords[i].corner);\n        // // debugging\n        //\n        // this.canvas.contextTop.fillRect(lines.bottomline.d.x, lines.bottomline.d.y, 2, 2);\n        // this.canvas.contextTop.fillRect(lines.bottomline.o.x, lines.bottomline.o.y, 2, 2);\n        //\n        // this.canvas.contextTop.fillRect(lines.leftline.d.x, lines.leftline.d.y, 2, 2);\n        // this.canvas.contextTop.fillRect(lines.leftline.o.x, lines.leftline.o.y, 2, 2);\n        //\n        // this.canvas.contextTop.fillRect(lines.topline.d.x, lines.topline.d.y, 2, 2);\n        // this.canvas.contextTop.fillRect(lines.topline.o.x, lines.topline.o.y, 2, 2);\n        //\n        // this.canvas.contextTop.fillRect(lines.rightline.d.x, lines.rightline.d.y, 2, 2);\n        // this.canvas.contextTop.fillRect(lines.rightline.o.x, lines.rightline.o.y, 2, 2);\n\n        xPoints = this._findCrossPoints({ x: ex, y: ey }, lines);\n        if (xPoints !== 0 && xPoints % 2 === 1) {\n          this.__corner = i;\n          return i;\n        }\n      }\n      return false;\n    },\n\n    /**\n     * Calls a function for each control. The function gets called,\n     * with the control, the object that is calling the iterator and the control's key\n     * @param {Function} fn function to iterate over the controls over\n     */\n    forEachControl: function(fn) {\n      for (var i in this.controls) {\n        fn(this.controls[i], i, this);\n      };\n    },\n\n    /**\n     * Sets the coordinates of the draggable boxes in the corners of\n     * the image used to scale/rotate it.\n     * note: if we would switch to ROUND corner area, all of this would disappear.\n     * everything would resolve to a single point and a pythagorean theorem for the distance\n     * @private\n     */\n    _setCornerCoords: function() {\n      var coords = this.oCoords;\n\n      for (var control in coords) {\n        var controlObject = this.controls[control];\n        coords[control].corner = controlObject.calcCornerCoords(\n          this.angle, this.cornerSize, coords[control].x, coords[control].y, false);\n        coords[control].touchCorner = controlObject.calcCornerCoords(\n          this.angle, this.touchCornerSize, coords[control].x, coords[control].y, true);\n      }\n    },\n\n    /**\n     * Draws a colored layer behind the object, inside its selection borders.\n     * Requires public options: padding, selectionBackgroundColor\n     * this function is called when the context is transformed\n     * has checks to be skipped when the object is on a staticCanvas\n     * @param {CanvasRenderingContext2D} ctx Context to draw on\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    drawSelectionBackground: function(ctx) {\n      if (!this.selectionBackgroundColor ||\n        (this.canvas && !this.canvas.interactive) ||\n        (this.canvas && this.canvas._activeObject !== this)\n      ) {\n        return this;\n      }\n      ctx.save();\n      var center = this.getCenterPoint(), wh = this._calculateCurrentDimensions(),\n          vpt = this.canvas.viewportTransform;\n      ctx.translate(center.x, center.y);\n      ctx.scale(1 / vpt[0], 1 / vpt[3]);\n      ctx.rotate(degreesToRadians(this.angle));\n      ctx.fillStyle = this.selectionBackgroundColor;\n      ctx.fillRect(-wh.x / 2, -wh.y / 2, wh.x, wh.y);\n      ctx.restore();\n      return this;\n    },\n\n    /**\n     * Draws borders of an object's bounding box.\n     * Requires public properties: width, height\n     * Requires public options: padding, borderColor\n     * @param {CanvasRenderingContext2D} ctx Context to draw on\n     * @param {Object} styleOverride object to override the object style\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    drawBorders: function(ctx, styleOverride) {\n      styleOverride = styleOverride || {};\n      var wh = this._calculateCurrentDimensions(),\n          strokeWidth = this.borderScaleFactor,\n          width = wh.x + strokeWidth,\n          height = wh.y + strokeWidth,\n          hasControls = typeof styleOverride.hasControls !== 'undefined' ?\n            styleOverride.hasControls : this.hasControls,\n          shouldStroke = false;\n\n      ctx.save();\n      ctx.strokeStyle = styleOverride.borderColor || this.borderColor;\n      this._setLineDash(ctx, styleOverride.borderDashArray || this.borderDashArray);\n\n      ctx.strokeRect(\n        -width / 2,\n        -height / 2,\n        width,\n        height\n      );\n\n      if (hasControls) {\n        ctx.beginPath();\n        this.forEachControl(function(control, key, fabricObject) {\n          // in this moment, the ctx is centered on the object.\n          // width and height of the above function are the size of the bbox.\n          if (control.withConnection && control.getVisibility(fabricObject, key)) {\n            // reset movement for each control\n            shouldStroke = true;\n            ctx.moveTo(control.x * width, control.y * height);\n            ctx.lineTo(\n              control.x * width + control.offsetX,\n              control.y * height + control.offsetY\n            );\n          }\n        });\n        if (shouldStroke) {\n          ctx.stroke();\n        }\n      }\n      ctx.restore();\n      return this;\n    },\n\n    /**\n     * Draws borders of an object's bounding box when it is inside a group.\n     * Requires public properties: width, height\n     * Requires public options: padding, borderColor\n     * @param {CanvasRenderingContext2D} ctx Context to draw on\n     * @param {object} options object representing current object parameters\n     * @param {Object} styleOverride object to override the object style\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    drawBordersInGroup: function(ctx, options, styleOverride) {\n      styleOverride = styleOverride || {};\n      var bbox = fabric.util.sizeAfterTransform(this.width, this.height, options),\n          strokeWidth = this.strokeWidth,\n          strokeUniform = this.strokeUniform,\n          borderScaleFactor = this.borderScaleFactor,\n          width =\n            bbox.x + strokeWidth * (strokeUniform ? this.canvas.getZoom() : options.scaleX) + borderScaleFactor,\n          height =\n            bbox.y + strokeWidth * (strokeUniform ? this.canvas.getZoom() : options.scaleY) + borderScaleFactor;\n      ctx.save();\n      this._setLineDash(ctx, styleOverride.borderDashArray || this.borderDashArray);\n      ctx.strokeStyle = styleOverride.borderColor || this.borderColor;\n      ctx.strokeRect(\n        -width / 2,\n        -height / 2,\n        width,\n        height\n      );\n\n      ctx.restore();\n      return this;\n    },\n\n    /**\n     * Draws corners of an object's bounding box.\n     * Requires public properties: width, height\n     * Requires public options: cornerSize, padding\n     * @param {CanvasRenderingContext2D} ctx Context to draw on\n     * @param {Object} styleOverride object to override the object style\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    drawControls: function(ctx, styleOverride) {\n      styleOverride = styleOverride || {};\n      ctx.save();\n      var retinaScaling = 1, matrix, p;\n      if (this.canvas) {\n        retinaScaling = this.canvas.getRetinaScaling();\n      }\n      ctx.setTransform(retinaScaling, 0, 0, retinaScaling, 0, 0);\n      ctx.strokeStyle = ctx.fillStyle = styleOverride.cornerColor || this.cornerColor;\n      if (!this.transparentCorners) {\n        ctx.strokeStyle = styleOverride.cornerStrokeColor || this.cornerStrokeColor;\n      }\n      this._setLineDash(ctx, styleOverride.cornerDashArray || this.cornerDashArray);\n      this.setCoords();\n      if (this.group) {\n        // fabricJS does not really support drawing controls inside groups,\n        // this piece of code here helps having at least the control in places.\n        // If an application needs to show some objects as selected because of some UI state\n        // can still call Object._renderControls() on any object they desire, independently of groups.\n        // using no padding, circular controls and hiding the rotating cursor is higly suggested,\n        matrix = this.group.calcTransformMatrix();\n      }\n      this.forEachControl(function(control, key, fabricObject) {\n        p = fabricObject.oCoords[key];\n        if (control.getVisibility(fabricObject, key)) {\n          if (matrix) {\n            p = fabric.util.transformPoint(p, matrix);\n          }\n          control.render(ctx, p.x, p.y, styleOverride, fabricObject);\n        }\n      });\n      ctx.restore();\n\n      return this;\n    },\n\n    /**\n     * Returns true if the specified control is visible, false otherwise.\n     * @param {String} controlKey The key of the control. Possible values are 'tl', 'tr', 'br', 'bl', 'ml', 'mt', 'mr', 'mb', 'mtr'.\n     * @returns {Boolean} true if the specified control is visible, false otherwise\n     */\n    isControlVisible: function(controlKey) {\n      return this.controls[controlKey] && this.controls[controlKey].getVisibility(this, controlKey);\n    },\n\n    /**\n     * Sets the visibility of the specified control.\n     * @param {String} controlKey The key of the control. Possible values are 'tl', 'tr', 'br', 'bl', 'ml', 'mt', 'mr', 'mb', 'mtr'.\n     * @param {Boolean} visible true to set the specified control visible, false otherwise\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    setControlVisible: function(controlKey, visible) {\n      if (!this._controlsVisibility) {\n        this._controlsVisibility = {};\n      }\n      this._controlsVisibility[controlKey] = visible;\n      return this;\n    },\n\n    /**\n     * Sets the visibility state of object controls.\n     * @param {Object} [options] Options object\n     * @param {Boolean} [options.bl] true to enable the bottom-left control, false to disable it\n     * @param {Boolean} [options.br] true to enable the bottom-right control, false to disable it\n     * @param {Boolean} [options.mb] true to enable the middle-bottom control, false to disable it\n     * @param {Boolean} [options.ml] true to enable the middle-left control, false to disable it\n     * @param {Boolean} [options.mr] true to enable the middle-right control, false to disable it\n     * @param {Boolean} [options.mt] true to enable the middle-top control, false to disable it\n     * @param {Boolean} [options.tl] true to enable the top-left control, false to disable it\n     * @param {Boolean} [options.tr] true to enable the top-right control, false to disable it\n     * @param {Boolean} [options.mtr] true to enable the middle-top-rotate control, false to disable it\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    setControlsVisibility: function(options) {\n      options || (options = { });\n\n      for (var p in options) {\n        this.setControlVisible(p, options[p]);\n      }\n      return this;\n    },\n\n\n    /**\n     * This callback function is called every time _discardActiveObject or _setActiveObject\n     * try to to deselect this object. If the function returns true, the process is cancelled\n     * @param {Object} [options] options sent from the upper functions\n     * @param {Event} [options.e] event if the process is generated by an event\n     */\n    onDeselect: function() {\n      // implemented by sub-classes, as needed.\n    },\n\n\n    /**\n     * This callback function is called every time _discardActiveObject or _setActiveObject\n     * try to to select this object. If the function returns true, the process is cancelled\n     * @param {Object} [options] options sent from the upper functions\n     * @param {Event} [options.e] event if the process is generated by an event\n     */\n    onSelect: function() {\n      // implemented by sub-classes, as needed.\n    }\n  });\n})();\n\n\nfabric.util.object.extend(fabric.StaticCanvas.prototype, /** @lends fabric.StaticCanvas.prototype */ {\n\n  /**\n   * Animation duration (in ms) for fx* methods\n   * @type Number\n   * @default\n   */\n  FX_DURATION: 500,\n\n  /**\n   * Centers object horizontally with animation.\n   * @param {fabric.Object} object Object to center\n   * @param {Object} [callbacks] Callbacks object with optional \"onComplete\" and/or \"onChange\" properties\n   * @param {Function} [callbacks.onComplete] Invoked on completion\n   * @param {Function} [callbacks.onChange] Invoked on every step of animation\n   * @return {fabric.AnimationContext} context\n   */\n  fxCenterObjectH: function (object, callbacks) {\n    callbacks = callbacks || { };\n\n    var empty = function() { },\n        onComplete = callbacks.onComplete || empty,\n        onChange = callbacks.onChange || empty,\n        _this = this;\n\n    return fabric.util.animate({\n      target: this,\n      startValue: object.left,\n      endValue: this.getCenterPoint().x,\n      duration: this.FX_DURATION,\n      onChange: function(value) {\n        object.set('left', value);\n        _this.requestRenderAll();\n        onChange();\n      },\n      onComplete: function() {\n        object.setCoords();\n        onComplete();\n      }\n    });\n  },\n\n  /**\n   * Centers object vertically with animation.\n   * @param {fabric.Object} object Object to center\n   * @param {Object} [callbacks] Callbacks object with optional \"onComplete\" and/or \"onChange\" properties\n   * @param {Function} [callbacks.onComplete] Invoked on completion\n   * @param {Function} [callbacks.onChange] Invoked on every step of animation\n   * @return {fabric.AnimationContext} context\n   */\n  fxCenterObjectV: function (object, callbacks) {\n    callbacks = callbacks || { };\n\n    var empty = function() { },\n        onComplete = callbacks.onComplete || empty,\n        onChange = callbacks.onChange || empty,\n        _this = this;\n\n    return fabric.util.animate({\n      target: this,\n      startValue: object.top,\n      endValue: this.getCenterPoint().y,\n      duration: this.FX_DURATION,\n      onChange: function(value) {\n        object.set('top', value);\n        _this.requestRenderAll();\n        onChange();\n      },\n      onComplete: function() {\n        object.setCoords();\n        onComplete();\n      }\n    });\n  },\n\n  /**\n   * Same as `fabric.Canvas#remove` but animated\n   * @param {fabric.Object} object Object to remove\n   * @param {Object} [callbacks] Callbacks object with optional \"onComplete\" and/or \"onChange\" properties\n   * @param {Function} [callbacks.onComplete] Invoked on completion\n   * @param {Function} [callbacks.onChange] Invoked on every step of animation\n   * @return {fabric.AnimationContext} context\n   */\n  fxRemove: function (object, callbacks) {\n    callbacks = callbacks || { };\n\n    var empty = function() { },\n        onComplete = callbacks.onComplete || empty,\n        onChange = callbacks.onChange || empty,\n        _this = this;\n\n    return fabric.util.animate({\n      target: this,\n      startValue: object.opacity,\n      endValue: 0,\n      duration: this.FX_DURATION,\n      onChange: function(value) {\n        object.set('opacity', value);\n        _this.requestRenderAll();\n        onChange();\n      },\n      onComplete: function () {\n        _this.remove(object);\n        onComplete();\n      }\n    });\n  }\n});\n\nfabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\n  /**\n   * Animates object's properties\n   * @param {String|Object} property Property to animate (if string) or properties to animate (if object)\n   * @param {Number|Object} value Value to animate property to (if string was given first) or options object\n   * @return {fabric.Object} thisArg\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#animation}\n   * @return {fabric.AnimationContext | fabric.AnimationContext[]} animation context (or an array if passed multiple properties)\n   *\n   * As object — multiple properties\n   *\n   * object.animate({ left: ..., top: ... });\n   * object.animate({ left: ..., top: ... }, { duration: ... });\n   *\n   * As string — one property\n   *\n   * object.animate('left', ...);\n   * object.animate('left', { duration: ... });\n   *\n   */\n  animate: function () {\n    if (arguments[0] && typeof arguments[0] === 'object') {\n      var propsToAnimate = [], prop, skipCallbacks, out = [];\n      for (prop in arguments[0]) {\n        propsToAnimate.push(prop);\n      }\n      for (var i = 0, len = propsToAnimate.length; i < len; i++) {\n        prop = propsToAnimate[i];\n        skipCallbacks = i !== len - 1;\n        out.push(this._animate(prop, arguments[0][prop], arguments[1], skipCallbacks));\n      }\n      return out;\n    }\n    else {\n      return this._animate.apply(this, arguments);\n    }\n  },\n\n  /**\n   * @private\n   * @param {String} property Property to animate\n   * @param {String} to Value to animate to\n   * @param {Object} [options] Options object\n   * @param {Boolean} [skipCallbacks] When true, callbacks like onchange and oncomplete are not invoked\n   */\n  _animate: function(property, to, options, skipCallbacks) {\n    var _this = this, propPair;\n\n    to = to.toString();\n\n    if (!options) {\n      options = { };\n    }\n    else {\n      options = fabric.util.object.clone(options);\n    }\n\n    if (~property.indexOf('.')) {\n      propPair = property.split('.');\n    }\n\n    var propIsColor =\n      _this.colorProperties.indexOf(property) > -1 ||\n      (propPair && _this.colorProperties.indexOf(propPair[1]) > -1);\n\n    var currentValue = propPair\n      ? this.get(propPair[0])[propPair[1]]\n      : this.get(property);\n\n    if (!('from' in options)) {\n      options.from = currentValue;\n    }\n\n    if (!propIsColor) {\n      if (~to.indexOf('=')) {\n        to = currentValue + parseFloat(to.replace('=', ''));\n      }\n      else {\n        to = parseFloat(to);\n      }\n    }\n\n    var _options = {\n      target: this,\n      startValue: options.from,\n      endValue: to,\n      byValue: options.by,\n      easing: options.easing,\n      duration: options.duration,\n      abort: options.abort && function(value, valueProgress, timeProgress) {\n        return options.abort.call(_this, value, valueProgress, timeProgress);\n      },\n      onChange: function (value, valueProgress, timeProgress) {\n        if (propPair) {\n          _this[propPair[0]][propPair[1]] = value;\n        }\n        else {\n          _this.set(property, value);\n        }\n        if (skipCallbacks) {\n          return;\n        }\n        options.onChange && options.onChange(value, valueProgress, timeProgress);\n      },\n      onComplete: function (value, valueProgress, timeProgress) {\n        if (skipCallbacks) {\n          return;\n        }\n\n        _this.setCoords();\n        options.onComplete && options.onComplete(value, valueProgress, timeProgress);\n      }\n    };\n\n    if (propIsColor) {\n      return fabric.util.animateColor(_options.startValue, _options.endValue, _options.duration, _options);\n    }\n    else {\n      return fabric.util.animate(_options);\n    }\n  }\n});\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      extend = fabric.util.object.extend,\n      clone = fabric.util.object.clone,\n      coordProps = { x1: 1, x2: 1, y1: 1, y2: 1 };\n\n  if (fabric.Line) {\n    fabric.warn('fabric.Line is already defined');\n    return;\n  }\n\n  /**\n   * Line class\n   * @class fabric.Line\n   * @extends fabric.Object\n   * @see {@link fabric.Line#initialize} for constructor definition\n   */\n  fabric.Line = fabric.util.createClass(fabric.Object, /** @lends fabric.Line.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'line',\n\n    /**\n     * x value or first line edge\n     * @type Number\n     * @default\n     */\n    x1: 0,\n\n    /**\n     * y value or first line edge\n     * @type Number\n     * @default\n     */\n    y1: 0,\n\n    /**\n     * x value or second line edge\n     * @type Number\n     * @default\n     */\n    x2: 0,\n\n    /**\n     * y value or second line edge\n     * @type Number\n     * @default\n     */\n    y2: 0,\n\n    cacheProperties: fabric.Object.prototype.cacheProperties.concat('x1', 'x2', 'y1', 'y2'),\n\n    /**\n     * Constructor\n     * @param {Array} [points] Array of points\n     * @param {Object} [options] Options object\n     * @return {fabric.Line} thisArg\n     */\n    initialize: function(points, options) {\n      if (!points) {\n        points = [0, 0, 0, 0];\n      }\n\n      this.callSuper('initialize', options);\n\n      this.set('x1', points[0]);\n      this.set('y1', points[1]);\n      this.set('x2', points[2]);\n      this.set('y2', points[3]);\n\n      this._setWidthHeight(options);\n    },\n\n    /**\n     * @private\n     * @param {Object} [options] Options\n     */\n    _setWidthHeight: function(options) {\n      options || (options = { });\n\n      this.width = Math.abs(this.x2 - this.x1);\n      this.height = Math.abs(this.y2 - this.y1);\n\n      this.left = 'left' in options\n        ? options.left\n        : this._getLeftToOriginX();\n\n      this.top = 'top' in options\n        ? options.top\n        : this._getTopToOriginY();\n    },\n\n    /**\n     * @private\n     * @param {String} key\n     * @param {*} value\n     */\n    _set: function(key, value) {\n      this.callSuper('_set', key, value);\n      if (typeof coordProps[key] !== 'undefined') {\n        this._setWidthHeight();\n      }\n      return this;\n    },\n\n    /**\n     * @private\n     * @return {Number} leftToOriginX Distance from left edge of canvas to originX of Line.\n     */\n    _getLeftToOriginX: makeEdgeToOriginGetter(\n      { // property names\n        origin: 'originX',\n        axis1: 'x1',\n        axis2: 'x2',\n        dimension: 'width'\n      },\n      { // possible values of origin\n        nearest: 'left',\n        center: 'center',\n        farthest: 'right'\n      }\n    ),\n\n    /**\n     * @private\n     * @return {Number} topToOriginY Distance from top edge of canvas to originY of Line.\n     */\n    _getTopToOriginY: makeEdgeToOriginGetter(\n      { // property names\n        origin: 'originY',\n        axis1: 'y1',\n        axis2: 'y2',\n        dimension: 'height'\n      },\n      { // possible values of origin\n        nearest: 'top',\n        center: 'center',\n        farthest: 'bottom'\n      }\n    ),\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(ctx) {\n      ctx.beginPath();\n\n\n      var p = this.calcLinePoints();\n      ctx.moveTo(p.x1, p.y1);\n      ctx.lineTo(p.x2, p.y2);\n\n      ctx.lineWidth = this.strokeWidth;\n\n      // TODO: test this\n      // make sure setting \"fill\" changes color of a line\n      // (by copying fillStyle to strokeStyle, since line is stroked, not filled)\n      var origStrokeStyle = ctx.strokeStyle;\n      ctx.strokeStyle = this.stroke || ctx.fillStyle;\n      this.stroke && this._renderStroke(ctx);\n      ctx.strokeStyle = origStrokeStyle;\n    },\n\n    /**\n     * This function is an helper for svg import. it returns the center of the object in the svg\n     * untransformed coordinates\n     * @private\n     * @return {Object} center point from element coordinates\n     */\n    _findCenterFromElement: function() {\n      return {\n        x: (this.x1 + this.x2) / 2,\n        y: (this.y1 + this.y2) / 2,\n      };\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @method toObject\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      return extend(this.callSuper('toObject', propertiesToInclude), this.calcLinePoints());\n    },\n\n    /*\n     * Calculate object dimensions from its properties\n     * @private\n     */\n    _getNonTransformedDimensions: function() {\n      var dim = this.callSuper('_getNonTransformedDimensions');\n      if (this.strokeLineCap === 'butt') {\n        if (this.width === 0) {\n          dim.y -= this.strokeWidth;\n        }\n        if (this.height === 0) {\n          dim.x -= this.strokeWidth;\n        }\n      }\n      return dim;\n    },\n\n    /**\n     * Recalculates line points given width and height\n     * @private\n     */\n    calcLinePoints: function() {\n      var xMult = this.x1 <= this.x2 ? -1 : 1,\n          yMult = this.y1 <= this.y2 ? -1 : 1,\n          x1 = (xMult * this.width * 0.5),\n          y1 = (yMult * this.height * 0.5),\n          x2 = (xMult * this.width * -0.5),\n          y2 = (yMult * this.height * -0.5);\n\n      return {\n        x1: x1,\n        x2: x2,\n        y1: y1,\n        y2: y2\n      };\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns svg representation of an instance\n     * @return {Array} an array of strings with the specific svg representation\n     * of the instance\n     */\n    _toSVG: function() {\n      var p = this.calcLinePoints();\n      return [\n        '<line ', 'COMMON_PARTS',\n        'x1=\"', p.x1,\n        '\" y1=\"', p.y1,\n        '\" x2=\"', p.x2,\n        '\" y2=\"', p.y2,\n        '\" />\\n'\n      ];\n    },\n    /* _TO_SVG_END_ */\n  });\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Line.fromElement})\n   * @static\n   * @memberOf fabric.Line\n   * @see http://www.w3.org/TR/SVG/shapes.html#LineElement\n   */\n  fabric.Line.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat('x1 y1 x2 y2'.split(' '));\n\n  /**\n   * Returns fabric.Line instance from an SVG element\n   * @static\n   * @memberOf fabric.Line\n   * @param {SVGElement} element Element to parse\n   * @param {Object} [options] Options object\n   * @param {Function} [callback] callback function invoked after parsing\n   */\n  fabric.Line.fromElement = function(element, callback, options) {\n    options = options || { };\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Line.ATTRIBUTE_NAMES),\n        points = [\n          parsedAttributes.x1 || 0,\n          parsedAttributes.y1 || 0,\n          parsedAttributes.x2 || 0,\n          parsedAttributes.y2 || 0\n        ];\n    callback(new fabric.Line(points, extend(parsedAttributes, options)));\n  };\n  /* _FROM_SVG_END_ */\n\n  /**\n   * Returns fabric.Line instance from an object representation\n   * @static\n   * @memberOf fabric.Line\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] invoked with new instance as first argument\n   */\n  fabric.Line.fromObject = function(object, callback) {\n    function _callback(instance) {\n      delete instance.points;\n      callback && callback(instance);\n    };\n    var options = clone(object, true);\n    options.points = [object.x1, object.y1, object.x2, object.y2];\n    fabric.Object._fromObject('Line', options, _callback, 'points');\n  };\n\n  /**\n   * Produces a function that calculates distance from canvas edge to Line origin.\n   */\n  function makeEdgeToOriginGetter(propertyNames, originValues) {\n    var origin = propertyNames.origin,\n        axis1 = propertyNames.axis1,\n        axis2 = propertyNames.axis2,\n        dimension = propertyNames.dimension,\n        nearest = originValues.nearest,\n        center = originValues.center,\n        farthest = originValues.farthest;\n\n    return function() {\n      switch (this.get(origin)) {\n        case nearest:\n          return Math.min(this.get(axis1), this.get(axis2));\n        case center:\n          return Math.min(this.get(axis1), this.get(axis2)) + (0.5 * this.get(dimension));\n        case farthest:\n          return Math.max(this.get(axis1), this.get(axis2));\n      }\n    };\n\n  }\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      degreesToRadians = fabric.util.degreesToRadians;\n\n  if (fabric.Circle) {\n    fabric.warn('fabric.Circle is already defined.');\n    return;\n  }\n\n  /**\n   * Circle class\n   * @class fabric.Circle\n   * @extends fabric.Object\n   * @see {@link fabric.Circle#initialize} for constructor definition\n   */\n  fabric.Circle = fabric.util.createClass(fabric.Object, /** @lends fabric.Circle.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'circle',\n\n    /**\n     * Radius of this circle\n     * @type Number\n     * @default\n     */\n    radius: 0,\n\n    /**\n     * degrees of start of the circle.\n     * probably will change to degrees in next major version\n     * @type Number 0 - 359\n     * @default 0\n     */\n    startAngle: 0,\n\n    /**\n     * End angle of the circle\n     * probably will change to degrees in next major version\n     * @type Number 1 - 360\n     * @default 360\n     */\n    endAngle: 360,\n\n    cacheProperties: fabric.Object.prototype.cacheProperties.concat('radius', 'startAngle', 'endAngle'),\n\n    /**\n     * @private\n     * @param {String} key\n     * @param {*} value\n     * @return {fabric.Circle} thisArg\n     */\n    _set: function(key, value) {\n      this.callSuper('_set', key, value);\n\n      if (key === 'radius') {\n        this.setRadius(value);\n      }\n\n      return this;\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      return this.callSuper('toObject', ['radius', 'startAngle', 'endAngle'].concat(propertiesToInclude));\n    },\n\n    /* _TO_SVG_START_ */\n\n    /**\n     * Returns svg representation of an instance\n     * @return {Array} an array of strings with the specific svg representation\n     * of the instance\n     */\n    _toSVG: function() {\n      var svgString, x = 0, y = 0,\n          angle = (this.endAngle - this.startAngle) % 360;\n\n      if (angle === 0) {\n        svgString = [\n          '<circle ', 'COMMON_PARTS',\n          'cx=\"' + x + '\" cy=\"' + y + '\" ',\n          'r=\"', this.radius,\n          '\" />\\n'\n        ];\n      }\n      else {\n        var start = degreesToRadians(this.startAngle),\n            end = degreesToRadians(this.endAngle),\n            radius = this.radius,\n            startX = fabric.util.cos(start) * radius,\n            startY = fabric.util.sin(start) * radius,\n            endX = fabric.util.cos(end) * radius,\n            endY = fabric.util.sin(end) * radius,\n            largeFlag = angle > 180 ? '1' : '0';\n        svgString = [\n          '<path d=\"M ' + startX + ' ' + startY,\n          ' A ' + radius + ' ' + radius,\n          ' 0 ', +largeFlag + ' 1', ' ' + endX + ' ' + endY,\n          '\" ', 'COMMON_PARTS', ' />\\n'\n        ];\n      }\n      return svgString;\n    },\n    /* _TO_SVG_END_ */\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx context to render on\n     */\n    _render: function(ctx) {\n      ctx.beginPath();\n      ctx.arc(\n        0,\n        0,\n        this.radius,\n        degreesToRadians(this.startAngle),\n        degreesToRadians(this.endAngle),\n        false\n      );\n      this._renderPaintInOrder(ctx);\n    },\n\n    /**\n     * Returns horizontal radius of an object (according to how an object is scaled)\n     * @return {Number}\n     */\n    getRadiusX: function() {\n      return this.get('radius') * this.get('scaleX');\n    },\n\n    /**\n     * Returns vertical radius of an object (according to how an object is scaled)\n     * @return {Number}\n     */\n    getRadiusY: function() {\n      return this.get('radius') * this.get('scaleY');\n    },\n\n    /**\n     * Sets radius of an object (and updates width accordingly)\n     * @return {fabric.Circle} thisArg\n     */\n    setRadius: function(value) {\n      this.radius = value;\n      return this.set('width', value * 2).set('height', value * 2);\n    },\n  });\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Circle.fromElement})\n   * @static\n   * @memberOf fabric.Circle\n   * @see: http://www.w3.org/TR/SVG/shapes.html#CircleElement\n   */\n  fabric.Circle.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat('cx cy r'.split(' '));\n\n  /**\n   * Returns {@link fabric.Circle} instance from an SVG element\n   * @static\n   * @memberOf fabric.Circle\n   * @param {SVGElement} element Element to parse\n   * @param {Function} [callback] Options callback invoked after parsing is finished\n   * @param {Object} [options] Options object\n   * @throws {Error} If value of `r` attribute is missing or invalid\n   */\n  fabric.Circle.fromElement = function(element, callback) {\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Circle.ATTRIBUTE_NAMES);\n\n    if (!isValidRadius(parsedAttributes)) {\n      throw new Error('value of `r` attribute is required and can not be negative');\n    }\n\n    parsedAttributes.left = (parsedAttributes.left || 0) - parsedAttributes.radius;\n    parsedAttributes.top = (parsedAttributes.top || 0) - parsedAttributes.radius;\n    callback(new fabric.Circle(parsedAttributes));\n  };\n\n  /**\n   * @private\n   */\n  function isValidRadius(attributes) {\n    return (('radius' in attributes) && (attributes.radius >= 0));\n  }\n  /* _FROM_SVG_END_ */\n\n  /**\n   * Returns {@link fabric.Circle} instance from an object representation\n   * @static\n   * @memberOf fabric.Circle\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] invoked with new instance as first argument\n   * @return {void}\n   */\n  fabric.Circle.fromObject = function(object, callback) {\n    fabric.Object._fromObject('Circle', object, callback);\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { });\n\n  if (fabric.Triangle) {\n    fabric.warn('fabric.Triangle is already defined');\n    return;\n  }\n\n  /**\n   * Triangle class\n   * @class fabric.Triangle\n   * @extends fabric.Object\n   * @return {fabric.Triangle} thisArg\n   * @see {@link fabric.Triangle#initialize} for constructor definition\n   */\n  fabric.Triangle = fabric.util.createClass(fabric.Object, /** @lends fabric.Triangle.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'triangle',\n\n    /**\n     * Width is set to 100 to compensate the old initialize code that was setting it to 100\n     * @type Number\n     * @default\n     */\n    width: 100,\n\n    /**\n     * Height is set to 100 to compensate the old initialize code that was setting it to 100\n     * @type Number\n     * @default\n     */\n    height: 100,\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(ctx) {\n      var widthBy2 = this.width / 2,\n          heightBy2 = this.height / 2;\n\n      ctx.beginPath();\n      ctx.moveTo(-widthBy2, heightBy2);\n      ctx.lineTo(0, -heightBy2);\n      ctx.lineTo(widthBy2, heightBy2);\n      ctx.closePath();\n\n      this._renderPaintInOrder(ctx);\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns svg representation of an instance\n     * @return {Array} an array of strings with the specific svg representation\n     * of the instance\n     */\n    _toSVG: function() {\n      var widthBy2 = this.width / 2,\n          heightBy2 = this.height / 2,\n          points = [\n            -widthBy2 + ' ' + heightBy2,\n            '0 ' + -heightBy2,\n            widthBy2 + ' ' + heightBy2\n          ].join(',');\n      return [\n        '<polygon ', 'COMMON_PARTS',\n        'points=\"', points,\n        '\" />'\n      ];\n    },\n    /* _TO_SVG_END_ */\n  });\n\n  /**\n   * Returns {@link fabric.Triangle} instance from an object representation\n   * @static\n   * @memberOf fabric.Triangle\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] invoked with new instance as first argument\n   */\n  fabric.Triangle.fromObject = function(object, callback) {\n    return fabric.Object._fromObject('Triangle', object, callback);\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      piBy2   = Math.PI * 2;\n\n  if (fabric.Ellipse) {\n    fabric.warn('fabric.Ellipse is already defined.');\n    return;\n  }\n\n  /**\n   * Ellipse class\n   * @class fabric.Ellipse\n   * @extends fabric.Object\n   * @return {fabric.Ellipse} thisArg\n   * @see {@link fabric.Ellipse#initialize} for constructor definition\n   */\n  fabric.Ellipse = fabric.util.createClass(fabric.Object, /** @lends fabric.Ellipse.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'ellipse',\n\n    /**\n     * Horizontal radius\n     * @type Number\n     * @default\n     */\n    rx:   0,\n\n    /**\n     * Vertical radius\n     * @type Number\n     * @default\n     */\n    ry:   0,\n\n    cacheProperties: fabric.Object.prototype.cacheProperties.concat('rx', 'ry'),\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     * @return {fabric.Ellipse} thisArg\n     */\n    initialize: function(options) {\n      this.callSuper('initialize', options);\n      this.set('rx', options && options.rx || 0);\n      this.set('ry', options && options.ry || 0);\n    },\n\n    /**\n     * @private\n     * @param {String} key\n     * @param {*} value\n     * @return {fabric.Ellipse} thisArg\n     */\n    _set: function(key, value) {\n      this.callSuper('_set', key, value);\n      switch (key) {\n\n        case 'rx':\n          this.rx = value;\n          this.set('width', value * 2);\n          break;\n\n        case 'ry':\n          this.ry = value;\n          this.set('height', value * 2);\n          break;\n\n      }\n      return this;\n    },\n\n    /**\n     * Returns horizontal radius of an object (according to how an object is scaled)\n     * @return {Number}\n     */\n    getRx: function() {\n      return this.get('rx') * this.get('scaleX');\n    },\n\n    /**\n     * Returns Vertical radius of an object (according to how an object is scaled)\n     * @return {Number}\n     */\n    getRy: function() {\n      return this.get('ry') * this.get('scaleY');\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      return this.callSuper('toObject', ['rx', 'ry'].concat(propertiesToInclude));\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns svg representation of an instance\n     * @return {Array} an array of strings with the specific svg representation\n     * of the instance\n     */\n    _toSVG: function() {\n      return [\n        '<ellipse ', 'COMMON_PARTS',\n        'cx=\"0\" cy=\"0\" ',\n        'rx=\"', this.rx,\n        '\" ry=\"', this.ry,\n        '\" />\\n'\n      ];\n    },\n    /* _TO_SVG_END_ */\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx context to render on\n     */\n    _render: function(ctx) {\n      ctx.beginPath();\n      ctx.save();\n      ctx.transform(1, 0, 0, this.ry / this.rx, 0, 0);\n      ctx.arc(\n        0,\n        0,\n        this.rx,\n        0,\n        piBy2,\n        false);\n      ctx.restore();\n      this._renderPaintInOrder(ctx);\n    },\n  });\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Ellipse.fromElement})\n   * @static\n   * @memberOf fabric.Ellipse\n   * @see http://www.w3.org/TR/SVG/shapes.html#EllipseElement\n   */\n  fabric.Ellipse.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat('cx cy rx ry'.split(' '));\n\n  /**\n   * Returns {@link fabric.Ellipse} instance from an SVG element\n   * @static\n   * @memberOf fabric.Ellipse\n   * @param {SVGElement} element Element to parse\n   * @param {Function} [callback] Options callback invoked after parsing is finished\n   * @return {fabric.Ellipse}\n   */\n  fabric.Ellipse.fromElement = function(element, callback) {\n\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Ellipse.ATTRIBUTE_NAMES);\n\n    parsedAttributes.left = (parsedAttributes.left || 0) - parsedAttributes.rx;\n    parsedAttributes.top = (parsedAttributes.top || 0) - parsedAttributes.ry;\n    callback(new fabric.Ellipse(parsedAttributes));\n  };\n  /* _FROM_SVG_END_ */\n\n  /**\n   * Returns {@link fabric.Ellipse} instance from an object representation\n   * @static\n   * @memberOf fabric.Ellipse\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] invoked with new instance as first argument\n   * @return {void}\n   */\n  fabric.Ellipse.fromObject = function(object, callback) {\n    fabric.Object._fromObject('Ellipse', object, callback);\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      extend = fabric.util.object.extend;\n\n  if (fabric.Rect) {\n    fabric.warn('fabric.Rect is already defined');\n    return;\n  }\n\n  /**\n   * Rectangle class\n   * @class fabric.Rect\n   * @extends fabric.Object\n   * @return {fabric.Rect} thisArg\n   * @see {@link fabric.Rect#initialize} for constructor definition\n   */\n  fabric.Rect = fabric.util.createClass(fabric.Object, /** @lends fabric.Rect.prototype */ {\n\n    /**\n     * List of properties to consider when checking if state of an object is changed ({@link fabric.Object#hasStateChanged})\n     * as well as for history (undo/redo) purposes\n     * @type Array\n     */\n    stateProperties: fabric.Object.prototype.stateProperties.concat('rx', 'ry'),\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'rect',\n\n    /**\n     * Horizontal border radius\n     * @type Number\n     * @default\n     */\n    rx:   0,\n\n    /**\n     * Vertical border radius\n     * @type Number\n     * @default\n     */\n    ry:   0,\n\n    cacheProperties: fabric.Object.prototype.cacheProperties.concat('rx', 'ry'),\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     * @return {Object} thisArg\n     */\n    initialize: function(options) {\n      this.callSuper('initialize', options);\n      this._initRxRy();\n    },\n\n    /**\n     * Initializes rx/ry attributes\n     * @private\n     */\n    _initRxRy: function() {\n      if (this.rx && !this.ry) {\n        this.ry = this.rx;\n      }\n      else if (this.ry && !this.rx) {\n        this.rx = this.ry;\n      }\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(ctx) {\n\n      // 1x1 case (used in spray brush) optimization was removed because\n      // with caching and higher zoom level this makes more damage than help\n\n      var rx = this.rx ? Math.min(this.rx, this.width / 2) : 0,\n          ry = this.ry ? Math.min(this.ry, this.height / 2) : 0,\n          w = this.width,\n          h = this.height,\n          x = -this.width / 2,\n          y = -this.height / 2,\n          isRounded = rx !== 0 || ry !== 0,\n          /* \"magic number\" for bezier approximations of arcs (http://itc.ktu.lt/itc354/Riskus354.pdf) */\n          k = 1 - 0.5522847498;\n      ctx.beginPath();\n\n      ctx.moveTo(x + rx, y);\n\n      ctx.lineTo(x + w - rx, y);\n      isRounded && ctx.bezierCurveTo(x + w - k * rx, y, x + w, y + k * ry, x + w, y + ry);\n\n      ctx.lineTo(x + w, y + h - ry);\n      isRounded && ctx.bezierCurveTo(x + w, y + h - k * ry, x + w - k * rx, y + h, x + w - rx, y + h);\n\n      ctx.lineTo(x + rx, y + h);\n      isRounded && ctx.bezierCurveTo(x + k * rx, y + h, x, y + h - k * ry, x, y + h - ry);\n\n      ctx.lineTo(x, y + ry);\n      isRounded && ctx.bezierCurveTo(x, y + k * ry, x + k * rx, y, x + rx, y);\n\n      ctx.closePath();\n\n      this._renderPaintInOrder(ctx);\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      return this.callSuper('toObject', ['rx', 'ry'].concat(propertiesToInclude));\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns svg representation of an instance\n     * @return {Array} an array of strings with the specific svg representation\n     * of the instance\n     */\n    _toSVG: function() {\n      var x = -this.width / 2, y = -this.height / 2;\n      return [\n        '<rect ', 'COMMON_PARTS',\n        'x=\"', x, '\" y=\"', y,\n        '\" rx=\"', this.rx, '\" ry=\"', this.ry,\n        '\" width=\"', this.width, '\" height=\"', this.height,\n        '\" />\\n'\n      ];\n    },\n    /* _TO_SVG_END_ */\n  });\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by `fabric.Rect.fromElement`)\n   * @static\n   * @memberOf fabric.Rect\n   * @see: http://www.w3.org/TR/SVG/shapes.html#RectElement\n   */\n  fabric.Rect.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat('x y rx ry width height'.split(' '));\n\n  /**\n   * Returns {@link fabric.Rect} instance from an SVG element\n   * @static\n   * @memberOf fabric.Rect\n   * @param {SVGElement} element Element to parse\n   * @param {Function} callback callback function invoked after parsing\n   * @param {Object} [options] Options object\n   */\n  fabric.Rect.fromElement = function(element, callback, options) {\n    if (!element) {\n      return callback(null);\n    }\n    options = options || { };\n\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Rect.ATTRIBUTE_NAMES);\n    parsedAttributes.left = parsedAttributes.left || 0;\n    parsedAttributes.top  = parsedAttributes.top  || 0;\n    parsedAttributes.height  = parsedAttributes.height || 0;\n    parsedAttributes.width  = parsedAttributes.width || 0;\n    var rect = new fabric.Rect(extend((options ? fabric.util.object.clone(options) : { }), parsedAttributes));\n    rect.visible = rect.visible && rect.width > 0 && rect.height > 0;\n    callback(rect);\n  };\n  /* _FROM_SVG_END_ */\n\n  /**\n   * Returns {@link fabric.Rect} instance from an object representation\n   * @static\n   * @memberOf fabric.Rect\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] Callback to invoke when an fabric.Rect instance is created\n   */\n  fabric.Rect.fromObject = function(object, callback) {\n    return fabric.Object._fromObject('Rect', object, callback);\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      extend = fabric.util.object.extend,\n      min = fabric.util.array.min,\n      max = fabric.util.array.max,\n      toFixed = fabric.util.toFixed,\n      projectStrokeOnPoints = fabric.util.projectStrokeOnPoints;\n\n  if (fabric.Polyline) {\n    fabric.warn('fabric.Polyline is already defined');\n    return;\n  }\n\n  /**\n   * Polyline class\n   * @class fabric.Polyline\n   * @extends fabric.Object\n   * @see {@link fabric.Polyline#initialize} for constructor definition\n   */\n  fabric.Polyline = fabric.util.createClass(fabric.Object, /** @lends fabric.Polyline.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'polyline',\n\n    /**\n     * Points array\n     * @type Array\n     * @default\n     */\n    points: null,\n\n    /**\n     * WARNING: Feature in progress\n     * Calculate the exact bounding box taking in account strokeWidth on acute angles\n     * this will be turned to true by default on fabric 6.0\n     * maybe will be left in as an optimization since calculations may be slow\n     * @deprecated\n     * @type Boolean\n     * @default false\n     */\n    exactBoundingBox: false,\n\n    cacheProperties: fabric.Object.prototype.cacheProperties.concat('points'),\n\n    /**\n     * Constructor\n     * @param {Array} points Array of points (where each point is an object with x and y)\n     * @param {Object} [options] Options object\n     * @return {fabric.Polyline} thisArg\n     * @example\n     * var poly = new fabric.Polyline([\n     *     { x: 10, y: 10 },\n     *     { x: 50, y: 30 },\n     *     { x: 40, y: 70 },\n     *     { x: 60, y: 50 },\n     *     { x: 100, y: 150 },\n     *     { x: 40, y: 100 }\n     *   ], {\n     *   stroke: 'red',\n     *   left: 100,\n     *   top: 100\n     * });\n     */\n    initialize: function(points, options) {\n      options = options || {};\n      this.points = points || [];\n      this.callSuper('initialize', options);\n      this._setPositionDimensions(options);\n    },\n\n    /**\n     * @private\n     */\n    _projectStrokeOnPoints: function () {\n      return projectStrokeOnPoints(this.points, this, true);\n    },\n\n    _setPositionDimensions: function(options) {\n      var calcDim = this._calcDimensions(options), correctLeftTop,\n          correctSize = this.exactBoundingBox ? this.strokeWidth : 0;\n      this.width = calcDim.width - correctSize;\n      this.height = calcDim.height - correctSize;\n      if (!options.fromSVG) {\n        correctLeftTop = this.translateToGivenOrigin(\n          {\n            // this looks bad, but is one way to keep it optional for now.\n            x: calcDim.left - this.strokeWidth / 2 + correctSize / 2,\n            y: calcDim.top - this.strokeWidth / 2 + correctSize / 2\n          },\n          'left',\n          'top',\n          this.originX,\n          this.originY\n        );\n      }\n      if (typeof options.left === 'undefined') {\n        this.left = options.fromSVG ? calcDim.left : correctLeftTop.x;\n      }\n      if (typeof options.top === 'undefined') {\n        this.top = options.fromSVG ? calcDim.top : correctLeftTop.y;\n      }\n      this.pathOffset = {\n        x: calcDim.left + this.width / 2 + correctSize / 2,\n        y: calcDim.top + this.height / 2 + correctSize / 2\n      };\n    },\n\n    /**\n     * Calculate the polygon min and max point from points array,\n     * returning an object with left, top, width, height to measure the\n     * polygon size\n     * @return {Object} object.left X coordinate of the polygon leftmost point\n     * @return {Object} object.top Y coordinate of the polygon topmost point\n     * @return {Object} object.width distance between X coordinates of the polygon leftmost and rightmost point\n     * @return {Object} object.height distance between Y coordinates of the polygon topmost and bottommost point\n     * @private\n     */\n    _calcDimensions: function() {\n\n      var points = this.exactBoundingBox ? this._projectStrokeOnPoints() : this.points,\n          minX = min(points, 'x') || 0,\n          minY = min(points, 'y') || 0,\n          maxX = max(points, 'x') || 0,\n          maxY = max(points, 'y') || 0,\n          width = (maxX - minX),\n          height = (maxY - minY);\n\n      return {\n        left: minX,\n        top: minY,\n        width: width,\n        height: height,\n      };\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      return extend(this.callSuper('toObject', propertiesToInclude), {\n        points: this.points.concat()\n      });\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns svg representation of an instance\n     * @return {Array} an array of strings with the specific svg representation\n     * of the instance\n     */\n    _toSVG: function() {\n      var points = [], diffX = this.pathOffset.x, diffY = this.pathOffset.y,\n          NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS;\n\n      for (var i = 0, len = this.points.length; i < len; i++) {\n        points.push(\n          toFixed(this.points[i].x - diffX, NUM_FRACTION_DIGITS), ',',\n          toFixed(this.points[i].y - diffY, NUM_FRACTION_DIGITS), ' '\n        );\n      }\n      return [\n        '<' + this.type + ' ', 'COMMON_PARTS',\n        'points=\"', points.join(''),\n        '\" />\\n'\n      ];\n    },\n    /* _TO_SVG_END_ */\n\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    commonRender: function(ctx) {\n      var point, len = this.points.length,\n          x = this.pathOffset.x,\n          y = this.pathOffset.y;\n\n      if (!len || isNaN(this.points[len - 1].y)) {\n        // do not draw if no points or odd points\n        // NaN comes from parseFloat of a empty string in parser\n        return false;\n      }\n      ctx.beginPath();\n      ctx.moveTo(this.points[0].x - x, this.points[0].y - y);\n      for (var i = 0; i < len; i++) {\n        point = this.points[i];\n        ctx.lineTo(point.x - x, point.y - y);\n      }\n      return true;\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(ctx) {\n      if (!this.commonRender(ctx)) {\n        return;\n      }\n      this._renderPaintInOrder(ctx);\n    },\n\n    /**\n     * Returns complexity of an instance\n     * @return {Number} complexity of this instance\n     */\n    complexity: function() {\n      return this.get('points').length;\n    }\n  });\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Polyline.fromElement})\n   * @static\n   * @memberOf fabric.Polyline\n   * @see: http://www.w3.org/TR/SVG/shapes.html#PolylineElement\n   */\n  fabric.Polyline.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat();\n\n  /**\n   * Returns fabric.Polyline instance from an SVG element\n   * @static\n   * @memberOf fabric.Polyline\n   * @param {SVGElement} element Element to parser\n   * @param {Function} callback callback function invoked after parsing\n   * @param {Object} [options] Options object\n   */\n  fabric.Polyline.fromElementGenerator = function(_class) {\n    return function(element, callback, options) {\n      if (!element) {\n        return callback(null);\n      }\n      options || (options = { });\n\n      var points = fabric.parsePointsAttribute(element.getAttribute('points')),\n          parsedAttributes = fabric.parseAttributes(element, fabric[_class].ATTRIBUTE_NAMES);\n      parsedAttributes.fromSVG = true;\n      callback(new fabric[_class](points, extend(parsedAttributes, options)));\n    };\n  };\n\n  fabric.Polyline.fromElement = fabric.Polyline.fromElementGenerator('Polyline');\n\n  /* _FROM_SVG_END_ */\n\n  /**\n   * Returns fabric.Polyline instance from an object representation\n   * @static\n   * @memberOf fabric.Polyline\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] Callback to invoke when an fabric.Path instance is created\n   */\n  fabric.Polyline.fromObject = function(object, callback) {\n    return fabric.Object._fromObject('Polyline', object, callback, 'points');\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = {}),\n      projectStrokeOnPoints = fabric.util.projectStrokeOnPoints;\n\n  if (fabric.Polygon) {\n    fabric.warn('fabric.Polygon is already defined');\n    return;\n  }\n\n  /**\n   * Polygon class\n   * @class fabric.Polygon\n   * @extends fabric.Polyline\n   * @see {@link fabric.Polygon#initialize} for constructor definition\n   */\n  fabric.Polygon = fabric.util.createClass(fabric.Polyline, /** @lends fabric.Polygon.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'polygon',\n\n    /**\n     * @private\n     */\n    _projectStrokeOnPoints: function () {\n      return projectStrokeOnPoints(this.points, this);\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(ctx) {\n      if (!this.commonRender(ctx)) {\n        return;\n      }\n      ctx.closePath();\n      this._renderPaintInOrder(ctx);\n    },\n\n  });\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by `fabric.Polygon.fromElement`)\n   * @static\n   * @memberOf fabric.Polygon\n   * @see: http://www.w3.org/TR/SVG/shapes.html#PolygonElement\n   */\n  fabric.Polygon.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat();\n\n  /**\n   * Returns {@link fabric.Polygon} instance from an SVG element\n   * @static\n   * @memberOf fabric.Polygon\n   * @param {SVGElement} element Element to parse\n   * @param {Function} callback callback function invoked after parsing\n   * @param {Object} [options] Options object\n   */\n  fabric.Polygon.fromElement = fabric.Polyline.fromElementGenerator('Polygon');\n  /* _FROM_SVG_END_ */\n\n  /**\n   * Returns fabric.Polygon instance from an object representation\n   * @static\n   * @memberOf fabric.Polygon\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] Callback to invoke when an fabric.Path instance is created\n   * @return {void}\n   */\n  fabric.Polygon.fromObject = function(object, callback) {\n    fabric.Object._fromObject('Polygon', object, callback, 'points');\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      min = fabric.util.array.min,\n      max = fabric.util.array.max,\n      extend = fabric.util.object.extend,\n      clone = fabric.util.object.clone,\n      toFixed = fabric.util.toFixed;\n\n  if (fabric.Path) {\n    fabric.warn('fabric.Path is already defined');\n    return;\n  }\n\n  /**\n   * Path class\n   * @class fabric.Path\n   * @extends fabric.Object\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#path_and_pathgroup}\n   * @see {@link fabric.Path#initialize} for constructor definition\n   */\n  fabric.Path = fabric.util.createClass(fabric.Object, /** @lends fabric.Path.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'path',\n\n    /**\n     * Array of path points\n     * @type Array\n     * @default\n     */\n    path: null,\n\n    cacheProperties: fabric.Object.prototype.cacheProperties.concat('path', 'fillRule'),\n\n    stateProperties: fabric.Object.prototype.stateProperties.concat('path'),\n\n    /**\n     * Constructor\n     * @param {Array|String} path Path data (sequence of coordinates and corresponding \"command\" tokens)\n     * @param {Object} [options] Options object\n     * @return {fabric.Path} thisArg\n     */\n    initialize: function (path, options) {\n      options = clone(options || {});\n      delete options.path;\n      this.callSuper('initialize', options);\n      this._setPath(path || [], options);\n    },\n\n    /**\n    * @private\n    * @param {Array|String} path Path data (sequence of coordinates and corresponding \"command\" tokens)\n    * @param {Object} [options] Options object\n    */\n    _setPath: function (path, options) {\n      this.path = fabric.util.makePathSimpler(\n        Array.isArray(path) ? path : fabric.util.parsePath(path)\n      );\n\n      fabric.Polyline.prototype._setPositionDimensions.call(this, options || {});\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx context to render path on\n     */\n    _renderPathCommands: function(ctx) {\n      var current, // current instruction\n          subpathStartX = 0,\n          subpathStartY = 0,\n          x = 0, // current x\n          y = 0, // current y\n          controlX = 0, // current control point x\n          controlY = 0, // current control point y\n          l = -this.pathOffset.x,\n          t = -this.pathOffset.y;\n\n      ctx.beginPath();\n\n      for (var i = 0, len = this.path.length; i < len; ++i) {\n\n        current = this.path[i];\n\n        switch (current[0]) { // first letter\n\n          case 'L': // lineto, absolute\n            x = current[1];\n            y = current[2];\n            ctx.lineTo(x + l, y + t);\n            break;\n\n          case 'M': // moveTo, absolute\n            x = current[1];\n            y = current[2];\n            subpathStartX = x;\n            subpathStartY = y;\n            ctx.moveTo(x + l, y + t);\n            break;\n\n          case 'C': // bezierCurveTo, absolute\n            x = current[5];\n            y = current[6];\n            controlX = current[3];\n            controlY = current[4];\n            ctx.bezierCurveTo(\n              current[1] + l,\n              current[2] + t,\n              controlX + l,\n              controlY + t,\n              x + l,\n              y + t\n            );\n            break;\n\n          case 'Q': // quadraticCurveTo, absolute\n            ctx.quadraticCurveTo(\n              current[1] + l,\n              current[2] + t,\n              current[3] + l,\n              current[4] + t\n            );\n            x = current[3];\n            y = current[4];\n            controlX = current[1];\n            controlY = current[2];\n            break;\n\n          case 'z':\n          case 'Z':\n            x = subpathStartX;\n            y = subpathStartY;\n            ctx.closePath();\n            break;\n        }\n      }\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx context to render path on\n     */\n    _render: function(ctx) {\n      this._renderPathCommands(ctx);\n      this._renderPaintInOrder(ctx);\n    },\n\n    /**\n     * Returns string representation of an instance\n     * @return {String} string representation of an instance\n     */\n    toString: function() {\n      return '#<fabric.Path (' + this.complexity() +\n        '): { \"top\": ' + this.top + ', \"left\": ' + this.left + ' }>';\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      return extend(this.callSuper('toObject', propertiesToInclude), {\n        path: this.path.map(function(item) { return item.slice(); }),\n      });\n    },\n\n    /**\n     * Returns dataless object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toDatalessObject: function(propertiesToInclude) {\n      var o = this.toObject(['sourcePath'].concat(propertiesToInclude));\n      if (o.sourcePath) {\n        delete o.path;\n      }\n      return o;\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns svg representation of an instance\n     * @return {Array} an array of strings with the specific svg representation\n     * of the instance\n     */\n    _toSVG: function() {\n      var path = fabric.util.joinPath(this.path);\n      return [\n        '<path ', 'COMMON_PARTS',\n        'd=\"', path,\n        '\" stroke-linecap=\"round\" ',\n        '/>\\n'\n      ];\n    },\n\n    _getOffsetTransform: function() {\n      var digits = fabric.Object.NUM_FRACTION_DIGITS;\n      return ' translate(' + toFixed(-this.pathOffset.x, digits) + ', ' +\n          toFixed(-this.pathOffset.y, digits) + ')';\n    },\n\n    /**\n     * Returns svg clipPath representation of an instance\n     * @param {Function} [reviver] Method for further parsing of svg representation.\n     * @return {String} svg representation of an instance\n     */\n    toClipPathSVG: function(reviver) {\n      var additionalTransform = this._getOffsetTransform();\n      return '\\t' + this._createBaseClipPathSVGMarkup(\n        this._toSVG(), { reviver: reviver, additionalTransform: additionalTransform }\n      );\n    },\n\n    /**\n     * Returns svg representation of an instance\n     * @param {Function} [reviver] Method for further parsing of svg representation.\n     * @return {String} svg representation of an instance\n     */\n    toSVG: function(reviver) {\n      var additionalTransform = this._getOffsetTransform();\n      return this._createBaseSVGMarkup(this._toSVG(), { reviver: reviver, additionalTransform: additionalTransform  });\n    },\n    /* _TO_SVG_END_ */\n\n    /**\n     * Returns number representation of an instance complexity\n     * @return {Number} complexity of this instance\n     */\n    complexity: function() {\n      return this.path.length;\n    },\n\n    /**\n     * @private\n     */\n    _calcDimensions: function() {\n\n      var aX = [],\n          aY = [],\n          current, // current instruction\n          subpathStartX = 0,\n          subpathStartY = 0,\n          x = 0, // current x\n          y = 0, // current y\n          bounds;\n\n      for (var i = 0, len = this.path.length; i < len; ++i) {\n\n        current = this.path[i];\n\n        switch (current[0]) { // first letter\n\n          case 'L': // lineto, absolute\n            x = current[1];\n            y = current[2];\n            bounds = [];\n            break;\n\n          case 'M': // moveTo, absolute\n            x = current[1];\n            y = current[2];\n            subpathStartX = x;\n            subpathStartY = y;\n            bounds = [];\n            break;\n\n          case 'C': // bezierCurveTo, absolute\n            bounds = fabric.util.getBoundsOfCurve(x, y,\n              current[1],\n              current[2],\n              current[3],\n              current[4],\n              current[5],\n              current[6]\n            );\n            x = current[5];\n            y = current[6];\n            break;\n\n          case 'Q': // quadraticCurveTo, absolute\n            bounds = fabric.util.getBoundsOfCurve(x, y,\n              current[1],\n              current[2],\n              current[1],\n              current[2],\n              current[3],\n              current[4]\n            );\n            x = current[3];\n            y = current[4];\n            break;\n\n          case 'z':\n          case 'Z':\n            x = subpathStartX;\n            y = subpathStartY;\n            break;\n        }\n        bounds.forEach(function (point) {\n          aX.push(point.x);\n          aY.push(point.y);\n        });\n        aX.push(x);\n        aY.push(y);\n      }\n\n      var minX = min(aX) || 0,\n          minY = min(aY) || 0,\n          maxX = max(aX) || 0,\n          maxY = max(aY) || 0,\n          deltaX = maxX - minX,\n          deltaY = maxY - minY;\n\n      return {\n        left: minX,\n        top: minY,\n        width: deltaX,\n        height: deltaY\n      };\n    }\n  });\n\n  /**\n   * Creates an instance of fabric.Path from an object\n   * @static\n   * @memberOf fabric.Path\n   * @param {Object} object\n   * @param {Function} [callback] Callback to invoke when an fabric.Path instance is created\n   */\n  fabric.Path.fromObject = function(object, callback) {\n    if (typeof object.sourcePath === 'string') {\n      var pathUrl = object.sourcePath;\n      fabric.loadSVGFromURL(pathUrl, function (elements) {\n        var path = elements[0];\n        path.setOptions(object);\n        if (object.clipPath) {\n          fabric.util.enlivenObjects([object.clipPath], function(elivenedObjects) {\n            path.clipPath = elivenedObjects[0];\n            callback && callback(path);\n          });\n        }\n        else {\n          callback && callback(path);\n        }\n      });\n    }\n    else {\n      fabric.Object._fromObject('Path', object, callback, 'path');\n    }\n  };\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by `fabric.Path.fromElement`)\n   * @static\n   * @memberOf fabric.Path\n   * @see http://www.w3.org/TR/SVG/paths.html#PathElement\n   */\n  fabric.Path.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat(['d']);\n\n  /**\n   * Creates an instance of fabric.Path from an SVG <path> element\n   * @static\n   * @memberOf fabric.Path\n   * @param {SVGElement} element to parse\n   * @param {Function} callback Callback to invoke when an fabric.Path instance is created\n   * @param {Object} [options] Options object\n   * @param {Function} [callback] Options callback invoked after parsing is finished\n   */\n  fabric.Path.fromElement = function(element, callback, options) {\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Path.ATTRIBUTE_NAMES);\n    parsedAttributes.fromSVG = true;\n    callback(new fabric.Path(parsedAttributes.d, extend(parsedAttributes, options)));\n  };\n  /* _FROM_SVG_END_ */\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      min = fabric.util.array.min,\n      max = fabric.util.array.max;\n\n  if (fabric.Group) {\n    return;\n  }\n\n  /**\n   * Group class\n   * @class fabric.Group\n   * @extends fabric.Object\n   * @mixes fabric.Collection\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#groups}\n   * @see {@link fabric.Group#initialize} for constructor definition\n   */\n  fabric.Group = fabric.util.createClass(fabric.Object, fabric.Collection, /** @lends fabric.Group.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'group',\n\n    /**\n     * Width of stroke\n     * @type Number\n     * @default\n     */\n    strokeWidth: 0,\n\n    /**\n     * Indicates if click, mouseover, mouseout events & hoverCursor should also check for subtargets\n     * @type Boolean\n     * @default\n     */\n    subTargetCheck: false,\n\n    /**\n     * Groups are container, do not render anything on theyr own, ence no cache properties\n     * @type Array\n     * @default\n     */\n    cacheProperties: [],\n\n    /**\n     * setOnGroup is a method used for TextBox that is no more used since 2.0.0 The behavior is still\n     * available setting this boolean to true.\n     * @type Boolean\n     * @since 2.0.0\n     * @default\n     */\n    useSetOnGroup: false,\n\n    /**\n     * Constructor\n     * @param {Object} objects Group objects\n     * @param {Object} [options] Options object\n     * @param {Boolean} [isAlreadyGrouped] if true, objects have been grouped already.\n     * @return {Object} thisArg\n     */\n    initialize: function(objects, options, isAlreadyGrouped) {\n      options = options || {};\n      this._objects = [];\n      // if objects enclosed in a group have been grouped already,\n      // we cannot change properties of objects.\n      // Thus we need to set options to group without objects,\n      isAlreadyGrouped && this.callSuper('initialize', options);\n      this._objects = objects || [];\n      for (var i = this._objects.length; i--; ) {\n        this._objects[i].group = this;\n      }\n\n      if (!isAlreadyGrouped) {\n        var center = options && options.centerPoint;\n        // we want to set origins before calculating the bounding box.\n        // so that the topleft can be set with that in mind.\n        // if specific top and left are passed, are overwritten later\n        // with the callSuper('initialize', options)\n        if (options.originX !== undefined) {\n          this.originX = options.originX;\n        }\n        if (options.originY !== undefined) {\n          this.originY = options.originY;\n        }\n        // if coming from svg i do not want to calc bounds.\n        // i assume width and height are passed along options\n        center || this._calcBounds();\n        this._updateObjectsCoords(center);\n        delete options.centerPoint;\n        this.callSuper('initialize', options);\n      }\n      else {\n        this._updateObjectsACoords();\n      }\n\n      this.setCoords();\n    },\n\n    /**\n     * @private\n     */\n    _updateObjectsACoords: function() {\n      var skipControls = true;\n      for (var i = this._objects.length; i--; ){\n        this._objects[i].setCoords(skipControls);\n      }\n    },\n\n    /**\n     * @private\n     * @param {Boolean} [skipCoordsChange] if true, coordinates of objects enclosed in a group do not change\n     */\n    _updateObjectsCoords: function(center) {\n      var center = center || this.getCenterPoint();\n      for (var i = this._objects.length; i--; ){\n        this._updateObjectCoords(this._objects[i], center);\n      }\n    },\n\n    /**\n     * @private\n     * @param {Object} object\n     * @param {fabric.Point} center, current center of group.\n     */\n    _updateObjectCoords: function(object, center) {\n      var objectLeft = object.left,\n          objectTop = object.top,\n          skipControls = true;\n\n      object.set({\n        left: objectLeft - center.x,\n        top: objectTop - center.y\n      });\n      object.group = this;\n      object.setCoords(skipControls);\n    },\n\n    /**\n     * Returns string represenation of a group\n     * @return {String}\n     */\n    toString: function() {\n      return '#<fabric.Group: (' + this.complexity() + ')>';\n    },\n\n    /**\n     * Adds an object to a group; Then recalculates group's dimension, position.\n     * @param {Object} object\n     * @return {fabric.Group} thisArg\n     * @chainable\n     */\n    addWithUpdate: function(object) {\n      var nested = !!this.group;\n      this._restoreObjectsState();\n      fabric.util.resetObjectTransform(this);\n      if (object) {\n        if (nested) {\n          // if this group is inside another group, we need to pre transform the object\n          fabric.util.removeTransformFromObject(object, this.group.calcTransformMatrix());\n        }\n        this._objects.push(object);\n        object.group = this;\n        object._set('canvas', this.canvas);\n      }\n      this._calcBounds();\n      this._updateObjectsCoords();\n      this.dirty = true;\n      if (nested) {\n        this.group.addWithUpdate();\n      }\n      else {\n        this.setCoords();\n      }\n      return this;\n    },\n\n    /**\n     * Removes an object from a group; Then recalculates group's dimension, position.\n     * @param {Object} object\n     * @return {fabric.Group} thisArg\n     * @chainable\n     */\n    removeWithUpdate: function(object) {\n      this._restoreObjectsState();\n      fabric.util.resetObjectTransform(this);\n\n      this.remove(object);\n      this._calcBounds();\n      this._updateObjectsCoords();\n      this.setCoords();\n      this.dirty = true;\n      return this;\n    },\n\n    /**\n     * @private\n     */\n    _onObjectAdded: function(object) {\n      this.dirty = true;\n      object.group = this;\n      object._set('canvas', this.canvas);\n    },\n\n    /**\n     * @private\n     */\n    _onObjectRemoved: function(object) {\n      this.dirty = true;\n      delete object.group;\n    },\n\n    /**\n     * @private\n     */\n    _set: function(key, value) {\n      var i = this._objects.length;\n      if (this.useSetOnGroup) {\n        while (i--) {\n          this._objects[i].setOnGroup(key, value);\n        }\n      }\n      if (key === 'canvas') {\n        while (i--) {\n          this._objects[i]._set(key, value);\n        }\n      }\n      fabric.Object.prototype._set.call(this, key, value);\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      var _includeDefaultValues = this.includeDefaultValues;\n      var objsToObject = this._objects\n        .filter(function (obj) {\n          return !obj.excludeFromExport;\n        })\n        .map(function (obj) {\n          var originalDefaults = obj.includeDefaultValues;\n          obj.includeDefaultValues = _includeDefaultValues;\n          var _obj = obj.toObject(propertiesToInclude);\n          obj.includeDefaultValues = originalDefaults;\n          return _obj;\n        });\n      var obj = fabric.Object.prototype.toObject.call(this, propertiesToInclude);\n      obj.objects = objsToObject;\n      return obj;\n    },\n\n    /**\n     * Returns object representation of an instance, in dataless mode.\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toDatalessObject: function(propertiesToInclude) {\n      var objsToObject, sourcePath = this.sourcePath;\n      if (sourcePath) {\n        objsToObject = sourcePath;\n      }\n      else {\n        var _includeDefaultValues = this.includeDefaultValues;\n        objsToObject = this._objects.map(function(obj) {\n          var originalDefaults = obj.includeDefaultValues;\n          obj.includeDefaultValues = _includeDefaultValues;\n          var _obj = obj.toDatalessObject(propertiesToInclude);\n          obj.includeDefaultValues = originalDefaults;\n          return _obj;\n        });\n      }\n      var obj = fabric.Object.prototype.toDatalessObject.call(this, propertiesToInclude);\n      obj.objects = objsToObject;\n      return obj;\n    },\n\n    /**\n     * Renders instance on a given context\n     * @param {CanvasRenderingContext2D} ctx context to render instance on\n     */\n    render: function(ctx) {\n      this._transformDone = true;\n      this.callSuper('render', ctx);\n      this._transformDone = false;\n    },\n\n    /**\n     * Decide if the object should cache or not. Create its own cache level\n     * needsItsOwnCache should be used when the object drawing method requires\n     * a cache step. None of the fabric classes requires it.\n     * Generally you do not cache objects in groups because the group is already cached.\n     * @return {Boolean}\n     */\n    shouldCache: function() {\n      var ownCache = fabric.Object.prototype.shouldCache.call(this);\n      if (ownCache) {\n        for (var i = 0, len = this._objects.length; i < len; i++) {\n          if (this._objects[i].willDrawShadow()) {\n            this.ownCaching = false;\n            return false;\n          }\n        }\n      }\n      return ownCache;\n    },\n\n    /**\n     * Check if this object or a child object will cast a shadow\n     * @return {Boolean}\n     */\n    willDrawShadow: function() {\n      if (fabric.Object.prototype.willDrawShadow.call(this)) {\n        return true;\n      }\n      for (var i = 0, len = this._objects.length; i < len; i++) {\n        if (this._objects[i].willDrawShadow()) {\n          return true;\n        }\n      }\n      return false;\n    },\n\n    /**\n     * Check if this group or its parent group are caching, recursively up\n     * @return {Boolean}\n     */\n    isOnACache: function() {\n      return this.ownCaching || (this.group && this.group.isOnACache());\n    },\n\n    /**\n     * Execute the drawing operation for an object on a specified context\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    drawObject: function(ctx) {\n      for (var i = 0, len = this._objects.length; i < len; i++) {\n        this._objects[i].render(ctx);\n      }\n      this._drawClipPath(ctx, this.clipPath);\n    },\n\n    /**\n     * Check if cache is dirty\n     */\n    isCacheDirty: function(skipCanvas) {\n      if (this.callSuper('isCacheDirty', skipCanvas)) {\n        return true;\n      }\n      if (!this.statefullCache) {\n        return false;\n      }\n      for (var i = 0, len = this._objects.length; i < len; i++) {\n        if (this._objects[i].isCacheDirty(true)) {\n          if (this._cacheCanvas) {\n            // if this group has not a cache canvas there is nothing to clean\n            var x = this.cacheWidth / this.zoomX, y = this.cacheHeight / this.zoomY;\n            this._cacheContext.clearRect(-x / 2, -y / 2, x, y);\n          }\n          return true;\n        }\n      }\n      return false;\n    },\n\n    /**\n     * Restores original state of each of group objects (original state is that which was before group was created).\n     * if the nested boolean is true, the original state will be restored just for the\n     * first group and not for all the group chain\n     * @private\n     * @param {Boolean} nested tell the function to restore object state up to the parent group and not more\n     * @return {fabric.Group} thisArg\n     * @chainable\n     */\n    _restoreObjectsState: function() {\n      var groupMatrix = this.calcOwnMatrix();\n      this._objects.forEach(function(object) {\n        // instead of using _this = this;\n        fabric.util.addTransformToObject(object, groupMatrix);\n        delete object.group;\n        object.setCoords();\n      });\n      return this;\n    },\n\n    /**\n     * Destroys a group (restoring state of its objects)\n     * @return {fabric.Group} thisArg\n     * @chainable\n     */\n    destroy: function() {\n      // when group is destroyed objects needs to get a repaint to be eventually\n      // displayed on canvas.\n      this._objects.forEach(function(object) {\n        object.set('dirty', true);\n      });\n      return this._restoreObjectsState();\n    },\n\n    dispose: function () {\n      this.callSuper('dispose');\n      this.forEachObject(function (object) {\n        object.dispose && object.dispose();\n      });\n      this._objects = [];\n    },\n\n    /**\n     * make a group an active selection, remove the group from canvas\n     * the group has to be on canvas for this to work.\n     * @return {fabric.ActiveSelection} thisArg\n     * @chainable\n     */\n    toActiveSelection: function() {\n      if (!this.canvas) {\n        return;\n      }\n      var objects = this._objects, canvas = this.canvas;\n      this._objects = [];\n      var options = this.toObject();\n      delete options.objects;\n      var activeSelection = new fabric.ActiveSelection([]);\n      activeSelection.set(options);\n      activeSelection.type = 'activeSelection';\n      canvas.remove(this);\n      objects.forEach(function(object) {\n        object.group = activeSelection;\n        object.dirty = true;\n        canvas.add(object);\n      });\n      activeSelection.canvas = canvas;\n      activeSelection._objects = objects;\n      canvas._activeObject = activeSelection;\n      activeSelection.setCoords();\n      return activeSelection;\n    },\n\n    /**\n     * Destroys a group (restoring state of its objects)\n     * @return {fabric.Group} thisArg\n     * @chainable\n     */\n    ungroupOnCanvas: function() {\n      return this._restoreObjectsState();\n    },\n\n    /**\n     * Sets coordinates of all objects inside group\n     * @return {fabric.Group} thisArg\n     * @chainable\n     */\n    setObjectsCoords: function() {\n      var skipControls = true;\n      this.forEachObject(function(object) {\n        object.setCoords(skipControls);\n      });\n      return this;\n    },\n\n    /**\n     * @private\n     */\n    _calcBounds: function(onlyWidthHeight) {\n      var aX = [],\n          aY = [],\n          o, prop, coords,\n          props = ['tr', 'br', 'bl', 'tl'],\n          i = 0, iLen = this._objects.length,\n          j, jLen = props.length;\n\n      for ( ; i < iLen; ++i) {\n        o = this._objects[i];\n        coords = o.calcACoords();\n        for (j = 0; j < jLen; j++) {\n          prop = props[j];\n          aX.push(coords[prop].x);\n          aY.push(coords[prop].y);\n        }\n        o.aCoords = coords;\n      }\n\n      this._getBounds(aX, aY, onlyWidthHeight);\n    },\n\n    /**\n     * @private\n     */\n    _getBounds: function(aX, aY, onlyWidthHeight) {\n      var minXY = new fabric.Point(min(aX), min(aY)),\n          maxXY = new fabric.Point(max(aX), max(aY)),\n          top = minXY.y || 0, left = minXY.x || 0,\n          width = (maxXY.x - minXY.x) || 0,\n          height = (maxXY.y - minXY.y) || 0;\n      this.width = width;\n      this.height = height;\n      if (!onlyWidthHeight) {\n        // the bounding box always finds the topleft most corner.\n        // whatever is the group origin, we set up here the left/top position.\n        this.setPositionByOrigin({ x: left, y: top }, 'left', 'top');\n      }\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns svg representation of an instance\n     * @param {Function} [reviver] Method for further parsing of svg representation.\n     * @return {String} svg representation of an instance\n     */\n    _toSVG: function(reviver) {\n      var svgString = ['<g ', 'COMMON_PARTS', ' >\\n'];\n\n      for (var i = 0, len = this._objects.length; i < len; i++) {\n        svgString.push('\\t\\t', this._objects[i].toSVG(reviver));\n      }\n      svgString.push('</g>\\n');\n      return svgString;\n    },\n\n    /**\n     * Returns styles-string for svg-export, specific version for group\n     * @return {String}\n     */\n    getSvgStyles: function() {\n      var opacity = typeof this.opacity !== 'undefined' && this.opacity !== 1 ?\n            'opacity: ' + this.opacity + ';' : '',\n          visibility = this.visible ? '' : ' visibility: hidden;';\n      return [\n        opacity,\n        this.getSvgFilter(),\n        visibility\n      ].join('');\n    },\n\n    /**\n     * Returns svg clipPath representation of an instance\n     * @param {Function} [reviver] Method for further parsing of svg representation.\n     * @return {String} svg representation of an instance\n     */\n    toClipPathSVG: function(reviver) {\n      var svgString = [];\n\n      for (var i = 0, len = this._objects.length; i < len; i++) {\n        svgString.push('\\t', this._objects[i].toClipPathSVG(reviver));\n      }\n\n      return this._createBaseClipPathSVGMarkup(svgString, { reviver: reviver });\n    },\n    /* _TO_SVG_END_ */\n  });\n\n  /**\n   * Returns {@link fabric.Group} instance from an object representation\n   * @static\n   * @memberOf fabric.Group\n   * @param {Object} object Object to create a group from\n   * @param {Function} [callback] Callback to invoke when an group instance is created\n   */\n  fabric.Group.fromObject = function(object, callback) {\n    var objects = object.objects,\n        options = fabric.util.object.clone(object, true);\n    delete options.objects;\n    if (typeof objects === 'string') {\n      // it has to be an url or something went wrong.\n      fabric.loadSVGFromURL(objects, function (elements) {\n        var group = fabric.util.groupSVGElements(elements, object, objects);\n        var clipPath = options.clipPath;\n        delete options.clipPath;\n        group.set(options);\n        if (clipPath) {\n          fabric.util.enlivenObjects([clipPath], function(elivenedObjects) {\n            group.clipPath = elivenedObjects[0];\n            callback && callback(group);\n          });\n        }\n        else {\n          callback && callback(group);\n        }\n      });\n      return;\n    }\n    fabric.util.enlivenObjects(objects, function (enlivenedObjects) {\n      fabric.util.enlivenObjectEnlivables(object, options, function () {\n        callback && callback(new fabric.Group(enlivenedObjects, options, true));\n      });\n    });\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { });\n\n  if (fabric.ActiveSelection) {\n    return;\n  }\n\n  /**\n   * Group class\n   * @class fabric.ActiveSelection\n   * @extends fabric.Group\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3#groups}\n   * @see {@link fabric.ActiveSelection#initialize} for constructor definition\n   */\n  fabric.ActiveSelection = fabric.util.createClass(fabric.Group, /** @lends fabric.ActiveSelection.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'activeSelection',\n\n    /**\n     * Constructor\n     * @param {Object} objects ActiveSelection objects\n     * @param {Object} [options] Options object\n     * @return {Object} thisArg\n     */\n    initialize: function(objects, options) {\n      options = options || {};\n      this._objects = objects || [];\n      for (var i = this._objects.length; i--; ) {\n        this._objects[i].group = this;\n      }\n\n      if (options.originX) {\n        this.originX = options.originX;\n      }\n      if (options.originY) {\n        this.originY = options.originY;\n      }\n      this._calcBounds();\n      this._updateObjectsCoords();\n      fabric.Object.prototype.initialize.call(this, options);\n      this.setCoords();\n    },\n\n    /**\n     * Change te activeSelection to a normal group,\n     * High level function that automatically adds it to canvas as\n     * active object. no events fired.\n     * @since 2.0.0\n     * @return {fabric.Group}\n     */\n    toGroup: function() {\n      var objects = this._objects.concat();\n      this._objects = [];\n      var options = fabric.Object.prototype.toObject.call(this);\n      var newGroup = new fabric.Group([]);\n      delete options.type;\n      newGroup.set(options);\n      objects.forEach(function(object) {\n        object.canvas.remove(object);\n        object.group = newGroup;\n      });\n      newGroup._objects = objects;\n      if (!this.canvas) {\n        return newGroup;\n      }\n      var canvas = this.canvas;\n      canvas.add(newGroup);\n      canvas._activeObject = newGroup;\n      newGroup.setCoords();\n      return newGroup;\n    },\n\n    /**\n     * If returns true, deselection is cancelled.\n     * @since 2.0.0\n     * @return {Boolean} [cancel]\n     */\n    onDeselect: function() {\n      this.destroy();\n      return false;\n    },\n\n    /**\n     * Returns string representation of a group\n     * @return {String}\n     */\n    toString: function() {\n      return '#<fabric.ActiveSelection: (' + this.complexity() + ')>';\n    },\n\n    /**\n     * Decide if the object should cache or not. Create its own cache level\n     * objectCaching is a global flag, wins over everything\n     * needsItsOwnCache should be used when the object drawing method requires\n     * a cache step. None of the fabric classes requires it.\n     * Generally you do not cache objects in groups because the group outside is cached.\n     * @return {Boolean}\n     */\n    shouldCache: function() {\n      return false;\n    },\n\n    /**\n     * Check if this group or its parent group are caching, recursively up\n     * @return {Boolean}\n     */\n    isOnACache: function() {\n      return false;\n    },\n\n    /**\n     * Renders controls and borders for the object\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {Object} [styleOverride] properties to override the object style\n     * @param {Object} [childrenOverride] properties to override the children overrides\n     */\n    _renderControls: function(ctx, styleOverride, childrenOverride) {\n      ctx.save();\n      ctx.globalAlpha = this.isMoving ? this.borderOpacityWhenMoving : 1;\n      childrenOverride = childrenOverride || { };\n      if (typeof childrenOverride.hasControls === 'undefined') {\n        childrenOverride.hasControls = false;\n      }\n      childrenOverride.forActiveSelection = true;\n      for (var i = 0, len = this._objects.length; i < len; i++) {\n        this._objects[i]._renderControls(ctx, childrenOverride);\n      }\n      this.callSuper('_renderControls', ctx, styleOverride);\n      ctx.restore();\n    },\n  });\n\n  /**\n   * Returns {@link fabric.ActiveSelection} instance from an object representation\n   * @static\n   * @memberOf fabric.ActiveSelection\n   * @param {Object} object Object to create a group from\n   * @param {Function} [callback] Callback to invoke when an ActiveSelection instance is created\n   */\n  fabric.ActiveSelection.fromObject = function(object, callback) {\n    fabric.util.enlivenObjects(object.objects, function(enlivenedObjects) {\n      delete object.objects;\n      callback && callback(new fabric.ActiveSelection(enlivenedObjects, object, true));\n    });\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var extend = fabric.util.object.extend;\n\n  if (!global.fabric) {\n    global.fabric = { };\n  }\n\n  if (global.fabric.Image) {\n    fabric.warn('fabric.Image is already defined.');\n    return;\n  }\n\n  /**\n   * Image class\n   * @class fabric.Image\n   * @extends fabric.Object\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1#images}\n   * @see {@link fabric.Image#initialize} for constructor definition\n   */\n  fabric.Image = fabric.util.createClass(fabric.Object, /** @lends fabric.Image.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'image',\n\n    /**\n     * Width of a stroke.\n     * For image quality a stroke multiple of 2 gives better results.\n     * @type Number\n     * @default\n     */\n    strokeWidth: 0,\n\n    /**\n     * When calling {@link fabric.Image.getSrc}, return value from element src with `element.getAttribute('src')`.\n     * This allows for relative urls as image src.\n     * @since 2.7.0\n     * @type Boolean\n     * @default\n     */\n    srcFromAttribute: false,\n\n    /**\n     * private\n     * contains last value of scaleX to detect\n     * if the Image got resized after the last Render\n     * @type Number\n     */\n    _lastScaleX: 1,\n\n    /**\n     * private\n     * contains last value of scaleY to detect\n     * if the Image got resized after the last Render\n     * @type Number\n     */\n    _lastScaleY: 1,\n\n    /**\n     * private\n     * contains last value of scaling applied by the apply filter chain\n     * @type Number\n     */\n    _filterScalingX: 1,\n\n    /**\n     * private\n     * contains last value of scaling applied by the apply filter chain\n     * @type Number\n     */\n    _filterScalingY: 1,\n\n    /**\n     * minimum scale factor under which any resizeFilter is triggered to resize the image\n     * 0 will disable the automatic resize. 1 will trigger automatically always.\n     * number bigger than 1 are not implemented yet.\n     * @type Number\n     */\n    minimumScaleTrigger: 0.5,\n\n    /**\n     * List of properties to consider when checking if\n     * state of an object is changed ({@link fabric.Object#hasStateChanged})\n     * as well as for history (undo/redo) purposes\n     * @type Array\n     */\n    stateProperties: fabric.Object.prototype.stateProperties.concat('cropX', 'cropY'),\n\n    /**\n     * List of properties to consider when checking if cache needs refresh\n     * Those properties are checked by statefullCache ON ( or lazy mode if we want ) or from single\n     * calls to Object.set(key, value). If the key is in this list, the object is marked as dirty\n     * and refreshed at the next render\n     * @type Array\n     */\n    cacheProperties: fabric.Object.prototype.cacheProperties.concat('cropX', 'cropY'),\n\n    /**\n     * key used to retrieve the texture representing this image\n     * @since 2.0.0\n     * @type String\n     * @default\n     */\n    cacheKey: '',\n\n    /**\n     * Image crop in pixels from original image size.\n     * @since 2.0.0\n     * @type Number\n     * @default\n     */\n    cropX: 0,\n\n    /**\n     * Image crop in pixels from original image size.\n     * @since 2.0.0\n     * @type Number\n     * @default\n     */\n    cropY: 0,\n\n    /**\n     * Indicates whether this canvas will use image smoothing when painting this image.\n     * Also influence if the cacheCanvas for this image uses imageSmoothing\n     * @since 4.0.0-beta.11\n     * @type Boolean\n     * @default\n     */\n    imageSmoothing: true,\n\n    /**\n     * Constructor\n     * Image can be initialized with any canvas drawable or a string.\n     * The string should be a url and will be loaded as an image.\n     * Canvas and Image element work out of the box, while videos require extra code to work.\n     * Please check video element events for seeking.\n     * @param {HTMLImageElement | HTMLCanvasElement | HTMLVideoElement | String} element Image element\n     * @param {Object} [options] Options object\n     * @param {function} [callback] callback function to call after eventual filters applied.\n     * @return {fabric.Image} thisArg\n     */\n    initialize: function(element, options) {\n      options || (options = { });\n      this.filters = [];\n      this.cacheKey = 'texture' + fabric.Object.__uid++;\n      this.callSuper('initialize', options);\n      this._initElement(element, options);\n    },\n\n    /**\n     * Returns image element which this instance if based on\n     * @return {HTMLImageElement} Image element\n     */\n    getElement: function() {\n      return this._element || {};\n    },\n\n    /**\n     * Sets image element for this instance to a specified one.\n     * If filters defined they are applied to new image.\n     * You might need to call `canvas.renderAll` and `object.setCoords` after replacing, to render new image and update controls area.\n     * @param {HTMLImageElement} element\n     * @param {Object} [options] Options object\n     * @return {fabric.Image} thisArg\n     * @chainable\n     */\n    setElement: function(element, options) {\n      this.removeTexture(this.cacheKey);\n      this.removeTexture(this.cacheKey + '_filtered');\n      this._element = element;\n      this._originalElement = element;\n      this._initConfig(options);\n      if (this.filters.length !== 0) {\n        this.applyFilters();\n      }\n      // resizeFilters work on the already filtered copy.\n      // we need to apply resizeFilters AFTER normal filters.\n      // applyResizeFilters is run more often than normal filters\n      // and is triggered by user interactions rather than dev code\n      if (this.resizeFilter) {\n        this.applyResizeFilters();\n      }\n      return this;\n    },\n\n    /**\n     * Delete a single texture if in webgl mode\n     */\n    removeTexture: function(key) {\n      var backend = fabric.filterBackend;\n      if (backend && backend.evictCachesForKey) {\n        backend.evictCachesForKey(key);\n      }\n    },\n\n    /**\n     * Delete textures, reference to elements and eventually JSDOM cleanup\n     */\n    dispose: function () {\n      this.callSuper('dispose');\n      this.removeTexture(this.cacheKey);\n      this.removeTexture(this.cacheKey + '_filtered');\n      this._cacheContext = undefined;\n      ['_originalElement', '_element', '_filteredEl', '_cacheCanvas'].forEach((function(element) {\n        fabric.util.cleanUpJsdomNode(this[element]);\n        this[element] = undefined;\n      }).bind(this));\n    },\n\n    /**\n     * Get the crossOrigin value (of the corresponding image element)\n     */\n    getCrossOrigin: function() {\n      return this._originalElement && (this._originalElement.crossOrigin || null);\n    },\n\n    /**\n     * Returns original size of an image\n     * @return {Object} Object with \"width\" and \"height\" properties\n     */\n    getOriginalSize: function() {\n      var element = this.getElement();\n      return {\n        width: element.naturalWidth || element.width,\n        height: element.naturalHeight || element.height\n      };\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _stroke: function(ctx) {\n      if (!this.stroke || this.strokeWidth === 0) {\n        return;\n      }\n      var w = this.width / 2, h = this.height / 2;\n      ctx.beginPath();\n      ctx.moveTo(-w, -h);\n      ctx.lineTo(w, -h);\n      ctx.lineTo(w, h);\n      ctx.lineTo(-w, h);\n      ctx.lineTo(-w, -h);\n      ctx.closePath();\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      var filters = [];\n\n      this.filters.forEach(function(filterObj) {\n        if (filterObj) {\n          filters.push(filterObj.toObject());\n        }\n      });\n      var object = extend(\n        this.callSuper(\n          'toObject',\n          ['cropX', 'cropY'].concat(propertiesToInclude)\n        ), {\n          src: this.getSrc(),\n          crossOrigin: this.getCrossOrigin(),\n          filters: filters,\n        });\n      if (this.resizeFilter) {\n        object.resizeFilter = this.resizeFilter.toObject();\n      }\n      return object;\n    },\n\n    /**\n     * Returns true if an image has crop applied, inspecting values of cropX,cropY,width,height.\n     * @return {Boolean}\n     */\n    hasCrop: function() {\n      return this.cropX || this.cropY || this.width < this._element.width || this.height < this._element.height;\n    },\n\n    /* _TO_SVG_START_ */\n    /**\n     * Returns svg representation of an instance\n     * @return {Array} an array of strings with the specific svg representation\n     * of the instance\n     */\n    _toSVG: function() {\n      var svgString = [], imageMarkup = [], strokeSvg, element = this._element,\n          x = -this.width / 2, y = -this.height / 2, clipPath = '', imageRendering = '';\n      if (!element) {\n        return [];\n      }\n      if (this.hasCrop()) {\n        var clipPathId = fabric.Object.__uid++;\n        svgString.push(\n          '<clipPath id=\"imageCrop_' + clipPathId + '\">\\n',\n          '\\t<rect x=\"' + x + '\" y=\"' + y + '\" width=\"' + this.width + '\" height=\"' + this.height + '\" />\\n',\n          '</clipPath>\\n'\n        );\n        clipPath = ' clip-path=\"url(#imageCrop_' + clipPathId + ')\" ';\n      }\n      if (!this.imageSmoothing) {\n        imageRendering = '\" image-rendering=\"optimizeSpeed';\n      }\n      imageMarkup.push('\\t<image ', 'COMMON_PARTS', 'xlink:href=\"', this.getSvgSrc(true),\n        '\" x=\"', x - this.cropX, '\" y=\"', y - this.cropY,\n        // we're essentially moving origin of transformation from top/left corner to the center of the shape\n        // by wrapping it in container <g> element with actual transformation, then offsetting object to the top/left\n        // so that object's center aligns with container's left/top\n        '\" width=\"', element.width || element.naturalWidth,\n        '\" height=\"', element.height || element.height,\n        imageRendering,\n        '\"', clipPath,\n        '></image>\\n');\n\n      if (this.stroke || this.strokeDashArray) {\n        var origFill = this.fill;\n        this.fill = null;\n        strokeSvg = [\n          '\\t<rect ',\n          'x=\"', x, '\" y=\"', y,\n          '\" width=\"', this.width, '\" height=\"', this.height,\n          '\" style=\"', this.getSvgStyles(),\n          '\"/>\\n'\n        ];\n        this.fill = origFill;\n      }\n      if (this.paintFirst !== 'fill') {\n        svgString = svgString.concat(strokeSvg, imageMarkup);\n      }\n      else {\n        svgString = svgString.concat(imageMarkup, strokeSvg);\n      }\n      return svgString;\n    },\n    /* _TO_SVG_END_ */\n\n    /**\n     * Returns source of an image\n     * @param {Boolean} filtered indicates if the src is needed for svg\n     * @return {String} Source of an image\n     */\n    getSrc: function(filtered) {\n      var element = filtered ? this._element : this._originalElement;\n      if (element) {\n        if (element.toDataURL) {\n          return element.toDataURL();\n        }\n\n        if (this.srcFromAttribute) {\n          return element.getAttribute('src');\n        }\n        else {\n          return element.src;\n        }\n      }\n      else {\n        return this.src || '';\n      }\n    },\n\n    /**\n     * Sets source of an image\n     * @param {String} src Source string (URL)\n     * @param {Function} [callback] Callback is invoked when image has been loaded (and all filters have been applied)\n     * @param {Object} [options] Options object\n     * @param {String} [options.crossOrigin] crossOrigin value (one of \"\", \"anonymous\", \"use-credentials\")\n     * @see https://developer.mozilla.org/en-US/docs/HTML/CORS_settings_attributes\n     * @return {fabric.Image} thisArg\n     * @chainable\n     */\n    setSrc: function(src, callback, options) {\n      fabric.util.loadImage(src, function(img, isError) {\n        this.setElement(img, options);\n        this._setWidthHeight();\n        callback && callback(this, isError);\n      }, this, options && options.crossOrigin);\n      return this;\n    },\n\n    /**\n     * Returns string representation of an instance\n     * @return {String} String representation of an instance\n     */\n    toString: function() {\n      return '#<fabric.Image: { src: \"' + this.getSrc() + '\" }>';\n    },\n\n    applyResizeFilters: function() {\n      var filter = this.resizeFilter,\n          minimumScale = this.minimumScaleTrigger,\n          objectScale = this.getTotalObjectScaling(),\n          scaleX = objectScale.scaleX,\n          scaleY = objectScale.scaleY,\n          elementToFilter = this._filteredEl || this._originalElement;\n      if (this.group) {\n        this.set('dirty', true);\n      }\n      if (!filter || (scaleX > minimumScale && scaleY > minimumScale)) {\n        this._element = elementToFilter;\n        this._filterScalingX = 1;\n        this._filterScalingY = 1;\n        this._lastScaleX = scaleX;\n        this._lastScaleY = scaleY;\n        return;\n      }\n      if (!fabric.filterBackend) {\n        fabric.filterBackend = fabric.initFilterBackend();\n      }\n      var canvasEl = fabric.util.createCanvasElement(),\n          cacheKey = this._filteredEl ? (this.cacheKey + '_filtered') : this.cacheKey,\n          sourceWidth = elementToFilter.width, sourceHeight = elementToFilter.height;\n      canvasEl.width = sourceWidth;\n      canvasEl.height = sourceHeight;\n      this._element = canvasEl;\n      this._lastScaleX = filter.scaleX = scaleX;\n      this._lastScaleY = filter.scaleY = scaleY;\n      fabric.filterBackend.applyFilters(\n        [filter], elementToFilter, sourceWidth, sourceHeight, this._element, cacheKey);\n      this._filterScalingX = canvasEl.width / this._originalElement.width;\n      this._filterScalingY = canvasEl.height / this._originalElement.height;\n    },\n\n    /**\n     * Applies filters assigned to this image (from \"filters\" array) or from filter param\n     * @method applyFilters\n     * @param {Array} filters to be applied\n     * @param {Boolean} forResizing specify if the filter operation is a resize operation\n     * @return {thisArg} return the fabric.Image object\n     * @chainable\n     */\n    applyFilters: function(filters) {\n\n      filters = filters || this.filters || [];\n      filters = filters.filter(function(filter) { return filter && !filter.isNeutralState(); });\n      this.set('dirty', true);\n\n      // needs to clear out or WEBGL will not resize correctly\n      this.removeTexture(this.cacheKey + '_filtered');\n\n      if (filters.length === 0) {\n        this._element = this._originalElement;\n        this._filteredEl = null;\n        this._filterScalingX = 1;\n        this._filterScalingY = 1;\n        return this;\n      }\n\n      var imgElement = this._originalElement,\n          sourceWidth = imgElement.naturalWidth || imgElement.width,\n          sourceHeight = imgElement.naturalHeight || imgElement.height;\n\n      if (this._element === this._originalElement) {\n        // if the element is the same we need to create a new element\n        var canvasEl = fabric.util.createCanvasElement();\n        canvasEl.width = sourceWidth;\n        canvasEl.height = sourceHeight;\n        this._element = canvasEl;\n        this._filteredEl = canvasEl;\n      }\n      else {\n        // clear the existing element to get new filter data\n        // also dereference the eventual resized _element\n        this._element = this._filteredEl;\n        this._filteredEl.getContext('2d').clearRect(0, 0, sourceWidth, sourceHeight);\n        // we also need to resize again at next renderAll, so remove saved _lastScaleX/Y\n        this._lastScaleX = 1;\n        this._lastScaleY = 1;\n      }\n      if (!fabric.filterBackend) {\n        fabric.filterBackend = fabric.initFilterBackend();\n      }\n      fabric.filterBackend.applyFilters(\n        filters, this._originalElement, sourceWidth, sourceHeight, this._element, this.cacheKey);\n      if (this._originalElement.width !== this._element.width ||\n        this._originalElement.height !== this._element.height) {\n        this._filterScalingX = this._element.width / this._originalElement.width;\n        this._filterScalingY = this._element.height / this._originalElement.height;\n      }\n      return this;\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(ctx) {\n      fabric.util.setImageSmoothing(ctx, this.imageSmoothing);\n      if (this.isMoving !== true && this.resizeFilter && this._needsResize()) {\n        this.applyResizeFilters();\n      }\n      this._stroke(ctx);\n      this._renderPaintInOrder(ctx);\n    },\n\n    /**\n     * Paint the cached copy of the object on the target context.\n     * it will set the imageSmoothing for the draw operation\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    drawCacheOnCanvas: function(ctx) {\n      fabric.util.setImageSmoothing(ctx, this.imageSmoothing);\n      fabric.Object.prototype.drawCacheOnCanvas.call(this, ctx);\n    },\n\n    /**\n     * Decide if the object should cache or not. Create its own cache level\n     * needsItsOwnCache should be used when the object drawing method requires\n     * a cache step. None of the fabric classes requires it.\n     * Generally you do not cache objects in groups because the group outside is cached.\n     * This is the special image version where we would like to avoid caching where possible.\n     * Essentially images do not benefit from caching. They may require caching, and in that\n     * case we do it. Also caching an image usually ends in a loss of details.\n     * A full performance audit should be done.\n     * @return {Boolean}\n     */\n    shouldCache: function() {\n      return this.needsItsOwnCache();\n    },\n\n    _renderFill: function(ctx) {\n      var elementToDraw = this._element;\n      if (!elementToDraw) {\n        return;\n      }\n      var scaleX = this._filterScalingX, scaleY = this._filterScalingY,\n          w = this.width, h = this.height, min = Math.min, max = Math.max,\n          // crop values cannot be lesser than 0.\n          cropX = max(this.cropX, 0), cropY = max(this.cropY, 0),\n          elWidth = elementToDraw.naturalWidth || elementToDraw.width,\n          elHeight = elementToDraw.naturalHeight || elementToDraw.height,\n          sX = cropX * scaleX,\n          sY = cropY * scaleY,\n          // the width height cannot exceed element width/height, starting from the crop offset.\n          sW = min(w * scaleX, elWidth - sX),\n          sH = min(h * scaleY, elHeight - sY),\n          x = -w / 2, y = -h / 2,\n          maxDestW = min(w, elWidth / scaleX - cropX),\n          maxDestH = min(h, elHeight / scaleY - cropY);\n\n      elementToDraw && ctx.drawImage(elementToDraw, sX, sY, sW, sH, x, y, maxDestW, maxDestH);\n    },\n\n    /**\n     * needed to check if image needs resize\n     * @private\n     */\n    _needsResize: function() {\n      var scale = this.getTotalObjectScaling();\n      return (scale.scaleX !== this._lastScaleX || scale.scaleY !== this._lastScaleY);\n    },\n\n    /**\n     * @private\n     */\n    _resetWidthHeight: function() {\n      this.set(this.getOriginalSize());\n    },\n\n    /**\n     * The Image class's initialization method. This method is automatically\n     * called by the constructor.\n     * @private\n     * @param {HTMLImageElement|String} element The element representing the image\n     * @param {Object} [options] Options object\n     */\n    _initElement: function(element, options) {\n      this.setElement(fabric.util.getById(element), options);\n      fabric.util.addClass(this.getElement(), fabric.Image.CSS_CANVAS);\n    },\n\n    /**\n     * @private\n     * @param {Object} [options] Options object\n     */\n    _initConfig: function(options) {\n      options || (options = { });\n      this.setOptions(options);\n      this._setWidthHeight(options);\n    },\n\n    /**\n     * @private\n     * @param {Array} filters to be initialized\n     * @param {Function} callback Callback to invoke when all fabric.Image.filters instances are created\n     */\n    _initFilters: function(filters, callback) {\n      if (filters && filters.length) {\n        fabric.util.enlivenObjects(filters, function(enlivenedObjects) {\n          callback && callback(enlivenedObjects);\n        }, 'fabric.Image.filters');\n      }\n      else {\n        callback && callback();\n      }\n    },\n\n    /**\n     * @private\n     * Set the width and the height of the image object, using the element or the\n     * options.\n     * @param {Object} [options] Object with width/height properties\n     */\n    _setWidthHeight: function(options) {\n      options || (options = { });\n      var el = this.getElement();\n      this.width = options.width || el.naturalWidth || el.width || 0;\n      this.height = options.height || el.naturalHeight || el.height || 0;\n    },\n\n    /**\n     * Calculate offset for center and scale factor for the image in order to respect\n     * the preserveAspectRatio attribute\n     * @private\n     * @return {Object}\n     */\n    parsePreserveAspectRatioAttribute: function() {\n      var pAR = fabric.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio || ''),\n          rWidth = this._element.width, rHeight = this._element.height,\n          scaleX = 1, scaleY = 1, offsetLeft = 0, offsetTop = 0, cropX = 0, cropY = 0,\n          offset, pWidth = this.width, pHeight = this.height, parsedAttributes = { width: pWidth, height: pHeight };\n      if (pAR && (pAR.alignX !== 'none' || pAR.alignY !== 'none')) {\n        if (pAR.meetOrSlice === 'meet') {\n          scaleX = scaleY = fabric.util.findScaleToFit(this._element, parsedAttributes);\n          offset = (pWidth - rWidth * scaleX) / 2;\n          if (pAR.alignX === 'Min') {\n            offsetLeft = -offset;\n          }\n          if (pAR.alignX === 'Max') {\n            offsetLeft = offset;\n          }\n          offset = (pHeight - rHeight * scaleY) / 2;\n          if (pAR.alignY === 'Min') {\n            offsetTop = -offset;\n          }\n          if (pAR.alignY === 'Max') {\n            offsetTop = offset;\n          }\n        }\n        if (pAR.meetOrSlice === 'slice') {\n          scaleX = scaleY = fabric.util.findScaleToCover(this._element, parsedAttributes);\n          offset = rWidth - pWidth / scaleX;\n          if (pAR.alignX === 'Mid') {\n            cropX = offset / 2;\n          }\n          if (pAR.alignX === 'Max') {\n            cropX = offset;\n          }\n          offset = rHeight - pHeight / scaleY;\n          if (pAR.alignY === 'Mid') {\n            cropY = offset / 2;\n          }\n          if (pAR.alignY === 'Max') {\n            cropY = offset;\n          }\n          rWidth = pWidth / scaleX;\n          rHeight = pHeight / scaleY;\n        }\n      }\n      else {\n        scaleX = pWidth / rWidth;\n        scaleY = pHeight / rHeight;\n      }\n      return {\n        width: rWidth,\n        height: rHeight,\n        scaleX: scaleX,\n        scaleY: scaleY,\n        offsetLeft: offsetLeft,\n        offsetTop: offsetTop,\n        cropX: cropX,\n        cropY: cropY\n      };\n    }\n  });\n\n  /**\n   * Default CSS class name for canvas\n   * @static\n   * @type String\n   * @default\n   */\n  fabric.Image.CSS_CANVAS = 'canvas-img';\n\n  /**\n   * Alias for getSrc\n   * @static\n   */\n  fabric.Image.prototype.getSvgSrc = fabric.Image.prototype.getSrc;\n\n  /**\n   * Creates an instance of fabric.Image from its object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} callback Callback to invoke when an image instance is created\n   */\n  fabric.Image.fromObject = function(_object, callback) {\n    var object = fabric.util.object.clone(_object);\n    fabric.util.loadImage(object.src, function(img, isError) {\n      if (isError) {\n        callback && callback(null, true);\n        return;\n      }\n      fabric.Image.prototype._initFilters.call(object, object.filters, function(filters) {\n        object.filters = filters || [];\n        fabric.Image.prototype._initFilters.call(object, [object.resizeFilter], function(resizeFilters) {\n          object.resizeFilter = resizeFilters[0];\n          fabric.util.enlivenObjectEnlivables(object, object, function () {\n            var image = new fabric.Image(img, object);\n            callback(image, false);\n          });\n        });\n      });\n    }, null, object.crossOrigin);\n  };\n\n  /**\n   * Creates an instance of fabric.Image from an URL string\n   * @static\n   * @param {String} url URL to create an image from\n   * @param {Function} [callback] Callback to invoke when image is created (newly created image is passed as a first argument). Second argument is a boolean indicating if an error occurred or not.\n   * @param {Object} [imgOptions] Options object\n   */\n  fabric.Image.fromURL = function(url, callback, imgOptions) {\n    fabric.util.loadImage(url, function(img, isError) {\n      callback && callback(new fabric.Image(img, imgOptions), isError);\n    }, null, imgOptions && imgOptions.crossOrigin);\n  };\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Image.fromElement})\n   * @static\n   * @see {@link http://www.w3.org/TR/SVG/struct.html#ImageElement}\n   */\n  fabric.Image.ATTRIBUTE_NAMES =\n    fabric.SHARED_ATTRIBUTES.concat(\n      'x y width height preserveAspectRatio xlink:href crossOrigin image-rendering'.split(' ')\n    );\n\n  /**\n   * Returns {@link fabric.Image} instance from an SVG element\n   * @static\n   * @param {SVGElement} element Element to parse\n   * @param {Object} [options] Options object\n   * @param {Function} callback Callback to execute when fabric.Image object is created\n   * @return {fabric.Image} Instance of fabric.Image\n   */\n  fabric.Image.fromElement = function(element, callback, options) {\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Image.ATTRIBUTE_NAMES);\n    fabric.Image.fromURL(parsedAttributes['xlink:href'], callback,\n      extend((options ? fabric.util.object.clone(options) : { }), parsedAttributes));\n  };\n  /* _FROM_SVG_END_ */\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\nfabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\n\n  /**\n   * @private\n   * @return {Number} angle value\n   */\n  _getAngleValueForStraighten: function() {\n    var angle = this.angle % 360;\n    if (angle > 0) {\n      return Math.round((angle - 1) / 90) * 90;\n    }\n    return Math.round(angle / 90) * 90;\n  },\n\n  /**\n   * Straightens an object (rotating it from current angle to one of 0, 90, 180, 270, etc. depending on which is closer)\n   * @return {fabric.Object} thisArg\n   * @chainable\n   */\n  straighten: function() {\n    return this.rotate(this._getAngleValueForStraighten());\n  },\n\n  /**\n   * Same as {@link fabric.Object.prototype.straighten} but with animation\n   * @param {Object} callbacks Object with callback functions\n   * @param {Function} [callbacks.onComplete] Invoked on completion\n   * @param {Function} [callbacks.onChange] Invoked on every step of animation\n   * @return {fabric.Object} thisArg\n   */\n  fxStraighten: function(callbacks) {\n    callbacks = callbacks || { };\n\n    var empty = function() { },\n        onComplete = callbacks.onComplete || empty,\n        onChange = callbacks.onChange || empty,\n        _this = this;\n\n    return fabric.util.animate({\n      target: this,\n      startValue: this.get('angle'),\n      endValue: this._getAngleValueForStraighten(),\n      duration: this.FX_DURATION,\n      onChange: function(value) {\n        _this.rotate(value);\n        onChange();\n      },\n      onComplete: function() {\n        _this.setCoords();\n        onComplete();\n      },\n    });\n  }\n});\n\nfabric.util.object.extend(fabric.StaticCanvas.prototype, /** @lends fabric.StaticCanvas.prototype */ {\n\n  /**\n   * Straightens object, then rerenders canvas\n   * @param {fabric.Object} object Object to straighten\n   * @return {fabric.Canvas} thisArg\n   * @chainable\n   */\n  straightenObject: function (object) {\n    object.straighten();\n    this.requestRenderAll();\n    return this;\n  },\n\n  /**\n   * Same as {@link fabric.Canvas.prototype.straightenObject}, but animated\n   * @param {fabric.Object} object Object to straighten\n   * @return {fabric.Canvas} thisArg\n   */\n  fxStraightenObject: function (object) {\n    return object.fxStraighten({\n      onChange: this.requestRenderAllBound\n    });\n  }\n});\n\n\n(function() {\n\n  'use strict';\n\n  /**\n   * Tests if webgl supports certain precision\n   * @param {WebGL} Canvas WebGL context to test on\n   * @param {String} Precision to test can be any of following: 'lowp', 'mediump', 'highp'\n   * @returns {Boolean} Whether the user's browser WebGL supports given precision.\n   */\n  function testPrecision(gl, precision){\n    var fragmentSource = 'precision ' + precision + ' float;\\nvoid main(){}';\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, fragmentSource);\n    gl.compileShader(fragmentShader);\n    if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n      return false;\n    }\n    return true;\n  }\n\n  /**\n   * Indicate whether this filtering backend is supported by the user's browser.\n   * @param {Number} tileSize check if the tileSize is supported\n   * @returns {Boolean} Whether the user's browser supports WebGL.\n   */\n  fabric.isWebglSupported = function(tileSize) {\n    if (fabric.isLikelyNode) {\n      return false;\n    }\n    tileSize = tileSize || fabric.WebglFilterBackend.prototype.tileSize;\n    var canvas = document.createElement('canvas');\n    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    var isSupported = false;\n    // eslint-disable-next-line\n    if (gl) {\n      fabric.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\n      isSupported = fabric.maxTextureSize >= tileSize;\n      var precisions = ['highp', 'mediump', 'lowp'];\n      for (var i = 0; i < 3; i++){\n        if (testPrecision(gl, precisions[i])){\n          fabric.webGlPrecision = precisions[i];\n          break;\n        };\n      }\n    }\n    this.isSupported = isSupported;\n    return isSupported;\n  };\n\n  fabric.WebglFilterBackend = WebglFilterBackend;\n\n  /**\n   * WebGL filter backend.\n   */\n  function WebglFilterBackend(options) {\n    if (options && options.tileSize) {\n      this.tileSize = options.tileSize;\n    }\n    this.setupGLContext(this.tileSize, this.tileSize);\n    this.captureGPUInfo();\n  };\n\n  WebglFilterBackend.prototype = /** @lends fabric.WebglFilterBackend.prototype */ {\n\n    tileSize: 2048,\n\n    /**\n     * Experimental. This object is a sort of repository of help layers used to avoid\n     * of recreating them during frequent filtering. If you are previewing a filter with\n     * a slider you probably do not want to create help layers every filter step.\n     * in this object there will be appended some canvases, created once, resized sometimes\n     * cleared never. Clearing is left to the developer.\n     **/\n    resources: {\n\n    },\n\n    /**\n     * Setup a WebGL context suitable for filtering, and bind any needed event handlers.\n     */\n    setupGLContext: function(width, height) {\n      this.dispose();\n      this.createWebGLCanvas(width, height);\n      // eslint-disable-next-line\n      this.aPosition = new Float32Array([0, 0, 0, 1, 1, 0, 1, 1]);\n      this.chooseFastestCopyGLTo2DMethod(width, height);\n    },\n\n    /**\n     * Pick a method to copy data from GL context to 2d canvas.  In some browsers using\n     * putImageData is faster than drawImage for that specific operation.\n     */\n    chooseFastestCopyGLTo2DMethod: function(width, height) {\n      var canMeasurePerf = typeof window.performance !== 'undefined', canUseImageData;\n      try {\n        new ImageData(1, 1);\n        canUseImageData = true;\n      }\n      catch (e) {\n        canUseImageData = false;\n      }\n      // eslint-disable-next-line no-undef\n      var canUseArrayBuffer = typeof ArrayBuffer !== 'undefined';\n      // eslint-disable-next-line no-undef\n      var canUseUint8Clamped = typeof Uint8ClampedArray !== 'undefined';\n\n      if (!(canMeasurePerf && canUseImageData && canUseArrayBuffer && canUseUint8Clamped)) {\n        return;\n      }\n\n      var targetCanvas = fabric.util.createCanvasElement();\n      // eslint-disable-next-line no-undef\n      var imageBuffer = new ArrayBuffer(width * height * 4);\n      if (fabric.forceGLPutImageData) {\n        this.imageBuffer = imageBuffer;\n        this.copyGLTo2D = copyGLTo2DPutImageData;\n        return;\n      }\n      var testContext = {\n        imageBuffer: imageBuffer,\n        destinationWidth: width,\n        destinationHeight: height,\n        targetCanvas: targetCanvas\n      };\n      var startTime, drawImageTime, putImageDataTime;\n      targetCanvas.width = width;\n      targetCanvas.height = height;\n\n      startTime = window.performance.now();\n      copyGLTo2DDrawImage.call(testContext, this.gl, testContext);\n      drawImageTime = window.performance.now() - startTime;\n\n      startTime = window.performance.now();\n      copyGLTo2DPutImageData.call(testContext, this.gl, testContext);\n      putImageDataTime = window.performance.now() - startTime;\n\n      if (drawImageTime > putImageDataTime) {\n        this.imageBuffer = imageBuffer;\n        this.copyGLTo2D = copyGLTo2DPutImageData;\n      }\n      else {\n        this.copyGLTo2D = copyGLTo2DDrawImage;\n      }\n    },\n\n    /**\n     * Create a canvas element and associated WebGL context and attaches them as\n     * class properties to the GLFilterBackend class.\n     */\n    createWebGLCanvas: function(width, height) {\n      var canvas = fabric.util.createCanvasElement();\n      canvas.width = width;\n      canvas.height = height;\n      var glOptions = {\n            alpha: true,\n            premultipliedAlpha: false,\n            depth: false,\n            stencil: false,\n            antialias: false\n          },\n          gl = canvas.getContext('webgl', glOptions);\n      if (!gl) {\n        gl = canvas.getContext('experimental-webgl', glOptions);\n      }\n      if (!gl) {\n        return;\n      }\n      gl.clearColor(0, 0, 0, 0);\n      // this canvas can fire webglcontextlost and webglcontextrestored\n      this.canvas = canvas;\n      this.gl = gl;\n    },\n\n    /**\n     * Attempts to apply the requested filters to the source provided, drawing the filtered output\n     * to the provided target canvas.\n     *\n     * @param {Array} filters The filters to apply.\n     * @param {HTMLImageElement|HTMLCanvasElement} source The source to be filtered.\n     * @param {Number} width The width of the source input.\n     * @param {Number} height The height of the source input.\n     * @param {HTMLCanvasElement} targetCanvas The destination for filtered output to be drawn.\n     * @param {String|undefined} cacheKey A key used to cache resources related to the source. If\n     * omitted, caching will be skipped.\n     */\n    applyFilters: function(filters, source, width, height, targetCanvas, cacheKey) {\n      var gl = this.gl;\n      var cachedTexture;\n      if (cacheKey) {\n        cachedTexture = this.getCachedTexture(cacheKey, source);\n      }\n      var pipelineState = {\n        originalWidth: source.width || source.originalWidth,\n        originalHeight: source.height || source.originalHeight,\n        sourceWidth: width,\n        sourceHeight: height,\n        destinationWidth: width,\n        destinationHeight: height,\n        context: gl,\n        sourceTexture: this.createTexture(gl, width, height, !cachedTexture && source),\n        targetTexture: this.createTexture(gl, width, height),\n        originalTexture: cachedTexture ||\n          this.createTexture(gl, width, height, !cachedTexture && source),\n        passes: filters.length,\n        webgl: true,\n        aPosition: this.aPosition,\n        programCache: this.programCache,\n        pass: 0,\n        filterBackend: this,\n        targetCanvas: targetCanvas\n      };\n      var tempFbo = gl.createFramebuffer();\n      gl.bindFramebuffer(gl.FRAMEBUFFER, tempFbo);\n      filters.forEach(function(filter) { filter && filter.applyTo(pipelineState); });\n      resizeCanvasIfNeeded(pipelineState);\n      this.copyGLTo2D(gl, pipelineState);\n      gl.bindTexture(gl.TEXTURE_2D, null);\n      gl.deleteTexture(pipelineState.sourceTexture);\n      gl.deleteTexture(pipelineState.targetTexture);\n      gl.deleteFramebuffer(tempFbo);\n      targetCanvas.getContext('2d').setTransform(1, 0, 0, 1, 0, 0);\n      return pipelineState;\n    },\n\n    /**\n     * Detach event listeners, remove references, and clean up caches.\n     */\n    dispose: function() {\n      if (this.canvas) {\n        this.canvas = null;\n        this.gl = null;\n      }\n      this.clearWebGLCaches();\n    },\n\n    /**\n     * Wipe out WebGL-related caches.\n     */\n    clearWebGLCaches: function() {\n      this.programCache = {};\n      this.textureCache = {};\n    },\n\n    /**\n     * Create a WebGL texture object.\n     *\n     * Accepts specific dimensions to initialize the texture to or a source image.\n     *\n     * @param {WebGLRenderingContext} gl The GL context to use for creating the texture.\n     * @param {Number} width The width to initialize the texture at.\n     * @param {Number} height The height to initialize the texture.\n     * @param {HTMLImageElement|HTMLCanvasElement} textureImageSource A source for the texture data.\n     * @param {Number} filterType gl.NEAREST or gl.LINEAR usually, webgl numeri constants\n     * @returns {WebGLTexture}\n     */\n    createTexture: function(gl, width, height, textureImageSource, filterType) {\n      var texture = gl.createTexture();\n      gl.bindTexture(gl.TEXTURE_2D, texture);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, filterType || gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, filterType || gl.NEAREST);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n      gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n      if (textureImageSource) {\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureImageSource);\n      }\n      else {\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n      }\n      return texture;\n    },\n\n    /**\n     * Can be optionally used to get a texture from the cache array\n     *\n     * If an existing texture is not found, a new texture is created and cached.\n     *\n     * @param {String} uniqueId A cache key to use to find an existing texture.\n     * @param {HTMLImageElement|HTMLCanvasElement} textureImageSource A source to use to create the\n     * texture cache entry if one does not already exist.\n     */\n    getCachedTexture: function(uniqueId, textureImageSource) {\n      if (this.textureCache[uniqueId]) {\n        return this.textureCache[uniqueId];\n      }\n      else {\n        var texture = this.createTexture(\n          this.gl, textureImageSource.width, textureImageSource.height, textureImageSource);\n        this.textureCache[uniqueId] = texture;\n        return texture;\n      }\n    },\n\n    /**\n     * Clear out cached resources related to a source image that has been\n     * filtered previously.\n     *\n     * @param {String} cacheKey The cache key provided when the source image was filtered.\n     */\n    evictCachesForKey: function(cacheKey) {\n      if (this.textureCache[cacheKey]) {\n        this.gl.deleteTexture(this.textureCache[cacheKey]);\n        delete this.textureCache[cacheKey];\n      }\n    },\n\n    copyGLTo2D: copyGLTo2DDrawImage,\n\n    /**\n     * Attempt to extract GPU information strings from a WebGL context.\n     *\n     * Useful information when debugging or blacklisting specific GPUs.\n     *\n     * @returns {Object} A GPU info object with renderer and vendor strings.\n     */\n    captureGPUInfo: function() {\n      if (this.gpuInfo) {\n        return this.gpuInfo;\n      }\n      var gl = this.gl, gpuInfo = { renderer: '', vendor: '' };\n      if (!gl) {\n        return gpuInfo;\n      }\n      var ext = gl.getExtension('WEBGL_debug_renderer_info');\n      if (ext) {\n        var renderer = gl.getParameter(ext.UNMASKED_RENDERER_WEBGL);\n        var vendor = gl.getParameter(ext.UNMASKED_VENDOR_WEBGL);\n        if (renderer) {\n          gpuInfo.renderer = renderer.toLowerCase();\n        }\n        if (vendor) {\n          gpuInfo.vendor = vendor.toLowerCase();\n        }\n      }\n      this.gpuInfo = gpuInfo;\n      return gpuInfo;\n    },\n  };\n})();\n\nfunction resizeCanvasIfNeeded(pipelineState) {\n  var targetCanvas = pipelineState.targetCanvas,\n      width = targetCanvas.width, height = targetCanvas.height,\n      dWidth = pipelineState.destinationWidth,\n      dHeight = pipelineState.destinationHeight;\n\n  if (width !== dWidth || height !== dHeight) {\n    targetCanvas.width = dWidth;\n    targetCanvas.height = dHeight;\n  }\n}\n\n/**\n * Copy an input WebGL canvas on to an output 2D canvas.\n *\n * The WebGL canvas is assumed to be upside down, with the top-left pixel of the\n * desired output image appearing in the bottom-left corner of the WebGL canvas.\n *\n * @param {WebGLRenderingContext} sourceContext The WebGL context to copy from.\n * @param {HTMLCanvasElement} targetCanvas The 2D target canvas to copy on to.\n * @param {Object} pipelineState The 2D target canvas to copy on to.\n */\nfunction copyGLTo2DDrawImage(gl, pipelineState) {\n  var glCanvas = gl.canvas, targetCanvas = pipelineState.targetCanvas,\n      ctx = targetCanvas.getContext('2d');\n  ctx.translate(0, targetCanvas.height); // move it down again\n  ctx.scale(1, -1); // vertical flip\n  // where is my image on the big glcanvas?\n  var sourceY = glCanvas.height - targetCanvas.height;\n  ctx.drawImage(glCanvas, 0, sourceY, targetCanvas.width, targetCanvas.height, 0, 0,\n    targetCanvas.width, targetCanvas.height);\n}\n\n/**\n * Copy an input WebGL canvas on to an output 2D canvas using 2d canvas' putImageData\n * API. Measurably faster than using ctx.drawImage in Firefox (version 54 on OSX Sierra).\n *\n * @param {WebGLRenderingContext} sourceContext The WebGL context to copy from.\n * @param {HTMLCanvasElement} targetCanvas The 2D target canvas to copy on to.\n * @param {Object} pipelineState The 2D target canvas to copy on to.\n */\nfunction copyGLTo2DPutImageData(gl, pipelineState) {\n  var targetCanvas = pipelineState.targetCanvas, ctx = targetCanvas.getContext('2d'),\n      dWidth = pipelineState.destinationWidth,\n      dHeight = pipelineState.destinationHeight,\n      numBytes = dWidth * dHeight * 4;\n\n  // eslint-disable-next-line no-undef\n  var u8 = new Uint8Array(this.imageBuffer, 0, numBytes);\n  // eslint-disable-next-line no-undef\n  var u8Clamped = new Uint8ClampedArray(this.imageBuffer, 0, numBytes);\n\n  gl.readPixels(0, 0, dWidth, dHeight, gl.RGBA, gl.UNSIGNED_BYTE, u8);\n  var imgData = new ImageData(u8Clamped, dWidth, dHeight);\n  ctx.putImageData(imgData, 0, 0);\n}\n\n\n(function() {\n\n  'use strict';\n\n  var noop = function() {};\n\n  fabric.Canvas2dFilterBackend = Canvas2dFilterBackend;\n\n  /**\n   * Canvas 2D filter backend.\n   */\n  function Canvas2dFilterBackend() {};\n\n  Canvas2dFilterBackend.prototype = /** @lends fabric.Canvas2dFilterBackend.prototype */ {\n    evictCachesForKey: noop,\n    dispose: noop,\n    clearWebGLCaches: noop,\n\n    /**\n     * Experimental. This object is a sort of repository of help layers used to avoid\n     * of recreating them during frequent filtering. If you are previewing a filter with\n     * a slider you probably do not want to create help layers every filter step.\n     * in this object there will be appended some canvases, created once, resized sometimes\n     * cleared never. Clearing is left to the developer.\n     **/\n    resources: {\n\n    },\n\n    /**\n     * Apply a set of filters against a source image and draw the filtered output\n     * to the provided destination canvas.\n     *\n     * @param {EnhancedFilter} filters The filter to apply.\n     * @param {HTMLImageElement|HTMLCanvasElement} sourceElement The source to be filtered.\n     * @param {Number} sourceWidth The width of the source input.\n     * @param {Number} sourceHeight The height of the source input.\n     * @param {HTMLCanvasElement} targetCanvas The destination for filtered output to be drawn.\n     */\n    applyFilters: function(filters, sourceElement, sourceWidth, sourceHeight, targetCanvas) {\n      var ctx = targetCanvas.getContext('2d');\n      ctx.drawImage(sourceElement, 0, 0, sourceWidth, sourceHeight);\n      var imageData = ctx.getImageData(0, 0, sourceWidth, sourceHeight);\n      var originalImageData = ctx.getImageData(0, 0, sourceWidth, sourceHeight);\n      var pipelineState = {\n        sourceWidth: sourceWidth,\n        sourceHeight: sourceHeight,\n        imageData: imageData,\n        originalEl: sourceElement,\n        originalImageData: originalImageData,\n        canvasEl: targetCanvas,\n        ctx: ctx,\n        filterBackend: this,\n      };\n      filters.forEach(function(filter) { filter.applyTo(pipelineState); });\n      if (pipelineState.imageData.width !== sourceWidth || pipelineState.imageData.height !== sourceHeight) {\n        targetCanvas.width = pipelineState.imageData.width;\n        targetCanvas.height = pipelineState.imageData.height;\n      }\n      ctx.putImageData(pipelineState.imageData, 0, 0);\n      return pipelineState;\n    },\n\n  };\n})();\n\n\n/**\n * @namespace fabric.Image.filters\n * @memberOf fabric.Image\n * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#image_filters}\n * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n */\nfabric.Image = fabric.Image || { };\nfabric.Image.filters = fabric.Image.filters || { };\n\n/**\n * Root filter class from which all filter classes inherit from\n * @class fabric.Image.filters.BaseFilter\n * @memberOf fabric.Image.filters\n */\nfabric.Image.filters.BaseFilter = fabric.util.createClass(/** @lends fabric.Image.filters.BaseFilter.prototype */ {\n\n  /**\n   * Filter type\n   * @param {String} type\n   * @default\n   */\n  type: 'BaseFilter',\n\n  /**\n   * Array of attributes to send with buffers. do not modify\n   * @private\n   */\n\n  vertexSource: 'attribute vec2 aPosition;\\n' +\n    'varying vec2 vTexCoord;\\n' +\n    'void main() {\\n' +\n      'vTexCoord = aPosition;\\n' +\n      'gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\\n' +\n    '}',\n\n  fragmentSource: 'precision highp float;\\n' +\n    'varying vec2 vTexCoord;\\n' +\n    'uniform sampler2D uTexture;\\n' +\n    'void main() {\\n' +\n      'gl_FragColor = texture2D(uTexture, vTexCoord);\\n' +\n    '}',\n\n  /**\n   * Constructor\n   * @param {Object} [options] Options object\n   */\n  initialize: function(options) {\n    if (options) {\n      this.setOptions(options);\n    }\n  },\n\n  /**\n   * Sets filter's properties from options\n   * @param {Object} [options] Options object\n   */\n  setOptions: function(options) {\n    for (var prop in options) {\n      this[prop] = options[prop];\n    }\n  },\n\n  /**\n   * Compile this filter's shader program.\n   *\n   * @param {WebGLRenderingContext} gl The GL canvas context to use for shader compilation.\n   * @param {String} fragmentSource fragmentShader source for compilation\n   * @param {String} vertexSource vertexShader source for compilation\n   */\n  createProgram: function(gl, fragmentSource, vertexSource) {\n    fragmentSource = fragmentSource || this.fragmentSource;\n    vertexSource = vertexSource || this.vertexSource;\n    if (fabric.webGlPrecision !== 'highp'){\n      fragmentSource = fragmentSource.replace(\n        /precision highp float/g,\n        'precision ' + fabric.webGlPrecision + ' float'\n      );\n    }\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n    gl.shaderSource(vertexShader, vertexSource);\n    gl.compileShader(vertexShader);\n    if (!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) {\n      throw new Error(\n        // eslint-disable-next-line prefer-template\n        'Vertex shader compile error for ' + this.type + ': ' +\n        gl.getShaderInfoLog(vertexShader)\n      );\n    }\n\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, fragmentSource);\n    gl.compileShader(fragmentShader);\n    if (!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n      throw new Error(\n        // eslint-disable-next-line prefer-template\n        'Fragment shader compile error for ' + this.type + ': ' +\n        gl.getShaderInfoLog(fragmentShader)\n      );\n    }\n\n    var program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n      throw new Error(\n        // eslint-disable-next-line prefer-template\n        'Shader link error for \"${this.type}\" ' +\n        gl.getProgramInfoLog(program)\n      );\n    }\n\n    var attributeLocations = this.getAttributeLocations(gl, program);\n    var uniformLocations = this.getUniformLocations(gl, program) || { };\n    uniformLocations.uStepW = gl.getUniformLocation(program, 'uStepW');\n    uniformLocations.uStepH = gl.getUniformLocation(program, 'uStepH');\n    return {\n      program: program,\n      attributeLocations: attributeLocations,\n      uniformLocations: uniformLocations\n    };\n  },\n\n  /**\n   * Return a map of attribute names to WebGLAttributeLocation objects.\n   *\n   * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n   * @param {WebGLShaderProgram} program The shader program from which to take attribute locations.\n   * @returns {Object} A map of attribute names to attribute locations.\n   */\n  getAttributeLocations: function(gl, program) {\n    return {\n      aPosition: gl.getAttribLocation(program, 'aPosition'),\n    };\n  },\n\n  /**\n   * Return a map of uniform names to WebGLUniformLocation objects.\n   *\n   * Intended to be overridden by subclasses.\n   *\n   * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n   * @param {WebGLShaderProgram} program The shader program from which to take uniform locations.\n   * @returns {Object} A map of uniform names to uniform locations.\n   */\n  getUniformLocations: function (/* gl, program */) {\n    // in case i do not need any special uniform i need to return an empty object\n    return { };\n  },\n\n  /**\n   * Send attribute data from this filter to its shader program on the GPU.\n   *\n   * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n   * @param {Object} attributeLocations A map of shader attribute names to their locations.\n   */\n  sendAttributeData: function(gl, attributeLocations, aPositionData) {\n    var attributeLocation = attributeLocations.aPosition;\n    var buffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\n    gl.enableVertexAttribArray(attributeLocation);\n    gl.vertexAttribPointer(attributeLocation, 2, gl.FLOAT, false, 0, 0);\n    gl.bufferData(gl.ARRAY_BUFFER, aPositionData, gl.STATIC_DRAW);\n  },\n\n  _setupFrameBuffer: function(options) {\n    var gl = options.context, width, height;\n    if (options.passes > 1) {\n      width = options.destinationWidth;\n      height = options.destinationHeight;\n      if (options.sourceWidth !== width || options.sourceHeight !== height) {\n        gl.deleteTexture(options.targetTexture);\n        options.targetTexture = options.filterBackend.createTexture(gl, width, height);\n      }\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D,\n        options.targetTexture, 0);\n    }\n    else {\n      // draw last filter on canvas and not to framebuffer.\n      gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n      gl.finish();\n    }\n  },\n\n  _swapTextures: function(options) {\n    options.passes--;\n    options.pass++;\n    var temp = options.targetTexture;\n    options.targetTexture = options.sourceTexture;\n    options.sourceTexture = temp;\n  },\n\n  /**\n   * Generic isNeutral implementation for one parameter based filters.\n   * Used only in image applyFilters to discard filters that will not have an effect\n   * on the image\n   * Other filters may need their own version ( ColorMatrix, HueRotation, gamma, ComposedFilter )\n   * @param {Object} options\n   **/\n  isNeutralState: function(/* options */) {\n    var main = this.mainParameter,\n        _class = fabric.Image.filters[this.type].prototype;\n    if (main) {\n      if (Array.isArray(_class[main])) {\n        for (var i = _class[main].length; i--;) {\n          if (this[main][i] !== _class[main][i]) {\n            return false;\n          }\n        }\n        return true;\n      }\n      else {\n        return _class[main] === this[main];\n      }\n    }\n    else {\n      return false;\n    }\n  },\n\n  /**\n   * Apply this filter to the input image data provided.\n   *\n   * Determines whether to use WebGL or Canvas2D based on the options.webgl flag.\n   *\n   * @param {Object} options\n   * @param {Number} options.passes The number of filters remaining to be executed\n   * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n   * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n   * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n   * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n   * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n   */\n  applyTo: function(options) {\n    if (options.webgl) {\n      this._setupFrameBuffer(options);\n      this.applyToWebGL(options);\n      this._swapTextures(options);\n    }\n    else {\n      this.applyTo2d(options);\n    }\n  },\n\n  /**\n   * Retrieves the cached shader.\n   * @param {Object} options\n   * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n   * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n   */\n  retrieveShader: function(options) {\n    if (!options.programCache.hasOwnProperty(this.type)) {\n      options.programCache[this.type] = this.createProgram(options.context);\n    }\n    return options.programCache[this.type];\n  },\n\n  /**\n   * Apply this filter using webgl.\n   *\n   * @param {Object} options\n   * @param {Number} options.passes The number of filters remaining to be executed\n   * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n   * @param {WebGLTexture} options.originalTexture The texture of the original input image.\n   * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n   * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n   * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n   * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n   */\n  applyToWebGL: function(options) {\n    var gl = options.context;\n    var shader = this.retrieveShader(options);\n    if (options.pass === 0 && options.originalTexture) {\n      gl.bindTexture(gl.TEXTURE_2D, options.originalTexture);\n    }\n    else {\n      gl.bindTexture(gl.TEXTURE_2D, options.sourceTexture);\n    }\n    gl.useProgram(shader.program);\n    this.sendAttributeData(gl, shader.attributeLocations, options.aPosition);\n\n    gl.uniform1f(shader.uniformLocations.uStepW, 1 / options.sourceWidth);\n    gl.uniform1f(shader.uniformLocations.uStepH, 1 / options.sourceHeight);\n\n    this.sendUniformData(gl, shader.uniformLocations);\n    gl.viewport(0, 0, options.destinationWidth, options.destinationHeight);\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n  },\n\n  bindAdditionalTexture: function(gl, texture, textureUnit) {\n    gl.activeTexture(textureUnit);\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    // reset active texture to 0 as usual\n    gl.activeTexture(gl.TEXTURE0);\n  },\n\n  unbindAdditionalTexture: function(gl, textureUnit) {\n    gl.activeTexture(textureUnit);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.activeTexture(gl.TEXTURE0);\n  },\n\n  getMainParameter: function() {\n    return this[this.mainParameter];\n  },\n\n  setMainParameter: function(value) {\n    this[this.mainParameter] = value;\n  },\n\n  /**\n   * Send uniform data from this filter to its shader program on the GPU.\n   *\n   * Intended to be overridden by subclasses.\n   *\n   * @param {WebGLRenderingContext} gl The canvas context used to compile the shader program.\n   * @param {Object} uniformLocations A map of shader uniform names to their locations.\n   */\n  sendUniformData: function(/* gl, uniformLocations */) {\n    // Intentionally left blank.  Override me in subclasses.\n  },\n\n  /**\n   * If needed by a 2d filter, this functions can create an helper canvas to be used\n   * remember that options.targetCanvas is available for use till end of chain.\n   */\n  createHelpLayer: function(options) {\n    if (!options.helpLayer) {\n      var helpLayer = document.createElement('canvas');\n      helpLayer.width = options.sourceWidth;\n      helpLayer.height = options.sourceHeight;\n      options.helpLayer = helpLayer;\n    }\n  },\n\n  /**\n   * Returns object representation of an instance\n   * @return {Object} Object representation of an instance\n   */\n  toObject: function() {\n    var object = { type: this.type }, mainP = this.mainParameter;\n    if (mainP) {\n      object[mainP] = this[mainP];\n    }\n    return object;\n  },\n\n  /**\n   * Returns a JSON representation of an instance\n   * @return {Object} JSON\n   */\n  toJSON: function() {\n    // delegate, not alias\n    return this.toObject();\n  }\n});\n\nfabric.Image.filters.BaseFilter.fromObject = function(object, callback) {\n  var filter = new fabric.Image.filters[object.type](object);\n  callback && callback(filter);\n  return filter;\n};\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Color Matrix filter class\n   * @class fabric.Image.filters.ColorMatrix\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.ColorMatrix#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @see {@Link http://www.webwasp.co.uk/tutorials/219/Color_Matrix_Filter.php}\n   * @see {@Link http://phoboslab.org/log/2013/11/fast-image-filters-with-webgl}\n   * @example <caption>Kodachrome filter</caption>\n   * var filter = new fabric.Image.filters.ColorMatrix({\n   *  matrix: [\n       1.1285582396593525, -0.3967382283601348, -0.03992559172921793, 0, 63.72958762196502,\n       -0.16404339962244616, 1.0835251566291304, -0.05498805115633132, 0, 24.732407896706203,\n       -0.16786010706155763, -0.5603416277695248, 1.6014850761964943, 0, 35.62982807460946,\n       0, 0, 0, 1, 0\n      ]\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.ColorMatrix = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.ColorMatrix.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'ColorMatrix',\n\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'uniform mat4 uColorMatrix;\\n' +\n      'uniform vec4 uConstants;\\n' +\n      'void main() {\\n' +\n        'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n        'color *= uColorMatrix;\\n' +\n        'color += uConstants;\\n' +\n        'gl_FragColor = color;\\n' +\n      '}',\n\n    /**\n     * Colormatrix for pixels.\n     * array of 20 floats. Numbers in positions 4, 9, 14, 19 loose meaning\n     * outside the -1, 1 range.\n     * 0.0039215686 is the part of 1 that get translated to 1 in 2d\n     * @param {Array} matrix array of 20 numbers.\n     * @default\n     */\n    matrix: [\n      1, 0, 0, 0, 0,\n      0, 1, 0, 0, 0,\n      0, 0, 1, 0, 0,\n      0, 0, 0, 1, 0\n    ],\n\n    mainParameter: 'matrix',\n\n    /**\n     * Lock the colormatrix on the color part, skipping alpha, mainly for non webgl scenario\n     * to save some calculation\n     * @type Boolean\n     * @default true\n     */\n    colorsOnly: true,\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     */\n    initialize: function(options) {\n      this.callSuper('initialize', options);\n      // create a new array instead mutating the prototype with push\n      this.matrix = this.matrix.slice(0);\n    },\n\n    /**\n     * Apply the ColorMatrix operation to a Uint8Array representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8Array to be filtered.\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          data = imageData.data,\n          iLen = data.length,\n          m = this.matrix,\n          r, g, b, a, i, colorsOnly = this.colorsOnly;\n\n      for (i = 0; i < iLen; i += 4) {\n        r = data[i];\n        g = data[i + 1];\n        b = data[i + 2];\n        if (colorsOnly) {\n          data[i] = r * m[0] + g * m[1] + b * m[2] + m[4] * 255;\n          data[i + 1] = r * m[5] + g * m[6] + b * m[7] + m[9] * 255;\n          data[i + 2] = r * m[10] + g * m[11] + b * m[12] + m[14] * 255;\n        }\n        else {\n          a = data[i + 3];\n          data[i] = r * m[0] + g * m[1] + b * m[2] + a * m[3] + m[4] * 255;\n          data[i + 1] = r * m[5] + g * m[6] + b * m[7] + a * m[8] + m[9] * 255;\n          data[i + 2] = r * m[10] + g * m[11] + b * m[12] + a * m[13] + m[14] * 255;\n          data[i + 3] = r * m[15] + g * m[16] + b * m[17] + a * m[18] + m[19] * 255;\n        }\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uColorMatrix: gl.getUniformLocation(program, 'uColorMatrix'),\n        uConstants: gl.getUniformLocation(program, 'uConstants'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      var m = this.matrix,\n          matrix = [\n            m[0], m[1], m[2], m[3],\n            m[5], m[6], m[7], m[8],\n            m[10], m[11], m[12], m[13],\n            m[15], m[16], m[17], m[18]\n          ],\n          constants = [m[4], m[9], m[14], m[19]];\n      gl.uniformMatrix4fv(uniformLocations.uColorMatrix, false, matrix);\n      gl.uniform4fv(uniformLocations.uConstants, constants);\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] function to invoke after filter creation\n   * @return {fabric.Image.filters.ColorMatrix} Instance of fabric.Image.filters.ColorMatrix\n   */\n  fabric.Image.filters.ColorMatrix.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Brightness filter class\n   * @class fabric.Image.filters.Brightness\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Brightness#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Brightness({\n   *   brightness: 0.05\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.Brightness = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Brightness.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Brightness',\n\n    /**\n     * Fragment source for the brightness program\n     */\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform float uBrightness;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n        'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n        'color.rgb += uBrightness;\\n' +\n        'gl_FragColor = color;\\n' +\n      '}',\n\n    /**\n     * Brightness value, from -1 to 1.\n     * translated to -255 to 255 for 2d\n     * 0.0039215686 is the part of 1 that get translated to 1 in 2d\n     * @param {Number} brightness\n     * @default\n     */\n    brightness: 0,\n\n    /**\n     * Describe the property that is the filter parameter\n     * @param {String} m\n     * @default\n     */\n    mainParameter: 'brightness',\n\n    /**\n    * Apply the Brightness operation to a Uint8ClampedArray representing the pixels of an image.\n    *\n    * @param {Object} options\n    * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n    */\n    applyTo2d: function(options) {\n      if (this.brightness === 0) {\n        return;\n      }\n      var imageData = options.imageData,\n          data = imageData.data, i, len = data.length,\n          brightness = Math.round(this.brightness * 255);\n      for (i = 0; i < len; i += 4) {\n        data[i] = data[i] + brightness;\n        data[i + 1] = data[i + 1] + brightness;\n        data[i + 2] = data[i + 2] + brightness;\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uBrightness: gl.getUniformLocation(program, 'uBrightness'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform1f(uniformLocations.uBrightness, this.brightness);\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Brightness} Instance of fabric.Image.filters.Brightness\n   */\n  fabric.Image.filters.Brightness.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      extend = fabric.util.object.extend,\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Adapted from <a href=\"http://www.html5rocks.com/en/tutorials/canvas/imagefilters/\">html5rocks article</a>\n   * @class fabric.Image.filters.Convolute\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Convolute#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example <caption>Sharpen filter</caption>\n   * var filter = new fabric.Image.filters.Convolute({\n   *   matrix: [ 0, -1,  0,\n   *            -1,  5, -1,\n   *             0, -1,  0 ]\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   * @example <caption>Blur filter</caption>\n   * var filter = new fabric.Image.filters.Convolute({\n   *   matrix: [ 1/9, 1/9, 1/9,\n   *             1/9, 1/9, 1/9,\n   *             1/9, 1/9, 1/9 ]\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   * @example <caption>Emboss filter</caption>\n   * var filter = new fabric.Image.filters.Convolute({\n   *   matrix: [ 1,   1,  1,\n   *             1, 0.7, -1,\n   *            -1,  -1, -1 ]\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   * @example <caption>Emboss filter with opaqueness</caption>\n   * var filter = new fabric.Image.filters.Convolute({\n   *   opaque: true,\n   *   matrix: [ 1,   1,  1,\n   *             1, 0.7, -1,\n   *            -1,  -1, -1 ]\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n  filters.Convolute = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Convolute.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Convolute',\n\n    /*\n     * Opaque value (true/false)\n     */\n    opaque: false,\n\n    /*\n     * matrix for the filter, max 9x9\n     */\n    matrix: [0, 0, 0, 0, 1, 0, 0, 0, 0],\n\n    /**\n     * Fragment source for the brightness program\n     */\n    fragmentSource: {\n      Convolute_3_1: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform float uMatrix[9];\\n' +\n        'uniform float uStepW;\\n' +\n        'uniform float uStepH;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = vec4(0, 0, 0, 0);\\n' +\n          'for (float h = 0.0; h < 3.0; h+=1.0) {\\n' +\n            'for (float w = 0.0; w < 3.0; w+=1.0) {\\n' +\n              'vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\\n' +\n              'color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\\n' +\n            '}\\n' +\n          '}\\n' +\n          'gl_FragColor = color;\\n' +\n        '}',\n      Convolute_3_0: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform float uMatrix[9];\\n' +\n        'uniform float uStepW;\\n' +\n        'uniform float uStepH;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = vec4(0, 0, 0, 1);\\n' +\n          'for (float h = 0.0; h < 3.0; h+=1.0) {\\n' +\n            'for (float w = 0.0; w < 3.0; w+=1.0) {\\n' +\n              'vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\\n' +\n              'color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\\n' +\n            '}\\n' +\n          '}\\n' +\n          'float alpha = texture2D(uTexture, vTexCoord).a;\\n' +\n          'gl_FragColor = color;\\n' +\n          'gl_FragColor.a = alpha;\\n' +\n        '}',\n      Convolute_5_1: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform float uMatrix[25];\\n' +\n        'uniform float uStepW;\\n' +\n        'uniform float uStepH;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = vec4(0, 0, 0, 0);\\n' +\n          'for (float h = 0.0; h < 5.0; h+=1.0) {\\n' +\n            'for (float w = 0.0; w < 5.0; w+=1.0) {\\n' +\n              'vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\\n' +\n              'color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\\n' +\n            '}\\n' +\n          '}\\n' +\n          'gl_FragColor = color;\\n' +\n        '}',\n      Convolute_5_0: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform float uMatrix[25];\\n' +\n        'uniform float uStepW;\\n' +\n        'uniform float uStepH;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = vec4(0, 0, 0, 1);\\n' +\n          'for (float h = 0.0; h < 5.0; h+=1.0) {\\n' +\n            'for (float w = 0.0; w < 5.0; w+=1.0) {\\n' +\n              'vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\\n' +\n              'color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\\n' +\n            '}\\n' +\n          '}\\n' +\n          'float alpha = texture2D(uTexture, vTexCoord).a;\\n' +\n          'gl_FragColor = color;\\n' +\n          'gl_FragColor.a = alpha;\\n' +\n        '}',\n      Convolute_7_1: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform float uMatrix[49];\\n' +\n        'uniform float uStepW;\\n' +\n        'uniform float uStepH;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = vec4(0, 0, 0, 0);\\n' +\n          'for (float h = 0.0; h < 7.0; h+=1.0) {\\n' +\n            'for (float w = 0.0; w < 7.0; w+=1.0) {\\n' +\n              'vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\\n' +\n              'color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\\n' +\n            '}\\n' +\n          '}\\n' +\n          'gl_FragColor = color;\\n' +\n        '}',\n      Convolute_7_0: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform float uMatrix[49];\\n' +\n        'uniform float uStepW;\\n' +\n        'uniform float uStepH;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = vec4(0, 0, 0, 1);\\n' +\n          'for (float h = 0.0; h < 7.0; h+=1.0) {\\n' +\n            'for (float w = 0.0; w < 7.0; w+=1.0) {\\n' +\n              'vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\\n' +\n              'color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\\n' +\n            '}\\n' +\n          '}\\n' +\n          'float alpha = texture2D(uTexture, vTexCoord).a;\\n' +\n          'gl_FragColor = color;\\n' +\n          'gl_FragColor.a = alpha;\\n' +\n        '}',\n      Convolute_9_1: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform float uMatrix[81];\\n' +\n        'uniform float uStepW;\\n' +\n        'uniform float uStepH;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = vec4(0, 0, 0, 0);\\n' +\n          'for (float h = 0.0; h < 9.0; h+=1.0) {\\n' +\n            'for (float w = 0.0; w < 9.0; w+=1.0) {\\n' +\n              'vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\\n' +\n              'color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\\n' +\n            '}\\n' +\n          '}\\n' +\n          'gl_FragColor = color;\\n' +\n        '}',\n      Convolute_9_0: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform float uMatrix[81];\\n' +\n        'uniform float uStepW;\\n' +\n        'uniform float uStepH;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = vec4(0, 0, 0, 1);\\n' +\n          'for (float h = 0.0; h < 9.0; h+=1.0) {\\n' +\n            'for (float w = 0.0; w < 9.0; w+=1.0) {\\n' +\n              'vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\\n' +\n              'color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\\n' +\n            '}\\n' +\n          '}\\n' +\n          'float alpha = texture2D(uTexture, vTexCoord).a;\\n' +\n          'gl_FragColor = color;\\n' +\n          'gl_FragColor.a = alpha;\\n' +\n        '}',\n    },\n\n    /**\n     * Constructor\n     * @memberOf fabric.Image.filters.Convolute.prototype\n     * @param {Object} [options] Options object\n     * @param {Boolean} [options.opaque=false] Opaque value (true/false)\n     * @param {Array} [options.matrix] Filter matrix\n     */\n\n\n    /**\n    * Retrieves the cached shader.\n    * @param {Object} options\n    * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n    * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n    */\n    retrieveShader: function(options) {\n      var size = Math.sqrt(this.matrix.length);\n      var cacheKey = this.type + '_' + size + '_' + (this.opaque ? 1 : 0);\n      var shaderSource = this.fragmentSource[cacheKey];\n      if (!options.programCache.hasOwnProperty(cacheKey)) {\n        options.programCache[cacheKey] = this.createProgram(options.context, shaderSource);\n      }\n      return options.programCache[cacheKey];\n    },\n\n    /**\n     * Apply the Brightness operation to a Uint8ClampedArray representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          data = imageData.data,\n          weights = this.matrix,\n          side = Math.round(Math.sqrt(weights.length)),\n          halfSide = Math.floor(side / 2),\n          sw = imageData.width,\n          sh = imageData.height,\n          output = options.ctx.createImageData(sw, sh),\n          dst = output.data,\n          // go through the destination image pixels\n          alphaFac = this.opaque ? 1 : 0,\n          r, g, b, a, dstOff,\n          scx, scy, srcOff, wt,\n          x, y, cx, cy;\n\n      for (y = 0; y < sh; y++) {\n        for (x = 0; x < sw; x++) {\n          dstOff = (y * sw + x) * 4;\n          // calculate the weighed sum of the source image pixels that\n          // fall under the convolution matrix\n          r = 0; g = 0; b = 0; a = 0;\n\n          for (cy = 0; cy < side; cy++) {\n            for (cx = 0; cx < side; cx++) {\n              scy = y + cy - halfSide;\n              scx = x + cx - halfSide;\n\n              // eslint-disable-next-line max-depth\n              if (scy < 0 || scy >= sh || scx < 0 || scx >= sw) {\n                continue;\n              }\n\n              srcOff = (scy * sw + scx) * 4;\n              wt = weights[cy * side + cx];\n\n              r += data[srcOff] * wt;\n              g += data[srcOff + 1] * wt;\n              b += data[srcOff + 2] * wt;\n              // eslint-disable-next-line max-depth\n              if (!alphaFac) {\n                a += data[srcOff + 3] * wt;\n              }\n            }\n          }\n          dst[dstOff] = r;\n          dst[dstOff + 1] = g;\n          dst[dstOff + 2] = b;\n          if (!alphaFac) {\n            dst[dstOff + 3] = a;\n          }\n          else {\n            dst[dstOff + 3] = data[dstOff + 3];\n          }\n        }\n      }\n      options.imageData = output;\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uMatrix: gl.getUniformLocation(program, 'uMatrix'),\n        uOpaque: gl.getUniformLocation(program, 'uOpaque'),\n        uHalfSize: gl.getUniformLocation(program, 'uHalfSize'),\n        uSize: gl.getUniformLocation(program, 'uSize'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform1fv(uniformLocations.uMatrix, this.matrix);\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function() {\n      return extend(this.callSuper('toObject'), {\n        opaque: this.opaque,\n        matrix: this.matrix\n      });\n    }\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Convolute} Instance of fabric.Image.filters.Convolute\n   */\n  fabric.Image.filters.Convolute.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Grayscale image filter class\n   * @class fabric.Image.filters.Grayscale\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Grayscale();\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.Grayscale = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Grayscale.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Grayscale',\n\n    fragmentSource: {\n      average: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'float average = (color.r + color.b + color.g) / 3.0;\\n' +\n          'gl_FragColor = vec4(average, average, average, color.a);\\n' +\n        '}',\n      lightness: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform int uMode;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 col = texture2D(uTexture, vTexCoord);\\n' +\n          'float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\\n' +\n          'gl_FragColor = vec4(average, average, average, col.a);\\n' +\n        '}',\n      luminosity: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform int uMode;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 col = texture2D(uTexture, vTexCoord);\\n' +\n          'float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\\n' +\n          'gl_FragColor = vec4(average, average, average, col.a);\\n' +\n        '}',\n    },\n\n\n    /**\n     * Grayscale mode, between 'average', 'lightness', 'luminosity'\n     * @param {String} type\n     * @default\n     */\n    mode: 'average',\n\n    mainParameter: 'mode',\n\n    /**\n     * Apply the Grayscale operation to a Uint8Array representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8Array to be filtered.\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          data = imageData.data, i,\n          len = data.length, value,\n          mode = this.mode;\n      for (i = 0; i < len; i += 4) {\n        if (mode === 'average') {\n          value = (data[i] + data[i + 1] + data[i + 2]) / 3;\n        }\n        else if (mode === 'lightness') {\n          value = (Math.min(data[i], data[i + 1], data[i + 2]) +\n            Math.max(data[i], data[i + 1], data[i + 2])) / 2;\n        }\n        else if (mode === 'luminosity') {\n          value = 0.21 * data[i] + 0.72 * data[i + 1] + 0.07 * data[i + 2];\n        }\n        data[i] = value;\n        data[i + 1] = value;\n        data[i + 2] = value;\n      }\n    },\n\n    /**\n     * Retrieves the cached shader.\n     * @param {Object} options\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    retrieveShader: function(options) {\n      var cacheKey = this.type + '_' + this.mode;\n      if (!options.programCache.hasOwnProperty(cacheKey)) {\n        var shaderSource = this.fragmentSource[this.mode];\n        options.programCache[cacheKey] = this.createProgram(options.context, shaderSource);\n      }\n      return options.programCache[cacheKey];\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uMode: gl.getUniformLocation(program, 'uMode'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      // default average mode.\n      var mode = 1;\n      gl.uniform1i(uniformLocations.uMode, mode);\n    },\n\n    /**\n     * Grayscale filter isNeutralState implementation\n     * The filter is never neutral\n     * on the image\n     **/\n    isNeutralState: function() {\n      return false;\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Grayscale} Instance of fabric.Image.filters.Grayscale\n   */\n  fabric.Image.filters.Grayscale.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Invert filter class\n   * @class fabric.Image.filters.Invert\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Invert();\n   * object.filters.push(filter);\n   * object.applyFilters(canvas.renderAll.bind(canvas));\n   */\n  filters.Invert = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Invert.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Invert',\n\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform int uInvert;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n        'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n        'if (uInvert == 1) {\\n' +\n          'gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\\n' +\n        '} else {\\n' +\n          'gl_FragColor = color;\\n' +\n        '}\\n' +\n      '}',\n\n    /**\n     * Filter invert. if false, does nothing\n     * @param {Boolean} invert\n     * @default\n     */\n    invert: true,\n\n    mainParameter: 'invert',\n\n    /**\n     * Apply the Invert operation to a Uint8Array representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8Array to be filtered.\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          data = imageData.data, i,\n          len = data.length;\n      for (i = 0; i < len; i += 4) {\n        data[i] = 255 - data[i];\n        data[i + 1] = 255 - data[i + 1];\n        data[i + 2] = 255 - data[i + 2];\n      }\n    },\n\n    /**\n     * Invert filter isNeutralState implementation\n     * Used only in image applyFilters to discard filters that will not have an effect\n     * on the image\n     * @param {Object} options\n     **/\n    isNeutralState: function() {\n      return !this.invert;\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uInvert: gl.getUniformLocation(program, 'uInvert'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform1i(uniformLocations.uInvert, this.invert);\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Invert} Instance of fabric.Image.filters.Invert\n   */\n  fabric.Image.filters.Invert.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      extend = fabric.util.object.extend,\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Noise filter class\n   * @class fabric.Image.filters.Noise\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Noise#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Noise({\n   *   noise: 700\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n  filters.Noise = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Noise.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Noise',\n\n    /**\n     * Fragment source for the noise program\n     */\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform float uStepH;\\n' +\n      'uniform float uNoise;\\n' +\n      'uniform float uSeed;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'float rand(vec2 co, float seed, float vScale) {\\n' +\n        'return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\\n' +\n      '}\\n' +\n      'void main() {\\n' +\n        'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n        'color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\\n' +\n        'gl_FragColor = color;\\n' +\n      '}',\n\n    /**\n     * Describe the property that is the filter parameter\n     * @param {String} m\n     * @default\n     */\n    mainParameter: 'noise',\n\n    /**\n     * Noise value, from\n     * @param {Number} noise\n     * @default\n     */\n    noise: 0,\n\n    /**\n     * Apply the Brightness operation to a Uint8ClampedArray representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n     */\n    applyTo2d: function(options) {\n      if (this.noise === 0) {\n        return;\n      }\n      var imageData = options.imageData,\n          data = imageData.data, i, len = data.length,\n          noise = this.noise, rand;\n\n      for (i = 0, len = data.length; i < len; i += 4) {\n\n        rand = (0.5 - Math.random()) * noise;\n\n        data[i] += rand;\n        data[i + 1] += rand;\n        data[i + 2] += rand;\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uNoise: gl.getUniformLocation(program, 'uNoise'),\n        uSeed: gl.getUniformLocation(program, 'uSeed'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform1f(uniformLocations.uNoise, this.noise / 255);\n      gl.uniform1f(uniformLocations.uSeed, Math.random());\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function() {\n      return extend(this.callSuper('toObject'), {\n        noise: this.noise\n      });\n    }\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Noise} Instance of fabric.Image.filters.Noise\n   */\n  fabric.Image.filters.Noise.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Pixelate filter class\n   * @class fabric.Image.filters.Pixelate\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Pixelate#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Pixelate({\n   *   blocksize: 8\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.Pixelate = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Pixelate.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Pixelate',\n\n    blocksize: 4,\n\n    mainParameter: 'blocksize',\n\n    /**\n     * Fragment source for the Pixelate program\n     */\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform float uBlocksize;\\n' +\n      'uniform float uStepW;\\n' +\n      'uniform float uStepH;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n        'float blockW = uBlocksize * uStepW;\\n' +\n        'float blockH = uBlocksize * uStepW;\\n' +\n        'int posX = int(vTexCoord.x / blockW);\\n' +\n        'int posY = int(vTexCoord.y / blockH);\\n' +\n        'float fposX = float(posX);\\n' +\n        'float fposY = float(posY);\\n' +\n        'vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\\n' +\n        'vec4 color = texture2D(uTexture, squareCoords);\\n' +\n        'gl_FragColor = color;\\n' +\n      '}',\n\n    /**\n     * Apply the Pixelate operation to a Uint8ClampedArray representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          data = imageData.data,\n          iLen = imageData.height,\n          jLen = imageData.width,\n          index, i, j, r, g, b, a,\n          _i, _j, _iLen, _jLen;\n\n      for (i = 0; i < iLen; i += this.blocksize) {\n        for (j = 0; j < jLen; j += this.blocksize) {\n\n          index = (i * 4) * jLen + (j * 4);\n\n          r = data[index];\n          g = data[index + 1];\n          b = data[index + 2];\n          a = data[index + 3];\n\n          _iLen = Math.min(i + this.blocksize, iLen);\n          _jLen = Math.min(j + this.blocksize, jLen);\n          for (_i = i; _i < _iLen; _i++) {\n            for (_j = j; _j < _jLen; _j++) {\n              index = (_i * 4) * jLen + (_j * 4);\n              data[index] = r;\n              data[index + 1] = g;\n              data[index + 2] = b;\n              data[index + 3] = a;\n            }\n          }\n        }\n      }\n    },\n\n    /**\n     * Indicate when the filter is not gonna apply changes to the image\n     **/\n    isNeutralState: function() {\n      return this.blocksize === 1;\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uBlocksize: gl.getUniformLocation(program, 'uBlocksize'),\n        uStepW: gl.getUniformLocation(program, 'uStepW'),\n        uStepH: gl.getUniformLocation(program, 'uStepH'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform1f(uniformLocations.uBlocksize, this.blocksize);\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Pixelate} Instance of fabric.Image.filters.Pixelate\n   */\n  fabric.Image.filters.Pixelate.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      extend = fabric.util.object.extend,\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Remove white filter class\n   * @class fabric.Image.filters.RemoveColor\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.RemoveColor#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.RemoveColor({\n   *   threshold: 0.2,\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n  filters.RemoveColor = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.RemoveColor.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'RemoveColor',\n\n    /**\n     * Color to remove, in any format understood by fabric.Color.\n     * @param {String} type\n     * @default\n     */\n    color: '#FFFFFF',\n\n    /**\n     * Fragment source for the brightness program\n     */\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform vec4 uLow;\\n' +\n      'uniform vec4 uHigh;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n        'gl_FragColor = texture2D(uTexture, vTexCoord);\\n' +\n        'if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\\n' +\n          'gl_FragColor.a = 0.0;\\n' +\n        '}\\n' +\n      '}',\n\n    /**\n     * distance to actual color, as value up or down from each r,g,b\n     * between 0 and 1\n     **/\n    distance: 0.02,\n\n    /**\n     * For color to remove inside distance, use alpha channel for a smoother deletion\n     * NOT IMPLEMENTED YET\n     **/\n    useAlpha: false,\n\n    /**\n     * Constructor\n     * @memberOf fabric.Image.filters.RemoveWhite.prototype\n     * @param {Object} [options] Options object\n     * @param {Number} [options.color=#RRGGBB] Threshold value\n     * @param {Number} [options.distance=10] Distance value\n     */\n\n    /**\n     * Applies filter to canvas element\n     * @param {Object} canvasEl Canvas element to apply filter to\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          data = imageData.data, i,\n          distance = this.distance * 255,\n          r, g, b,\n          source = new fabric.Color(this.color).getSource(),\n          lowC = [\n            source[0] - distance,\n            source[1] - distance,\n            source[2] - distance,\n          ],\n          highC = [\n            source[0] + distance,\n            source[1] + distance,\n            source[2] + distance,\n          ];\n\n\n      for (i = 0; i < data.length; i += 4) {\n        r = data[i];\n        g = data[i + 1];\n        b = data[i + 2];\n\n        if (r > lowC[0] &&\n            g > lowC[1] &&\n            b > lowC[2] &&\n            r < highC[0] &&\n            g < highC[1] &&\n            b < highC[2]) {\n          data[i + 3] = 0;\n        }\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uLow: gl.getUniformLocation(program, 'uLow'),\n        uHigh: gl.getUniformLocation(program, 'uHigh'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      var source = new fabric.Color(this.color).getSource(),\n          distance = parseFloat(this.distance),\n          lowC = [\n            0 + source[0] / 255 - distance,\n            0 + source[1] / 255 - distance,\n            0 + source[2] / 255 - distance,\n            1\n          ],\n          highC = [\n            source[0] / 255 + distance,\n            source[1] / 255 + distance,\n            source[2] / 255 + distance,\n            1\n          ];\n      gl.uniform4fv(uniformLocations.uLow, lowC);\n      gl.uniform4fv(uniformLocations.uHigh, highC);\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function() {\n      return extend(this.callSuper('toObject'), {\n        color: this.color,\n        distance: this.distance\n      });\n    }\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.RemoveColor} Instance of fabric.Image.filters.RemoveWhite\n   */\n  fabric.Image.filters.RemoveColor.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  var matrices = {\n    Brownie: [\n      0.59970,0.34553,-0.27082,0,0.186,\n      -0.03770,0.86095,0.15059,0,-0.1449,\n      0.24113,-0.07441,0.44972,0,-0.02965,\n      0,0,0,1,0\n    ],\n    Vintage: [\n      0.62793,0.32021,-0.03965,0,0.03784,\n      0.02578,0.64411,0.03259,0,0.02926,\n      0.04660,-0.08512,0.52416,0,0.02023,\n      0,0,0,1,0\n    ],\n    Kodachrome: [\n      1.12855,-0.39673,-0.03992,0,0.24991,\n      -0.16404,1.08352,-0.05498,0,0.09698,\n      -0.16786,-0.56034,1.60148,0,0.13972,\n      0,0,0,1,0\n    ],\n    Technicolor: [\n      1.91252,-0.85453,-0.09155,0,0.04624,\n      -0.30878,1.76589,-0.10601,0,-0.27589,\n      -0.23110,-0.75018,1.84759,0,0.12137,\n      0,0,0,1,0\n    ],\n    Polaroid: [\n      1.438,-0.062,-0.062,0,0,\n      -0.122,1.378,-0.122,0,0,\n      -0.016,-0.016,1.483,0,0,\n      0,0,0,1,0\n    ],\n    Sepia: [\n      0.393, 0.769, 0.189, 0, 0,\n      0.349, 0.686, 0.168, 0, 0,\n      0.272, 0.534, 0.131, 0, 0,\n      0, 0, 0, 1, 0\n    ],\n    BlackWhite: [\n      1.5, 1.5, 1.5, 0, -1,\n      1.5, 1.5, 1.5, 0, -1,\n      1.5, 1.5, 1.5, 0, -1,\n      0, 0, 0, 1, 0,\n    ]\n  };\n\n  for (var key in matrices) {\n    filters[key] = createClass(filters.ColorMatrix, /** @lends fabric.Image.filters.Sepia.prototype */ {\n\n      /**\n       * Filter type\n       * @param {String} type\n       * @default\n       */\n      type: key,\n\n      /**\n       * Colormatrix for the effect\n       * array of 20 floats. Numbers in positions 4, 9, 14, 19 loose meaning\n       * outside the -1, 1 range.\n       * @param {Array} matrix array of 20 numbers.\n       * @default\n       */\n      matrix: matrices[key],\n\n      /**\n       * Lock the matrix export for this kind of static, parameter less filters.\n       */\n      mainParameter: false,\n      /**\n       * Lock the colormatrix on the color part, skipping alpha\n       */\n      colorsOnly: true,\n\n    });\n    fabric.Image.filters[key].fromObject = fabric.Image.filters.BaseFilter.fromObject;\n  }\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n  'use strict';\n\n  var fabric = global.fabric,\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Color Blend filter class\n   * @class fabric.Image.filter.BlendColor\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @example\n   * var filter = new fabric.Image.filters.BlendColor({\n   *  color: '#000',\n   *  mode: 'multiply'\n   * });\n   *\n   * var filter = new fabric.Image.filters.BlendImage({\n   *  image: fabricImageObject,\n   *  mode: 'multiply',\n   *  alpha: 0.5\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n\n  filters.BlendColor = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Blend.prototype */ {\n    type: 'BlendColor',\n\n    /**\n     * Color to make the blend operation with. default to a reddish color since black or white\n     * gives always strong result.\n     * @type String\n     * @default\n     **/\n    color: '#F95C63',\n\n    /**\n     * Blend mode for the filter: one of multiply, add, diff, screen, subtract,\n     * darken, lighten, overlay, exclusion, tint.\n     * @type String\n     * @default\n     **/\n    mode: 'multiply',\n\n    /**\n     * alpha value. represent the strength of the blend color operation.\n     * @type Number\n     * @default\n     **/\n    alpha: 1,\n\n    /**\n     * Fragment source for the Multiply program\n     */\n    fragmentSource: {\n      multiply: 'gl_FragColor.rgb *= uColor.rgb;\\n',\n      screen: 'gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\\n',\n      add: 'gl_FragColor.rgb += uColor.rgb;\\n',\n      diff: 'gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\\n',\n      subtract: 'gl_FragColor.rgb -= uColor.rgb;\\n',\n      lighten: 'gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\\n',\n      darken: 'gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\\n',\n      exclusion: 'gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\\n',\n      overlay: 'if (uColor.r < 0.5) {\\n' +\n          'gl_FragColor.r *= 2.0 * uColor.r;\\n' +\n        '} else {\\n' +\n          'gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\\n' +\n        '}\\n' +\n        'if (uColor.g < 0.5) {\\n' +\n          'gl_FragColor.g *= 2.0 * uColor.g;\\n' +\n        '} else {\\n' +\n          'gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\\n' +\n        '}\\n' +\n        'if (uColor.b < 0.5) {\\n' +\n          'gl_FragColor.b *= 2.0 * uColor.b;\\n' +\n        '} else {\\n' +\n          'gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\\n' +\n        '}\\n',\n      tint: 'gl_FragColor.rgb *= (1.0 - uColor.a);\\n' +\n        'gl_FragColor.rgb += uColor.rgb;\\n',\n    },\n\n    /**\n     * build the fragment source for the filters, joining the common part with\n     * the specific one.\n     * @param {String} mode the mode of the filter, a key of this.fragmentSource\n     * @return {String} the source to be compiled\n     * @private\n     */\n    buildSource: function(mode) {\n      return 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform vec4 uColor;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'gl_FragColor = color;\\n' +\n          'if (color.a > 0.0) {\\n' +\n            this.fragmentSource[mode] +\n          '}\\n' +\n        '}';\n    },\n\n    /**\n     * Retrieves the cached shader.\n     * @param {Object} options\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    retrieveShader: function(options) {\n      var cacheKey = this.type + '_' + this.mode, shaderSource;\n      if (!options.programCache.hasOwnProperty(cacheKey)) {\n        shaderSource = this.buildSource(this.mode);\n        options.programCache[cacheKey] = this.createProgram(options.context, shaderSource);\n      }\n      return options.programCache[cacheKey];\n    },\n\n    /**\n     * Apply the Blend operation to a Uint8ClampedArray representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          data = imageData.data, iLen = data.length,\n          tr, tg, tb,\n          r, g, b,\n          source, alpha1 = 1 - this.alpha;\n\n      source = new fabric.Color(this.color).getSource();\n      tr = source[0] * this.alpha;\n      tg = source[1] * this.alpha;\n      tb = source[2] * this.alpha;\n\n      for (var i = 0; i < iLen; i += 4) {\n\n        r = data[i];\n        g = data[i + 1];\n        b = data[i + 2];\n\n        switch (this.mode) {\n          case 'multiply':\n            data[i] = r * tr / 255;\n            data[i + 1] = g * tg / 255;\n            data[i + 2] = b * tb / 255;\n            break;\n          case 'screen':\n            data[i] = 255 - (255 - r) * (255 - tr) / 255;\n            data[i + 1] = 255 - (255 - g) * (255 - tg) / 255;\n            data[i + 2] = 255 - (255 - b) * (255 - tb) / 255;\n            break;\n          case 'add':\n            data[i] = r + tr;\n            data[i + 1] = g + tg;\n            data[i + 2] = b + tb;\n            break;\n          case 'diff':\n          case 'difference':\n            data[i] = Math.abs(r - tr);\n            data[i + 1] = Math.abs(g - tg);\n            data[i + 2] = Math.abs(b - tb);\n            break;\n          case 'subtract':\n            data[i] = r - tr;\n            data[i + 1] = g - tg;\n            data[i + 2] = b - tb;\n            break;\n          case 'darken':\n            data[i] = Math.min(r, tr);\n            data[i + 1] = Math.min(g, tg);\n            data[i + 2] = Math.min(b, tb);\n            break;\n          case 'lighten':\n            data[i] = Math.max(r, tr);\n            data[i + 1] = Math.max(g, tg);\n            data[i + 2] = Math.max(b, tb);\n            break;\n          case 'overlay':\n            data[i] = tr < 128 ? (2 * r * tr / 255) : (255 - 2 * (255 - r) * (255 - tr) / 255);\n            data[i + 1] = tg < 128 ? (2 * g * tg / 255) : (255 - 2 * (255 - g) * (255 - tg) / 255);\n            data[i + 2] = tb < 128 ? (2 * b * tb / 255) : (255 - 2 * (255 - b) * (255 - tb) / 255);\n            break;\n          case 'exclusion':\n            data[i] = tr + r - ((2 * tr * r) / 255);\n            data[i + 1] = tg + g - ((2 * tg * g) / 255);\n            data[i + 2] = tb + b - ((2 * tb * b) / 255);\n            break;\n          case 'tint':\n            data[i] = tr + r * alpha1;\n            data[i + 1] = tg + g * alpha1;\n            data[i + 2] = tb + b * alpha1;\n        }\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uColor: gl.getUniformLocation(program, 'uColor'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      var source = new fabric.Color(this.color).getSource();\n      source[0] = this.alpha * source[0] / 255;\n      source[1] = this.alpha * source[1] / 255;\n      source[2] = this.alpha * source[2] / 255;\n      source[3] = this.alpha;\n      gl.uniform4fv(uniformLocations.uColor, source);\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function() {\n      return {\n        type: this.type,\n        color: this.color,\n        mode: this.mode,\n        alpha: this.alpha\n      };\n    }\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.BlendColor} Instance of fabric.Image.filters.BlendColor\n   */\n  fabric.Image.filters.BlendColor.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n  'use strict';\n\n  var fabric = global.fabric,\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Image Blend filter class\n   * @class fabric.Image.filter.BlendImage\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @example\n   * var filter = new fabric.Image.filters.BlendColor({\n   *  color: '#000',\n   *  mode: 'multiply'\n   * });\n   *\n   * var filter = new fabric.Image.filters.BlendImage({\n   *  image: fabricImageObject,\n   *  mode: 'multiply',\n   *  alpha: 0.5\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n\n  filters.BlendImage = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.BlendImage.prototype */ {\n    type: 'BlendImage',\n\n    /**\n     * Color to make the blend operation with. default to a reddish color since black or white\n     * gives always strong result.\n     **/\n    image: null,\n\n    /**\n     * Blend mode for the filter (one of \"multiply\", \"mask\")\n     * @type String\n     * @default\n     **/\n    mode: 'multiply',\n\n    /**\n     * alpha value. represent the strength of the blend image operation.\n     * not implemented.\n     **/\n    alpha: 1,\n\n    vertexSource: 'attribute vec2 aPosition;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'varying vec2 vTexCoord2;\\n' +\n      'uniform mat3 uTransformMatrix;\\n' +\n      'void main() {\\n' +\n        'vTexCoord = aPosition;\\n' +\n        'vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\\n' +\n        'gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\\n' +\n      '}',\n\n    /**\n     * Fragment source for the Multiply program\n     */\n    fragmentSource: {\n      multiply: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform sampler2D uImage;\\n' +\n        'uniform vec4 uColor;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'varying vec2 vTexCoord2;\\n' +\n        'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'vec4 color2 = texture2D(uImage, vTexCoord2);\\n' +\n          'color.rgba *= color2.rgba;\\n' +\n          'gl_FragColor = color;\\n' +\n        '}',\n      mask: 'precision highp float;\\n' +\n        'uniform sampler2D uTexture;\\n' +\n        'uniform sampler2D uImage;\\n' +\n        'uniform vec4 uColor;\\n' +\n        'varying vec2 vTexCoord;\\n' +\n        'varying vec2 vTexCoord2;\\n' +\n        'void main() {\\n' +\n          'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n          'vec4 color2 = texture2D(uImage, vTexCoord2);\\n' +\n          'color.a = color2.a;\\n' +\n          'gl_FragColor = color;\\n' +\n        '}',\n    },\n\n    /**\n     * Retrieves the cached shader.\n     * @param {Object} options\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    retrieveShader: function(options) {\n      var cacheKey = this.type + '_' + this.mode;\n      var shaderSource = this.fragmentSource[this.mode];\n      if (!options.programCache.hasOwnProperty(cacheKey)) {\n        options.programCache[cacheKey] = this.createProgram(options.context, shaderSource);\n      }\n      return options.programCache[cacheKey];\n    },\n\n    applyToWebGL: function(options) {\n      // load texture to blend.\n      var gl = options.context,\n          texture = this.createTexture(options.filterBackend, this.image);\n      this.bindAdditionalTexture(gl, texture, gl.TEXTURE1);\n      this.callSuper('applyToWebGL', options);\n      this.unbindAdditionalTexture(gl, gl.TEXTURE1);\n    },\n\n    createTexture: function(backend, image) {\n      return backend.getCachedTexture(image.cacheKey, image._element);\n    },\n\n    /**\n     * Calculate a transformMatrix to adapt the image to blend over\n     * @param {Object} options\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    calculateMatrix: function() {\n      var image = this.image,\n          width = image._element.width,\n          height = image._element.height;\n      return [\n        1 / image.scaleX, 0, 0,\n        0, 1 / image.scaleY, 0,\n        -image.left / width, -image.top / height, 1\n      ];\n    },\n\n    /**\n     * Apply the Blend operation to a Uint8ClampedArray representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          resources = options.filterBackend.resources,\n          data = imageData.data, iLen = data.length,\n          width = imageData.width,\n          height = imageData.height,\n          tr, tg, tb, ta,\n          r, g, b, a,\n          canvas1, context, image = this.image, blendData;\n\n      if (!resources.blendImage) {\n        resources.blendImage = fabric.util.createCanvasElement();\n      }\n      canvas1 = resources.blendImage;\n      context = canvas1.getContext('2d');\n      if (canvas1.width !== width || canvas1.height !== height) {\n        canvas1.width = width;\n        canvas1.height = height;\n      }\n      else {\n        context.clearRect(0, 0, width, height);\n      }\n      context.setTransform(image.scaleX, 0, 0, image.scaleY, image.left, image.top);\n      context.drawImage(image._element, 0, 0, width, height);\n      blendData = context.getImageData(0, 0, width, height).data;\n      for (var i = 0; i < iLen; i += 4) {\n\n        r = data[i];\n        g = data[i + 1];\n        b = data[i + 2];\n        a = data[i + 3];\n\n        tr = blendData[i];\n        tg = blendData[i + 1];\n        tb = blendData[i + 2];\n        ta = blendData[i + 3];\n\n        switch (this.mode) {\n          case 'multiply':\n            data[i] = r * tr / 255;\n            data[i + 1] = g * tg / 255;\n            data[i + 2] = b * tb / 255;\n            data[i + 3] = a * ta / 255;\n            break;\n          case 'mask':\n            data[i + 3] = ta;\n            break;\n        }\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uTransformMatrix: gl.getUniformLocation(program, 'uTransformMatrix'),\n        uImage: gl.getUniformLocation(program, 'uImage'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      var matrix = this.calculateMatrix();\n      gl.uniform1i(uniformLocations.uImage, 1); // texture unit 1.\n      gl.uniformMatrix3fv(uniformLocations.uTransformMatrix, false, matrix);\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function() {\n      return {\n        type: this.type,\n        image: this.image && this.image.toObject(),\n        mode: this.mode,\n        alpha: this.alpha\n      };\n    }\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} callback to be invoked after filter creation\n   * @return {fabric.Image.filters.BlendImage} Instance of fabric.Image.filters.BlendImage\n   */\n  fabric.Image.filters.BlendImage.fromObject = function(object, callback) {\n    fabric.Image.fromObject(object.image, function(image) {\n      var options = fabric.util.object.clone(object);\n      options.image = image;\n      callback(new fabric.Image.filters.BlendImage(options));\n    });\n  };\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }), pow = Math.pow, floor = Math.floor,\n      sqrt = Math.sqrt, abs = Math.abs, round = Math.round, sin = Math.sin,\n      ceil = Math.ceil,\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Resize image filter class\n   * @class fabric.Image.filters.Resize\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Resize();\n   * object.filters.push(filter);\n   * object.applyFilters(canvas.renderAll.bind(canvas));\n   */\n  filters.Resize = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Resize.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Resize',\n\n    /**\n     * Resize type\n     * for webgl resizeType is just lanczos, for canvas2d can be:\n     * bilinear, hermite, sliceHack, lanczos.\n     * @param {String} resizeType\n     * @default\n     */\n    resizeType: 'hermite',\n\n    /**\n     * Scale factor for resizing, x axis\n     * @param {Number} scaleX\n     * @default\n     */\n    scaleX: 1,\n\n    /**\n     * Scale factor for resizing, y axis\n     * @param {Number} scaleY\n     * @default\n     */\n    scaleY: 1,\n\n    /**\n     * LanczosLobes parameter for lanczos filter, valid for resizeType lanczos\n     * @param {Number} lanczosLobes\n     * @default\n     */\n    lanczosLobes: 3,\n\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uDelta: gl.getUniformLocation(program, 'uDelta'),\n        uTaps: gl.getUniformLocation(program, 'uTaps'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform2fv(uniformLocations.uDelta, this.horizontal ? [1 / this.width, 0] : [0, 1 / this.height]);\n      gl.uniform1fv(uniformLocations.uTaps, this.taps);\n    },\n\n    /**\n     * Retrieves the cached shader.\n     * @param {Object} options\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    retrieveShader: function(options) {\n      var filterWindow = this.getFilterWindow(), cacheKey = this.type + '_' + filterWindow;\n      if (!options.programCache.hasOwnProperty(cacheKey)) {\n        var fragmentShader = this.generateShader(filterWindow);\n        options.programCache[cacheKey] = this.createProgram(options.context, fragmentShader);\n      }\n      return options.programCache[cacheKey];\n    },\n\n    getFilterWindow: function() {\n      var scale = this.tempScale;\n      return Math.ceil(this.lanczosLobes / scale);\n    },\n\n    getTaps: function() {\n      var lobeFunction = this.lanczosCreate(this.lanczosLobes), scale = this.tempScale,\n          filterWindow = this.getFilterWindow(), taps = new Array(filterWindow);\n      for (var i = 1; i <= filterWindow; i++) {\n        taps[i - 1] = lobeFunction(i * scale);\n      }\n      return taps;\n    },\n\n    /**\n     * Generate vertex and shader sources from the necessary steps numbers\n     * @param {Number} filterWindow\n     */\n    generateShader: function(filterWindow) {\n      var offsets = new Array(filterWindow),\n          fragmentShader = this.fragmentSourceTOP, filterWindow;\n\n      for (var i = 1; i <= filterWindow; i++) {\n        offsets[i - 1] = i + '.0 * uDelta';\n      }\n\n      fragmentShader += 'uniform float uTaps[' + filterWindow + '];\\n';\n      fragmentShader += 'void main() {\\n';\n      fragmentShader += '  vec4 color = texture2D(uTexture, vTexCoord);\\n';\n      fragmentShader += '  float sum = 1.0;\\n';\n\n      offsets.forEach(function(offset, i) {\n        fragmentShader += '  color += texture2D(uTexture, vTexCoord + ' + offset + ') * uTaps[' + i + '];\\n';\n        fragmentShader += '  color += texture2D(uTexture, vTexCoord - ' + offset + ') * uTaps[' + i + '];\\n';\n        fragmentShader += '  sum += 2.0 * uTaps[' + i + '];\\n';\n      });\n      fragmentShader += '  gl_FragColor = color / sum;\\n';\n      fragmentShader += '}';\n      return fragmentShader;\n    },\n\n    fragmentSourceTOP: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform vec2 uDelta;\\n' +\n      'varying vec2 vTexCoord;\\n',\n\n    /**\n     * Apply the resize filter to the image\n     * Determines whether to use WebGL or Canvas2D based on the options.webgl flag.\n     *\n     * @param {Object} options\n     * @param {Number} options.passes The number of filters remaining to be executed\n     * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n     * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n     * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    applyTo: function(options) {\n      if (options.webgl) {\n        options.passes++;\n        this.width = options.sourceWidth;\n        this.horizontal = true;\n        this.dW = Math.round(this.width * this.scaleX);\n        this.dH = options.sourceHeight;\n        this.tempScale = this.dW / this.width;\n        this.taps = this.getTaps();\n        options.destinationWidth = this.dW;\n        this._setupFrameBuffer(options);\n        this.applyToWebGL(options);\n        this._swapTextures(options);\n        options.sourceWidth = options.destinationWidth;\n\n        this.height = options.sourceHeight;\n        this.horizontal = false;\n        this.dH = Math.round(this.height * this.scaleY);\n        this.tempScale = this.dH / this.height;\n        this.taps = this.getTaps();\n        options.destinationHeight = this.dH;\n        this._setupFrameBuffer(options);\n        this.applyToWebGL(options);\n        this._swapTextures(options);\n        options.sourceHeight = options.destinationHeight;\n      }\n      else {\n        this.applyTo2d(options);\n      }\n    },\n\n    isNeutralState: function() {\n      return this.scaleX === 1 && this.scaleY === 1;\n    },\n\n    lanczosCreate: function(lobes) {\n      return function(x) {\n        if (x >= lobes || x <= -lobes) {\n          return 0.0;\n        }\n        if (x < 1.19209290E-07 && x > -1.19209290E-07) {\n          return 1.0;\n        }\n        x *= Math.PI;\n        var xx = x / lobes;\n        return (sin(x) / x) * sin(xx) / xx;\n      };\n    },\n\n    /**\n     * Applies filter to canvas element\n     * @memberOf fabric.Image.filters.Resize.prototype\n     * @param {Object} canvasEl Canvas element to apply filter to\n     * @param {Number} scaleX\n     * @param {Number} scaleY\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData,\n          scaleX = this.scaleX,\n          scaleY = this.scaleY;\n\n      this.rcpScaleX = 1 / scaleX;\n      this.rcpScaleY = 1 / scaleY;\n\n      var oW = imageData.width, oH = imageData.height,\n          dW = round(oW * scaleX), dH = round(oH * scaleY),\n          newData;\n\n      if (this.resizeType === 'sliceHack') {\n        newData = this.sliceByTwo(options, oW, oH, dW, dH);\n      }\n      else if (this.resizeType === 'hermite') {\n        newData = this.hermiteFastResize(options, oW, oH, dW, dH);\n      }\n      else if (this.resizeType === 'bilinear') {\n        newData = this.bilinearFiltering(options, oW, oH, dW, dH);\n      }\n      else if (this.resizeType === 'lanczos') {\n        newData = this.lanczosResize(options, oW, oH, dW, dH);\n      }\n      options.imageData = newData;\n    },\n\n    /**\n     * Filter sliceByTwo\n     * @param {Object} canvasEl Canvas element to apply filter to\n     * @param {Number} oW Original Width\n     * @param {Number} oH Original Height\n     * @param {Number} dW Destination Width\n     * @param {Number} dH Destination Height\n     * @returns {ImageData}\n     */\n    sliceByTwo: function(options, oW, oH, dW, dH) {\n      var imageData = options.imageData,\n          mult = 0.5, doneW = false, doneH = false, stepW = oW * mult,\n          stepH = oH * mult, resources = fabric.filterBackend.resources,\n          tmpCanvas, ctx, sX = 0, sY = 0, dX = oW, dY = 0;\n      if (!resources.sliceByTwo) {\n        resources.sliceByTwo = document.createElement('canvas');\n      }\n      tmpCanvas = resources.sliceByTwo;\n      if (tmpCanvas.width < oW * 1.5 || tmpCanvas.height < oH) {\n        tmpCanvas.width = oW * 1.5;\n        tmpCanvas.height = oH;\n      }\n      ctx = tmpCanvas.getContext('2d');\n      ctx.clearRect(0, 0, oW * 1.5, oH);\n      ctx.putImageData(imageData, 0, 0);\n\n      dW = floor(dW);\n      dH = floor(dH);\n\n      while (!doneW || !doneH) {\n        oW = stepW;\n        oH = stepH;\n        if (dW < floor(stepW * mult)) {\n          stepW = floor(stepW * mult);\n        }\n        else {\n          stepW = dW;\n          doneW = true;\n        }\n        if (dH < floor(stepH * mult)) {\n          stepH = floor(stepH * mult);\n        }\n        else {\n          stepH = dH;\n          doneH = true;\n        }\n        ctx.drawImage(tmpCanvas, sX, sY, oW, oH, dX, dY, stepW, stepH);\n        sX = dX;\n        sY = dY;\n        dY += stepH;\n      }\n      return ctx.getImageData(sX, sY, dW, dH);\n    },\n\n    /**\n     * Filter lanczosResize\n     * @param {Object} canvasEl Canvas element to apply filter to\n     * @param {Number} oW Original Width\n     * @param {Number} oH Original Height\n     * @param {Number} dW Destination Width\n     * @param {Number} dH Destination Height\n     * @returns {ImageData}\n     */\n    lanczosResize: function(options, oW, oH, dW, dH) {\n\n      function process(u) {\n        var v, i, weight, idx, a, red, green,\n            blue, alpha, fX, fY;\n        center.x = (u + 0.5) * ratioX;\n        icenter.x = floor(center.x);\n        for (v = 0; v < dH; v++) {\n          center.y = (v + 0.5) * ratioY;\n          icenter.y = floor(center.y);\n          a = 0; red = 0; green = 0; blue = 0; alpha = 0;\n          for (i = icenter.x - range2X; i <= icenter.x + range2X; i++) {\n            if (i < 0 || i >= oW) {\n              continue;\n            }\n            fX = floor(1000 * abs(i - center.x));\n            if (!cacheLanc[fX]) {\n              cacheLanc[fX] = { };\n            }\n            for (var j = icenter.y - range2Y; j <= icenter.y + range2Y; j++) {\n              if (j < 0 || j >= oH) {\n                continue;\n              }\n              fY = floor(1000 * abs(j - center.y));\n              if (!cacheLanc[fX][fY]) {\n                cacheLanc[fX][fY] = lanczos(sqrt(pow(fX * rcpRatioX, 2) + pow(fY * rcpRatioY, 2)) / 1000);\n              }\n              weight = cacheLanc[fX][fY];\n              if (weight > 0) {\n                idx = (j * oW + i) * 4;\n                a += weight;\n                red += weight * srcData[idx];\n                green += weight * srcData[idx + 1];\n                blue += weight * srcData[idx + 2];\n                alpha += weight * srcData[idx + 3];\n              }\n            }\n          }\n          idx = (v * dW + u) * 4;\n          destData[idx] = red / a;\n          destData[idx + 1] = green / a;\n          destData[idx + 2] = blue / a;\n          destData[idx + 3] = alpha / a;\n        }\n\n        if (++u < dW) {\n          return process(u);\n        }\n        else {\n          return destImg;\n        }\n      }\n\n      var srcData = options.imageData.data,\n          destImg = options.ctx.createImageData(dW, dH),\n          destData = destImg.data,\n          lanczos = this.lanczosCreate(this.lanczosLobes),\n          ratioX = this.rcpScaleX, ratioY = this.rcpScaleY,\n          rcpRatioX = 2 / this.rcpScaleX, rcpRatioY = 2 / this.rcpScaleY,\n          range2X = ceil(ratioX * this.lanczosLobes / 2),\n          range2Y = ceil(ratioY * this.lanczosLobes / 2),\n          cacheLanc = { }, center = { }, icenter = { };\n\n      return process(0);\n    },\n\n    /**\n     * bilinearFiltering\n     * @param {Object} canvasEl Canvas element to apply filter to\n     * @param {Number} oW Original Width\n     * @param {Number} oH Original Height\n     * @param {Number} dW Destination Width\n     * @param {Number} dH Destination Height\n     * @returns {ImageData}\n     */\n    bilinearFiltering: function(options, oW, oH, dW, dH) {\n      var a, b, c, d, x, y, i, j, xDiff, yDiff, chnl,\n          color, offset = 0, origPix, ratioX = this.rcpScaleX,\n          ratioY = this.rcpScaleY,\n          w4 = 4 * (oW - 1), img = options.imageData,\n          pixels = img.data, destImage = options.ctx.createImageData(dW, dH),\n          destPixels = destImage.data;\n      for (i = 0; i < dH; i++) {\n        for (j = 0; j < dW; j++) {\n          x = floor(ratioX * j);\n          y = floor(ratioY * i);\n          xDiff = ratioX * j - x;\n          yDiff = ratioY * i - y;\n          origPix = 4 * (y * oW + x);\n\n          for (chnl = 0; chnl < 4; chnl++) {\n            a = pixels[origPix + chnl];\n            b = pixels[origPix + 4 + chnl];\n            c = pixels[origPix + w4 + chnl];\n            d = pixels[origPix + w4 + 4 + chnl];\n            color = a * (1 - xDiff) * (1 - yDiff) + b * xDiff * (1 - yDiff) +\n                    c * yDiff * (1 - xDiff) + d * xDiff * yDiff;\n            destPixels[offset++] = color;\n          }\n        }\n      }\n      return destImage;\n    },\n\n    /**\n     * hermiteFastResize\n     * @param {Object} canvasEl Canvas element to apply filter to\n     * @param {Number} oW Original Width\n     * @param {Number} oH Original Height\n     * @param {Number} dW Destination Width\n     * @param {Number} dH Destination Height\n     * @returns {ImageData}\n     */\n    hermiteFastResize: function(options, oW, oH, dW, dH) {\n      var ratioW = this.rcpScaleX, ratioH = this.rcpScaleY,\n          ratioWHalf = ceil(ratioW / 2),\n          ratioHHalf = ceil(ratioH / 2),\n          img = options.imageData, data = img.data,\n          img2 = options.ctx.createImageData(dW, dH), data2 = img2.data;\n      for (var j = 0; j < dH; j++) {\n        for (var i = 0; i < dW; i++) {\n          var x2 = (i + j * dW) * 4, weight = 0, weights = 0, weightsAlpha = 0,\n              gxR = 0, gxG = 0, gxB = 0, gxA = 0, centerY = (j + 0.5) * ratioH;\n          for (var yy = floor(j * ratioH); yy < (j + 1) * ratioH; yy++) {\n            var dy = abs(centerY - (yy + 0.5)) / ratioHHalf,\n                centerX = (i + 0.5) * ratioW, w0 = dy * dy;\n            for (var xx = floor(i * ratioW); xx < (i + 1) * ratioW; xx++) {\n              var dx = abs(centerX - (xx + 0.5)) / ratioWHalf,\n                  w = sqrt(w0 + dx * dx);\n              /* eslint-disable max-depth */\n              if (w > 1 && w < -1) {\n                continue;\n              }\n              //hermite filter\n              weight = 2 * w * w * w - 3 * w * w + 1;\n              if (weight > 0) {\n                dx = 4 * (xx + yy * oW);\n                //alpha\n                gxA += weight * data[dx + 3];\n                weightsAlpha += weight;\n                //colors\n                if (data[dx + 3] < 255) {\n                  weight = weight * data[dx + 3] / 250;\n                }\n                gxR += weight * data[dx];\n                gxG += weight * data[dx + 1];\n                gxB += weight * data[dx + 2];\n                weights += weight;\n              }\n              /* eslint-enable max-depth */\n            }\n          }\n          data2[x2] = gxR / weights;\n          data2[x2 + 1] = gxG / weights;\n          data2[x2 + 2] = gxB / weights;\n          data2[x2 + 3] = gxA / weightsAlpha;\n        }\n      }\n      return img2;\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function() {\n      return {\n        type: this.type,\n        scaleX: this.scaleX,\n        scaleY: this.scaleY,\n        resizeType: this.resizeType,\n        lanczosLobes: this.lanczosLobes\n      };\n    }\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Resize} Instance of fabric.Image.filters.Resize\n   */\n  fabric.Image.filters.Resize.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Contrast filter class\n   * @class fabric.Image.filters.Contrast\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Contrast#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Contrast({\n   *   contrast: 0.25\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.Contrast = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Contrast.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Contrast',\n\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform float uContrast;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n        'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n        'float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\\n' +\n        'color.rgb = contrastF * (color.rgb - 0.5) + 0.5;\\n' +\n        'gl_FragColor = color;\\n' +\n      '}',\n\n    /**\n     * contrast value, range from -1 to 1.\n     * @param {Number} contrast\n     * @default 0\n     */\n    contrast: 0,\n\n    mainParameter: 'contrast',\n\n    /**\n     * Constructor\n     * @memberOf fabric.Image.filters.Contrast.prototype\n     * @param {Object} [options] Options object\n     * @param {Number} [options.contrast=0] Value to contrast the image up (-1...1)\n     */\n\n    /**\n      * Apply the Contrast operation to a Uint8Array representing the pixels of an image.\n      *\n      * @param {Object} options\n      * @param {ImageData} options.imageData The Uint8Array to be filtered.\n      */\n    applyTo2d: function(options) {\n      if (this.contrast === 0) {\n        return;\n      }\n      var imageData = options.imageData, i, len,\n          data = imageData.data, len = data.length,\n          contrast = Math.floor(this.contrast * 255),\n          contrastF = 259 * (contrast + 255) / (255 * (259 - contrast));\n\n      for (i = 0; i < len; i += 4) {\n        data[i] = contrastF * (data[i] - 128) + 128;\n        data[i + 1] = contrastF * (data[i + 1] - 128) + 128;\n        data[i + 2] = contrastF * (data[i + 2] - 128) + 128;\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uContrast: gl.getUniformLocation(program, 'uContrast'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform1f(uniformLocations.uContrast, this.contrast);\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Contrast} Instance of fabric.Image.filters.Contrast\n   */\n  fabric.Image.filters.Contrast.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Saturate filter class\n   * @class fabric.Image.filters.Saturation\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Saturation#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Saturation({\n   *   saturation: 1\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.Saturation = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Saturation.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Saturation',\n\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform float uSaturation;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n        'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n        'float rgMax = max(color.r, color.g);\\n' +\n        'float rgbMax = max(rgMax, color.b);\\n' +\n        'color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\\n' +\n        'color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\\n' +\n        'color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\\n' +\n        'gl_FragColor = color;\\n' +\n      '}',\n\n    /**\n     * Saturation value, from -1 to 1.\n     * Increases/decreases the color saturation.\n     * A value of 0 has no effect.\n     * \n     * @param {Number} saturation\n     * @default\n     */\n    saturation: 0,\n\n    mainParameter: 'saturation',\n\n    /**\n     * Constructor\n     * @memberOf fabric.Image.filters.Saturate.prototype\n     * @param {Object} [options] Options object\n     * @param {Number} [options.saturate=0] Value to saturate the image (-1...1)\n     */\n\n    /**\n     * Apply the Saturation operation to a Uint8ClampedArray representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n     */\n    applyTo2d: function(options) {\n      if (this.saturation === 0) {\n        return;\n      }\n      var imageData = options.imageData,\n          data = imageData.data, len = data.length,\n          adjust = -this.saturation, i, max;\n\n      for (i = 0; i < len; i += 4) {\n        max = Math.max(data[i], data[i + 1], data[i + 2]);\n        data[i] += max !== data[i] ? (max - data[i]) * adjust : 0;\n        data[i + 1] += max !== data[i + 1] ? (max - data[i + 1]) * adjust : 0;\n        data[i + 2] += max !== data[i + 2] ? (max - data[i + 2]) * adjust : 0;\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uSaturation: gl.getUniformLocation(program, 'uSaturation'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform1f(uniformLocations.uSaturation, -this.saturation);\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Saturation} Instance of fabric.Image.filters.Saturate\n   */\n  fabric.Image.filters.Saturation.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Vibrance filter class\n   * @class fabric.Image.filters.Vibrance\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Vibrance#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Vibrance({\n   *   vibrance: 1\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.Vibrance = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Vibrance.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Vibrance',\n\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform float uVibrance;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n        'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n        'float max = max(color.r, max(color.g, color.b));\\n' +\n        'float avg = (color.r + color.g + color.b) / 3.0;\\n' +\n        'float amt = (abs(max - avg) * 2.0) * uVibrance;\\n' +\n        'color.r += max != color.r ? (max - color.r) * amt : 0.00;\\n' +\n        'color.g += max != color.g ? (max - color.g) * amt : 0.00;\\n' +\n        'color.b += max != color.b ? (max - color.b) * amt : 0.00;\\n' +\n        'gl_FragColor = color;\\n' +\n      '}',\n\n    /**\n     * Vibrance value, from -1 to 1.\n     * Increases/decreases the saturation of more muted colors with less effect on saturated colors.\n     * A value of 0 has no effect.\n     * \n     * @param {Number} vibrance\n     * @default\n     */\n    vibrance: 0,\n\n    mainParameter: 'vibrance',\n\n    /**\n     * Constructor\n     * @memberOf fabric.Image.filters.Vibrance.prototype\n     * @param {Object} [options] Options object\n     * @param {Number} [options.vibrance=0] Vibrance value for the image (between -1 and 1)\n     */\n\n    /**\n     * Apply the Vibrance operation to a Uint8ClampedArray representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8ClampedArray to be filtered.\n     */\n    applyTo2d: function(options) {\n      if (this.vibrance === 0) {\n        return;\n      }\n      var imageData = options.imageData,\n          data = imageData.data, len = data.length,\n          adjust = -this.vibrance, i, max, avg, amt;\n\n      for (i = 0; i < len; i += 4) {\n        max = Math.max(data[i], data[i + 1], data[i + 2]);\n        avg = (data[i] + data[i + 1] + data[i + 2]) / 3;\n        amt = ((Math.abs(max - avg) * 2 / 255) * adjust);\n        data[i] += max !== data[i] ? (max - data[i]) * amt : 0;\n        data[i + 1] += max !== data[i + 1] ? (max - data[i + 1]) * amt : 0;\n        data[i + 2] += max !== data[i + 2] ? (max - data[i + 2]) * amt : 0;\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uVibrance: gl.getUniformLocation(program, 'uVibrance'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform1f(uniformLocations.uVibrance, -this.vibrance);\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Vibrance} Instance of fabric.Image.filters.Vibrance\n   */\n  fabric.Image.filters.Vibrance.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Blur filter class\n   * @class fabric.Image.filters.Blur\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Blur#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Blur({\n   *   blur: 0.5\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   * canvas.renderAll();\n   */\n  filters.Blur = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Blur.prototype */ {\n\n    type: 'Blur',\n\n    /*\n'gl_FragColor = vec4(0.0);',\n'gl_FragColor += texture2D(texture, vTexCoord + -7 * uDelta)*0.0044299121055113265;',\n'gl_FragColor += texture2D(texture, vTexCoord + -6 * uDelta)*0.00895781211794;',\n'gl_FragColor += texture2D(texture, vTexCoord + -5 * uDelta)*0.0215963866053;',\n'gl_FragColor += texture2D(texture, vTexCoord + -4 * uDelta)*0.0443683338718;',\n'gl_FragColor += texture2D(texture, vTexCoord + -3 * uDelta)*0.0776744219933;',\n'gl_FragColor += texture2D(texture, vTexCoord + -2 * uDelta)*0.115876621105;',\n'gl_FragColor += texture2D(texture, vTexCoord + -1 * uDelta)*0.147308056121;',\n'gl_FragColor += texture2D(texture, vTexCoord              )*0.159576912161;',\n'gl_FragColor += texture2D(texture, vTexCoord + 1 * uDelta)*0.147308056121;',\n'gl_FragColor += texture2D(texture, vTexCoord + 2 * uDelta)*0.115876621105;',\n'gl_FragColor += texture2D(texture, vTexCoord + 3 * uDelta)*0.0776744219933;',\n'gl_FragColor += texture2D(texture, vTexCoord + 4 * uDelta)*0.0443683338718;',\n'gl_FragColor += texture2D(texture, vTexCoord + 5 * uDelta)*0.0215963866053;',\n'gl_FragColor += texture2D(texture, vTexCoord + 6 * uDelta)*0.00895781211794;',\n'gl_FragColor += texture2D(texture, vTexCoord + 7 * uDelta)*0.0044299121055113265;',\n*/\n\n    /* eslint-disable max-len */\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform vec2 uDelta;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'const float nSamples = 15.0;\\n' +\n      'vec3 v3offset = vec3(12.9898, 78.233, 151.7182);\\n' +\n      'float random(vec3 scale) {\\n' +\n        /* use the fragment position for a different seed per-pixel */\n        'return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\\n' +\n      '}\\n' +\n      'void main() {\\n' +\n        'vec4 color = vec4(0.0);\\n' +\n        'float total = 0.0;\\n' +\n        'float offset = random(v3offset);\\n' +\n        'for (float t = -nSamples; t <= nSamples; t++) {\\n' +\n          'float percent = (t + offset - 0.5) / nSamples;\\n' +\n          'float weight = 1.0 - abs(percent);\\n' +\n          'color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\\n' +\n          'total += weight;\\n' +\n        '}\\n' +\n        'gl_FragColor = color / total;\\n' +\n      '}',\n    /* eslint-enable max-len */\n\n    /**\n     * blur value, in percentage of image dimensions.\n     * specific to keep the image blur constant at different resolutions\n     * range between 0 and 1.\n     * @type Number\n     * @default\n     */\n    blur: 0,\n\n    mainParameter: 'blur',\n\n    applyTo: function(options) {\n      if (options.webgl) {\n        // this aspectRatio is used to give the same blur to vertical and horizontal\n        this.aspectRatio = options.sourceWidth / options.sourceHeight;\n        options.passes++;\n        this._setupFrameBuffer(options);\n        this.horizontal = true;\n        this.applyToWebGL(options);\n        this._swapTextures(options);\n        this._setupFrameBuffer(options);\n        this.horizontal = false;\n        this.applyToWebGL(options);\n        this._swapTextures(options);\n      }\n      else {\n        this.applyTo2d(options);\n      }\n    },\n\n    applyTo2d: function(options) {\n      // paint canvasEl with current image data.\n      //options.ctx.putImageData(options.imageData, 0, 0);\n      options.imageData = this.simpleBlur(options);\n    },\n\n    simpleBlur: function(options) {\n      var resources = options.filterBackend.resources, canvas1, canvas2,\n          width = options.imageData.width,\n          height = options.imageData.height;\n\n      if (!resources.blurLayer1) {\n        resources.blurLayer1 = fabric.util.createCanvasElement();\n        resources.blurLayer2 = fabric.util.createCanvasElement();\n      }\n      canvas1 = resources.blurLayer1;\n      canvas2 = resources.blurLayer2;\n      if (canvas1.width !== width || canvas1.height !== height) {\n        canvas2.width = canvas1.width = width;\n        canvas2.height = canvas1.height = height;\n      }\n      var ctx1 = canvas1.getContext('2d'),\n          ctx2 = canvas2.getContext('2d'),\n          nSamples = 15,\n          random, percent, j, i,\n          blur = this.blur * 0.06 * 0.5;\n\n      // load first canvas\n      ctx1.putImageData(options.imageData, 0, 0);\n      ctx2.clearRect(0, 0, width, height);\n\n      for (i = -nSamples; i <= nSamples; i++) {\n        random = (Math.random() - 0.5) / 4;\n        percent = i / nSamples;\n        j = blur * percent * width + random;\n        ctx2.globalAlpha = 1 - Math.abs(percent);\n        ctx2.drawImage(canvas1, j, random);\n        ctx1.drawImage(canvas2, 0, 0);\n        ctx2.globalAlpha = 1;\n        ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n      }\n      for (i = -nSamples; i <= nSamples; i++) {\n        random = (Math.random() - 0.5) / 4;\n        percent = i / nSamples;\n        j = blur * percent * height + random;\n        ctx2.globalAlpha = 1 - Math.abs(percent);\n        ctx2.drawImage(canvas1, random, j);\n        ctx1.drawImage(canvas2, 0, 0);\n        ctx2.globalAlpha = 1;\n        ctx2.clearRect(0, 0, canvas2.width, canvas2.height);\n      }\n      options.ctx.drawImage(canvas1, 0, 0);\n      var newImageData = options.ctx.getImageData(0, 0, canvas1.width, canvas1.height);\n      ctx1.globalAlpha = 1;\n      ctx1.clearRect(0, 0, canvas1.width, canvas1.height);\n      return newImageData;\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        delta: gl.getUniformLocation(program, 'uDelta'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      var delta = this.chooseRightDelta();\n      gl.uniform2fv(uniformLocations.delta, delta);\n    },\n\n    /**\n     * choose right value of image percentage to blur with\n     * @returns {Array} a numeric array with delta values\n     */\n    chooseRightDelta: function() {\n      var blurScale = 1, delta = [0, 0], blur;\n      if (this.horizontal) {\n        if (this.aspectRatio > 1) {\n          // image is wide, i want to shrink radius horizontal\n          blurScale = 1 / this.aspectRatio;\n        }\n      }\n      else {\n        if (this.aspectRatio < 1) {\n          // image is tall, i want to shrink radius vertical\n          blurScale = this.aspectRatio;\n        }\n      }\n      blur = blurScale * this.blur * 0.12;\n      if (this.horizontal) {\n        delta[0] = blur;\n      }\n      else {\n        delta[1] = blur;\n      }\n      return delta;\n    },\n  });\n\n  /**\n   * Deserialize a JSON definition of a BlurFilter into a concrete instance.\n   */\n  filters.Blur.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * Gamma filter class\n   * @class fabric.Image.filters.Gamma\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.Gamma#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.Gamma({\n   *   gamma: [1, 0.5, 2.1]\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.Gamma = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Gamma.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'Gamma',\n\n    fragmentSource: 'precision highp float;\\n' +\n      'uniform sampler2D uTexture;\\n' +\n      'uniform vec3 uGamma;\\n' +\n      'varying vec2 vTexCoord;\\n' +\n      'void main() {\\n' +\n        'vec4 color = texture2D(uTexture, vTexCoord);\\n' +\n        'vec3 correction = (1.0 / uGamma);\\n' +\n        'color.r = pow(color.r, correction.r);\\n' +\n        'color.g = pow(color.g, correction.g);\\n' +\n        'color.b = pow(color.b, correction.b);\\n' +\n        'gl_FragColor = color;\\n' +\n        'gl_FragColor.rgb *= color.a;\\n' +\n      '}',\n\n    /**\n     * Gamma array value, from 0.01 to 2.2.\n     * @param {Array} gamma\n     * @default\n     */\n    gamma: [1, 1, 1],\n\n    /**\n     * Describe the property that is the filter parameter\n     * @param {String} m\n     * @default\n     */\n    mainParameter: 'gamma',\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     */\n    initialize: function(options) {\n      this.gamma = [1, 1, 1];\n      filters.BaseFilter.prototype.initialize.call(this, options);\n    },\n\n    /**\n     * Apply the Gamma operation to a Uint8Array representing the pixels of an image.\n     *\n     * @param {Object} options\n     * @param {ImageData} options.imageData The Uint8Array to be filtered.\n     */\n    applyTo2d: function(options) {\n      var imageData = options.imageData, data = imageData.data,\n          gamma = this.gamma, len = data.length,\n          rInv = 1 / gamma[0], gInv = 1 / gamma[1],\n          bInv = 1 / gamma[2], i;\n\n      if (!this.rVals) {\n        // eslint-disable-next-line\n        this.rVals = new Uint8Array(256);\n        // eslint-disable-next-line\n        this.gVals = new Uint8Array(256);\n        // eslint-disable-next-line\n        this.bVals = new Uint8Array(256);\n      }\n\n      // This is an optimization - pre-compute a look-up table for each color channel\n      // instead of performing these pow calls for each pixel in the image.\n      for (i = 0, len = 256; i < len; i++) {\n        this.rVals[i] = Math.pow(i / 255, rInv) * 255;\n        this.gVals[i] = Math.pow(i / 255, gInv) * 255;\n        this.bVals[i] = Math.pow(i / 255, bInv) * 255;\n      }\n      for (i = 0, len = data.length; i < len; i += 4) {\n        data[i] = this.rVals[data[i]];\n        data[i + 1] = this.gVals[data[i + 1]];\n        data[i + 2] = this.bVals[data[i + 2]];\n      }\n    },\n\n    /**\n     * Return WebGL uniform locations for this filter's shader.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {WebGLShaderProgram} program This filter's compiled shader program.\n     */\n    getUniformLocations: function(gl, program) {\n      return {\n        uGamma: gl.getUniformLocation(program, 'uGamma'),\n      };\n    },\n\n    /**\n     * Send data from this filter to its shader program's uniforms.\n     *\n     * @param {WebGLRenderingContext} gl The GL canvas context used to compile this filter's shader.\n     * @param {Object} uniformLocations A map of string uniform names to WebGLUniformLocation objects\n     */\n    sendUniformData: function(gl, uniformLocations) {\n      gl.uniform3fv(uniformLocations.uGamma, this.gamma);\n    },\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.Gamma} Instance of fabric.Image.filters.Gamma\n   */\n  fabric.Image.filters.Gamma.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * A container class that knows how to apply a sequence of filters to an input image.\n   */\n  filters.Composed = createClass(filters.BaseFilter, /** @lends fabric.Image.filters.Composed.prototype */ {\n\n    type: 'Composed',\n\n    /**\n     * A non sparse array of filters to apply\n     */\n    subFilters: [],\n\n    /**\n     * Constructor\n     * @param {Object} [options] Options object\n     */\n    initialize: function(options) {\n      this.callSuper('initialize', options);\n      // create a new array instead mutating the prototype with push\n      this.subFilters = this.subFilters.slice(0);\n    },\n\n    /**\n     * Apply this container's filters to the input image provided.\n     *\n     * @param {Object} options\n     * @param {Number} options.passes The number of filters remaining to be applied.\n     */\n    applyTo: function(options) {\n      options.passes += this.subFilters.length - 1;\n      this.subFilters.forEach(function(filter) {\n        filter.applyTo(options);\n      });\n    },\n\n    /**\n     * Serialize this filter into JSON.\n     *\n     * @returns {Object} A JSON representation of this filter.\n     */\n    toObject: function() {\n      return fabric.util.object.extend(this.callSuper('toObject'), {\n        subFilters: this.subFilters.map(function(filter) { return filter.toObject(); }),\n      });\n    },\n\n    isNeutralState: function() {\n      return !this.subFilters.some(function(filter) { return !filter.isNeutralState(); });\n    }\n  });\n\n  /**\n   * Deserialize a JSON definition of a ComposedFilter into a concrete instance.\n   */\n  fabric.Image.filters.Composed.fromObject = function(object, callback) {\n    var filters = object.subFilters || [],\n        subFilters = filters.map(function(filter) {\n          return new fabric.Image.filters[filter.type](filter);\n        }),\n        instance = new fabric.Image.filters.Composed({ subFilters: subFilters });\n    callback && callback(instance);\n    return instance;\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric  = global.fabric || (global.fabric = { }),\n      filters = fabric.Image.filters,\n      createClass = fabric.util.createClass;\n\n  /**\n   * HueRotation filter class\n   * @class fabric.Image.filters.HueRotation\n   * @memberOf fabric.Image.filters\n   * @extends fabric.Image.filters.BaseFilter\n   * @see {@link fabric.Image.filters.HueRotation#initialize} for constructor definition\n   * @see {@link http://fabricjs.com/image-filters|ImageFilters demo}\n   * @example\n   * var filter = new fabric.Image.filters.HueRotation({\n   *   rotation: -0.5\n   * });\n   * object.filters.push(filter);\n   * object.applyFilters();\n   */\n  filters.HueRotation = createClass(filters.ColorMatrix, /** @lends fabric.Image.filters.HueRotation.prototype */ {\n\n    /**\n     * Filter type\n     * @param {String} type\n     * @default\n     */\n    type: 'HueRotation',\n\n    /**\n     * HueRotation value, from -1 to 1.\n     * the unit is radians\n     * @param {Number} myParameter\n     * @default\n     */\n    rotation: 0,\n\n    /**\n     * Describe the property that is the filter parameter\n     * @param {String} m\n     * @default\n     */\n    mainParameter: 'rotation',\n\n    calculateMatrix: function() {\n      var rad = this.rotation * Math.PI, cos = fabric.util.cos(rad), sin = fabric.util.sin(rad),\n          aThird = 1 / 3, aThirdSqtSin = Math.sqrt(aThird) * sin, OneMinusCos = 1 - cos;\n      this.matrix = [\n        1, 0, 0, 0, 0,\n        0, 1, 0, 0, 0,\n        0, 0, 1, 0, 0,\n        0, 0, 0, 1, 0\n      ];\n      this.matrix[0] = cos + OneMinusCos / 3;\n      this.matrix[1] = aThird * OneMinusCos - aThirdSqtSin;\n      this.matrix[2] = aThird * OneMinusCos + aThirdSqtSin;\n      this.matrix[5] = aThird * OneMinusCos + aThirdSqtSin;\n      this.matrix[6] = cos + aThird * OneMinusCos;\n      this.matrix[7] = aThird * OneMinusCos - aThirdSqtSin;\n      this.matrix[10] = aThird * OneMinusCos - aThirdSqtSin;\n      this.matrix[11] = aThird * OneMinusCos + aThirdSqtSin;\n      this.matrix[12] = cos + aThird * OneMinusCos;\n    },\n\n    /**\n     * HueRotation isNeutralState implementation\n     * Used only in image applyFilters to discard filters that will not have an effect\n     * on the image\n     * @param {Object} options\n     **/\n    isNeutralState: function(options) {\n      this.calculateMatrix();\n      return filters.BaseFilter.prototype.isNeutralState.call(this, options);\n    },\n\n    /**\n     * Apply this filter to the input image data provided.\n     *\n     * Determines whether to use WebGL or Canvas2D based on the options.webgl flag.\n     *\n     * @param {Object} options\n     * @param {Number} options.passes The number of filters remaining to be executed\n     * @param {Boolean} options.webgl Whether to use webgl to render the filter.\n     * @param {WebGLTexture} options.sourceTexture The texture setup as the source to be filtered.\n     * @param {WebGLTexture} options.targetTexture The texture where filtered output should be drawn.\n     * @param {WebGLRenderingContext} options.context The GL context used for rendering.\n     * @param {Object} options.programCache A map of compiled shader programs, keyed by filter type.\n     */\n    applyTo: function(options) {\n      this.calculateMatrix();\n      filters.BaseFilter.prototype.applyTo.call(this, options);\n    },\n\n  });\n\n  /**\n   * Returns filter instance from an object representation\n   * @static\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] to be invoked after filter creation\n   * @return {fabric.Image.filters.HueRotation} Instance of fabric.Image.filters.HueRotation\n   */\n  fabric.Image.filters.HueRotation.fromObject = fabric.Image.filters.BaseFilter.fromObject;\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = { }),\n      clone = fabric.util.object.clone;\n\n  if (fabric.Text) {\n    fabric.warn('fabric.Text is already defined');\n    return;\n  }\n\n  var additionalProps =\n    ('fontFamily fontWeight fontSize text underline overline linethrough' +\n    ' textAlign fontStyle lineHeight textBackgroundColor charSpacing styles' +\n    ' direction path pathStartOffset pathSide pathAlign').split(' ');\n\n  /**\n   * Text class\n   * @class fabric.Text\n   * @extends fabric.Object\n   * @return {fabric.Text} thisArg\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2#text}\n   * @see {@link fabric.Text#initialize} for constructor definition\n   */\n  fabric.Text = fabric.util.createClass(fabric.Object, /** @lends fabric.Text.prototype */ {\n\n    /**\n     * Properties which when set cause object to change dimensions\n     * @type Array\n     * @private\n     */\n    _dimensionAffectingProps: [\n      'fontSize',\n      'fontWeight',\n      'fontFamily',\n      'fontStyle',\n      'lineHeight',\n      'text',\n      'charSpacing',\n      'textAlign',\n      'styles',\n      'path',\n      'pathStartOffset',\n      'pathSide',\n      'pathAlign'\n    ],\n\n    /**\n     * @private\n     */\n    _reNewline: /\\r?\\n/,\n\n    /**\n     * Use this regular expression to filter for whitespaces that is not a new line.\n     * Mostly used when text is 'justify' aligned.\n     * @private\n     */\n    _reSpacesAndTabs: /[ \\t\\r]/g,\n\n    /**\n     * Use this regular expression to filter for whitespace that is not a new line.\n     * Mostly used when text is 'justify' aligned.\n     * @private\n     */\n    _reSpaceAndTab: /[ \\t\\r]/,\n\n    /**\n     * Use this regular expression to filter consecutive groups of non spaces.\n     * Mostly used when text is 'justify' aligned.\n     * @private\n     */\n    _reWords: /\\S+/g,\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type:                 'text',\n\n    /**\n     * Font size (in pixels)\n     * @type Number\n     * @default\n     */\n    fontSize:             40,\n\n    /**\n     * Font weight (e.g. bold, normal, 400, 600, 800)\n     * @type {(Number|String)}\n     * @default\n     */\n    fontWeight:           'normal',\n\n    /**\n     * Font family\n     * @type String\n     * @default\n     */\n    fontFamily:           'Times New Roman',\n\n    /**\n     * Text decoration underline.\n     * @type Boolean\n     * @default\n     */\n    underline:       false,\n\n    /**\n     * Text decoration overline.\n     * @type Boolean\n     * @default\n     */\n    overline:       false,\n\n    /**\n     * Text decoration linethrough.\n     * @type Boolean\n     * @default\n     */\n    linethrough:       false,\n\n    /**\n     * Text alignment. Possible values: \"left\", \"center\", \"right\", \"justify\",\n     * \"justify-left\", \"justify-center\" or \"justify-right\".\n     * @type String\n     * @default\n     */\n    textAlign:            'left',\n\n    /**\n     * Font style . Possible values: \"\", \"normal\", \"italic\" or \"oblique\".\n     * @type String\n     * @default\n     */\n    fontStyle:            'normal',\n\n    /**\n     * Line height\n     * @type Number\n     * @default\n     */\n    lineHeight:           1.16,\n\n    /**\n     * Superscript schema object (minimum overlap)\n     * @type {Object}\n     * @default\n     */\n    superscript: {\n      size:      0.60, // fontSize factor\n      baseline: -0.35  // baseline-shift factor (upwards)\n    },\n\n    /**\n     * Subscript schema object (minimum overlap)\n     * @type {Object}\n     * @default\n     */\n    subscript: {\n      size:      0.60, // fontSize factor\n      baseline:  0.11  // baseline-shift factor (downwards)\n    },\n\n    /**\n     * Background color of text lines\n     * @type String\n     * @default\n     */\n    textBackgroundColor:  '',\n\n    /**\n     * List of properties to consider when checking if\n     * state of an object is changed ({@link fabric.Object#hasStateChanged})\n     * as well as for history (undo/redo) purposes\n     * @type Array\n     */\n    stateProperties: fabric.Object.prototype.stateProperties.concat(additionalProps),\n\n    /**\n     * List of properties to consider when checking if cache needs refresh\n     * @type Array\n     */\n    cacheProperties: fabric.Object.prototype.cacheProperties.concat(additionalProps),\n\n    /**\n     * When defined, an object is rendered via stroke and this property specifies its color.\n     * <b>Backwards incompatibility note:</b> This property was named \"strokeStyle\" until v1.1.6\n     * @type String\n     * @default\n     */\n    stroke:               null,\n\n    /**\n     * Shadow object representing shadow of this shape.\n     * <b>Backwards incompatibility note:</b> This property was named \"textShadow\" (String) until v1.2.11\n     * @type fabric.Shadow\n     * @default\n     */\n    shadow:               null,\n\n    /**\n     * fabric.Path that the text should follow.\n     * since 4.6.0 the path will be drawn automatically.\n     * if you want to make the path visible, give it a stroke and strokeWidth or fill value\n     * if you want it to be hidden, assign visible = false to the path.\n     * This feature is in BETA, and SVG import/export is not yet supported.\n     * @type fabric.Path\n     * @example\n     * var textPath = new fabric.Text('Text on a path', {\n     *     top: 150,\n     *     left: 150,\n     *     textAlign: 'center',\n     *     charSpacing: -50,\n     *     path: new fabric.Path('M 0 0 C 50 -100 150 -100 200 0', {\n     *         strokeWidth: 1,\n     *         visible: false\n     *     }),\n     *     pathSide: 'left',\n     *     pathStartOffset: 0\n     * });\n     * @default\n     */\n    path:               null,\n\n    /**\n     * Offset amount for text path starting position\n     * Only used when text has a path\n     * @type Number\n     * @default\n     */\n    pathStartOffset:               0,\n\n    /**\n     * Which side of the path the text should be drawn on.\n     * Only used when text has a path\n     * @type {String} 'left|right'\n     * @default\n     */\n    pathSide:               'left',\n\n    /**\n     * How text is aligned to the path. This property determines\n     * the perpendicular position of each character relative to the path.\n     * (one of \"baseline\", \"center\", \"ascender\", \"descender\")\n     * This feature is in BETA, and its behavior may change\n     * @type String\n     * @default\n     */\n    pathAlign:               'baseline',\n\n    /**\n     * @private\n     */\n    _fontSizeFraction: 0.222,\n\n    /**\n     * @private\n     */\n    offsets: {\n      underline: 0.10,\n      linethrough: -0.315,\n      overline: -0.88\n    },\n\n    /**\n     * Text Line proportion to font Size (in pixels)\n     * @type Number\n     * @default\n     */\n    _fontSizeMult:             1.13,\n\n    /**\n     * additional space between characters\n     * expressed in thousands of em unit\n     * @type Number\n     * @default\n     */\n    charSpacing:             0,\n\n    /**\n     * Object containing character styles - top-level properties -> line numbers,\n     * 2nd-level properties - character numbers\n     * @type Object\n     * @default\n     */\n    styles: null,\n\n    /**\n     * Reference to a context to measure text char or couple of chars\n     * the cacheContext of the canvas will be used or a freshly created one if the object is not on canvas\n     * once created it will be referenced on fabric._measuringContext to avoid creating a canvas for every\n     * text object created.\n     * @type {CanvasRenderingContext2D}\n     * @default\n     */\n    _measuringContext: null,\n\n    /**\n     * Baseline shift, styles only, keep at 0 for the main text object\n     * @type {Number}\n     * @default\n     */\n    deltaY: 0,\n\n    /**\n     * WARNING: EXPERIMENTAL. NOT SUPPORTED YET\n     * determine the direction of the text.\n     * This has to be set manually together with textAlign and originX for proper\n     * experience.\n     * some interesting link for the future\n     * https://www.w3.org/International/questions/qa-bidi-unicode-controls\n     * @since 4.5.0\n     * @type {String} 'ltr|rtl'\n     * @default\n     */\n    direction: 'ltr',\n\n    /**\n     * Array of properties that define a style unit (of 'styles').\n     * @type {Array}\n     * @default\n     */\n    _styleProperties: [\n      'stroke',\n      'strokeWidth',\n      'fill',\n      'fontFamily',\n      'fontSize',\n      'fontWeight',\n      'fontStyle',\n      'underline',\n      'overline',\n      'linethrough',\n      'deltaY',\n      'textBackgroundColor',\n    ],\n\n    /**\n     * contains characters bounding boxes\n     */\n    __charBounds: [],\n\n    /**\n     * use this size when measuring text. To avoid IE11 rounding errors\n     * @type {Number}\n     * @default\n     * @readonly\n     * @private\n     */\n    CACHE_FONT_SIZE: 400,\n\n    /**\n     * contains the min text width to avoid getting 0\n     * @type {Number}\n     * @default\n     */\n    MIN_TEXT_WIDTH: 2,\n\n    /**\n     * Constructor\n     * @param {String} text Text string\n     * @param {Object} [options] Options object\n     * @return {fabric.Text} thisArg\n     */\n    initialize: function(text, options) {\n      this.styles = options ? (options.styles || { }) : { };\n      this.text = text;\n      this.__skipDimension = true;\n      this.callSuper('initialize', options);\n      if (this.path) {\n        this.setPathInfo();\n      }\n      this.__skipDimension = false;\n      this.initDimensions();\n      this.setCoords();\n      this.setupState({ propertySet: '_dimensionAffectingProps' });\n    },\n\n    /**\n     * If text has a path, it will add the extra information needed\n     * for path and text calculations\n     * @return {fabric.Text} thisArg\n     */\n    setPathInfo: function() {\n      var path = this.path;\n      if (path) {\n        path.segmentsInfo = fabric.util.getPathSegmentsInfo(path.path);\n      }\n    },\n\n    /**\n     * Return a context for measurement of text string.\n     * if created it gets stored for reuse\n     * this is for internal use, please do not use it\n     * @private\n     * @param {String} text Text string\n     * @param {Object} [options] Options object\n     * @return {fabric.Text} thisArg\n     */\n    getMeasuringContext: function() {\n      // if we did not return we have to measure something.\n      if (!fabric._measuringContext) {\n        fabric._measuringContext = this.canvas && this.canvas.contextCache ||\n          fabric.util.createCanvasElement().getContext('2d');\n      }\n      return fabric._measuringContext;\n    },\n\n    /**\n     * @private\n     * Divides text into lines of text and lines of graphemes.\n     */\n    _splitText: function() {\n      var newLines = this._splitTextIntoLines(this.text);\n      this.textLines = newLines.lines;\n      this._textLines = newLines.graphemeLines;\n      this._unwrappedTextLines = newLines._unwrappedLines;\n      this._text = newLines.graphemeText;\n      return newLines;\n    },\n\n    /**\n     * Initialize or update text dimensions.\n     * Updates this.width and this.height with the proper values.\n     * Does not return dimensions.\n     */\n    initDimensions: function() {\n      if (this.__skipDimension) {\n        return;\n      }\n      this._splitText();\n      this._clearCache();\n      if (this.path) {\n        // Add the space of a line around the path. This is an approximation\n        var additionalWidth = this.getHeightOfLine(0) * 1.1;\n        this.width = this.path.width + additionalWidth;\n        this.height = this.path.height + additionalWidth;\n      }\n      else {\n        this.width = this.calcTextWidth() || this.cursorWidth || this.MIN_TEXT_WIDTH;\n        this.height = this.calcTextHeight();\n      }\n      if (this.textAlign.indexOf('justify') !== -1) {\n        // once text is measured we need to make space fatter to make justified text.\n        this.enlargeSpaces();\n      }\n      this.saveState({ propertySet: '_dimensionAffectingProps' });\n    },\n\n    /**\n     * Enlarge space boxes and shift the others\n     */\n    enlargeSpaces: function() {\n      var diffSpace, currentLineWidth, numberOfSpaces, accumulatedSpace, line, charBound, spaces;\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\n        if (this.textAlign !== 'justify' && (i === len - 1 || this.isEndOfWrapping(i))) {\n          continue;\n        }\n        accumulatedSpace = 0;\n        line = this._textLines[i];\n        currentLineWidth = this.getLineWidth(i);\n        if (currentLineWidth < this.width && (spaces = this.textLines[i].match(this._reSpacesAndTabs))) {\n          numberOfSpaces = spaces.length;\n          diffSpace = (this.width - currentLineWidth) / numberOfSpaces;\n          for (var j = 0, jlen = line.length; j <= jlen; j++) {\n            charBound = this.__charBounds[i][j];\n            if (this._reSpaceAndTab.test(line[j])) {\n              charBound.width += diffSpace;\n              charBound.kernedWidth += diffSpace;\n              charBound.left += accumulatedSpace;\n              accumulatedSpace += diffSpace;\n            }\n            else {\n              charBound.left += accumulatedSpace;\n            }\n          }\n        }\n      }\n    },\n\n    /**\n     * Detect if the text line is ended with an hard break\n     * text and itext do not have wrapping, return false\n     * @return {Boolean}\n     */\n    isEndOfWrapping: function(lineIndex) {\n      return lineIndex === this._textLines.length - 1;\n    },\n\n    /**\n     * Detect if a line has a linebreak and so we need to account for it when moving\n     * and counting style.\n     * It return always for text and Itext.\n     * @return Number\n     */\n    missingNewlineOffset: function() {\n      return 1;\n    },\n\n    /**\n     * Returns string representation of an instance\n     * @return {String} String representation of text object\n     */\n    toString: function() {\n      return '#<fabric.Text (' + this.complexity() +\n        '): { \"text\": \"' + this.text + '\", \"fontFamily\": \"' + this.fontFamily + '\" }>';\n    },\n\n    /**\n     * Return the dimension and the zoom level needed to create a cache canvas\n     * big enough to host the object to be cached.\n     * @private\n     * @param {Object} dim.x width of object to be cached\n     * @param {Object} dim.y height of object to be cached\n     * @return {Object}.width width of canvas\n     * @return {Object}.height height of canvas\n     * @return {Object}.zoomX zoomX zoom value to unscale the canvas before drawing cache\n     * @return {Object}.zoomY zoomY zoom value to unscale the canvas before drawing cache\n     */\n    _getCacheCanvasDimensions: function() {\n      var dims = this.callSuper('_getCacheCanvasDimensions');\n      var fontSize = this.fontSize;\n      dims.width += fontSize * dims.zoomX;\n      dims.height += fontSize * dims.zoomY;\n      return dims;\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(ctx) {\n      var path = this.path;\n      path && !path.isNotVisible() && path._render(ctx);\n      this._setTextStyles(ctx);\n      this._renderTextLinesBackground(ctx);\n      this._renderTextDecoration(ctx, 'underline');\n      this._renderText(ctx);\n      this._renderTextDecoration(ctx, 'overline');\n      this._renderTextDecoration(ctx, 'linethrough');\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderText: function(ctx) {\n      if (this.paintFirst === 'stroke') {\n        this._renderTextStroke(ctx);\n        this._renderTextFill(ctx);\n      }\n      else {\n        this._renderTextFill(ctx);\n        this._renderTextStroke(ctx);\n      }\n    },\n\n    /**\n     * Set the font parameter of the context with the object properties or with charStyle\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {Object} [charStyle] object with font style properties\n     * @param {String} [charStyle.fontFamily] Font Family\n     * @param {Number} [charStyle.fontSize] Font size in pixels. ( without px suffix )\n     * @param {String} [charStyle.fontWeight] Font weight\n     * @param {String} [charStyle.fontStyle] Font style (italic|normal)\n     */\n    _setTextStyles: function(ctx, charStyle, forMeasuring) {\n      ctx.textBaseline = 'alphabetical';\n      if (this.path) {\n        switch (this.pathAlign) {\n          case 'center':\n            ctx.textBaseline = 'middle';\n            break;\n          case 'ascender':\n            ctx.textBaseline = 'top';\n            break;\n          case 'descender':\n            ctx.textBaseline = 'bottom';\n            break;\n        }\n      }\n      ctx.font = this._getFontDeclaration(charStyle, forMeasuring);\n    },\n\n    /**\n     * calculate and return the text Width measuring each line.\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @return {Number} Maximum width of fabric.Text object\n     */\n    calcTextWidth: function() {\n      var maxWidth = this.getLineWidth(0);\n\n      for (var i = 1, len = this._textLines.length; i < len; i++) {\n        var currentLineWidth = this.getLineWidth(i);\n        if (currentLineWidth > maxWidth) {\n          maxWidth = currentLineWidth;\n        }\n      }\n      return maxWidth;\n    },\n\n    /**\n     * @private\n     * @param {String} method Method name (\"fillText\" or \"strokeText\")\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {String} line Text to render\n     * @param {Number} left Left position of text\n     * @param {Number} top Top position of text\n     * @param {Number} lineIndex Index of a line in a text\n     */\n    _renderTextLine: function(method, ctx, line, left, top, lineIndex) {\n      this._renderChars(method, ctx, line, left, top, lineIndex);\n    },\n\n    /**\n     * Renders the text background for lines, taking care of style\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderTextLinesBackground: function(ctx) {\n      if (!this.textBackgroundColor && !this.styleHas('textBackgroundColor')) {\n        return;\n      }\n      var heightOfLine,\n          lineLeftOffset, originalFill = ctx.fillStyle,\n          line, lastColor,\n          leftOffset = this._getLeftOffset(),\n          lineTopOffset = this._getTopOffset(),\n          boxStart = 0, boxWidth = 0, charBox, currentColor, path = this.path,\n          drawStart;\n\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\n        heightOfLine = this.getHeightOfLine(i);\n        if (!this.textBackgroundColor && !this.styleHas('textBackgroundColor', i)) {\n          lineTopOffset += heightOfLine;\n          continue;\n        }\n        line = this._textLines[i];\n        lineLeftOffset = this._getLineLeftOffset(i);\n        boxWidth = 0;\n        boxStart = 0;\n        lastColor = this.getValueOfPropertyAt(i, 0, 'textBackgroundColor');\n        for (var j = 0, jlen = line.length; j < jlen; j++) {\n          charBox = this.__charBounds[i][j];\n          currentColor = this.getValueOfPropertyAt(i, j, 'textBackgroundColor');\n          if (path) {\n            ctx.save();\n            ctx.translate(charBox.renderLeft, charBox.renderTop);\n            ctx.rotate(charBox.angle);\n            ctx.fillStyle = currentColor;\n            currentColor && ctx.fillRect(\n              -charBox.width / 2,\n              -heightOfLine / this.lineHeight * (1 - this._fontSizeFraction),\n              charBox.width,\n              heightOfLine / this.lineHeight\n            );\n            ctx.restore();\n          }\n          else if (currentColor !== lastColor) {\n            drawStart = leftOffset + lineLeftOffset + boxStart;\n            if (this.direction === 'rtl') {\n              drawStart = this.width - drawStart - boxWidth;\n            }\n            ctx.fillStyle = lastColor;\n            lastColor && ctx.fillRect(\n              drawStart,\n              lineTopOffset,\n              boxWidth,\n              heightOfLine / this.lineHeight\n            );\n            boxStart = charBox.left;\n            boxWidth = charBox.width;\n            lastColor = currentColor;\n          }\n          else {\n            boxWidth += charBox.kernedWidth;\n          }\n        }\n        if (currentColor && !path) {\n          drawStart = leftOffset + lineLeftOffset + boxStart;\n          if (this.direction === 'rtl') {\n            drawStart = this.width - drawStart - boxWidth;\n          }\n          ctx.fillStyle = currentColor;\n          ctx.fillRect(\n            drawStart,\n            lineTopOffset,\n            boxWidth,\n            heightOfLine / this.lineHeight\n          );\n        }\n        lineTopOffset += heightOfLine;\n      }\n      ctx.fillStyle = originalFill;\n      // if there is text background color no\n      // other shadows should be casted\n      this._removeShadow(ctx);\n    },\n\n    /**\n     * @private\n     * @param {Object} decl style declaration for cache\n     * @param {String} decl.fontFamily fontFamily\n     * @param {String} decl.fontStyle fontStyle\n     * @param {String} decl.fontWeight fontWeight\n     * @return {Object} reference to cache\n     */\n    getFontCache: function(decl) {\n      var fontFamily = decl.fontFamily.toLowerCase();\n      if (!fabric.charWidthsCache[fontFamily]) {\n        fabric.charWidthsCache[fontFamily] = { };\n      }\n      var cache = fabric.charWidthsCache[fontFamily],\n          cacheProp = decl.fontStyle.toLowerCase() + '_' + (decl.fontWeight + '').toLowerCase();\n      if (!cache[cacheProp]) {\n        cache[cacheProp] = { };\n      }\n      return cache[cacheProp];\n    },\n\n    /**\n     * measure and return the width of a single character.\n     * possibly overridden to accommodate different measure logic or\n     * to hook some external lib for character measurement\n     * @private\n     * @param {String} _char, char to be measured\n     * @param {Object} charStyle style of char to be measured\n     * @param {String} [previousChar] previous char\n     * @param {Object} [prevCharStyle] style of previous char\n     */\n    _measureChar: function(_char, charStyle, previousChar, prevCharStyle) {\n      // first i try to return from cache\n      var fontCache = this.getFontCache(charStyle), fontDeclaration = this._getFontDeclaration(charStyle),\n          previousFontDeclaration = this._getFontDeclaration(prevCharStyle), couple = previousChar + _char,\n          stylesAreEqual = fontDeclaration === previousFontDeclaration, width, coupleWidth, previousWidth,\n          fontMultiplier = charStyle.fontSize / this.CACHE_FONT_SIZE, kernedWidth;\n\n      if (previousChar && fontCache[previousChar] !== undefined) {\n        previousWidth = fontCache[previousChar];\n      }\n      if (fontCache[_char] !== undefined) {\n        kernedWidth = width = fontCache[_char];\n      }\n      if (stylesAreEqual && fontCache[couple] !== undefined) {\n        coupleWidth = fontCache[couple];\n        kernedWidth = coupleWidth - previousWidth;\n      }\n      if (width === undefined || previousWidth === undefined || coupleWidth === undefined) {\n        var ctx = this.getMeasuringContext();\n        // send a TRUE to specify measuring font size CACHE_FONT_SIZE\n        this._setTextStyles(ctx, charStyle, true);\n      }\n      if (width === undefined) {\n        kernedWidth = width = ctx.measureText(_char).width;\n        fontCache[_char] = width;\n      }\n      if (previousWidth === undefined && stylesAreEqual && previousChar) {\n        previousWidth = ctx.measureText(previousChar).width;\n        fontCache[previousChar] = previousWidth;\n      }\n      if (stylesAreEqual && coupleWidth === undefined) {\n        // we can measure the kerning couple and subtract the width of the previous character\n        coupleWidth = ctx.measureText(couple).width;\n        fontCache[couple] = coupleWidth;\n        kernedWidth = coupleWidth - previousWidth;\n      }\n      return { width: width * fontMultiplier, kernedWidth: kernedWidth * fontMultiplier };\n    },\n\n    /**\n     * Computes height of character at given position\n     * @param {Number} line the line index number\n     * @param {Number} _char the character index number\n     * @return {Number} fontSize of the character\n     */\n    getHeightOfChar: function(line, _char) {\n      return this.getValueOfPropertyAt(line, _char, 'fontSize');\n    },\n\n    /**\n     * measure a text line measuring all characters.\n     * @param {Number} lineIndex line number\n     * @return {Number} Line width\n     */\n    measureLine: function(lineIndex) {\n      var lineInfo = this._measureLine(lineIndex);\n      if (this.charSpacing !== 0) {\n        lineInfo.width -= this._getWidthOfCharSpacing();\n      }\n      if (lineInfo.width < 0) {\n        lineInfo.width = 0;\n      }\n      return lineInfo;\n    },\n\n    /**\n     * measure every grapheme of a line, populating __charBounds\n     * @param {Number} lineIndex\n     * @return {Object} object.width total width of characters\n     * @return {Object} object.widthOfSpaces length of chars that match this._reSpacesAndTabs\n     */\n    _measureLine: function(lineIndex) {\n      var width = 0, i, grapheme, line = this._textLines[lineIndex], prevGrapheme,\n          graphemeInfo, numOfSpaces = 0, lineBounds = new Array(line.length),\n          positionInPath = 0, startingPoint, totalPathLength, path = this.path,\n          reverse = this.pathSide === 'right';\n\n      this.__charBounds[lineIndex] = lineBounds;\n      for (i = 0; i < line.length; i++) {\n        grapheme = line[i];\n        graphemeInfo = this._getGraphemeBox(grapheme, lineIndex, i, prevGrapheme);\n        lineBounds[i] = graphemeInfo;\n        width += graphemeInfo.kernedWidth;\n        prevGrapheme = grapheme;\n      }\n      // this latest bound box represent the last character of the line\n      // to simplify cursor handling in interactive mode.\n      lineBounds[i] = {\n        left: graphemeInfo ? graphemeInfo.left + graphemeInfo.width : 0,\n        width: 0,\n        kernedWidth: 0,\n        height: this.fontSize\n      };\n      if (path) {\n        totalPathLength = path.segmentsInfo[path.segmentsInfo.length - 1].length;\n        startingPoint = fabric.util.getPointOnPath(path.path, 0, path.segmentsInfo);\n        startingPoint.x += path.pathOffset.x;\n        startingPoint.y += path.pathOffset.y;\n        switch (this.textAlign) {\n          case 'left':\n            positionInPath = reverse ? (totalPathLength - width) : 0;\n            break;\n          case 'center':\n            positionInPath = (totalPathLength - width) / 2;\n            break;\n          case 'right':\n            positionInPath = reverse ? 0 : (totalPathLength - width);\n            break;\n          //todo - add support for justify\n        }\n        positionInPath += this.pathStartOffset * (reverse ? -1 : 1);\n        for (i = reverse ? line.length - 1 : 0;\n          reverse ? i >= 0 : i < line.length;\n          reverse ? i-- : i++) {\n          graphemeInfo = lineBounds[i];\n          if (positionInPath > totalPathLength) {\n            positionInPath %= totalPathLength;\n          }\n          else if (positionInPath < 0) {\n            positionInPath += totalPathLength;\n          }\n          // it would probably much faster to send all the grapheme position for a line\n          // and calculate path position/angle at once.\n          this._setGraphemeOnPath(positionInPath, graphemeInfo, startingPoint);\n          positionInPath += graphemeInfo.kernedWidth;\n        }\n      }\n      return { width: width, numOfSpaces: numOfSpaces };\n    },\n\n    /**\n     * Calculate the angle  and the left,top position of the char that follow a path.\n     * It appends it to graphemeInfo to be reused later at rendering\n     * @private\n     * @param {Number} positionInPath to be measured\n     * @param {Object} graphemeInfo current grapheme box information\n     * @param {Object} startingPoint position of the point\n     */\n    _setGraphemeOnPath: function(positionInPath, graphemeInfo, startingPoint) {\n      var centerPosition = positionInPath + graphemeInfo.kernedWidth / 2,\n          path = this.path;\n\n      // we are at currentPositionOnPath. we want to know what point on the path is.\n      var info = fabric.util.getPointOnPath(path.path, centerPosition, path.segmentsInfo);\n      graphemeInfo.renderLeft = info.x - startingPoint.x;\n      graphemeInfo.renderTop = info.y - startingPoint.y;\n      graphemeInfo.angle = info.angle + (this.pathSide ===  'right' ? Math.PI : 0);\n    },\n\n    /**\n     * Measure and return the info of a single grapheme.\n     * needs the the info of previous graphemes already filled\n     * @private\n     * @param {String} grapheme to be measured\n     * @param {Number} lineIndex index of the line where the char is\n     * @param {Number} charIndex position in the line\n     * @param {String} [prevGrapheme] character preceding the one to be measured\n     */\n    _getGraphemeBox: function(grapheme, lineIndex, charIndex, prevGrapheme, skipLeft) {\n      var style = this.getCompleteStyleDeclaration(lineIndex, charIndex),\n          prevStyle = prevGrapheme ? this.getCompleteStyleDeclaration(lineIndex, charIndex - 1) : { },\n          info = this._measureChar(grapheme, style, prevGrapheme, prevStyle),\n          kernedWidth = info.kernedWidth,\n          width = info.width, charSpacing;\n\n      if (this.charSpacing !== 0) {\n        charSpacing = this._getWidthOfCharSpacing();\n        width += charSpacing;\n        kernedWidth += charSpacing;\n      }\n\n      var box = {\n        width: width,\n        left: 0,\n        height: style.fontSize,\n        kernedWidth: kernedWidth,\n        deltaY: style.deltaY,\n      };\n      if (charIndex > 0 && !skipLeft) {\n        var previousBox = this.__charBounds[lineIndex][charIndex - 1];\n        box.left = previousBox.left + previousBox.width + info.kernedWidth - info.width;\n      }\n      return box;\n    },\n\n    /**\n     * Calculate height of line at 'lineIndex'\n     * @param {Number} lineIndex index of line to calculate\n     * @return {Number}\n     */\n    getHeightOfLine: function(lineIndex) {\n      if (this.__lineHeights[lineIndex]) {\n        return this.__lineHeights[lineIndex];\n      }\n\n      var line = this._textLines[lineIndex],\n          // char 0 is measured before the line cycle because it nneds to char\n          // emptylines\n          maxHeight = this.getHeightOfChar(lineIndex, 0);\n      for (var i = 1, len = line.length; i < len; i++) {\n        maxHeight = Math.max(this.getHeightOfChar(lineIndex, i), maxHeight);\n      }\n\n      return this.__lineHeights[lineIndex] = maxHeight * this.lineHeight * this._fontSizeMult;\n    },\n\n    /**\n     * Calculate text box height\n     */\n    calcTextHeight: function() {\n      var lineHeight, height = 0;\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\n        lineHeight = this.getHeightOfLine(i);\n        height += (i === len - 1 ? lineHeight / this.lineHeight : lineHeight);\n      }\n      return height;\n    },\n\n    /**\n     * @private\n     * @return {Number} Left offset\n     */\n    _getLeftOffset: function() {\n      return this.direction === 'ltr' ? -this.width / 2 : this.width / 2;\n    },\n\n    /**\n     * @private\n     * @return {Number} Top offset\n     */\n    _getTopOffset: function() {\n      return -this.height / 2;\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {String} method Method name (\"fillText\" or \"strokeText\")\n     */\n    _renderTextCommon: function(ctx, method) {\n      ctx.save();\n      var lineHeights = 0, left = this._getLeftOffset(), top = this._getTopOffset();\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\n        var heightOfLine = this.getHeightOfLine(i),\n            maxHeight = heightOfLine / this.lineHeight,\n            leftOffset = this._getLineLeftOffset(i);\n        this._renderTextLine(\n          method,\n          ctx,\n          this._textLines[i],\n          left + leftOffset,\n          top + lineHeights + maxHeight,\n          i\n        );\n        lineHeights += heightOfLine;\n      }\n      ctx.restore();\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderTextFill: function(ctx) {\n      if (!this.fill && !this.styleHas('fill')) {\n        return;\n      }\n\n      this._renderTextCommon(ctx, 'fillText');\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderTextStroke: function(ctx) {\n      if ((!this.stroke || this.strokeWidth === 0) && this.isEmptyStyles()) {\n        return;\n      }\n\n      if (this.shadow && !this.shadow.affectStroke) {\n        this._removeShadow(ctx);\n      }\n\n      ctx.save();\n      this._setLineDash(ctx, this.strokeDashArray);\n      ctx.beginPath();\n      this._renderTextCommon(ctx, 'strokeText');\n      ctx.closePath();\n      ctx.restore();\n    },\n\n    /**\n     * @private\n     * @param {String} method fillText or strokeText.\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {Array} line Content of the line, splitted in an array by grapheme\n     * @param {Number} left\n     * @param {Number} top\n     * @param {Number} lineIndex\n     */\n    _renderChars: function(method, ctx, line, left, top, lineIndex) {\n      // set proper line offset\n      var lineHeight = this.getHeightOfLine(lineIndex),\n          isJustify = this.textAlign.indexOf('justify') !== -1,\n          actualStyle,\n          nextStyle,\n          charsToRender = '',\n          charBox,\n          boxWidth = 0,\n          timeToRender,\n          path = this.path,\n          shortCut = !isJustify && this.charSpacing === 0 && this.isEmptyStyles(lineIndex) && !path,\n          isLtr = this.direction === 'ltr', sign = this.direction === 'ltr' ? 1 : -1,\n          drawingLeft, currentDirection = ctx.canvas.getAttribute('dir');\n      ctx.save();\n      if (currentDirection !== this.direction) {\n        ctx.canvas.setAttribute('dir', isLtr ? 'ltr' : 'rtl');\n        ctx.direction = isLtr ? 'ltr' : 'rtl';\n        ctx.textAlign = isLtr ? 'left' : 'right';\n      }\n      top -= lineHeight * this._fontSizeFraction / this.lineHeight;\n      if (shortCut) {\n        // render all the line in one pass without checking\n        // drawingLeft = isLtr ? left : left - this.getLineWidth(lineIndex);\n        this._renderChar(method, ctx, lineIndex, 0, line.join(''), left, top, lineHeight);\n        ctx.restore();\n        return;\n      }\n      for (var i = 0, len = line.length - 1; i <= len; i++) {\n        timeToRender = i === len || this.charSpacing || path;\n        charsToRender += line[i];\n        charBox = this.__charBounds[lineIndex][i];\n        if (boxWidth === 0) {\n          left += sign * (charBox.kernedWidth - charBox.width);\n          boxWidth += charBox.width;\n        }\n        else {\n          boxWidth += charBox.kernedWidth;\n        }\n        if (isJustify && !timeToRender) {\n          if (this._reSpaceAndTab.test(line[i])) {\n            timeToRender = true;\n          }\n        }\n        if (!timeToRender) {\n          // if we have charSpacing, we render char by char\n          actualStyle = actualStyle || this.getCompleteStyleDeclaration(lineIndex, i);\n          nextStyle = this.getCompleteStyleDeclaration(lineIndex, i + 1);\n          timeToRender = fabric.util.hasStyleChanged(actualStyle, nextStyle, false);\n        }\n        if (timeToRender) {\n          if (path) {\n            ctx.save();\n            ctx.translate(charBox.renderLeft, charBox.renderTop);\n            ctx.rotate(charBox.angle);\n            this._renderChar(method, ctx, lineIndex, i, charsToRender, -boxWidth / 2, 0, lineHeight);\n            ctx.restore();\n          }\n          else {\n            drawingLeft = left;\n            this._renderChar(method, ctx, lineIndex, i, charsToRender, drawingLeft, top, lineHeight);\n          }\n          charsToRender = '';\n          actualStyle = nextStyle;\n          left += sign * boxWidth;\n          boxWidth = 0;\n        }\n      }\n      ctx.restore();\n    },\n\n    /**\n     * This function try to patch the missing gradientTransform on canvas gradients.\n     * transforming a context to transform the gradient, is going to transform the stroke too.\n     * we want to transform the gradient but not the stroke operation, so we create\n     * a transformed gradient on a pattern and then we use the pattern instead of the gradient.\n     * this method has drawbacks: is slow, is in low resolution, needs a patch for when the size\n     * is limited.\n     * @private\n     * @param {fabric.Gradient} filler a fabric gradient instance\n     * @return {CanvasPattern} a pattern to use as fill/stroke style\n     */\n    _applyPatternGradientTransformText: function(filler) {\n      var pCanvas = fabric.util.createCanvasElement(), pCtx,\n          // TODO: verify compatibility with strokeUniform\n          width = this.width + this.strokeWidth, height = this.height + this.strokeWidth;\n      pCanvas.width = width;\n      pCanvas.height = height;\n      pCtx = pCanvas.getContext('2d');\n      pCtx.beginPath(); pCtx.moveTo(0, 0); pCtx.lineTo(width, 0); pCtx.lineTo(width, height);\n      pCtx.lineTo(0, height); pCtx.closePath();\n      pCtx.translate(width / 2, height / 2);\n      pCtx.fillStyle = filler.toLive(pCtx);\n      this._applyPatternGradientTransform(pCtx, filler);\n      pCtx.fill();\n      return pCtx.createPattern(pCanvas, 'no-repeat');\n    },\n\n    handleFiller: function(ctx, property, filler) {\n      var offsetX, offsetY;\n      if (filler.toLive) {\n        if (filler.gradientUnits === 'percentage' || filler.gradientTransform || filler.patternTransform) {\n          // need to transform gradient in a pattern.\n          // this is a slow process. If you are hitting this codepath, and the object\n          // is not using caching, you should consider switching it on.\n          // we need a canvas as big as the current object caching canvas.\n          offsetX = -this.width / 2;\n          offsetY = -this.height / 2;\n          ctx.translate(offsetX, offsetY);\n          ctx[property] = this._applyPatternGradientTransformText(filler);\n          return { offsetX: offsetX, offsetY: offsetY };\n        }\n        else {\n          // is a simple gradient or pattern\n          ctx[property] = filler.toLive(ctx, this);\n          return this._applyPatternGradientTransform(ctx, filler);\n        }\n      }\n      else {\n        // is a color\n        ctx[property] = filler;\n      }\n      return { offsetX: 0, offsetY: 0 };\n    },\n\n    _setStrokeStyles: function(ctx, decl) {\n      ctx.lineWidth = decl.strokeWidth;\n      ctx.lineCap = this.strokeLineCap;\n      ctx.lineDashOffset = this.strokeDashOffset;\n      ctx.lineJoin = this.strokeLineJoin;\n      ctx.miterLimit = this.strokeMiterLimit;\n      return this.handleFiller(ctx, 'strokeStyle', decl.stroke);\n    },\n\n    _setFillStyles: function(ctx, decl) {\n      return this.handleFiller(ctx, 'fillStyle', decl.fill);\n    },\n\n    /**\n     * @private\n     * @param {String} method\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {Number} lineIndex\n     * @param {Number} charIndex\n     * @param {String} _char\n     * @param {Number} left Left coordinate\n     * @param {Number} top Top coordinate\n     * @param {Number} lineHeight Height of the line\n     */\n    _renderChar: function(method, ctx, lineIndex, charIndex, _char, left, top) {\n      var decl = this._getStyleDeclaration(lineIndex, charIndex),\n          fullDecl = this.getCompleteStyleDeclaration(lineIndex, charIndex),\n          shouldFill = method === 'fillText' && fullDecl.fill,\n          shouldStroke = method === 'strokeText' && fullDecl.stroke && fullDecl.strokeWidth,\n          fillOffsets, strokeOffsets;\n\n      if (!shouldStroke && !shouldFill) {\n        return;\n      }\n      ctx.save();\n\n      shouldFill && (fillOffsets = this._setFillStyles(ctx, fullDecl));\n      shouldStroke && (strokeOffsets = this._setStrokeStyles(ctx, fullDecl));\n\n      ctx.font = this._getFontDeclaration(fullDecl);\n\n\n      if (decl && decl.textBackgroundColor) {\n        this._removeShadow(ctx);\n      }\n      if (decl && decl.deltaY) {\n        top += decl.deltaY;\n      }\n      shouldFill && ctx.fillText(_char, left - fillOffsets.offsetX, top - fillOffsets.offsetY);\n      shouldStroke && ctx.strokeText(_char, left - strokeOffsets.offsetX, top - strokeOffsets.offsetY);\n      ctx.restore();\n    },\n\n    /**\n     * Turns the character into a 'superior figure' (i.e. 'superscript')\n     * @param {Number} start selection start\n     * @param {Number} end selection end\n     * @returns {fabric.Text} thisArg\n     * @chainable\n     */\n    setSuperscript: function(start, end) {\n      return this._setScript(start, end, this.superscript);\n    },\n\n    /**\n     * Turns the character into an 'inferior figure' (i.e. 'subscript')\n     * @param {Number} start selection start\n     * @param {Number} end selection end\n     * @returns {fabric.Text} thisArg\n     * @chainable\n     */\n    setSubscript: function(start, end) {\n      return this._setScript(start, end, this.subscript);\n    },\n\n    /**\n     * Applies 'schema' at given position\n     * @private\n     * @param {Number} start selection start\n     * @param {Number} end selection end\n     * @param {Number} schema\n     * @returns {fabric.Text} thisArg\n     * @chainable\n     */\n    _setScript: function(start, end, schema) {\n      var loc = this.get2DCursorLocation(start, true),\n          fontSize = this.getValueOfPropertyAt(loc.lineIndex, loc.charIndex, 'fontSize'),\n          dy = this.getValueOfPropertyAt(loc.lineIndex, loc.charIndex, 'deltaY'),\n          style = { fontSize: fontSize * schema.size, deltaY: dy + fontSize * schema.baseline };\n      this.setSelectionStyles(style, start, end);\n      return this;\n    },\n\n    /**\n     * @private\n     * @param {Number} lineIndex index text line\n     * @return {Number} Line left offset\n     */\n    _getLineLeftOffset: function(lineIndex) {\n      var lineWidth = this.getLineWidth(lineIndex),\n          lineDiff = this.width - lineWidth, textAlign = this.textAlign, direction = this.direction,\n          isEndOfWrapping, leftOffset = 0, isEndOfWrapping = this.isEndOfWrapping(lineIndex);\n      if (textAlign === 'justify'\n        || (textAlign === 'justify-center' && !isEndOfWrapping)\n        || (textAlign === 'justify-right' && !isEndOfWrapping)\n        || (textAlign === 'justify-left' && !isEndOfWrapping)\n      ) {\n        return 0;\n      }\n      if (textAlign === 'center') {\n        leftOffset = lineDiff / 2;\n      }\n      if (textAlign === 'right') {\n        leftOffset = lineDiff;\n      }\n      if (textAlign === 'justify-center') {\n        leftOffset = lineDiff / 2;\n      }\n      if (textAlign === 'justify-right') {\n        leftOffset = lineDiff;\n      }\n      if (direction === 'rtl') {\n        leftOffset -= lineDiff;\n      }\n      return leftOffset;\n    },\n\n    /**\n     * @private\n     */\n    _clearCache: function() {\n      this.__lineWidths = [];\n      this.__lineHeights = [];\n      this.__charBounds = [];\n    },\n\n    /**\n     * @private\n     */\n    _shouldClearDimensionCache: function() {\n      var shouldClear = this._forceClearCache;\n      shouldClear || (shouldClear = this.hasStateChanged('_dimensionAffectingProps'));\n      if (shouldClear) {\n        this.dirty = true;\n        this._forceClearCache = false;\n      }\n      return shouldClear;\n    },\n\n    /**\n     * Measure a single line given its index. Used to calculate the initial\n     * text bounding box. The values are calculated and stored in __lineWidths cache.\n     * @private\n     * @param {Number} lineIndex line number\n     * @return {Number} Line width\n     */\n    getLineWidth: function(lineIndex) {\n      if (this.__lineWidths[lineIndex] !== undefined) {\n        return this.__lineWidths[lineIndex];\n      }\n\n      var lineInfo = this.measureLine(lineIndex);\n      var width = lineInfo.width;\n      this.__lineWidths[lineIndex] = width;\n      return width;\n    },\n\n    _getWidthOfCharSpacing: function() {\n      if (this.charSpacing !== 0) {\n        return this.fontSize * this.charSpacing / 1000;\n      }\n      return 0;\n    },\n\n    /**\n     * Retrieves the value of property at given character position\n     * @param {Number} lineIndex the line number\n     * @param {Number} charIndex the character number\n     * @param {String} property the property name\n     * @returns the value of 'property'\n     */\n    getValueOfPropertyAt: function(lineIndex, charIndex, property) {\n      var charStyle = this._getStyleDeclaration(lineIndex, charIndex);\n      if (charStyle && typeof charStyle[property] !== 'undefined') {\n        return charStyle[property];\n      }\n      return this[property];\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _renderTextDecoration: function(ctx, type) {\n      if (!this[type] && !this.styleHas(type)) {\n        return;\n      }\n      ctx.save();\n      // if type is overline or linethrough we shouldn't cast shadow\n      if (type === 'overline' || type === 'linethrough') {\n        this._removeShadow(ctx);\n      }\n      var heightOfLine, size, _size,\n          lineLeftOffset, dy, _dy,\n          line, lastDecoration,\n          leftOffset = this._getLeftOffset(),\n          topOffset = this._getTopOffset(), top,\n          boxStart, boxWidth, charBox, currentDecoration,\n          maxHeight, currentFill, lastFill, path = this.path,\n          charSpacing = this._getWidthOfCharSpacing(),\n          offsetY = this.offsets[type];\n\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\n        heightOfLine = this.getHeightOfLine(i);\n        if (!this[type] && !this.styleHas(type, i)) {\n          topOffset += heightOfLine;\n          continue;\n        }\n        line = this._textLines[i];\n        maxHeight = heightOfLine / this.lineHeight;\n        lineLeftOffset = this._getLineLeftOffset(i);\n        boxStart = 0;\n        boxWidth = 0;\n        lastDecoration = this.getValueOfPropertyAt(i, 0, type);\n        lastFill = this.getValueOfPropertyAt(i, 0, 'fill');\n        top = topOffset + maxHeight * (1 - this._fontSizeFraction);\n        size = this.getHeightOfChar(i, 0);\n        dy = this.getValueOfPropertyAt(i, 0, 'deltaY');\n        for (var j = 0, jlen = line.length; j < jlen; j++) {\n          charBox = this.__charBounds[i][j];\n          currentDecoration = this.getValueOfPropertyAt(i, j, type);\n          currentFill = this.getValueOfPropertyAt(i, j, 'fill');\n          _size = this.getHeightOfChar(i, j);\n          _dy = this.getValueOfPropertyAt(i, j, 'deltaY');\n          if (path && currentDecoration && currentFill) {\n            ctx.save();\n            ctx.fillStyle = lastFill;\n            ctx.translate(charBox.renderLeft, charBox.renderTop);\n            ctx.rotate(charBox.angle);\n            ctx.fillRect(\n              -charBox.kernedWidth / 2,\n              offsetY * _size + _dy,\n              charBox.kernedWidth,\n              this.fontSize / 15\n            );\n            ctx.restore();\n          }\n          else if (\n            (currentDecoration !== lastDecoration || currentFill !== lastFill || _size !== size || _dy !== dy)\n            && boxWidth > 0\n          ) {\n            var drawStart = leftOffset + lineLeftOffset + boxStart;\n            if (this.direction === 'rtl') {\n              drawStart = this.width - drawStart - boxWidth;\n            }\n            if (lastDecoration && lastFill) {\n              ctx.fillStyle = lastFill;\n              ctx.fillRect(\n                drawStart,\n                top + offsetY * size + dy,\n                boxWidth,\n                this.fontSize / 15\n              );\n            }\n            boxStart = charBox.left;\n            boxWidth = charBox.width;\n            lastDecoration = currentDecoration;\n            lastFill = currentFill;\n            size = _size;\n            dy = _dy;\n          }\n          else {\n            boxWidth += charBox.kernedWidth;\n          }\n        }\n        var drawStart = leftOffset + lineLeftOffset + boxStart;\n        if (this.direction === 'rtl') {\n          drawStart = this.width - drawStart - boxWidth;\n        }\n        ctx.fillStyle = currentFill;\n        currentDecoration && currentFill && ctx.fillRect(\n          drawStart,\n          top + offsetY * size + dy,\n          boxWidth - charSpacing,\n          this.fontSize / 15\n        );\n        topOffset += heightOfLine;\n      }\n      ctx.restore();\n    },\n\n    /**\n     * return font declaration string for canvas context\n     * @param {Object} [styleObject] object\n     * @returns {String} font declaration formatted for canvas context.\n     */\n    _getFontDeclaration: function(styleObject, forMeasuring) {\n      var style = styleObject || this, family = this.fontFamily,\n          fontIsGeneric = fabric.Text.genericFonts.indexOf(family.toLowerCase()) > -1;\n      var fontFamily = family === undefined ||\n      family.indexOf('\\'') > -1 || family.indexOf(',') > -1 ||\n      family.indexOf('\"') > -1 || fontIsGeneric\n        ? style.fontFamily : '\"' + style.fontFamily + '\"';\n      return [\n        // node-canvas needs \"weight style\", while browsers need \"style weight\"\n        // verify if this can be fixed in JSDOM\n        (fabric.isLikelyNode ? style.fontWeight : style.fontStyle),\n        (fabric.isLikelyNode ? style.fontStyle : style.fontWeight),\n        forMeasuring ? this.CACHE_FONT_SIZE + 'px' : style.fontSize + 'px',\n        fontFamily\n      ].join(' ');\n    },\n\n    /**\n     * Renders text instance on a specified context\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    render: function(ctx) {\n      // do not render if object is not visible\n      if (!this.visible) {\n        return;\n      }\n      if (this.canvas && this.canvas.skipOffscreen && !this.group && !this.isOnScreen()) {\n        return;\n      }\n      if (this._shouldClearDimensionCache()) {\n        this.initDimensions();\n      }\n      this.callSuper('render', ctx);\n    },\n\n    /**\n     * Returns the text as an array of lines.\n     * @param {String} text text to split\n     * @returns {Array} Lines in the text\n     */\n    _splitTextIntoLines: function(text) {\n      var lines = text.split(this._reNewline),\n          newLines = new Array(lines.length),\n          newLine = ['\\n'],\n          newText = [];\n      for (var i = 0; i < lines.length; i++) {\n        newLines[i] = fabric.util.string.graphemeSplit(lines[i]);\n        newText = newText.concat(newLines[i], newLine);\n      }\n      newText.pop();\n      return { _unwrappedLines: newLines, lines: lines, graphemeText: newText, graphemeLines: newLines };\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      var allProperties = additionalProps.concat(propertiesToInclude);\n      var obj = this.callSuper('toObject', allProperties);\n      obj.styles = fabric.util.stylesToArray(this.styles, this.text);\n      if (obj.path) {\n        obj.path = this.path.toObject();\n      }\n      return obj;\n    },\n\n    /**\n     * Sets property to a given value. When changing position/dimension -related properties (left, top, scale, angle, etc.) `set` does not update position of object's borders/controls. If you need to update those, call `setCoords()`.\n     * @param {String|Object} key Property name or object (if object, iterate over the object properties)\n     * @param {Object|Function} value Property value (if function, the value is passed into it and its return value is used as a new one)\n     * @return {fabric.Object} thisArg\n     * @chainable\n     */\n    set: function(key, value) {\n      this.callSuper('set', key, value);\n      var needsDims = false;\n      var isAddingPath = false;\n      if (typeof key === 'object') {\n        for (var _key in key) {\n          if (_key === 'path') {\n            this.setPathInfo();\n          }\n          needsDims = needsDims || this._dimensionAffectingProps.indexOf(_key) !== -1;\n          isAddingPath = isAddingPath || _key === 'path';\n        }\n      }\n      else {\n        needsDims = this._dimensionAffectingProps.indexOf(key) !== -1;\n        isAddingPath = key === 'path';\n      }\n      if (isAddingPath) {\n        this.setPathInfo();\n      }\n      if (needsDims) {\n        this.initDimensions();\n        this.setCoords();\n      }\n      return this;\n    },\n\n    /**\n     * Returns complexity of an instance\n     * @return {Number} complexity\n     */\n    complexity: function() {\n      return 1;\n    }\n  });\n\n  /* _FROM_SVG_START_ */\n  /**\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Text.fromElement})\n   * @static\n   * @memberOf fabric.Text\n   * @see: http://www.w3.org/TR/SVG/text.html#TextElement\n   */\n  fabric.Text.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat(\n    'x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor'.split(' '));\n\n  /**\n   * Default SVG font size\n   * @static\n   * @memberOf fabric.Text\n   */\n  fabric.Text.DEFAULT_SVG_FONT_SIZE = 16;\n\n  /**\n   * Returns fabric.Text instance from an SVG element (<b>not yet implemented</b>)\n   * @static\n   * @memberOf fabric.Text\n   * @param {SVGElement} element Element to parse\n   * @param {Function} callback callback function invoked after parsing\n   * @param {Object} [options] Options object\n   */\n  fabric.Text.fromElement = function(element, callback, options) {\n    if (!element) {\n      return callback(null);\n    }\n\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Text.ATTRIBUTE_NAMES),\n        parsedAnchor = parsedAttributes.textAnchor || 'left';\n    options = fabric.util.object.extend((options ? clone(options) : { }), parsedAttributes);\n\n    options.top = options.top || 0;\n    options.left = options.left || 0;\n    if (parsedAttributes.textDecoration) {\n      var textDecoration = parsedAttributes.textDecoration;\n      if (textDecoration.indexOf('underline') !== -1) {\n        options.underline = true;\n      }\n      if (textDecoration.indexOf('overline') !== -1) {\n        options.overline = true;\n      }\n      if (textDecoration.indexOf('line-through') !== -1) {\n        options.linethrough = true;\n      }\n      delete options.textDecoration;\n    }\n    if ('dx' in parsedAttributes) {\n      options.left += parsedAttributes.dx;\n    }\n    if ('dy' in parsedAttributes) {\n      options.top += parsedAttributes.dy;\n    }\n    if (!('fontSize' in options)) {\n      options.fontSize = fabric.Text.DEFAULT_SVG_FONT_SIZE;\n    }\n\n    var textContent = '';\n\n    // The XML is not properly parsed in IE9 so a workaround to get\n    // textContent is through firstChild.data. Another workaround would be\n    // to convert XML loaded from a file to be converted using DOMParser (same way loadSVGFromString() does)\n    if (!('textContent' in element)) {\n      if ('firstChild' in element && element.firstChild !== null) {\n        if ('data' in element.firstChild && element.firstChild.data !== null) {\n          textContent = element.firstChild.data;\n        }\n      }\n    }\n    else {\n      textContent = element.textContent;\n    }\n\n    textContent = textContent.replace(/^\\s+|\\s+$|\\n+/g, '').replace(/\\s+/g, ' ');\n    var originalStrokeWidth = options.strokeWidth;\n    options.strokeWidth = 0;\n\n    var text = new fabric.Text(textContent, options),\n        textHeightScaleFactor = text.getScaledHeight() / text.height,\n        lineHeightDiff = (text.height + text.strokeWidth) * text.lineHeight - text.height,\n        scaledDiff = lineHeightDiff * textHeightScaleFactor,\n        textHeight = text.getScaledHeight() + scaledDiff,\n        offX = 0;\n    /*\n      Adjust positioning:\n        x/y attributes in SVG correspond to the bottom-left corner of text bounding box\n        fabric output by default at top, left.\n    */\n    if (parsedAnchor === 'center') {\n      offX = text.getScaledWidth() / 2;\n    }\n    if (parsedAnchor === 'right') {\n      offX = text.getScaledWidth();\n    }\n    text.set({\n      left: text.left - offX,\n      top: text.top - (textHeight - text.fontSize * (0.07 + text._fontSizeFraction)) / text.lineHeight,\n      strokeWidth: typeof originalStrokeWidth !== 'undefined' ? originalStrokeWidth : 1,\n    });\n    callback(text);\n  };\n  /* _FROM_SVG_END_ */\n\n  /**\n   * Returns fabric.Text instance from an object representation\n   * @static\n   * @memberOf fabric.Text\n   * @param {Object} object plain js Object to create an instance from\n   * @param {Function} [callback] Callback to invoke when an fabric.Text instance is created\n   */\n  fabric.Text.fromObject = function(object, callback) {\n    var objectCopy = clone(object), path = object.path;\n    delete objectCopy.path;\n    return fabric.Object._fromObject('Text', objectCopy, function(textInstance) {\n      textInstance.styles = fabric.util.stylesFromArray(object.styles, object.text);\n      if (path) {\n        fabric.Object._fromObject('Path', path, function(pathInstance) {\n          textInstance.set('path', pathInstance);\n          callback(textInstance);\n        }, 'path');\n      }\n      else {\n        callback(textInstance);\n      }\n    }, 'text');\n  };\n\n  fabric.Text.genericFonts = ['sans-serif', 'serif', 'cursive', 'fantasy', 'monospace'];\n\n  fabric.util.createAccessors && fabric.util.createAccessors(fabric.Text);\n\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function() {\n  fabric.util.object.extend(fabric.Text.prototype, /** @lends fabric.Text.prototype */ {\n    /**\n     * Returns true if object has no styling or no styling in a line\n     * @param {Number} lineIndex , lineIndex is on wrapped lines.\n     * @return {Boolean}\n     */\n    isEmptyStyles: function(lineIndex) {\n      if (!this.styles) {\n        return true;\n      }\n      if (typeof lineIndex !== 'undefined' && !this.styles[lineIndex]) {\n        return true;\n      }\n      var obj = typeof lineIndex === 'undefined' ? this.styles : { line: this.styles[lineIndex] };\n      for (var p1 in obj) {\n        for (var p2 in obj[p1]) {\n          // eslint-disable-next-line no-unused-vars\n          for (var p3 in obj[p1][p2]) {\n            return false;\n          }\n        }\n      }\n      return true;\n    },\n\n    /**\n     * Returns true if object has a style property or has it ina specified line\n     * This function is used to detect if a text will use a particular property or not.\n     * @param {String} property to check for\n     * @param {Number} lineIndex to check the style on\n     * @return {Boolean}\n     */\n    styleHas: function(property, lineIndex) {\n      if (!this.styles || !property || property === '') {\n        return false;\n      }\n      if (typeof lineIndex !== 'undefined' && !this.styles[lineIndex]) {\n        return false;\n      }\n      var obj = typeof lineIndex === 'undefined' ? this.styles : { 0: this.styles[lineIndex] };\n      // eslint-disable-next-line\n      for (var p1 in obj) {\n        // eslint-disable-next-line\n        for (var p2 in obj[p1]) {\n          if (typeof obj[p1][p2][property] !== 'undefined') {\n            return true;\n          }\n        }\n      }\n      return false;\n    },\n\n    /**\n     * Check if characters in a text have a value for a property\n     * whose value matches the textbox's value for that property.  If so,\n     * the character-level property is deleted.  If the character\n     * has no other properties, then it is also deleted.  Finally,\n     * if the line containing that character has no other characters\n     * then it also is deleted.\n     *\n     * @param {string} property The property to compare between characters and text.\n     */\n    cleanStyle: function(property) {\n      if (!this.styles || !property || property === '') {\n        return false;\n      }\n      var obj = this.styles, stylesCount = 0, letterCount, stylePropertyValue,\n          allStyleObjectPropertiesMatch = true, graphemeCount = 0, styleObject;\n      // eslint-disable-next-line\n      for (var p1 in obj) {\n        letterCount = 0;\n        // eslint-disable-next-line\n        for (var p2 in obj[p1]) {\n          var styleObject = obj[p1][p2],\n              stylePropertyHasBeenSet = styleObject.hasOwnProperty(property);\n\n          stylesCount++;\n\n          if (stylePropertyHasBeenSet) {\n            if (!stylePropertyValue) {\n              stylePropertyValue = styleObject[property];\n            }\n            else if (styleObject[property] !== stylePropertyValue) {\n              allStyleObjectPropertiesMatch = false;\n            }\n\n            if (styleObject[property] === this[property]) {\n              delete styleObject[property];\n            }\n          }\n          else {\n            allStyleObjectPropertiesMatch = false;\n          }\n\n          if (Object.keys(styleObject).length !== 0) {\n            letterCount++;\n          }\n          else {\n            delete obj[p1][p2];\n          }\n        }\n\n        if (letterCount === 0) {\n          delete obj[p1];\n        }\n      }\n      // if every grapheme has the same style set then\n      // delete those styles and set it on the parent\n      for (var i = 0; i < this._textLines.length; i++) {\n        graphemeCount += this._textLines[i].length;\n      }\n      if (allStyleObjectPropertiesMatch && stylesCount === graphemeCount) {\n        this[property] = stylePropertyValue;\n        this.removeStyle(property);\n      }\n    },\n\n    /**\n     * Remove a style property or properties from all individual character styles\n     * in a text object.  Deletes the character style object if it contains no other style\n     * props.  Deletes a line style object if it contains no other character styles.\n     *\n     * @param {String} props The property to remove from character styles.\n     */\n    removeStyle: function(property) {\n      if (!this.styles || !property || property === '') {\n        return;\n      }\n      var obj = this.styles, line, lineNum, charNum;\n      for (lineNum in obj) {\n        line = obj[lineNum];\n        for (charNum in line) {\n          delete line[charNum][property];\n          if (Object.keys(line[charNum]).length === 0) {\n            delete line[charNum];\n          }\n        }\n        if (Object.keys(line).length === 0) {\n          delete obj[lineNum];\n        }\n      }\n    },\n\n    /**\n     * @private\n     */\n    _extendStyles: function(index, styles) {\n      var loc = this.get2DCursorLocation(index);\n\n      if (!this._getLineStyle(loc.lineIndex)) {\n        this._setLineStyle(loc.lineIndex);\n      }\n\n      if (!this._getStyleDeclaration(loc.lineIndex, loc.charIndex)) {\n        this._setStyleDeclaration(loc.lineIndex, loc.charIndex, {});\n      }\n\n      fabric.util.object.extend(this._getStyleDeclaration(loc.lineIndex, loc.charIndex), styles);\n    },\n\n    /**\n     * Returns 2d representation (lineIndex and charIndex) of cursor (or selection start)\n     * @param {Number} [selectionStart] Optional index. When not given, current selectionStart is used.\n     * @param {Boolean} [skipWrapping] consider the location for unwrapped lines. useful to manage styles.\n     */\n    get2DCursorLocation: function(selectionStart, skipWrapping) {\n      if (typeof selectionStart === 'undefined') {\n        selectionStart = this.selectionStart;\n      }\n      var lines = skipWrapping ? this._unwrappedTextLines : this._textLines,\n          len = lines.length;\n      for (var i = 0; i < len; i++) {\n        if (selectionStart <= lines[i].length) {\n          return {\n            lineIndex: i,\n            charIndex: selectionStart\n          };\n        }\n        selectionStart -= lines[i].length + this.missingNewlineOffset(i, skipWrapping);\n      }\n      return {\n        lineIndex: i - 1,\n        charIndex: lines[i - 1].length < selectionStart ? lines[i - 1].length : selectionStart\n      };\n    },\n\n    /**\n     * Gets style of a current selection/cursor (at the start position)\n     * if startIndex or endIndex are not provided, selectionStart or selectionEnd will be used.\n     * @param {Number} [startIndex] Start index to get styles at\n     * @param {Number} [endIndex] End index to get styles at, if not specified selectionEnd or startIndex + 1\n     * @param {Boolean} [complete] get full style or not\n     * @return {Array} styles an array with one, zero or more Style objects\n     */\n    getSelectionStyles: function(startIndex, endIndex, complete) {\n      if (typeof startIndex === 'undefined') {\n        startIndex = this.selectionStart || 0;\n      }\n      if (typeof endIndex === 'undefined') {\n        endIndex = this.selectionEnd || startIndex;\n      }\n      var styles = [];\n      for (var i = startIndex; i < endIndex; i++) {\n        styles.push(this.getStyleAtPosition(i, complete));\n      }\n      return styles;\n    },\n\n    /**\n     * Gets style of a current selection/cursor position\n     * @param {Number} position  to get styles at\n     * @param {Boolean} [complete] full style if true\n     * @return {Object} style Style object at a specified index\n     * @private\n     */\n    getStyleAtPosition: function(position, complete) {\n      var loc = this.get2DCursorLocation(position),\n          style = complete ? this.getCompleteStyleDeclaration(loc.lineIndex, loc.charIndex) :\n            this._getStyleDeclaration(loc.lineIndex, loc.charIndex);\n      return style || {};\n    },\n\n    /**\n     * Sets style of a current selection, if no selection exist, do not set anything.\n     * @param {Object} [styles] Styles object\n     * @param {Number} [startIndex] Start index to get styles at\n     * @param {Number} [endIndex] End index to get styles at, if not specified selectionEnd or startIndex + 1\n     * @return {fabric.IText} thisArg\n     * @chainable\n     */\n    setSelectionStyles: function(styles, startIndex, endIndex) {\n      if (typeof startIndex === 'undefined') {\n        startIndex = this.selectionStart || 0;\n      }\n      if (typeof endIndex === 'undefined') {\n        endIndex = this.selectionEnd || startIndex;\n      }\n      for (var i = startIndex; i < endIndex; i++) {\n        this._extendStyles(i, styles);\n      }\n      /* not included in _extendStyles to avoid clearing cache more than once */\n      this._forceClearCache = true;\n      return this;\n    },\n\n    /**\n     * get the reference, not a clone, of the style object for a given character\n     * @param {Number} lineIndex\n     * @param {Number} charIndex\n     * @return {Object} style object\n     */\n    _getStyleDeclaration: function(lineIndex, charIndex) {\n      var lineStyle = this.styles && this.styles[lineIndex];\n      if (!lineStyle) {\n        return null;\n      }\n      return lineStyle[charIndex];\n    },\n\n    /**\n     * return a new object that contains all the style property for a character\n     * the object returned is newly created\n     * @param {Number} lineIndex of the line where the character is\n     * @param {Number} charIndex position of the character on the line\n     * @return {Object} style object\n     */\n    getCompleteStyleDeclaration: function(lineIndex, charIndex) {\n      var style = this._getStyleDeclaration(lineIndex, charIndex) || { },\n          styleObject = { }, prop;\n      for (var i = 0; i < this._styleProperties.length; i++) {\n        prop = this._styleProperties[i];\n        styleObject[prop] = typeof style[prop] === 'undefined' ? this[prop] : style[prop];\n      }\n      return styleObject;\n    },\n\n    /**\n     * @param {Number} lineIndex\n     * @param {Number} charIndex\n     * @param {Object} style\n     * @private\n     */\n    _setStyleDeclaration: function(lineIndex, charIndex, style) {\n      this.styles[lineIndex][charIndex] = style;\n    },\n\n    /**\n     *\n     * @param {Number} lineIndex\n     * @param {Number} charIndex\n     * @private\n     */\n    _deleteStyleDeclaration: function(lineIndex, charIndex) {\n      delete this.styles[lineIndex][charIndex];\n    },\n\n    /**\n     * @param {Number} lineIndex\n     * @return {Boolean} if the line exists or not\n     * @private\n     */\n    _getLineStyle: function(lineIndex) {\n      return !!this.styles[lineIndex];\n    },\n\n    /**\n     * Set the line style to an empty object so that is initialized\n     * @param {Number} lineIndex\n     * @private\n     */\n    _setLineStyle: function(lineIndex) {\n      this.styles[lineIndex] = {};\n    },\n\n    /**\n     * @param {Number} lineIndex\n     * @private\n     */\n    _deleteLineStyle: function(lineIndex) {\n      delete this.styles[lineIndex];\n    }\n  });\n})();\n\n\n(function() {\n\n  function parseDecoration(object) {\n    if (object.textDecoration) {\n      object.textDecoration.indexOf('underline') > -1 && (object.underline = true);\n      object.textDecoration.indexOf('line-through') > -1 && (object.linethrough = true);\n      object.textDecoration.indexOf('overline') > -1 && (object.overline = true);\n      delete object.textDecoration;\n    }\n  }\n\n  /**\n   * IText class (introduced in <b>v1.4</b>) Events are also fired with \"text:\"\n   * prefix when observing canvas.\n   * @class fabric.IText\n   * @extends fabric.Text\n   * @mixes fabric.Observable\n   *\n   * @fires changed\n   * @fires selection:changed\n   * @fires editing:entered\n   * @fires editing:exited\n   *\n   * @return {fabric.IText} thisArg\n   * @see {@link fabric.IText#initialize} for constructor definition\n   *\n   * <p>Supported key combinations:</p>\n   * <pre>\n   *   Move cursor:                    left, right, up, down\n   *   Select character:               shift + left, shift + right\n   *   Select text vertically:         shift + up, shift + down\n   *   Move cursor by word:            alt + left, alt + right\n   *   Select words:                   shift + alt + left, shift + alt + right\n   *   Move cursor to line start/end:  cmd + left, cmd + right or home, end\n   *   Select till start/end of line:  cmd + shift + left, cmd + shift + right or shift + home, shift + end\n   *   Jump to start/end of text:      cmd + up, cmd + down\n   *   Select till start/end of text:  cmd + shift + up, cmd + shift + down or shift + pgUp, shift + pgDown\n   *   Delete character:               backspace\n   *   Delete word:                    alt + backspace\n   *   Delete line:                    cmd + backspace\n   *   Forward delete:                 delete\n   *   Copy text:                      ctrl/cmd + c\n   *   Paste text:                     ctrl/cmd + v\n   *   Cut text:                       ctrl/cmd + x\n   *   Select entire text:             ctrl/cmd + a\n   *   Quit editing                    tab or esc\n   * </pre>\n   *\n   * <p>Supported mouse/touch combination</p>\n   * <pre>\n   *   Position cursor:                click/touch\n   *   Create selection:               click/touch & drag\n   *   Create selection:               click & shift + click\n   *   Select word:                    double click\n   *   Select line:                    triple click\n   * </pre>\n   */\n  fabric.IText = fabric.util.createClass(fabric.Text, fabric.Observable, /** @lends fabric.IText.prototype */ {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'i-text',\n\n    /**\n     * Index where text selection starts (or where cursor is when there is no selection)\n     * @type Number\n     * @default\n     */\n    selectionStart: 0,\n\n    /**\n     * Index where text selection ends\n     * @type Number\n     * @default\n     */\n    selectionEnd: 0,\n\n    /**\n     * Color of text selection\n     * @type String\n     * @default\n     */\n    selectionColor: 'rgba(17,119,255,0.3)',\n\n    /**\n     * Indicates whether text is in editing mode\n     * @type Boolean\n     * @default\n     */\n    isEditing: false,\n\n    /**\n     * Indicates whether a text can be edited\n     * @type Boolean\n     * @default\n     */\n    editable: true,\n\n    /**\n     * Border color of text object while it's in editing mode\n     * @type String\n     * @default\n     */\n    editingBorderColor: 'rgba(102,153,255,0.25)',\n\n    /**\n     * Width of cursor (in px)\n     * @type Number\n     * @default\n     */\n    cursorWidth: 2,\n\n    /**\n     * Color of text cursor color in editing mode.\n     * if not set (default) will take color from the text.\n     * if set to a color value that fabric can understand, it will\n     * be used instead of the color of the text at the current position.\n     * @type String\n     * @default\n     */\n    cursorColor: '',\n\n    /**\n     * Delay between cursor blink (in ms)\n     * @type Number\n     * @default\n     */\n    cursorDelay: 1000,\n\n    /**\n     * Duration of cursor fadein (in ms)\n     * @type Number\n     * @default\n     */\n    cursorDuration: 600,\n\n    /**\n     * Indicates whether internal text char widths can be cached\n     * @type Boolean\n     * @default\n     */\n    caching: true,\n\n    /**\n     * DOM container to append the hiddenTextarea.\n     * An alternative to attaching to the document.body.\n     * Useful to reduce laggish redraw of the full document.body tree and\n     * also with modals event capturing that won't let the textarea take focus.\n     * @type HTMLElement\n     * @default\n     */\n    hiddenTextareaContainer: null,\n\n    /**\n     * @private\n     */\n    _reSpace: /\\s|\\n/,\n\n    /**\n     * @private\n     */\n    _currentCursorOpacity: 0,\n\n    /**\n     * @private\n     */\n    _selectionDirection: null,\n\n    /**\n     * @private\n     */\n    _abortCursorAnimation: false,\n\n    /**\n     * @private\n     */\n    __widthOfSpace: [],\n\n    /**\n     * Helps determining when the text is in composition, so that the cursor\n     * rendering is altered.\n     */\n    inCompositionMode: false,\n\n    /**\n     * Constructor\n     * @param {String} text Text string\n     * @param {Object} [options] Options object\n     * @return {fabric.IText} thisArg\n     */\n    initialize: function(text, options) {\n      this.callSuper('initialize', text, options);\n      this.initBehavior();\n    },\n\n    /**\n     * Sets selection start (left boundary of a selection)\n     * @param {Number} index Index to set selection start to\n     */\n    setSelectionStart: function(index) {\n      index = Math.max(index, 0);\n      this._updateAndFire('selectionStart', index);\n    },\n\n    /**\n     * Sets selection end (right boundary of a selection)\n     * @param {Number} index Index to set selection end to\n     */\n    setSelectionEnd: function(index) {\n      index = Math.min(index, this.text.length);\n      this._updateAndFire('selectionEnd', index);\n    },\n\n    /**\n     * @private\n     * @param {String} property 'selectionStart' or 'selectionEnd'\n     * @param {Number} index new position of property\n     */\n    _updateAndFire: function(property, index) {\n      if (this[property] !== index) {\n        this._fireSelectionChanged();\n        this[property] = index;\n      }\n      this._updateTextarea();\n    },\n\n    /**\n     * Fires the even of selection changed\n     * @private\n     */\n    _fireSelectionChanged: function() {\n      this.fire('selection:changed');\n      this.canvas && this.canvas.fire('text:selection:changed', { target: this });\n    },\n\n    /**\n     * Initialize text dimensions. Render all text on given context\n     * or on a offscreen canvas to get the text width with measureText.\n     * Updates this.width and this.height with the proper values.\n     * Does not return dimensions.\n     * @private\n     */\n    initDimensions: function() {\n      this.isEditing && this.initDelayedCursor();\n      this.clearContextTop();\n      this.callSuper('initDimensions');\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    render: function(ctx) {\n      this.clearContextTop();\n      this.callSuper('render', ctx);\n      // clear the cursorOffsetCache, so we ensure to calculate once per renderCursor\n      // the correct position but not at every cursor animation.\n      this.cursorOffsetCache = { };\n      this.renderCursorOrSelection();\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     */\n    _render: function(ctx) {\n      this.callSuper('_render', ctx);\n    },\n\n    /**\n     * Prepare and clean the contextTop\n     */\n    clearContextTop: function(skipRestore) {\n      if (!this.isEditing || !this.canvas || !this.canvas.contextTop) {\n        return;\n      }\n      var ctx = this.canvas.contextTop, v = this.canvas.viewportTransform;\n      ctx.save();\n      ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n      this.transform(ctx);\n      this._clearTextArea(ctx);\n      skipRestore || ctx.restore();\n    },\n    /**\n     * Renders cursor or selection (depending on what exists)\n     * it does on the contextTop. If contextTop is not available, do nothing.\n     */\n    renderCursorOrSelection: function() {\n      if (!this.isEditing || !this.canvas || !this.canvas.contextTop) {\n        return;\n      }\n      var boundaries = this._getCursorBoundaries(),\n          ctx = this.canvas.contextTop;\n      this.clearContextTop(true);\n      if (this.selectionStart === this.selectionEnd) {\n        this.renderCursor(boundaries, ctx);\n      }\n      else {\n        this.renderSelection(boundaries, ctx);\n      }\n      ctx.restore();\n    },\n\n    _clearTextArea: function(ctx) {\n      // we add 4 pixel, to be sure to do not leave any pixel out\n      var width = this.width + 4, height = this.height + 4;\n      ctx.clearRect(-width / 2, -height / 2, width, height);\n    },\n\n    /**\n     * Returns cursor boundaries (left, top, leftOffset, topOffset)\n     * @private\n     * @param {Array} chars Array of characters\n     * @param {String} typeOfBoundaries\n     */\n    _getCursorBoundaries: function(position) {\n\n      // left/top are left/top of entire text box\n      // leftOffset/topOffset are offset from that left/top point of a text box\n\n      if (typeof position === 'undefined') {\n        position = this.selectionStart;\n      }\n\n      var left = this._getLeftOffset(),\n          top = this._getTopOffset(),\n          offsets = this._getCursorBoundariesOffsets(position);\n      return {\n        left: left,\n        top: top,\n        leftOffset: offsets.left,\n        topOffset: offsets.top\n      };\n    },\n\n    /**\n     * @private\n     */\n    _getCursorBoundariesOffsets: function(position) {\n      if (this.cursorOffsetCache && 'top' in this.cursorOffsetCache) {\n        return this.cursorOffsetCache;\n      }\n      var lineLeftOffset,\n          lineIndex,\n          charIndex,\n          topOffset = 0,\n          leftOffset = 0,\n          boundaries,\n          cursorPosition = this.get2DCursorLocation(position);\n      charIndex = cursorPosition.charIndex;\n      lineIndex = cursorPosition.lineIndex;\n      for (var i = 0; i < lineIndex; i++) {\n        topOffset += this.getHeightOfLine(i);\n      }\n      lineLeftOffset = this._getLineLeftOffset(lineIndex);\n      var bound = this.__charBounds[lineIndex][charIndex];\n      bound && (leftOffset = bound.left);\n      if (this.charSpacing !== 0 && charIndex === this._textLines[lineIndex].length) {\n        leftOffset -= this._getWidthOfCharSpacing();\n      }\n      boundaries = {\n        top: topOffset,\n        left: lineLeftOffset + (leftOffset > 0 ? leftOffset : 0),\n      };\n      if (this.direction === 'rtl') {\n        boundaries.left *= -1;\n      }\n      this.cursorOffsetCache = boundaries;\n      return this.cursorOffsetCache;\n    },\n\n    /**\n     * Renders cursor\n     * @param {Object} boundaries\n     * @param {CanvasRenderingContext2D} ctx transformed context to draw on\n     */\n    renderCursor: function(boundaries, ctx) {\n      var cursorLocation = this.get2DCursorLocation(),\n          lineIndex = cursorLocation.lineIndex,\n          charIndex = cursorLocation.charIndex > 0 ? cursorLocation.charIndex - 1 : 0,\n          charHeight = this.getValueOfPropertyAt(lineIndex, charIndex, 'fontSize'),\n          multiplier = this.scaleX * this.canvas.getZoom(),\n          cursorWidth = this.cursorWidth / multiplier,\n          topOffset = boundaries.topOffset,\n          dy = this.getValueOfPropertyAt(lineIndex, charIndex, 'deltaY');\n      topOffset += (1 - this._fontSizeFraction) * this.getHeightOfLine(lineIndex) / this.lineHeight\n        - charHeight * (1 - this._fontSizeFraction);\n\n      if (this.inCompositionMode) {\n        this.renderSelection(boundaries, ctx);\n      }\n      ctx.fillStyle = this.cursorColor || this.getValueOfPropertyAt(lineIndex, charIndex, 'fill');\n      ctx.globalAlpha = this.__isMousedown ? 1 : this._currentCursorOpacity;\n      ctx.fillRect(\n        boundaries.left + boundaries.leftOffset - cursorWidth / 2,\n        topOffset + boundaries.top + dy,\n        cursorWidth,\n        charHeight);\n    },\n\n    /**\n     * Renders text selection\n     * @param {Object} boundaries Object with left/top/leftOffset/topOffset\n     * @param {CanvasRenderingContext2D} ctx transformed context to draw on\n     */\n    renderSelection: function(boundaries, ctx) {\n\n      var selectionStart = this.inCompositionMode ? this.hiddenTextarea.selectionStart : this.selectionStart,\n          selectionEnd = this.inCompositionMode ? this.hiddenTextarea.selectionEnd : this.selectionEnd,\n          isJustify = this.textAlign.indexOf('justify') !== -1,\n          start = this.get2DCursorLocation(selectionStart),\n          end = this.get2DCursorLocation(selectionEnd),\n          startLine = start.lineIndex,\n          endLine = end.lineIndex,\n          startChar = start.charIndex < 0 ? 0 : start.charIndex,\n          endChar = end.charIndex < 0 ? 0 : end.charIndex;\n\n      for (var i = startLine; i <= endLine; i++) {\n        var lineOffset = this._getLineLeftOffset(i) || 0,\n            lineHeight = this.getHeightOfLine(i),\n            realLineHeight = 0, boxStart = 0, boxEnd = 0;\n\n        if (i === startLine) {\n          boxStart = this.__charBounds[startLine][startChar].left;\n        }\n        if (i >= startLine && i < endLine) {\n          boxEnd = isJustify && !this.isEndOfWrapping(i) ? this.width : this.getLineWidth(i) || 5; // WTF is this 5?\n        }\n        else if (i === endLine) {\n          if (endChar === 0) {\n            boxEnd = this.__charBounds[endLine][endChar].left;\n          }\n          else {\n            var charSpacing = this._getWidthOfCharSpacing();\n            boxEnd = this.__charBounds[endLine][endChar - 1].left\n              + this.__charBounds[endLine][endChar - 1].width - charSpacing;\n          }\n        }\n        realLineHeight = lineHeight;\n        if (this.lineHeight < 1 || (i === endLine && this.lineHeight > 1)) {\n          lineHeight /= this.lineHeight;\n        }\n        var drawStart = boundaries.left + lineOffset + boxStart,\n            drawWidth = boxEnd - boxStart,\n            drawHeight = lineHeight, extraTop = 0;\n        if (this.inCompositionMode) {\n          ctx.fillStyle = this.compositionColor || 'black';\n          drawHeight = 1;\n          extraTop = lineHeight;\n        }\n        else {\n          ctx.fillStyle = this.selectionColor;\n        }\n        if (this.direction === 'rtl') {\n          drawStart = this.width - drawStart - drawWidth;\n        }\n        ctx.fillRect(\n          drawStart,\n          boundaries.top + boundaries.topOffset + extraTop,\n          drawWidth,\n          drawHeight);\n        boundaries.topOffset += realLineHeight;\n      }\n    },\n\n    /**\n     * High level function to know the height of the cursor.\n     * the currentChar is the one that precedes the cursor\n     * Returns fontSize of char at the current cursor\n     * Unused from the library, is for the end user\n     * @return {Number} Character font size\n     */\n    getCurrentCharFontSize: function() {\n      var cp = this._getCurrentCharIndex();\n      return this.getValueOfPropertyAt(cp.l, cp.c, 'fontSize');\n    },\n\n    /**\n     * High level function to know the color of the cursor.\n     * the currentChar is the one that precedes the cursor\n     * Returns color (fill) of char at the current cursor\n     * if the text object has a pattern or gradient for filler, it will return that.\n     * Unused by the library, is for the end user\n     * @return {String | fabric.Gradient | fabric.Pattern} Character color (fill)\n     */\n    getCurrentCharColor: function() {\n      var cp = this._getCurrentCharIndex();\n      return this.getValueOfPropertyAt(cp.l, cp.c, 'fill');\n    },\n\n    /**\n     * Returns the cursor position for the getCurrent.. functions\n     * @private\n     */\n    _getCurrentCharIndex: function() {\n      var cursorPosition = this.get2DCursorLocation(this.selectionStart, true),\n          charIndex = cursorPosition.charIndex > 0 ? cursorPosition.charIndex - 1 : 0;\n      return { l: cursorPosition.lineIndex, c: charIndex };\n    }\n  });\n\n  /**\n   * Returns fabric.IText instance from an object representation\n   * @static\n   * @memberOf fabric.IText\n   * @param {Object} object Object to create an instance from\n   * @param {function} [callback] invoked with new instance as argument\n   */\n  fabric.IText.fromObject = function(object, callback) {\n    var styles = fabric.util.stylesFromArray(object.styles, object.text);\n    //copy object to prevent mutation\n    var objCopy = Object.assign({}, object, { styles: styles });\n    delete objCopy.path;\n    parseDecoration(objCopy);\n    if (objCopy.styles) {\n      for (var i in objCopy.styles) {\n        for (var j in objCopy.styles[i]) {\n          parseDecoration(objCopy.styles[i][j]);\n        }\n      }\n    }\n    fabric.Object._fromObject('IText', objCopy, function(textInstance) {\n      if (object.path) {\n        fabric.Object._fromObject('Path', object.path, function(pathInstance) {\n          textInstance.set('path', pathInstance);\n          callback(textInstance);\n        }, 'path');\n      }\n      else {\n        callback(textInstance);\n      }\n    }, 'text');\n  };\n})();\n\n\n(function() {\n\n  var clone = fabric.util.object.clone;\n\n  fabric.util.object.extend(fabric.IText.prototype, /** @lends fabric.IText.prototype */ {\n\n    /**\n     * Initializes all the interactive behavior of IText\n     */\n    initBehavior: function() {\n      this.initAddedHandler();\n      this.initRemovedHandler();\n      this.initCursorSelectionHandlers();\n      this.initDoubleClickSimulation();\n      this.mouseMoveHandler = this.mouseMoveHandler.bind(this);\n    },\n\n    onDeselect: function() {\n      this.isEditing && this.exitEditing();\n      this.selected = false;\n    },\n\n    /**\n     * Initializes \"added\" event handler\n     */\n    initAddedHandler: function() {\n      var _this = this;\n      this.on('added', function() {\n        var canvas = _this.canvas;\n        if (canvas) {\n          if (!canvas._hasITextHandlers) {\n            canvas._hasITextHandlers = true;\n            _this._initCanvasHandlers(canvas);\n          }\n          canvas._iTextInstances = canvas._iTextInstances || [];\n          canvas._iTextInstances.push(_this);\n        }\n      });\n    },\n\n    initRemovedHandler: function() {\n      var _this = this;\n      this.on('removed', function() {\n        var canvas = _this.canvas;\n        if (canvas) {\n          canvas._iTextInstances = canvas._iTextInstances || [];\n          fabric.util.removeFromArray(canvas._iTextInstances, _this);\n          if (canvas._iTextInstances.length === 0) {\n            canvas._hasITextHandlers = false;\n            _this._removeCanvasHandlers(canvas);\n          }\n        }\n      });\n    },\n\n    /**\n     * register canvas event to manage exiting on other instances\n     * @private\n     */\n    _initCanvasHandlers: function(canvas) {\n      canvas._mouseUpITextHandler = function() {\n        if (canvas._iTextInstances) {\n          canvas._iTextInstances.forEach(function(obj) {\n            obj.__isMousedown = false;\n          });\n        }\n      };\n      canvas.on('mouse:up', canvas._mouseUpITextHandler);\n    },\n\n    /**\n     * remove canvas event to manage exiting on other instances\n     * @private\n     */\n    _removeCanvasHandlers: function(canvas) {\n      canvas.off('mouse:up', canvas._mouseUpITextHandler);\n    },\n\n    /**\n     * @private\n     */\n    _tick: function() {\n      this._currentTickState = this._animateCursor(this, 1, this.cursorDuration, '_onTickComplete');\n    },\n\n    /**\n     * @private\n     */\n    _animateCursor: function(obj, targetOpacity, duration, completeMethod) {\n\n      var tickState;\n\n      tickState = {\n        isAborted: false,\n        abort: function() {\n          this.isAborted = true;\n        },\n      };\n\n      obj.animate('_currentCursorOpacity', targetOpacity, {\n        duration: duration,\n        onComplete: function() {\n          if (!tickState.isAborted) {\n            obj[completeMethod]();\n          }\n        },\n        onChange: function() {\n          // we do not want to animate a selection, only cursor\n          if (obj.canvas && obj.selectionStart === obj.selectionEnd) {\n            obj.renderCursorOrSelection();\n          }\n        },\n        abort: function() {\n          return tickState.isAborted;\n        }\n      });\n      return tickState;\n    },\n\n    /**\n     * @private\n     */\n    _onTickComplete: function() {\n\n      var _this = this;\n\n      if (this._cursorTimeout1) {\n        clearTimeout(this._cursorTimeout1);\n      }\n      this._cursorTimeout1 = setTimeout(function() {\n        _this._currentTickCompleteState = _this._animateCursor(_this, 0, this.cursorDuration / 2, '_tick');\n      }, 100);\n    },\n\n    /**\n     * Initializes delayed cursor\n     */\n    initDelayedCursor: function(restart) {\n      var _this = this,\n          delay = restart ? 0 : this.cursorDelay;\n\n      this.abortCursorAnimation();\n      this._currentCursorOpacity = 1;\n      this._cursorTimeout2 = setTimeout(function() {\n        _this._tick();\n      }, delay);\n    },\n\n    /**\n     * Aborts cursor animation and clears all timeouts\n     */\n    abortCursorAnimation: function() {\n      var shouldClear = this._currentTickState || this._currentTickCompleteState,\n          canvas = this.canvas;\n      this._currentTickState && this._currentTickState.abort();\n      this._currentTickCompleteState && this._currentTickCompleteState.abort();\n\n      clearTimeout(this._cursorTimeout1);\n      clearTimeout(this._cursorTimeout2);\n\n      this._currentCursorOpacity = 0;\n      // to clear just itext area we need to transform the context\n      // it may not be worth it\n      if (shouldClear && canvas) {\n        canvas.clearContext(canvas.contextTop || canvas.contextContainer);\n      }\n\n    },\n\n    /**\n     * Selects entire text\n     * @return {fabric.IText} thisArg\n     * @chainable\n     */\n    selectAll: function() {\n      this.selectionStart = 0;\n      this.selectionEnd = this._text.length;\n      this._fireSelectionChanged();\n      this._updateTextarea();\n      return this;\n    },\n\n    /**\n     * Returns selected text\n     * @return {String}\n     */\n    getSelectedText: function() {\n      return this._text.slice(this.selectionStart, this.selectionEnd).join('');\n    },\n\n    /**\n     * Find new selection index representing start of current word according to current selection index\n     * @param {Number} startFrom Current selection index\n     * @return {Number} New selection index\n     */\n    findWordBoundaryLeft: function(startFrom) {\n      var offset = 0, index = startFrom - 1;\n\n      // remove space before cursor first\n      if (this._reSpace.test(this._text[index])) {\n        while (this._reSpace.test(this._text[index])) {\n          offset++;\n          index--;\n        }\n      }\n      while (/\\S/.test(this._text[index]) && index > -1) {\n        offset++;\n        index--;\n      }\n\n      return startFrom - offset;\n    },\n\n    /**\n     * Find new selection index representing end of current word according to current selection index\n     * @param {Number} startFrom Current selection index\n     * @return {Number} New selection index\n     */\n    findWordBoundaryRight: function(startFrom) {\n      var offset = 0, index = startFrom;\n\n      // remove space after cursor first\n      if (this._reSpace.test(this._text[index])) {\n        while (this._reSpace.test(this._text[index])) {\n          offset++;\n          index++;\n        }\n      }\n      while (/\\S/.test(this._text[index]) && index < this._text.length) {\n        offset++;\n        index++;\n      }\n\n      return startFrom + offset;\n    },\n\n    /**\n     * Find new selection index representing start of current line according to current selection index\n     * @param {Number} startFrom Current selection index\n     * @return {Number} New selection index\n     */\n    findLineBoundaryLeft: function(startFrom) {\n      var offset = 0, index = startFrom - 1;\n\n      while (!/\\n/.test(this._text[index]) && index > -1) {\n        offset++;\n        index--;\n      }\n\n      return startFrom - offset;\n    },\n\n    /**\n     * Find new selection index representing end of current line according to current selection index\n     * @param {Number} startFrom Current selection index\n     * @return {Number} New selection index\n     */\n    findLineBoundaryRight: function(startFrom) {\n      var offset = 0, index = startFrom;\n\n      while (!/\\n/.test(this._text[index]) && index < this._text.length) {\n        offset++;\n        index++;\n      }\n\n      return startFrom + offset;\n    },\n\n    /**\n     * Finds index corresponding to beginning or end of a word\n     * @param {Number} selectionStart Index of a character\n     * @param {Number} direction 1 or -1\n     * @return {Number} Index of the beginning or end of a word\n     */\n    searchWordBoundary: function(selectionStart, direction) {\n      var text = this._text,\n          index     = this._reSpace.test(text[selectionStart]) ? selectionStart - 1 : selectionStart,\n          _char     = text[index],\n          // wrong\n          reNonWord = fabric.reNonWord;\n\n      while (!reNonWord.test(_char) && index > 0 && index < text.length) {\n        index += direction;\n        _char = text[index];\n      }\n      if (reNonWord.test(_char)) {\n        index += direction === 1 ? 0 : 1;\n      }\n      return index;\n    },\n\n    /**\n     * Selects a word based on the index\n     * @param {Number} selectionStart Index of a character\n     */\n    selectWord: function(selectionStart) {\n      selectionStart = selectionStart || this.selectionStart;\n      var newSelectionStart = this.searchWordBoundary(selectionStart, -1), /* search backwards */\n          newSelectionEnd = this.searchWordBoundary(selectionStart, 1); /* search forward */\n\n      this.selectionStart = newSelectionStart;\n      this.selectionEnd = newSelectionEnd;\n      this._fireSelectionChanged();\n      this._updateTextarea();\n      this.renderCursorOrSelection();\n    },\n\n    /**\n     * Selects a line based on the index\n     * @param {Number} selectionStart Index of a character\n     * @return {fabric.IText} thisArg\n     * @chainable\n     */\n    selectLine: function(selectionStart) {\n      selectionStart = selectionStart || this.selectionStart;\n      var newSelectionStart = this.findLineBoundaryLeft(selectionStart),\n          newSelectionEnd = this.findLineBoundaryRight(selectionStart);\n\n      this.selectionStart = newSelectionStart;\n      this.selectionEnd = newSelectionEnd;\n      this._fireSelectionChanged();\n      this._updateTextarea();\n      return this;\n    },\n\n    /**\n     * Enters editing state\n     * @return {fabric.IText} thisArg\n     * @chainable\n     */\n    enterEditing: function(e) {\n      if (this.isEditing || !this.editable) {\n        return;\n      }\n\n      if (this.canvas) {\n        this.canvas.calcOffset();\n        this.exitEditingOnOthers(this.canvas);\n      }\n\n      this.isEditing = true;\n\n      this.initHiddenTextarea(e);\n      this.hiddenTextarea.focus();\n      this.hiddenTextarea.value = this.text;\n      this._updateTextarea();\n      this._saveEditingProps();\n      this._setEditingProps();\n      this._textBeforeEdit = this.text;\n\n      this._tick();\n      this.fire('editing:entered');\n      this._fireSelectionChanged();\n      if (!this.canvas) {\n        return this;\n      }\n      this.canvas.fire('text:editing:entered', { target: this });\n      this.initMouseMoveHandler();\n      this.canvas.requestRenderAll();\n      return this;\n    },\n\n    exitEditingOnOthers: function(canvas) {\n      if (canvas._iTextInstances) {\n        canvas._iTextInstances.forEach(function(obj) {\n          obj.selected = false;\n          if (obj.isEditing) {\n            obj.exitEditing();\n          }\n        });\n      }\n    },\n\n    /**\n     * Initializes \"mousemove\" event handler\n     */\n    initMouseMoveHandler: function() {\n      this.canvas.on('mouse:move', this.mouseMoveHandler);\n    },\n\n    /**\n     * @private\n     */\n    mouseMoveHandler: function(options) {\n      if (!this.__isMousedown || !this.isEditing) {\n        return;\n      }\n\n      // regain focus\n      document.activeElement !== this.hiddenTextarea && this.hiddenTextarea.focus();\n\n      var newSelectionStart = this.getSelectionStartFromPointer(options.e),\n          currentStart = this.selectionStart,\n          currentEnd = this.selectionEnd;\n      if (\n        (newSelectionStart !== this.__selectionStartOnMouseDown || currentStart === currentEnd)\n        &&\n        (currentStart === newSelectionStart || currentEnd === newSelectionStart)\n      ) {\n        return;\n      }\n      if (newSelectionStart > this.__selectionStartOnMouseDown) {\n        this.selectionStart = this.__selectionStartOnMouseDown;\n        this.selectionEnd = newSelectionStart;\n      }\n      else {\n        this.selectionStart = newSelectionStart;\n        this.selectionEnd = this.__selectionStartOnMouseDown;\n      }\n      if (this.selectionStart !== currentStart || this.selectionEnd !== currentEnd) {\n        this.restartCursorIfNeeded();\n        this._fireSelectionChanged();\n        this._updateTextarea();\n        this.renderCursorOrSelection();\n      }\n    },\n\n    /**\n     * @private\n     */\n    _setEditingProps: function() {\n      this.hoverCursor = 'text';\n\n      if (this.canvas) {\n        this.canvas.defaultCursor = this.canvas.moveCursor = 'text';\n      }\n\n      this.borderColor = this.editingBorderColor;\n      this.hasControls = this.selectable = false;\n      this.lockMovementX = this.lockMovementY = true;\n    },\n\n    /**\n     * convert from textarea to grapheme indexes\n     */\n    fromStringToGraphemeSelection: function(start, end, text) {\n      var smallerTextStart = text.slice(0, start),\n          graphemeStart = fabric.util.string.graphemeSplit(smallerTextStart).length;\n      if (start === end) {\n        return { selectionStart: graphemeStart, selectionEnd: graphemeStart };\n      }\n      var smallerTextEnd = text.slice(start, end),\n          graphemeEnd = fabric.util.string.graphemeSplit(smallerTextEnd).length;\n      return { selectionStart: graphemeStart, selectionEnd: graphemeStart + graphemeEnd };\n    },\n\n    /**\n     * convert from fabric to textarea values\n     */\n    fromGraphemeToStringSelection: function(start, end, _text) {\n      var smallerTextStart = _text.slice(0, start),\n          graphemeStart = smallerTextStart.join('').length;\n      if (start === end) {\n        return { selectionStart: graphemeStart, selectionEnd: graphemeStart };\n      }\n      var smallerTextEnd = _text.slice(start, end),\n          graphemeEnd = smallerTextEnd.join('').length;\n      return { selectionStart: graphemeStart, selectionEnd: graphemeStart + graphemeEnd };\n    },\n\n    /**\n     * @private\n     */\n    _updateTextarea: function() {\n      this.cursorOffsetCache = { };\n      if (!this.hiddenTextarea) {\n        return;\n      }\n      if (!this.inCompositionMode) {\n        var newSelection = this.fromGraphemeToStringSelection(this.selectionStart, this.selectionEnd, this._text);\n        this.hiddenTextarea.selectionStart = newSelection.selectionStart;\n        this.hiddenTextarea.selectionEnd = newSelection.selectionEnd;\n      }\n      this.updateTextareaPosition();\n    },\n\n    /**\n     * @private\n     */\n    updateFromTextArea: function() {\n      if (!this.hiddenTextarea) {\n        return;\n      }\n      this.cursorOffsetCache = { };\n      this.text = this.hiddenTextarea.value;\n      if (this._shouldClearDimensionCache()) {\n        this.initDimensions();\n        this.setCoords();\n      }\n      var newSelection = this.fromStringToGraphemeSelection(\n        this.hiddenTextarea.selectionStart, this.hiddenTextarea.selectionEnd, this.hiddenTextarea.value);\n      this.selectionEnd = this.selectionStart = newSelection.selectionEnd;\n      if (!this.inCompositionMode) {\n        this.selectionStart = newSelection.selectionStart;\n      }\n      this.updateTextareaPosition();\n    },\n\n    /**\n     * @private\n     */\n    updateTextareaPosition: function() {\n      if (this.selectionStart === this.selectionEnd) {\n        var style = this._calcTextareaPosition();\n        this.hiddenTextarea.style.left = style.left;\n        this.hiddenTextarea.style.top = style.top;\n      }\n    },\n\n    /**\n     * @private\n     * @return {Object} style contains style for hiddenTextarea\n     */\n    _calcTextareaPosition: function() {\n      if (!this.canvas) {\n        return { x: 1, y: 1 };\n      }\n      var desiredPosition = this.inCompositionMode ? this.compositionStart : this.selectionStart,\n          boundaries = this._getCursorBoundaries(desiredPosition),\n          cursorLocation = this.get2DCursorLocation(desiredPosition),\n          lineIndex = cursorLocation.lineIndex,\n          charIndex = cursorLocation.charIndex,\n          charHeight = this.getValueOfPropertyAt(lineIndex, charIndex, 'fontSize') * this.lineHeight,\n          leftOffset = boundaries.leftOffset,\n          m = this.calcTransformMatrix(),\n          p = {\n            x: boundaries.left + leftOffset,\n            y: boundaries.top + boundaries.topOffset + charHeight\n          },\n          retinaScaling = this.canvas.getRetinaScaling(),\n          upperCanvas = this.canvas.upperCanvasEl,\n          upperCanvasWidth = upperCanvas.width / retinaScaling,\n          upperCanvasHeight = upperCanvas.height / retinaScaling,\n          maxWidth = upperCanvasWidth - charHeight,\n          maxHeight = upperCanvasHeight - charHeight,\n          scaleX = upperCanvas.clientWidth / upperCanvasWidth,\n          scaleY = upperCanvas.clientHeight / upperCanvasHeight;\n\n      p = fabric.util.transformPoint(p, m);\n      p = fabric.util.transformPoint(p, this.canvas.viewportTransform);\n      p.x *= scaleX;\n      p.y *= scaleY;\n      if (p.x < 0) {\n        p.x = 0;\n      }\n      if (p.x > maxWidth) {\n        p.x = maxWidth;\n      }\n      if (p.y < 0) {\n        p.y = 0;\n      }\n      if (p.y > maxHeight) {\n        p.y = maxHeight;\n      }\n\n      // add canvas offset on document\n      p.x += this.canvas._offset.left;\n      p.y += this.canvas._offset.top;\n\n      return { left: p.x + 'px', top: p.y + 'px', fontSize: charHeight + 'px', charHeight: charHeight };\n    },\n\n    /**\n     * @private\n     */\n    _saveEditingProps: function() {\n      this._savedProps = {\n        hasControls: this.hasControls,\n        borderColor: this.borderColor,\n        lockMovementX: this.lockMovementX,\n        lockMovementY: this.lockMovementY,\n        hoverCursor: this.hoverCursor,\n        selectable: this.selectable,\n        defaultCursor: this.canvas && this.canvas.defaultCursor,\n        moveCursor: this.canvas && this.canvas.moveCursor\n      };\n    },\n\n    /**\n     * @private\n     */\n    _restoreEditingProps: function() {\n      if (!this._savedProps) {\n        return;\n      }\n\n      this.hoverCursor = this._savedProps.hoverCursor;\n      this.hasControls = this._savedProps.hasControls;\n      this.borderColor = this._savedProps.borderColor;\n      this.selectable = this._savedProps.selectable;\n      this.lockMovementX = this._savedProps.lockMovementX;\n      this.lockMovementY = this._savedProps.lockMovementY;\n\n      if (this.canvas) {\n        this.canvas.defaultCursor = this._savedProps.defaultCursor;\n        this.canvas.moveCursor = this._savedProps.moveCursor;\n      }\n    },\n\n    /**\n     * Exits from editing state\n     * @return {fabric.IText} thisArg\n     * @chainable\n     */\n    exitEditing: function() {\n      var isTextChanged = (this._textBeforeEdit !== this.text);\n      var hiddenTextarea = this.hiddenTextarea;\n      this.selected = false;\n      this.isEditing = false;\n\n      this.selectionEnd = this.selectionStart;\n\n      if (hiddenTextarea) {\n        hiddenTextarea.blur && hiddenTextarea.blur();\n        hiddenTextarea.parentNode && hiddenTextarea.parentNode.removeChild(hiddenTextarea);\n      }\n      this.hiddenTextarea = null;\n      this.abortCursorAnimation();\n      this._restoreEditingProps();\n      this._currentCursorOpacity = 0;\n      if (this._shouldClearDimensionCache()) {\n        this.initDimensions();\n        this.setCoords();\n      }\n      this.fire('editing:exited');\n      isTextChanged && this.fire('modified');\n      if (this.canvas) {\n        this.canvas.off('mouse:move', this.mouseMoveHandler);\n        this.canvas.fire('text:editing:exited', { target: this });\n        isTextChanged && this.canvas.fire('object:modified', { target: this });\n      }\n      return this;\n    },\n\n    /**\n     * @private\n     */\n    _removeExtraneousStyles: function() {\n      for (var prop in this.styles) {\n        if (!this._textLines[prop]) {\n          delete this.styles[prop];\n        }\n      }\n    },\n\n    /**\n     * remove and reflow a style block from start to end.\n     * @param {Number} start linear start position for removal (included in removal)\n     * @param {Number} end linear end position for removal ( excluded from removal )\n     */\n    removeStyleFromTo: function(start, end) {\n      var cursorStart = this.get2DCursorLocation(start, true),\n          cursorEnd = this.get2DCursorLocation(end, true),\n          lineStart = cursorStart.lineIndex,\n          charStart = cursorStart.charIndex,\n          lineEnd = cursorEnd.lineIndex,\n          charEnd = cursorEnd.charIndex,\n          i, styleObj;\n      if (lineStart !== lineEnd) {\n        // step1 remove the trailing of lineStart\n        if (this.styles[lineStart]) {\n          for (i = charStart; i < this._unwrappedTextLines[lineStart].length; i++) {\n            delete this.styles[lineStart][i];\n          }\n        }\n        // step2 move the trailing of lineEnd to lineStart if needed\n        if (this.styles[lineEnd]) {\n          for (i = charEnd; i < this._unwrappedTextLines[lineEnd].length; i++) {\n            styleObj = this.styles[lineEnd][i];\n            if (styleObj) {\n              this.styles[lineStart] || (this.styles[lineStart] = { });\n              this.styles[lineStart][charStart + i - charEnd] = styleObj;\n            }\n          }\n        }\n        // step3 detects lines will be completely removed.\n        for (i = lineStart + 1; i <= lineEnd; i++) {\n          delete this.styles[i];\n        }\n        // step4 shift remaining lines.\n        this.shiftLineStyles(lineEnd, lineStart - lineEnd);\n      }\n      else {\n        // remove and shift left on the same line\n        if (this.styles[lineStart]) {\n          styleObj = this.styles[lineStart];\n          var diff = charEnd - charStart, numericChar, _char;\n          for (i = charStart; i < charEnd; i++) {\n            delete styleObj[i];\n          }\n          for (_char in this.styles[lineStart]) {\n            numericChar = parseInt(_char, 10);\n            if (numericChar >= charEnd) {\n              styleObj[numericChar - diff] = styleObj[_char];\n              delete styleObj[_char];\n            }\n          }\n        }\n      }\n    },\n\n    /**\n     * Shifts line styles up or down\n     * @param {Number} lineIndex Index of a line\n     * @param {Number} offset Can any number?\n     */\n    shiftLineStyles: function(lineIndex, offset) {\n      // shift all line styles by offset upward or downward\n      // do not clone deep. we need new array, not new style objects\n      var clonedStyles = clone(this.styles);\n      for (var line in this.styles) {\n        var numericLine = parseInt(line, 10);\n        if (numericLine > lineIndex) {\n          this.styles[numericLine + offset] = clonedStyles[numericLine];\n          if (!clonedStyles[numericLine - offset]) {\n            delete this.styles[numericLine];\n          }\n        }\n      }\n    },\n\n    restartCursorIfNeeded: function() {\n      if (!this._currentTickState || this._currentTickState.isAborted\n        || !this._currentTickCompleteState || this._currentTickCompleteState.isAborted\n      ) {\n        this.initDelayedCursor();\n      }\n    },\n\n    /**\n     * Handle insertion of more consecutive style lines for when one or more\n     * newlines gets added to the text. Since current style needs to be shifted\n     * first we shift the current style of the number lines needed, then we add\n     * new lines from the last to the first.\n     * @param {Number} lineIndex Index of a line\n     * @param {Number} charIndex Index of a char\n     * @param {Number} qty number of lines to add\n     * @param {Array} copiedStyle Array of objects styles\n     */\n    insertNewlineStyleObject: function(lineIndex, charIndex, qty, copiedStyle) {\n      var currentCharStyle,\n          newLineStyles = {},\n          someStyleIsCarryingOver = false,\n          originalLineLength = this._unwrappedTextLines[lineIndex].length,\n          isEndOfLine = originalLineLength === charIndex;\n\n      qty || (qty = 1);\n      this.shiftLineStyles(lineIndex, qty);\n      if (this.styles[lineIndex]) {\n        currentCharStyle = this.styles[lineIndex][charIndex === 0 ? charIndex : charIndex - 1];\n      }\n      // we clone styles of all chars\n      // after cursor onto the current line\n      for (var index in this.styles[lineIndex]) {\n        var numIndex = parseInt(index, 10);\n        if (numIndex >= charIndex) {\n          someStyleIsCarryingOver = true;\n          newLineStyles[numIndex - charIndex] = this.styles[lineIndex][index];\n          // remove lines from the previous line since they're on a new line now\n          if (!(isEndOfLine && charIndex === 0)) {\n            delete this.styles[lineIndex][index];\n          }\n        }\n      }\n      var styleCarriedOver = false;\n      if (someStyleIsCarryingOver && !isEndOfLine) {\n        // if is end of line, the extra style we copied\n        // is probably not something we want\n        this.styles[lineIndex + qty] = newLineStyles;\n        styleCarriedOver = true;\n      }\n      if (styleCarriedOver || originalLineLength > charIndex) {\n        // skip the last line of since we already prepared it\n        // or contains text without style that we don't want to style\n        // just because it changed lines\n        qty--;\n      }\n      // for the all the lines or all the other lines\n      // we clone current char style onto the next (otherwise empty) line\n      while (qty > 0) {\n        if (copiedStyle && copiedStyle[qty - 1]) {\n          this.styles[lineIndex + qty] = { 0: clone(copiedStyle[qty - 1]) };\n        }\n        else if (currentCharStyle) {\n          this.styles[lineIndex + qty] = { 0: clone(currentCharStyle) };\n        }\n        else {\n          delete this.styles[lineIndex + qty];\n        }\n        qty--;\n      }\n      this._forceClearCache = true;\n    },\n\n    /**\n     * Inserts style object for a given line/char index\n     * @param {Number} lineIndex Index of a line\n     * @param {Number} charIndex Index of a char\n     * @param {Number} quantity number Style object to insert, if given\n     * @param {Array} copiedStyle array of style objects\n     */\n    insertCharStyleObject: function(lineIndex, charIndex, quantity, copiedStyle) {\n      if (!this.styles) {\n        this.styles = {};\n      }\n      var currentLineStyles       = this.styles[lineIndex],\n          currentLineStylesCloned = currentLineStyles ? clone(currentLineStyles) : {};\n\n      quantity || (quantity = 1);\n      // shift all char styles by quantity forward\n      // 0,1,2,3 -> (charIndex=2) -> 0,1,3,4 -> (insert 2) -> 0,1,2,3,4\n      for (var index in currentLineStylesCloned) {\n        var numericIndex = parseInt(index, 10);\n        if (numericIndex >= charIndex) {\n          currentLineStyles[numericIndex + quantity] = currentLineStylesCloned[numericIndex];\n          // only delete the style if there was nothing moved there\n          if (!currentLineStylesCloned[numericIndex - quantity]) {\n            delete currentLineStyles[numericIndex];\n          }\n        }\n      }\n      this._forceClearCache = true;\n      if (copiedStyle) {\n        while (quantity--) {\n          if (!Object.keys(copiedStyle[quantity]).length) {\n            continue;\n          }\n          if (!this.styles[lineIndex]) {\n            this.styles[lineIndex] = {};\n          }\n          this.styles[lineIndex][charIndex + quantity] = clone(copiedStyle[quantity]);\n        }\n        return;\n      }\n      if (!currentLineStyles) {\n        return;\n      }\n      var newStyle = currentLineStyles[charIndex ? charIndex - 1 : 1];\n      while (newStyle && quantity--) {\n        this.styles[lineIndex][charIndex + quantity] = clone(newStyle);\n      }\n    },\n\n    /**\n     * Inserts style object(s)\n     * @param {Array} insertedText Characters at the location where style is inserted\n     * @param {Number} start cursor index for inserting style\n     * @param {Array} [copiedStyle] array of style objects to insert.\n     */\n    insertNewStyleBlock: function(insertedText, start, copiedStyle) {\n      var cursorLoc = this.get2DCursorLocation(start, true),\n          addedLines = [0], linesLength = 0;\n      // get an array of how many char per lines are being added.\n      for (var i = 0; i < insertedText.length; i++) {\n        if (insertedText[i] === '\\n') {\n          linesLength++;\n          addedLines[linesLength] = 0;\n        }\n        else {\n          addedLines[linesLength]++;\n        }\n      }\n      // for the first line copy the style from the current char position.\n      if (addedLines[0] > 0) {\n        this.insertCharStyleObject(cursorLoc.lineIndex, cursorLoc.charIndex, addedLines[0], copiedStyle);\n        copiedStyle = copiedStyle && copiedStyle.slice(addedLines[0] + 1);\n      }\n      linesLength && this.insertNewlineStyleObject(\n        cursorLoc.lineIndex, cursorLoc.charIndex + addedLines[0], linesLength);\n      for (var i = 1; i < linesLength; i++) {\n        if (addedLines[i] > 0) {\n          this.insertCharStyleObject(cursorLoc.lineIndex + i, 0, addedLines[i], copiedStyle);\n        }\n        else if (copiedStyle) {\n          // this test is required in order to close #6841\n          // when a pasted buffer begins with a newline then\n          // this.styles[cursorLoc.lineIndex + i] and copiedStyle[0]\n          // may be undefined for some reason\n          if (this.styles[cursorLoc.lineIndex + i] && copiedStyle[0]) {\n            this.styles[cursorLoc.lineIndex + i][0] = copiedStyle[0];\n          }\n        }\n        copiedStyle = copiedStyle && copiedStyle.slice(addedLines[i] + 1);\n      }\n      // we use i outside the loop to get it like linesLength\n      if (addedLines[i] > 0) {\n        this.insertCharStyleObject(cursorLoc.lineIndex + i, 0, addedLines[i], copiedStyle);\n      }\n    },\n\n    /**\n     * Set the selectionStart and selectionEnd according to the new position of cursor\n     * mimic the key - mouse navigation when shift is pressed.\n     */\n    setSelectionStartEndWithShift: function(start, end, newSelection) {\n      if (newSelection <= start) {\n        if (end === start) {\n          this._selectionDirection = 'left';\n        }\n        else if (this._selectionDirection === 'right') {\n          this._selectionDirection = 'left';\n          this.selectionEnd = start;\n        }\n        this.selectionStart = newSelection;\n      }\n      else if (newSelection > start && newSelection < end) {\n        if (this._selectionDirection === 'right') {\n          this.selectionEnd = newSelection;\n        }\n        else {\n          this.selectionStart = newSelection;\n        }\n      }\n      else {\n        // newSelection is > selection start and end\n        if (end === start) {\n          this._selectionDirection = 'right';\n        }\n        else if (this._selectionDirection === 'left') {\n          this._selectionDirection = 'right';\n          this.selectionStart = end;\n        }\n        this.selectionEnd = newSelection;\n      }\n    },\n\n    setSelectionInBoundaries: function() {\n      var length = this.text.length;\n      if (this.selectionStart > length) {\n        this.selectionStart = length;\n      }\n      else if (this.selectionStart < 0) {\n        this.selectionStart = 0;\n      }\n      if (this.selectionEnd > length) {\n        this.selectionEnd = length;\n      }\n      else if (this.selectionEnd < 0) {\n        this.selectionEnd = 0;\n      }\n    }\n  });\n})();\n\n\nfabric.util.object.extend(fabric.IText.prototype, /** @lends fabric.IText.prototype */ {\n  /**\n   * Initializes \"dbclick\" event handler\n   */\n  initDoubleClickSimulation: function() {\n\n    // for double click\n    this.__lastClickTime = +new Date();\n\n    // for triple click\n    this.__lastLastClickTime = +new Date();\n\n    this.__lastPointer = { };\n\n    this.on('mousedown', this.onMouseDown);\n  },\n\n  /**\n   * Default event handler to simulate triple click\n   * @private\n   */\n  onMouseDown: function(options) {\n    if (!this.canvas) {\n      return;\n    }\n    this.__newClickTime = +new Date();\n    var newPointer = options.pointer;\n    if (this.isTripleClick(newPointer)) {\n      this.fire('tripleclick', options);\n      this._stopEvent(options.e);\n    }\n    this.__lastLastClickTime = this.__lastClickTime;\n    this.__lastClickTime = this.__newClickTime;\n    this.__lastPointer = newPointer;\n    this.__lastIsEditing = this.isEditing;\n    this.__lastSelected = this.selected;\n  },\n\n  isTripleClick: function(newPointer) {\n    return this.__newClickTime - this.__lastClickTime < 500 &&\n        this.__lastClickTime - this.__lastLastClickTime < 500 &&\n        this.__lastPointer.x === newPointer.x &&\n        this.__lastPointer.y === newPointer.y;\n  },\n\n  /**\n   * @private\n   */\n  _stopEvent: function(e) {\n    e.preventDefault && e.preventDefault();\n    e.stopPropagation && e.stopPropagation();\n  },\n\n  /**\n   * Initializes event handlers related to cursor or selection\n   */\n  initCursorSelectionHandlers: function() {\n    this.initMousedownHandler();\n    this.initMouseupHandler();\n    this.initClicks();\n  },\n\n  /**\n   * Default handler for double click, select a word\n   */\n  doubleClickHandler: function(options) {\n    if (!this.isEditing) {\n      return;\n    }\n    this.selectWord(this.getSelectionStartFromPointer(options.e));\n  },\n\n  /**\n   * Default handler for triple click, select a line\n   */\n  tripleClickHandler: function(options) {\n    if (!this.isEditing) {\n      return;\n    }\n    this.selectLine(this.getSelectionStartFromPointer(options.e));\n  },\n\n  /**\n   * Initializes double and triple click event handlers\n   */\n  initClicks: function() {\n    this.on('mousedblclick', this.doubleClickHandler);\n    this.on('tripleclick', this.tripleClickHandler);\n  },\n\n  /**\n   * Default event handler for the basic functionalities needed on _mouseDown\n   * can be overridden to do something different.\n   * Scope of this implementation is: find the click position, set selectionStart\n   * find selectionEnd, initialize the drawing of either cursor or selection area\n   * initializing a mousedDown on a text area will cancel fabricjs knowledge of\n   * current compositionMode. It will be set to false.\n   */\n  _mouseDownHandler: function(options) {\n    if (!this.canvas || !this.editable || (options.e.button && options.e.button !== 1)) {\n      return;\n    }\n\n    this.__isMousedown = true;\n\n    if (this.selected) {\n      this.inCompositionMode = false;\n      this.setCursorByClick(options.e);\n    }\n\n    if (this.isEditing) {\n      this.__selectionStartOnMouseDown = this.selectionStart;\n      if (this.selectionStart === this.selectionEnd) {\n        this.abortCursorAnimation();\n      }\n      this.renderCursorOrSelection();\n    }\n  },\n\n  /**\n   * Default event handler for the basic functionalities needed on mousedown:before\n   * can be overridden to do something different.\n   * Scope of this implementation is: verify the object is already selected when mousing down\n   */\n  _mouseDownHandlerBefore: function(options) {\n    if (!this.canvas || !this.editable || (options.e.button && options.e.button !== 1)) {\n      return;\n    }\n    // we want to avoid that an object that was selected and then becomes unselectable,\n    // may trigger editing mode in some way.\n    this.selected = this === this.canvas._activeObject;\n  },\n\n  /**\n   * Initializes \"mousedown\" event handler\n   */\n  initMousedownHandler: function() {\n    this.on('mousedown', this._mouseDownHandler);\n    this.on('mousedown:before', this._mouseDownHandlerBefore);\n  },\n\n  /**\n   * Initializes \"mouseup\" event handler\n   */\n  initMouseupHandler: function() {\n    this.on('mouseup', this.mouseUpHandler);\n  },\n\n  /**\n   * standard handler for mouse up, overridable\n   * @private\n   */\n  mouseUpHandler: function(options) {\n    this.__isMousedown = false;\n    if (!this.editable || this.group ||\n      (options.transform && options.transform.actionPerformed) ||\n      (options.e.button && options.e.button !== 1)) {\n      return;\n    }\n\n    if (this.canvas) {\n      var currentActive = this.canvas._activeObject;\n      if (currentActive && currentActive !== this) {\n        // avoid running this logic when there is an active object\n        // this because is possible with shift click and fast clicks,\n        // to rapidly deselect and reselect this object and trigger an enterEdit\n        return;\n      }\n    }\n\n    if (this.__lastSelected && !this.__corner) {\n      this.selected = false;\n      this.__lastSelected = false;\n      this.enterEditing(options.e);\n      if (this.selectionStart === this.selectionEnd) {\n        this.initDelayedCursor(true);\n      }\n      else {\n        this.renderCursorOrSelection();\n      }\n    }\n    else {\n      this.selected = true;\n    }\n  },\n\n  /**\n   * Changes cursor location in a text depending on passed pointer (x/y) object\n   * @param {Event} e Event object\n   */\n  setCursorByClick: function(e) {\n    var newSelection = this.getSelectionStartFromPointer(e),\n        start = this.selectionStart, end = this.selectionEnd;\n    if (e.shiftKey) {\n      this.setSelectionStartEndWithShift(start, end, newSelection);\n    }\n    else {\n      this.selectionStart = newSelection;\n      this.selectionEnd = newSelection;\n    }\n    if (this.isEditing) {\n      this._fireSelectionChanged();\n      this._updateTextarea();\n    }\n  },\n\n  /**\n   * Returns index of a character corresponding to where an object was clicked\n   * @param {Event} e Event object\n   * @return {Number} Index of a character\n   */\n  getSelectionStartFromPointer: function(e) {\n    var mouseOffset = this.getLocalPointer(e),\n        prevWidth = 0,\n        width = 0,\n        height = 0,\n        charIndex = 0,\n        lineIndex = 0,\n        lineLeftOffset,\n        line;\n    for (var i = 0, len = this._textLines.length; i < len; i++) {\n      if (height <= mouseOffset.y) {\n        height += this.getHeightOfLine(i) * this.scaleY;\n        lineIndex = i;\n        if (i > 0) {\n          charIndex += this._textLines[i - 1].length + this.missingNewlineOffset(i - 1);\n        }\n      }\n      else {\n        break;\n      }\n    }\n    lineLeftOffset = this._getLineLeftOffset(lineIndex);\n    width = lineLeftOffset * this.scaleX;\n    line = this._textLines[lineIndex];\n    // handling of RTL: in order to get things work correctly,\n    // we assume RTL writing is mirrored compared to LTR writing.\n    // so in position detection we mirror the X offset, and when is time\n    // of rendering it, we mirror it again.\n    if (this.direction === 'rtl') {\n      mouseOffset.x = this.width * this.scaleX - mouseOffset.x + width;\n    }\n    for (var j = 0, jlen = line.length; j < jlen; j++) {\n      prevWidth = width;\n      // i removed something about flipX here, check.\n      width += this.__charBounds[lineIndex][j].kernedWidth * this.scaleX;\n      if (width <= mouseOffset.x) {\n        charIndex++;\n      }\n      else {\n        break;\n      }\n    }\n    return this._getNewSelectionStartFromOffset(mouseOffset, prevWidth, width, charIndex, jlen);\n  },\n\n  /**\n   * @private\n   */\n  _getNewSelectionStartFromOffset: function(mouseOffset, prevWidth, width, index, jlen) {\n    // we need Math.abs because when width is after the last char, the offset is given as 1, while is 0\n    var distanceBtwLastCharAndCursor = mouseOffset.x - prevWidth,\n        distanceBtwNextCharAndCursor = width - mouseOffset.x,\n        offset = distanceBtwNextCharAndCursor > distanceBtwLastCharAndCursor ||\n          distanceBtwNextCharAndCursor < 0 ? 0 : 1,\n        newSelectionStart = index + offset;\n    // if object is horizontally flipped, mirror cursor location from the end\n    if (this.flipX) {\n      newSelectionStart = jlen - newSelectionStart;\n    }\n\n    if (newSelectionStart > this._text.length) {\n      newSelectionStart = this._text.length;\n    }\n\n    return newSelectionStart;\n  }\n});\n\n\nfabric.util.object.extend(fabric.IText.prototype, /** @lends fabric.IText.prototype */ {\n\n  /**\n   * Initializes hidden textarea (needed to bring up keyboard in iOS)\n   */\n  initHiddenTextarea: function() {\n    this.hiddenTextarea = fabric.document.createElement('textarea');\n    this.hiddenTextarea.setAttribute('autocapitalize', 'off');\n    this.hiddenTextarea.setAttribute('autocorrect', 'off');\n    this.hiddenTextarea.setAttribute('autocomplete', 'off');\n    this.hiddenTextarea.setAttribute('spellcheck', 'false');\n    this.hiddenTextarea.setAttribute('data-fabric-hiddentextarea', '');\n    this.hiddenTextarea.setAttribute('wrap', 'off');\n    var style = this._calcTextareaPosition();\n    // line-height: 1px; was removed from the style to fix this:\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=870966\n    this.hiddenTextarea.style.cssText = 'position: absolute; top: ' + style.top +\n    '; left: ' + style.left + '; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px;' +\n    ' padding-top: ' + style.fontSize + ';';\n\n    if (this.hiddenTextareaContainer) {\n      this.hiddenTextareaContainer.appendChild(this.hiddenTextarea);\n    }\n    else {\n      fabric.document.body.appendChild(this.hiddenTextarea);\n    }\n\n    fabric.util.addListener(this.hiddenTextarea, 'keydown', this.onKeyDown.bind(this));\n    fabric.util.addListener(this.hiddenTextarea, 'keyup', this.onKeyUp.bind(this));\n    fabric.util.addListener(this.hiddenTextarea, 'input', this.onInput.bind(this));\n    fabric.util.addListener(this.hiddenTextarea, 'copy', this.copy.bind(this));\n    fabric.util.addListener(this.hiddenTextarea, 'cut', this.copy.bind(this));\n    fabric.util.addListener(this.hiddenTextarea, 'paste', this.paste.bind(this));\n    fabric.util.addListener(this.hiddenTextarea, 'compositionstart', this.onCompositionStart.bind(this));\n    fabric.util.addListener(this.hiddenTextarea, 'compositionupdate', this.onCompositionUpdate.bind(this));\n    fabric.util.addListener(this.hiddenTextarea, 'compositionend', this.onCompositionEnd.bind(this));\n\n    if (!this._clickHandlerInitialized && this.canvas) {\n      fabric.util.addListener(this.canvas.upperCanvasEl, 'click', this.onClick.bind(this));\n      this._clickHandlerInitialized = true;\n    }\n  },\n\n  /**\n   * For functionalities on keyDown\n   * Map a special key to a function of the instance/prototype\n   * If you need different behaviour for ESC or TAB or arrows, you have to change\n   * this map setting the name of a function that you build on the fabric.Itext or\n   * your prototype.\n   * the map change will affect all Instances unless you need for only some text Instances\n   * in that case you have to clone this object and assign your Instance.\n   * this.keysMap = fabric.util.object.clone(this.keysMap);\n   * The function must be in fabric.Itext.prototype.myFunction And will receive event as args[0]\n   */\n  keysMap: {\n    9:  'exitEditing',\n    27: 'exitEditing',\n    33: 'moveCursorUp',\n    34: 'moveCursorDown',\n    35: 'moveCursorRight',\n    36: 'moveCursorLeft',\n    37: 'moveCursorLeft',\n    38: 'moveCursorUp',\n    39: 'moveCursorRight',\n    40: 'moveCursorDown',\n  },\n\n  keysMapRtl: {\n    9:  'exitEditing',\n    27: 'exitEditing',\n    33: 'moveCursorUp',\n    34: 'moveCursorDown',\n    35: 'moveCursorLeft',\n    36: 'moveCursorRight',\n    37: 'moveCursorRight',\n    38: 'moveCursorUp',\n    39: 'moveCursorLeft',\n    40: 'moveCursorDown',\n  },\n\n  /**\n   * For functionalities on keyUp + ctrl || cmd\n   */\n  ctrlKeysMapUp: {\n    67: 'copy',\n    88: 'cut'\n  },\n\n  /**\n   * For functionalities on keyDown + ctrl || cmd\n   */\n  ctrlKeysMapDown: {\n    65: 'selectAll'\n  },\n\n  onClick: function() {\n    // No need to trigger click event here, focus is enough to have the keyboard appear on Android\n    this.hiddenTextarea && this.hiddenTextarea.focus();\n  },\n\n  /**\n   * Handles keydown event\n   * only used for arrows and combination of modifier keys.\n   * @param {Event} e Event object\n   */\n  onKeyDown: function(e) {\n    if (!this.isEditing) {\n      return;\n    }\n    var keyMap = this.direction === 'rtl' ? this.keysMapRtl : this.keysMap;\n    if (e.keyCode in keyMap) {\n      this[keyMap[e.keyCode]](e);\n    }\n    else if ((e.keyCode in this.ctrlKeysMapDown) && (e.ctrlKey || e.metaKey)) {\n      this[this.ctrlKeysMapDown[e.keyCode]](e);\n    }\n    else {\n      return;\n    }\n    e.stopImmediatePropagation();\n    e.preventDefault();\n    if (e.keyCode >= 33 && e.keyCode <= 40) {\n      // if i press an arrow key just update selection\n      this.inCompositionMode = false;\n      this.clearContextTop();\n      this.renderCursorOrSelection();\n    }\n    else {\n      this.canvas && this.canvas.requestRenderAll();\n    }\n  },\n\n  /**\n   * Handles keyup event\n   * We handle KeyUp because ie11 and edge have difficulties copy/pasting\n   * if a copy/cut event fired, keyup is dismissed\n   * @param {Event} e Event object\n   */\n  onKeyUp: function(e) {\n    if (!this.isEditing || this._copyDone || this.inCompositionMode) {\n      this._copyDone = false;\n      return;\n    }\n    if ((e.keyCode in this.ctrlKeysMapUp) && (e.ctrlKey || e.metaKey)) {\n      this[this.ctrlKeysMapUp[e.keyCode]](e);\n    }\n    else {\n      return;\n    }\n    e.stopImmediatePropagation();\n    e.preventDefault();\n    this.canvas && this.canvas.requestRenderAll();\n  },\n\n  /**\n   * Handles onInput event\n   * @param {Event} e Event object\n   */\n  onInput: function(e) {\n    var fromPaste = this.fromPaste;\n    this.fromPaste = false;\n    e && e.stopPropagation();\n    if (!this.isEditing) {\n      return;\n    }\n    // decisions about style changes.\n    var nextText = this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,\n        charCount = this._text.length,\n        nextCharCount = nextText.length,\n        removedText, insertedText,\n        charDiff = nextCharCount - charCount,\n        selectionStart = this.selectionStart, selectionEnd = this.selectionEnd,\n        selection = selectionStart !== selectionEnd,\n        copiedStyle, removeFrom, removeTo;\n    if (this.hiddenTextarea.value === '') {\n      this.styles = { };\n      this.updateFromTextArea();\n      this.fire('changed');\n      if (this.canvas) {\n        this.canvas.fire('text:changed', { target: this });\n        this.canvas.requestRenderAll();\n      }\n      return;\n    }\n\n    var textareaSelection = this.fromStringToGraphemeSelection(\n      this.hiddenTextarea.selectionStart,\n      this.hiddenTextarea.selectionEnd,\n      this.hiddenTextarea.value\n    );\n    var backDelete = selectionStart > textareaSelection.selectionStart;\n\n    if (selection) {\n      removedText = this._text.slice(selectionStart, selectionEnd);\n      charDiff += selectionEnd - selectionStart;\n    }\n    else if (nextCharCount < charCount) {\n      if (backDelete) {\n        removedText = this._text.slice(selectionEnd + charDiff, selectionEnd);\n      }\n      else {\n        removedText = this._text.slice(selectionStart, selectionStart - charDiff);\n      }\n    }\n    insertedText = nextText.slice(textareaSelection.selectionEnd - charDiff, textareaSelection.selectionEnd);\n    if (removedText && removedText.length) {\n      if (insertedText.length) {\n        // let's copy some style before deleting.\n        // we want to copy the style before the cursor OR the style at the cursor if selection\n        // is bigger than 0.\n        copiedStyle = this.getSelectionStyles(selectionStart, selectionStart + 1, false);\n        // now duplicate the style one for each inserted text.\n        copiedStyle = insertedText.map(function() {\n          // this return an array of references, but that is fine since we are\n          // copying the style later.\n          return copiedStyle[0];\n        });\n      }\n      if (selection) {\n        removeFrom = selectionStart;\n        removeTo = selectionEnd;\n      }\n      else if (backDelete) {\n        // detect differences between forwardDelete and backDelete\n        removeFrom = selectionEnd - removedText.length;\n        removeTo = selectionEnd;\n      }\n      else {\n        removeFrom = selectionEnd;\n        removeTo = selectionEnd + removedText.length;\n      }\n      this.removeStyleFromTo(removeFrom, removeTo);\n    }\n    if (insertedText.length) {\n      if (fromPaste && insertedText.join('') === fabric.copiedText && !fabric.disableStyleCopyPaste) {\n        copiedStyle = fabric.copiedTextStyle;\n      }\n      this.insertNewStyleBlock(insertedText, selectionStart, copiedStyle);\n    }\n    this.updateFromTextArea();\n    this.fire('changed');\n    if (this.canvas) {\n      this.canvas.fire('text:changed', { target: this });\n      this.canvas.requestRenderAll();\n    }\n  },\n  /**\n   * Composition start\n   */\n  onCompositionStart: function() {\n    this.inCompositionMode = true;\n  },\n\n  /**\n   * Composition end\n   */\n  onCompositionEnd: function() {\n    this.inCompositionMode = false;\n  },\n\n  // /**\n  //  * Composition update\n  //  */\n  onCompositionUpdate: function(e) {\n    this.compositionStart = e.target.selectionStart;\n    this.compositionEnd = e.target.selectionEnd;\n    this.updateTextareaPosition();\n  },\n\n  /**\n   * Copies selected text\n   * @param {Event} e Event object\n   */\n  copy: function() {\n    if (this.selectionStart === this.selectionEnd) {\n      //do not cut-copy if no selection\n      return;\n    }\n\n    fabric.copiedText = this.getSelectedText();\n    if (!fabric.disableStyleCopyPaste) {\n      fabric.copiedTextStyle = this.getSelectionStyles(this.selectionStart, this.selectionEnd, true);\n    }\n    else {\n      fabric.copiedTextStyle = null;\n    }\n    this._copyDone = true;\n  },\n\n  /**\n   * Pastes text\n   * @param {Event} e Event object\n   */\n  paste: function() {\n    this.fromPaste = true;\n  },\n\n  /**\n   * @private\n   * @param {Event} e Event object\n   * @return {Object} Clipboard data object\n   */\n  _getClipboardData: function(e) {\n    return (e && e.clipboardData) || fabric.window.clipboardData;\n  },\n\n  /**\n   * Finds the width in pixels before the cursor on the same line\n   * @private\n   * @param {Number} lineIndex\n   * @param {Number} charIndex\n   * @return {Number} widthBeforeCursor width before cursor\n   */\n  _getWidthBeforeCursor: function(lineIndex, charIndex) {\n    var widthBeforeCursor = this._getLineLeftOffset(lineIndex), bound;\n\n    if (charIndex > 0) {\n      bound = this.__charBounds[lineIndex][charIndex - 1];\n      widthBeforeCursor += bound.left + bound.width;\n    }\n    return widthBeforeCursor;\n  },\n\n  /**\n   * Gets start offset of a selection\n   * @param {Event} e Event object\n   * @param {Boolean} isRight\n   * @return {Number}\n   */\n  getDownCursorOffset: function(e, isRight) {\n    var selectionProp = this._getSelectionForOffset(e, isRight),\n        cursorLocation = this.get2DCursorLocation(selectionProp),\n        lineIndex = cursorLocation.lineIndex;\n    // if on last line, down cursor goes to end of line\n    if (lineIndex === this._textLines.length - 1 || e.metaKey || e.keyCode === 34) {\n      // move to the end of a text\n      return this._text.length - selectionProp;\n    }\n    var charIndex = cursorLocation.charIndex,\n        widthBeforeCursor = this._getWidthBeforeCursor(lineIndex, charIndex),\n        indexOnOtherLine = this._getIndexOnLine(lineIndex + 1, widthBeforeCursor),\n        textAfterCursor = this._textLines[lineIndex].slice(charIndex);\n    return textAfterCursor.length + indexOnOtherLine + 1 + this.missingNewlineOffset(lineIndex);\n  },\n\n  /**\n   * private\n   * Helps finding if the offset should be counted from Start or End\n   * @param {Event} e Event object\n   * @param {Boolean} isRight\n   * @return {Number}\n   */\n  _getSelectionForOffset: function(e, isRight) {\n    if (e.shiftKey && this.selectionStart !== this.selectionEnd && isRight) {\n      return this.selectionEnd;\n    }\n    else {\n      return this.selectionStart;\n    }\n  },\n\n  /**\n   * @param {Event} e Event object\n   * @param {Boolean} isRight\n   * @return {Number}\n   */\n  getUpCursorOffset: function(e, isRight) {\n    var selectionProp = this._getSelectionForOffset(e, isRight),\n        cursorLocation = this.get2DCursorLocation(selectionProp),\n        lineIndex = cursorLocation.lineIndex;\n    if (lineIndex === 0 || e.metaKey || e.keyCode === 33) {\n      // if on first line, up cursor goes to start of line\n      return -selectionProp;\n    }\n    var charIndex = cursorLocation.charIndex,\n        widthBeforeCursor = this._getWidthBeforeCursor(lineIndex, charIndex),\n        indexOnOtherLine = this._getIndexOnLine(lineIndex - 1, widthBeforeCursor),\n        textBeforeCursor = this._textLines[lineIndex].slice(0, charIndex),\n        missingNewlineOffset = this.missingNewlineOffset(lineIndex - 1);\n    // return a negative offset\n    return -this._textLines[lineIndex - 1].length\n     + indexOnOtherLine - textBeforeCursor.length + (1 - missingNewlineOffset);\n  },\n\n  /**\n   * for a given width it founds the matching character.\n   * @private\n   */\n  _getIndexOnLine: function(lineIndex, width) {\n\n    var line = this._textLines[lineIndex],\n        lineLeftOffset = this._getLineLeftOffset(lineIndex),\n        widthOfCharsOnLine = lineLeftOffset,\n        indexOnLine = 0, charWidth, foundMatch;\n\n    for (var j = 0, jlen = line.length; j < jlen; j++) {\n      charWidth = this.__charBounds[lineIndex][j].width;\n      widthOfCharsOnLine += charWidth;\n      if (widthOfCharsOnLine > width) {\n        foundMatch = true;\n        var leftEdge = widthOfCharsOnLine - charWidth,\n            rightEdge = widthOfCharsOnLine,\n            offsetFromLeftEdge = Math.abs(leftEdge - width),\n            offsetFromRightEdge = Math.abs(rightEdge - width);\n\n        indexOnLine = offsetFromRightEdge < offsetFromLeftEdge ? j : (j - 1);\n        break;\n      }\n    }\n\n    // reached end\n    if (!foundMatch) {\n      indexOnLine = line.length - 1;\n    }\n\n    return indexOnLine;\n  },\n\n\n  /**\n   * Moves cursor down\n   * @param {Event} e Event object\n   */\n  moveCursorDown: function(e) {\n    if (this.selectionStart >= this._text.length && this.selectionEnd >= this._text.length) {\n      return;\n    }\n    this._moveCursorUpOrDown('Down', e);\n  },\n\n  /**\n   * Moves cursor up\n   * @param {Event} e Event object\n   */\n  moveCursorUp: function(e) {\n    if (this.selectionStart === 0 && this.selectionEnd === 0) {\n      return;\n    }\n    this._moveCursorUpOrDown('Up', e);\n  },\n\n  /**\n   * Moves cursor up or down, fires the events\n   * @param {String} direction 'Up' or 'Down'\n   * @param {Event} e Event object\n   */\n  _moveCursorUpOrDown: function(direction, e) {\n    // getUpCursorOffset\n    // getDownCursorOffset\n    var action = 'get' + direction + 'CursorOffset',\n        offset = this[action](e, this._selectionDirection === 'right');\n    if (e.shiftKey) {\n      this.moveCursorWithShift(offset);\n    }\n    else {\n      this.moveCursorWithoutShift(offset);\n    }\n    if (offset !== 0) {\n      this.setSelectionInBoundaries();\n      this.abortCursorAnimation();\n      this._currentCursorOpacity = 1;\n      this.initDelayedCursor();\n      this._fireSelectionChanged();\n      this._updateTextarea();\n    }\n  },\n\n  /**\n   * Moves cursor with shift\n   * @param {Number} offset\n   */\n  moveCursorWithShift: function(offset) {\n    var newSelection = this._selectionDirection === 'left'\n      ? this.selectionStart + offset\n      : this.selectionEnd + offset;\n    this.setSelectionStartEndWithShift(this.selectionStart, this.selectionEnd, newSelection);\n    return offset !== 0;\n  },\n\n  /**\n   * Moves cursor up without shift\n   * @param {Number} offset\n   */\n  moveCursorWithoutShift: function(offset) {\n    if (offset < 0) {\n      this.selectionStart += offset;\n      this.selectionEnd = this.selectionStart;\n    }\n    else {\n      this.selectionEnd += offset;\n      this.selectionStart = this.selectionEnd;\n    }\n    return offset !== 0;\n  },\n\n  /**\n   * Moves cursor left\n   * @param {Event} e Event object\n   */\n  moveCursorLeft: function(e) {\n    if (this.selectionStart === 0 && this.selectionEnd === 0) {\n      return;\n    }\n    this._moveCursorLeftOrRight('Left', e);\n  },\n\n  /**\n   * @private\n   * @return {Boolean} true if a change happened\n   */\n  _move: function(e, prop, direction) {\n    var newValue;\n    if (e.altKey) {\n      newValue = this['findWordBoundary' + direction](this[prop]);\n    }\n    else if (e.metaKey || e.keyCode === 35 ||  e.keyCode === 36 ) {\n      newValue = this['findLineBoundary' + direction](this[prop]);\n    }\n    else {\n      this[prop] += direction === 'Left' ? -1 : 1;\n      return true;\n    }\n    if (typeof newValue !== 'undefined' && this[prop] !== newValue) {\n      this[prop] = newValue;\n      return true;\n    }\n  },\n\n  /**\n   * @private\n   */\n  _moveLeft: function(e, prop) {\n    return this._move(e, prop, 'Left');\n  },\n\n  /**\n   * @private\n   */\n  _moveRight: function(e, prop) {\n    return this._move(e, prop, 'Right');\n  },\n\n  /**\n   * Moves cursor left without keeping selection\n   * @param {Event} e\n   */\n  moveCursorLeftWithoutShift: function(e) {\n    var change = true;\n    this._selectionDirection = 'left';\n\n    // only move cursor when there is no selection,\n    // otherwise we discard it, and leave cursor on same place\n    if (this.selectionEnd === this.selectionStart && this.selectionStart !== 0) {\n      change = this._moveLeft(e, 'selectionStart');\n\n    }\n    this.selectionEnd = this.selectionStart;\n    return change;\n  },\n\n  /**\n   * Moves cursor left while keeping selection\n   * @param {Event} e\n   */\n  moveCursorLeftWithShift: function(e) {\n    if (this._selectionDirection === 'right' && this.selectionStart !== this.selectionEnd) {\n      return this._moveLeft(e, 'selectionEnd');\n    }\n    else if (this.selectionStart !== 0){\n      this._selectionDirection = 'left';\n      return this._moveLeft(e, 'selectionStart');\n    }\n  },\n\n  /**\n   * Moves cursor right\n   * @param {Event} e Event object\n   */\n  moveCursorRight: function(e) {\n    if (this.selectionStart >= this._text.length && this.selectionEnd >= this._text.length) {\n      return;\n    }\n    this._moveCursorLeftOrRight('Right', e);\n  },\n\n  /**\n   * Moves cursor right or Left, fires event\n   * @param {String} direction 'Left', 'Right'\n   * @param {Event} e Event object\n   */\n  _moveCursorLeftOrRight: function(direction, e) {\n    var actionName = 'moveCursor' + direction + 'With';\n    this._currentCursorOpacity = 1;\n\n    if (e.shiftKey) {\n      actionName += 'Shift';\n    }\n    else {\n      actionName += 'outShift';\n    }\n    if (this[actionName](e)) {\n      this.abortCursorAnimation();\n      this.initDelayedCursor();\n      this._fireSelectionChanged();\n      this._updateTextarea();\n    }\n  },\n\n  /**\n   * Moves cursor right while keeping selection\n   * @param {Event} e\n   */\n  moveCursorRightWithShift: function(e) {\n    if (this._selectionDirection === 'left' && this.selectionStart !== this.selectionEnd) {\n      return this._moveRight(e, 'selectionStart');\n    }\n    else if (this.selectionEnd !== this._text.length) {\n      this._selectionDirection = 'right';\n      return this._moveRight(e, 'selectionEnd');\n    }\n  },\n\n  /**\n   * Moves cursor right without keeping selection\n   * @param {Event} e Event object\n   */\n  moveCursorRightWithoutShift: function(e) {\n    var changed = true;\n    this._selectionDirection = 'right';\n\n    if (this.selectionStart === this.selectionEnd) {\n      changed = this._moveRight(e, 'selectionStart');\n      this.selectionEnd = this.selectionStart;\n    }\n    else {\n      this.selectionStart = this.selectionEnd;\n    }\n    return changed;\n  },\n\n  /**\n   * Removes characters from start/end\n   * start/end ar per grapheme position in _text array.\n   *\n   * @param {Number} start\n   * @param {Number} end default to start + 1\n   */\n  removeChars: function(start, end) {\n    if (typeof end === 'undefined') {\n      end = start + 1;\n    }\n    this.removeStyleFromTo(start, end);\n    this._text.splice(start, end - start);\n    this.text = this._text.join('');\n    this.set('dirty', true);\n    if (this._shouldClearDimensionCache()) {\n      this.initDimensions();\n      this.setCoords();\n    }\n    this._removeExtraneousStyles();\n  },\n\n  /**\n   * insert characters at start position, before start position.\n   * start  equal 1 it means the text get inserted between actual grapheme 0 and 1\n   * if style array is provided, it must be as the same length of text in graphemes\n   * if end is provided and is bigger than start, old text is replaced.\n   * start/end ar per grapheme position in _text array.\n   *\n   * @param {String} text text to insert\n   * @param {Array} style array of style objects\n   * @param {Number} start\n   * @param {Number} end default to start + 1\n   */\n  insertChars: function(text, style, start, end) {\n    if (typeof end === 'undefined') {\n      end = start;\n    }\n    if (end > start) {\n      this.removeStyleFromTo(start, end);\n    }\n    var graphemes = fabric.util.string.graphemeSplit(text);\n    this.insertNewStyleBlock(graphemes, start, style);\n    this._text = [].concat(this._text.slice(0, start), graphemes, this._text.slice(end));\n    this.text = this._text.join('');\n    this.set('dirty', true);\n    if (this._shouldClearDimensionCache()) {\n      this.initDimensions();\n      this.setCoords();\n    }\n    this._removeExtraneousStyles();\n  },\n\n});\n\n\n/* _TO_SVG_START_ */\n(function() {\n  var toFixed = fabric.util.toFixed,\n      radiansToDegrees = fabric.util.radiansToDegrees,\n      calcRotateMatrix = fabric.util.calcRotateMatrix,\n      transformPoint = fabric.util.transformPoint,\n      multipleSpacesRegex = /  +/g;\n\n  fabric.util.object.extend(fabric.Text.prototype, /** @lends fabric.Text.prototype */ {\n\n    /**\n     * Returns SVG representation of an instance\n     * @param {Function} [reviver] Method for further parsing of svg representation.\n     * @return {String} svg representation of an instance\n     */\n    _toSVG: function() {\n      var offsets = this._getSVGLeftTopOffsets(),\n          textAndBg = this._getSVGTextAndBg(offsets.textTop, offsets.textLeft);\n      return this._wrapSVGTextAndBg(textAndBg);\n    },\n\n    /**\n     * Returns svg representation of an instance\n     * @param {Function} [reviver] Method for further parsing of svg representation.\n     * @return {String} svg representation of an instance\n     */\n    toSVG: function(reviver) {\n      var textSvg = this._createBaseSVGMarkup(\n            this._toSVG(),\n            { reviver: reviver, noStyle: true, withShadow: true }\n          ),\n          path = this.path;\n\n      if (path) {\n        return (\n          textSvg +\n          path._createBaseSVGMarkup(path._toSVG(), {\n            reviver: reviver,\n            withShadow: true,\n          })\n        );\n      }\n      return textSvg;\n    },\n\n    /**\n     * @private\n     */\n    _getSVGLeftTopOffsets: function() {\n      return {\n        textLeft: -this.width / 2,\n        textTop: -this.height / 2,\n        lineTop: this.getHeightOfLine(0)\n      };\n    },\n\n    /**\n     * @private\n     */\n    _wrapSVGTextAndBg: function(textAndBg) {\n      var noShadow = true,\n          textDecoration = this.getSvgTextDecoration(this);\n      return [\n        textAndBg.textBgRects.join(''),\n        '\\t\\t<text xml:space=\"preserve\" ',\n        (this.fontFamily ? 'font-family=\"' + this.fontFamily.replace(/\"/g, '\\'') + '\" ' : ''),\n        (this.fontSize ? 'font-size=\"' + this.fontSize + '\" ' : ''),\n        (this.fontStyle ? 'font-style=\"' + this.fontStyle + '\" ' : ''),\n        (this.fontWeight ? 'font-weight=\"' + this.fontWeight + '\" ' : ''),\n        (textDecoration ? 'text-decoration=\"' + textDecoration + '\" ' : ''),\n        'style=\"', this.getSvgStyles(noShadow), '\"', this.addPaintOrder(), ' >',\n        textAndBg.textSpans.join(''),\n        '</text>\\n'\n      ];\n    },\n\n    /**\n     * @private\n     * @param {Number} textTopOffset Text top offset\n     * @param {Number} textLeftOffset Text left offset\n     * @return {Object}\n     */\n    _getSVGTextAndBg: function(textTopOffset, textLeftOffset) {\n      var textSpans = [],\n          textBgRects = [],\n          height = textTopOffset, lineOffset;\n      // bounding-box background\n      this._setSVGBg(textBgRects);\n\n      // text and text-background\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\n        lineOffset = this._getLineLeftOffset(i);\n        if (this.textBackgroundColor || this.styleHas('textBackgroundColor', i)) {\n          this._setSVGTextLineBg(textBgRects, i, textLeftOffset + lineOffset, height);\n        }\n        this._setSVGTextLineText(textSpans, i, textLeftOffset + lineOffset, height);\n        height += this.getHeightOfLine(i);\n      }\n\n      return {\n        textSpans: textSpans,\n        textBgRects: textBgRects\n      };\n    },\n\n    /**\n     * @private\n     */\n    _createTextCharSpan: function(_char, styleDecl, left, top, charBox) {\n      var shouldUseWhitespace = _char !== _char.trim() || _char.match(multipleSpacesRegex),\n          styleProps = this.getSvgSpanStyles(styleDecl, shouldUseWhitespace),\n          fillStyles = styleProps ? 'style=\"' + styleProps + '\"' : '',\n          dy = styleDecl.deltaY, dySpan = '',\n          NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS,\n          angleAttr = '';\n      if (dy) {\n        dySpan = ' dy=\"' + toFixed(dy, NUM_FRACTION_DIGITS) + '\" ';\n      }\n      if (charBox.renderLeft !== undefined) {\n        var angle = charBox.angle;\n        angleAttr = ' rotate=\"' + toFixed(radiansToDegrees(angle), fabric.Object.NUM_FRACTION_DIGITS) + '\" ';\n        var wBy2 = charBox.width / 2,\n            m = calcRotateMatrix({ angle: radiansToDegrees(angle) });\n        m[4] = charBox.renderLeft;\n        m[5] = charBox.renderTop;\n        var renderPoint = transformPoint({ x: -wBy2, y: 0 }, m);\n        left = renderPoint.x;\n        top = renderPoint.y;\n      }\n      return [\n        '<tspan x=\"', toFixed(left, NUM_FRACTION_DIGITS), '\" y=\"',\n        toFixed(top, NUM_FRACTION_DIGITS), '\" ', dySpan,\n        fillStyles, angleAttr, '>',\n        fabric.util.string.escapeXml(_char),\n        '</tspan>'\n      ].join('');\n    },\n\n    _setSVGTextLineText: function(textSpans, lineIndex, textLeftOffset, textTopOffset) {\n      // set proper line offset\n      var lineHeight = this.getHeightOfLine(lineIndex),\n          isJustify = this.textAlign.indexOf('justify') !== -1,\n          actualStyle,\n          nextStyle,\n          charsToRender = '',\n          charBox, style,\n          boxWidth = 0,\n          line = this._textLines[lineIndex],\n          timeToRender;\n\n      textTopOffset += lineHeight * (1 - this._fontSizeFraction) / this.lineHeight;\n      for (var i = 0, len = line.length - 1; i <= len; i++) {\n        timeToRender = i === len || this.charSpacing || this.path;\n        charsToRender += line[i];\n        charBox = this.__charBounds[lineIndex][i];\n        if (boxWidth === 0) {\n          textLeftOffset += charBox.kernedWidth - charBox.width;\n          boxWidth += charBox.width;\n        }\n        else {\n          boxWidth += charBox.kernedWidth;\n        }\n        if (isJustify && !timeToRender) {\n          if (this._reSpaceAndTab.test(line[i])) {\n            timeToRender = true;\n          }\n        }\n        if (!timeToRender) {\n          // if we have charSpacing, we render char by char\n          actualStyle = actualStyle || this.getCompleteStyleDeclaration(lineIndex, i);\n          nextStyle = this.getCompleteStyleDeclaration(lineIndex, i + 1);\n          timeToRender = fabric.util.hasStyleChanged(actualStyle, nextStyle, true);\n        }\n        if (timeToRender) {\n          style = this._getStyleDeclaration(lineIndex, i) || { };\n          textSpans.push(this._createTextCharSpan(charsToRender, style, textLeftOffset, textTopOffset, charBox));\n          charsToRender = '';\n          actualStyle = nextStyle;\n          textLeftOffset += boxWidth;\n          boxWidth = 0;\n        }\n      }\n    },\n\n    _pushTextBgRect: function(textBgRects, color, left, top, width, height) {\n      var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS;\n      textBgRects.push(\n        '\\t\\t<rect ',\n        this._getFillAttributes(color),\n        ' x=\"',\n        toFixed(left, NUM_FRACTION_DIGITS),\n        '\" y=\"',\n        toFixed(top, NUM_FRACTION_DIGITS),\n        '\" width=\"',\n        toFixed(width, NUM_FRACTION_DIGITS),\n        '\" height=\"',\n        toFixed(height, NUM_FRACTION_DIGITS),\n        '\"></rect>\\n');\n    },\n\n    _setSVGTextLineBg: function(textBgRects, i, leftOffset, textTopOffset) {\n      var line = this._textLines[i],\n          heightOfLine = this.getHeightOfLine(i) / this.lineHeight,\n          boxWidth = 0,\n          boxStart = 0,\n          charBox, currentColor,\n          lastColor = this.getValueOfPropertyAt(i, 0, 'textBackgroundColor');\n      for (var j = 0, jlen = line.length; j < jlen; j++) {\n        charBox = this.__charBounds[i][j];\n        currentColor = this.getValueOfPropertyAt(i, j, 'textBackgroundColor');\n        if (currentColor !== lastColor) {\n          lastColor && this._pushTextBgRect(textBgRects, lastColor, leftOffset + boxStart,\n            textTopOffset, boxWidth, heightOfLine);\n          boxStart = charBox.left;\n          boxWidth = charBox.width;\n          lastColor = currentColor;\n        }\n        else {\n          boxWidth += charBox.kernedWidth;\n        }\n      }\n      currentColor && this._pushTextBgRect(textBgRects, currentColor, leftOffset + boxStart,\n        textTopOffset, boxWidth, heightOfLine);\n    },\n\n    /**\n     * Adobe Illustrator (at least CS5) is unable to render rgba()-based fill values\n     * we work around it by \"moving\" alpha channel into opacity attribute and setting fill's alpha to 1\n     *\n     * @private\n     * @param {*} value\n     * @return {String}\n     */\n    _getFillAttributes: function(value) {\n      var fillColor = (value && typeof value === 'string') ? new fabric.Color(value) : '';\n      if (!fillColor || !fillColor.getSource() || fillColor.getAlpha() === 1) {\n        return 'fill=\"' + value + '\"';\n      }\n      return 'opacity=\"' + fillColor.getAlpha() + '\" fill=\"' + fillColor.setAlpha(1).toRgb() + '\"';\n    },\n\n    /**\n     * @private\n     */\n    _getSVGLineTopOffset: function(lineIndex) {\n      var lineTopOffset = 0, lastHeight = 0;\n      for (var j = 0; j < lineIndex; j++) {\n        lineTopOffset += this.getHeightOfLine(j);\n      }\n      lastHeight = this.getHeightOfLine(j);\n      return {\n        lineTop: lineTopOffset,\n        offset: (this._fontSizeMult - this._fontSizeFraction) * lastHeight / (this.lineHeight * this._fontSizeMult)\n      };\n    },\n\n    /**\n     * Returns styles-string for svg-export\n     * @param {Boolean} skipShadow a boolean to skip shadow filter output\n     * @return {String}\n     */\n    getSvgStyles: function(skipShadow) {\n      var svgStyle = fabric.Object.prototype.getSvgStyles.call(this, skipShadow);\n      return svgStyle + ' white-space: pre;';\n    },\n  });\n})();\n/* _TO_SVG_END_ */\n\n\n(function(global) {\n\n  'use strict';\n\n  var fabric = global.fabric || (global.fabric = {});\n\n  /**\n   * Textbox class, based on IText, allows the user to resize the text rectangle\n   * and wraps lines automatically. Textboxes have their Y scaling locked, the\n   * user can only change width. Height is adjusted automatically based on the\n   * wrapping of lines.\n   * @class fabric.Textbox\n   * @extends fabric.IText\n   * @mixes fabric.Observable\n   * @return {fabric.Textbox} thisArg\n   * @see {@link fabric.Textbox#initialize} for constructor definition\n   */\n  fabric.Textbox = fabric.util.createClass(fabric.IText, fabric.Observable, {\n\n    /**\n     * Type of an object\n     * @type String\n     * @default\n     */\n    type: 'textbox',\n\n    /**\n     * Minimum width of textbox, in pixels.\n     * @type Number\n     * @default\n     */\n    minWidth: 20,\n\n    /**\n     * Minimum calculated width of a textbox, in pixels.\n     * fixed to 2 so that an empty textbox cannot go to 0\n     * and is still selectable without text.\n     * @type Number\n     * @default\n     */\n    dynamicMinWidth: 2,\n\n    /**\n     * Cached array of text wrapping.\n     * @type Array\n     */\n    __cachedLines: null,\n\n    /**\n     * Override standard Object class values\n     */\n    lockScalingFlip: true,\n\n    /**\n     * Override standard Object class values\n     * Textbox needs this on false\n     */\n    noScaleCache: false,\n\n    /**\n     * Properties which when set cause object to change dimensions\n     * @type Object\n     * @private\n     */\n    _dimensionAffectingProps: fabric.Text.prototype._dimensionAffectingProps.concat('width'),\n\n    /**\n     * Use this regular expression to split strings in breakable lines\n     * @private\n     */\n    _wordJoiners: /[ \\t\\r]/,\n\n    /**\n     * Use this boolean property in order to split strings that have no white space concept.\n     * this is a cheap way to help with chinese/japanese\n     * @type Boolean\n     * @since 2.6.0\n     */\n    splitByGrapheme: false,\n\n    /**\n     * Unlike superclass's version of this function, Textbox does not update\n     * its width.\n     * @private\n     * @override\n     */\n    initDimensions: function() {\n      if (this.__skipDimension) {\n        return;\n      }\n      this.isEditing && this.initDelayedCursor();\n      this.clearContextTop();\n      this._clearCache();\n      // clear dynamicMinWidth as it will be different after we re-wrap line\n      this.dynamicMinWidth = 0;\n      // wrap lines\n      this._styleMap = this._generateStyleMap(this._splitText());\n      // if after wrapping, the width is smaller than dynamicMinWidth, change the width and re-wrap\n      if (this.dynamicMinWidth > this.width) {\n        this._set('width', this.dynamicMinWidth);\n      }\n      if (this.textAlign.indexOf('justify') !== -1) {\n        // once text is measured we need to make space fatter to make justified text.\n        this.enlargeSpaces();\n      }\n      // clear cache and re-calculate height\n      this.height = this.calcTextHeight();\n      this.saveState({ propertySet: '_dimensionAffectingProps' });\n    },\n\n    /**\n     * Generate an object that translates the style object so that it is\n     * broken up by visual lines (new lines and automatic wrapping).\n     * The original text styles object is broken up by actual lines (new lines only),\n     * which is only sufficient for Text / IText\n     * @private\n     */\n    _generateStyleMap: function(textInfo) {\n      var realLineCount     = 0,\n          realLineCharCount = 0,\n          charCount         = 0,\n          map               = {};\n\n      for (var i = 0; i < textInfo.graphemeLines.length; i++) {\n        if (textInfo.graphemeText[charCount] === '\\n' && i > 0) {\n          realLineCharCount = 0;\n          charCount++;\n          realLineCount++;\n        }\n        else if (!this.splitByGrapheme && this._reSpaceAndTab.test(textInfo.graphemeText[charCount]) && i > 0) {\n          // this case deals with space's that are removed from end of lines when wrapping\n          realLineCharCount++;\n          charCount++;\n        }\n\n        map[i] = { line: realLineCount, offset: realLineCharCount };\n\n        charCount += textInfo.graphemeLines[i].length;\n        realLineCharCount += textInfo.graphemeLines[i].length;\n      }\n\n      return map;\n    },\n\n    /**\n     * Returns true if object has a style property or has it on a specified line\n     * @param {Number} lineIndex\n     * @return {Boolean}\n     */\n    styleHas: function(property, lineIndex) {\n      if (this._styleMap && !this.isWrapping) {\n        var map = this._styleMap[lineIndex];\n        if (map) {\n          lineIndex = map.line;\n        }\n      }\n      return fabric.Text.prototype.styleHas.call(this, property, lineIndex);\n    },\n\n    /**\n     * Returns true if object has no styling or no styling in a line\n     * @param {Number} lineIndex , lineIndex is on wrapped lines.\n     * @return {Boolean}\n     */\n    isEmptyStyles: function(lineIndex) {\n      if (!this.styles) {\n        return true;\n      }\n      var offset = 0, nextLineIndex = lineIndex + 1, nextOffset, obj, shouldLimit = false,\n          map = this._styleMap[lineIndex], mapNextLine = this._styleMap[lineIndex + 1];\n      if (map) {\n        lineIndex = map.line;\n        offset = map.offset;\n      }\n      if (mapNextLine) {\n        nextLineIndex = mapNextLine.line;\n        shouldLimit = nextLineIndex === lineIndex;\n        nextOffset = mapNextLine.offset;\n      }\n      obj = typeof lineIndex === 'undefined' ? this.styles : { line: this.styles[lineIndex] };\n      for (var p1 in obj) {\n        for (var p2 in obj[p1]) {\n          if (p2 >= offset && (!shouldLimit || p2 < nextOffset)) {\n            // eslint-disable-next-line no-unused-vars\n            for (var p3 in obj[p1][p2]) {\n              return false;\n            }\n          }\n        }\n      }\n      return true;\n    },\n\n    /**\n     * @param {Number} lineIndex\n     * @param {Number} charIndex\n     * @private\n     */\n    _getStyleDeclaration: function(lineIndex, charIndex) {\n      if (this._styleMap && !this.isWrapping) {\n        var map = this._styleMap[lineIndex];\n        if (!map) {\n          return null;\n        }\n        lineIndex = map.line;\n        charIndex = map.offset + charIndex;\n      }\n      return this.callSuper('_getStyleDeclaration', lineIndex, charIndex);\n    },\n\n    /**\n     * @param {Number} lineIndex\n     * @param {Number} charIndex\n     * @param {Object} style\n     * @private\n     */\n    _setStyleDeclaration: function(lineIndex, charIndex, style) {\n      var map = this._styleMap[lineIndex];\n      lineIndex = map.line;\n      charIndex = map.offset + charIndex;\n\n      this.styles[lineIndex][charIndex] = style;\n    },\n\n    /**\n     * @param {Number} lineIndex\n     * @param {Number} charIndex\n     * @private\n     */\n    _deleteStyleDeclaration: function(lineIndex, charIndex) {\n      var map = this._styleMap[lineIndex];\n      lineIndex = map.line;\n      charIndex = map.offset + charIndex;\n      delete this.styles[lineIndex][charIndex];\n    },\n\n    /**\n     * probably broken need a fix\n     * Returns the real style line that correspond to the wrapped lineIndex line\n     * Used just to verify if the line does exist or not.\n     * @param {Number} lineIndex\n     * @returns {Boolean} if the line exists or not\n     * @private\n     */\n    _getLineStyle: function(lineIndex) {\n      var map = this._styleMap[lineIndex];\n      return !!this.styles[map.line];\n    },\n\n    /**\n     * Set the line style to an empty object so that is initialized\n     * @param {Number} lineIndex\n     * @param {Object} style\n     * @private\n     */\n    _setLineStyle: function(lineIndex) {\n      var map = this._styleMap[lineIndex];\n      this.styles[map.line] = {};\n    },\n\n    /**\n     * Wraps text using the 'width' property of Textbox. First this function\n     * splits text on newlines, so we preserve newlines entered by the user.\n     * Then it wraps each line using the width of the Textbox by calling\n     * _wrapLine().\n     * @param {Array} lines The string array of text that is split into lines\n     * @param {Number} desiredWidth width you want to wrap to\n     * @returns {Array} Array of lines\n     */\n    _wrapText: function(lines, desiredWidth) {\n      var wrapped = [], i;\n      this.isWrapping = true;\n      for (i = 0; i < lines.length; i++) {\n        wrapped = wrapped.concat(this._wrapLine(lines[i], i, desiredWidth));\n      }\n      this.isWrapping = false;\n      return wrapped;\n    },\n\n    /**\n     * Helper function to measure a string of text, given its lineIndex and charIndex offset\n     * it gets called when charBounds are not available yet.\n     * @param {CanvasRenderingContext2D} ctx\n     * @param {String} text\n     * @param {number} lineIndex\n     * @param {number} charOffset\n     * @returns {number}\n     * @private\n     */\n    _measureWord: function(word, lineIndex, charOffset) {\n      var width = 0, prevGrapheme, skipLeft = true;\n      charOffset = charOffset || 0;\n      for (var i = 0, len = word.length; i < len; i++) {\n        var box = this._getGraphemeBox(word[i], lineIndex, i + charOffset, prevGrapheme, skipLeft);\n        width += box.kernedWidth;\n        prevGrapheme = word[i];\n      }\n      return width;\n    },\n\n    /**\n     * Wraps a line of text using the width of the Textbox and a context.\n     * @param {Array} line The grapheme array that represent the line\n     * @param {Number} lineIndex\n     * @param {Number} desiredWidth width you want to wrap the line to\n     * @param {Number} reservedSpace space to remove from wrapping for custom functionalities\n     * @returns {Array} Array of line(s) into which the given text is wrapped\n     * to.\n     */\n    _wrapLine: function(_line, lineIndex, desiredWidth, reservedSpace) {\n      var lineWidth = 0,\n          splitByGrapheme = this.splitByGrapheme,\n          graphemeLines = [],\n          line = [],\n          // spaces in different languages?\n          words = splitByGrapheme ? fabric.util.string.graphemeSplit(_line) : _line.split(this._wordJoiners),\n          word = '',\n          offset = 0,\n          infix = splitByGrapheme ? '' : ' ',\n          wordWidth = 0,\n          infixWidth = 0,\n          largestWordWidth = 0,\n          lineJustStarted = true,\n          additionalSpace = this._getWidthOfCharSpacing(),\n          reservedSpace = reservedSpace || 0;\n      // fix a difference between split and graphemeSplit\n      if (words.length === 0) {\n        words.push([]);\n      }\n      desiredWidth -= reservedSpace;\n      for (var i = 0; i < words.length; i++) {\n        // if using splitByGrapheme words are already in graphemes.\n        word = splitByGrapheme ? words[i] : fabric.util.string.graphemeSplit(words[i]);\n        wordWidth = this._measureWord(word, lineIndex, offset);\n        offset += word.length;\n\n        lineWidth += infixWidth + wordWidth - additionalSpace;\n        if (lineWidth > desiredWidth && !lineJustStarted) {\n          graphemeLines.push(line);\n          line = [];\n          lineWidth = wordWidth;\n          lineJustStarted = true;\n        }\n        else {\n          lineWidth += additionalSpace;\n        }\n\n        if (!lineJustStarted && !splitByGrapheme) {\n          line.push(infix);\n        }\n        line = line.concat(word);\n\n        infixWidth = splitByGrapheme ? 0 : this._measureWord([infix], lineIndex, offset);\n        offset++;\n        lineJustStarted = false;\n        // keep track of largest word\n        if (wordWidth > largestWordWidth) {\n          largestWordWidth = wordWidth;\n        }\n      }\n\n      i && graphemeLines.push(line);\n\n      if (largestWordWidth + reservedSpace > this.dynamicMinWidth) {\n        this.dynamicMinWidth = largestWordWidth - additionalSpace + reservedSpace;\n      }\n      return graphemeLines;\n    },\n\n    /**\n     * Detect if the text line is ended with an hard break\n     * text and itext do not have wrapping, return false\n     * @param {Number} lineIndex text to split\n     * @return {Boolean}\n     */\n    isEndOfWrapping: function(lineIndex) {\n      if (!this._styleMap[lineIndex + 1]) {\n        // is last line, return true;\n        return true;\n      }\n      if (this._styleMap[lineIndex + 1].line !== this._styleMap[lineIndex].line) {\n        // this is last line before a line break, return true;\n        return true;\n      }\n      return false;\n    },\n\n    /**\n     * Detect if a line has a linebreak and so we need to account for it when moving\n     * and counting style.\n     * This is important only for splitByGrapheme at the end of wrapping.\n     * If we are not wrapping the offset is always 1\n     * @return Number\n     */\n    missingNewlineOffset: function(lineIndex, skipWrapping) {\n      if (this.splitByGrapheme && !skipWrapping) {\n        return this.isEndOfWrapping(lineIndex) ? 1 : 0;\n      }\n      return 1;\n    },\n\n    /**\n    * Gets lines of text to render in the Textbox. This function calculates\n    * text wrapping on the fly every time it is called.\n    * @param {String} text text to split\n    * @returns {Array} Array of lines in the Textbox.\n    * @override\n    */\n    _splitTextIntoLines: function(text) {\n      var newText = fabric.Text.prototype._splitTextIntoLines.call(this, text),\n          graphemeLines = this._wrapText(newText.lines, this.width),\n          lines = new Array(graphemeLines.length);\n      for (var i = 0; i < graphemeLines.length; i++) {\n        lines[i] = graphemeLines[i].join('');\n      }\n      newText.lines = lines;\n      newText.graphemeLines = graphemeLines;\n      return newText;\n    },\n\n    getMinWidth: function() {\n      return Math.max(this.minWidth, this.dynamicMinWidth);\n    },\n\n    _removeExtraneousStyles: function() {\n      var linesToKeep = {};\n      for (var prop in this._styleMap) {\n        if (this._textLines[prop]) {\n          linesToKeep[this._styleMap[prop].line] = 1;\n        }\n      }\n      for (var prop in this.styles) {\n        if (!linesToKeep[prop]) {\n          delete this.styles[prop];\n        }\n      }\n    },\n\n    /**\n     * Returns object representation of an instance\n     * @method toObject\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} object representation of an instance\n     */\n    toObject: function(propertiesToInclude) {\n      return this.callSuper('toObject', ['minWidth', 'splitByGrapheme'].concat(propertiesToInclude));\n    }\n  });\n\n  /**\n   * Returns fabric.Textbox instance from an object representation\n   * @static\n   * @memberOf fabric.Textbox\n   * @param {Object} object Object to create an instance from\n   * @param {Function} [callback] Callback to invoke when an fabric.Textbox instance is created\n   */\n  fabric.Textbox.fromObject = function(object, callback) {\n    var styles = fabric.util.stylesFromArray(object.styles, object.text);\n    //copy object to prevent mutation\n    var objCopy = Object.assign({}, object, { styles: styles });\n    delete objCopy.path;\n    return fabric.Object._fromObject('Textbox', objCopy,  function(textInstance) {\n      if (object.path) {\n        fabric.Object._fromObject('Path', object.path, function(pathInstance) {\n          textInstance.set('path', pathInstance);\n          callback(textInstance);\n        }, 'path');\n      }\n      else {\n        callback(textInstance);\n      }\n    }, 'text');\n  };\n})(typeof exports !== 'undefined' ? exports : this);\n\n\n(function() {\n\n  var controlsUtils = fabric.controlsUtils,\n      scaleSkewStyleHandler = controlsUtils.scaleSkewCursorStyleHandler,\n      scaleStyleHandler = controlsUtils.scaleCursorStyleHandler,\n      scalingEqually = controlsUtils.scalingEqually,\n      scalingYOrSkewingX = controlsUtils.scalingYOrSkewingX,\n      scalingXOrSkewingY = controlsUtils.scalingXOrSkewingY,\n      scaleOrSkewActionName = controlsUtils.scaleOrSkewActionName,\n      objectControls = fabric.Object.prototype.controls;\n\n  objectControls.ml = new fabric.Control({\n    x: -0.5,\n    y: 0,\n    cursorStyleHandler: scaleSkewStyleHandler,\n    actionHandler: scalingXOrSkewingY,\n    getActionName: scaleOrSkewActionName,\n  });\n\n  objectControls.mr = new fabric.Control({\n    x: 0.5,\n    y: 0,\n    cursorStyleHandler: scaleSkewStyleHandler,\n    actionHandler: scalingXOrSkewingY,\n    getActionName: scaleOrSkewActionName,\n  });\n\n  objectControls.mb = new fabric.Control({\n    x: 0,\n    y: 0.5,\n    cursorStyleHandler: scaleSkewStyleHandler,\n    actionHandler: scalingYOrSkewingX,\n    getActionName: scaleOrSkewActionName,\n  });\n\n  objectControls.mt = new fabric.Control({\n    x: 0,\n    y: -0.5,\n    cursorStyleHandler: scaleSkewStyleHandler,\n    actionHandler: scalingYOrSkewingX,\n    getActionName: scaleOrSkewActionName,\n  });\n\n  objectControls.tl = new fabric.Control({\n    x: -0.5,\n    y: -0.5,\n    cursorStyleHandler: scaleStyleHandler,\n    actionHandler: scalingEqually\n  });\n\n  objectControls.tr = new fabric.Control({\n    x: 0.5,\n    y: -0.5,\n    cursorStyleHandler: scaleStyleHandler,\n    actionHandler: scalingEqually\n  });\n\n  objectControls.bl = new fabric.Control({\n    x: -0.5,\n    y: 0.5,\n    cursorStyleHandler: scaleStyleHandler,\n    actionHandler: scalingEqually\n  });\n\n  objectControls.br = new fabric.Control({\n    x: 0.5,\n    y: 0.5,\n    cursorStyleHandler: scaleStyleHandler,\n    actionHandler: scalingEqually\n  });\n\n  objectControls.mtr = new fabric.Control({\n    x: 0,\n    y: -0.5,\n    actionHandler: controlsUtils.rotationWithSnapping,\n    cursorStyleHandler: controlsUtils.rotationStyleHandler,\n    offsetY: -40,\n    withConnection: true,\n    actionName: 'rotate',\n  });\n\n  if (fabric.Textbox) {\n    // this is breaking the prototype inheritance, no time / ideas to fix it.\n    // is important to document that if you want to have all objects to have a\n    // specific custom control, you have to add it to Object prototype and to Textbox\n    // prototype. The controls are shared as references. So changes to control `tr`\n    // can still apply to all objects if needed.\n    var textBoxControls = fabric.Textbox.prototype.controls = { };\n\n    textBoxControls.mtr = objectControls.mtr;\n    textBoxControls.tr = objectControls.tr;\n    textBoxControls.br = objectControls.br;\n    textBoxControls.tl = objectControls.tl;\n    textBoxControls.bl = objectControls.bl;\n    textBoxControls.mt = objectControls.mt;\n    textBoxControls.mb = objectControls.mb;\n\n    textBoxControls.mr = new fabric.Control({\n      x: 0.5,\n      y: 0,\n      actionHandler: controlsUtils.changeWidth,\n      cursorStyleHandler: scaleSkewStyleHandler,\n      actionName: 'resizing',\n    });\n\n    textBoxControls.ml = new fabric.Control({\n      x: -0.5,\n      y: 0,\n      actionHandler: controlsUtils.changeWidth,\n      cursorStyleHandler: scaleSkewStyleHandler,\n      actionName: 'resizing',\n    });\n  }\n})();\n\n","(function(a,b){if(\"function\"==typeof define&&define.amd)define([],b);else if(\"undefined\"!=typeof exports)b();else{b(),a.FileSaver={exports:{}}.exports}})(this,function(){\"use strict\";function b(a,b){return\"undefined\"==typeof b?b={autoBom:!1}:\"object\"!=typeof b&&(console.warn(\"Deprecated: Expected third argument to be a object\"),b={autoBom:!b}),b.autoBom&&/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(a.type)?new Blob([\"\\uFEFF\",a],{type:a.type}):a}function c(a,b,c){var d=new XMLHttpRequest;d.open(\"GET\",a),d.responseType=\"blob\",d.onload=function(){g(d.response,b,c)},d.onerror=function(){console.error(\"could not download file\")},d.send()}function d(a){var b=new XMLHttpRequest;b.open(\"HEAD\",a,!1);try{b.send()}catch(a){}return 200<=b.status&&299>=b.status}function e(a){try{a.dispatchEvent(new MouseEvent(\"click\"))}catch(c){var b=document.createEvent(\"MouseEvents\");b.initMouseEvent(\"click\",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),a.dispatchEvent(b)}}var f=\"object\"==typeof window&&window.window===window?window:\"object\"==typeof self&&self.self===self?self:\"object\"==typeof global&&global.global===global?global:void 0,a=f.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),g=f.saveAs||(\"object\"!=typeof window||window!==f?function(){}:\"download\"in HTMLAnchorElement.prototype&&!a?function(b,g,h){var i=f.URL||f.webkitURL,j=document.createElement(\"a\");g=g||b.name||\"download\",j.download=g,j.rel=\"noopener\",\"string\"==typeof b?(j.href=b,j.origin===location.origin?e(j):d(j.href)?c(b,g,h):e(j,j.target=\"_blank\")):(j.href=i.createObjectURL(b),setTimeout(function(){i.revokeObjectURL(j.href)},4E4),setTimeout(function(){e(j)},0))}:\"msSaveOrOpenBlob\"in navigator?function(f,g,h){if(g=g||f.name||\"download\",\"string\"!=typeof f)navigator.msSaveOrOpenBlob(b(f,h),g);else if(d(f))c(f,g,h);else{var i=document.createElement(\"a\");i.href=f,i.target=\"_blank\",setTimeout(function(){e(i)})}}:function(b,d,e,g){if(g=g||open(\"\",\"_blank\"),g&&(g.document.title=g.document.body.innerText=\"downloading...\"),\"string\"==typeof b)return c(b,d,e);var h=\"application/octet-stream\"===b.type,i=/constructor/i.test(f.HTMLElement)||f.safari,j=/CriOS\\/[\\d]+/.test(navigator.userAgent);if((j||h&&i||a)&&\"undefined\"!=typeof FileReader){var k=new FileReader;k.onloadend=function(){var a=k.result;a=j?a:a.replace(/^data:[^;]*;/,\"data:attachment/file;\"),g?g.location.href=a:location=a,g=null},k.readAsDataURL(b)}else{var l=f.URL||f.webkitURL,m=l.createObjectURL(b);g?g.location=m:location.href=m,g=null,setTimeout(function(){l.revokeObjectURL(m)},4E4)}});f.saveAs=g.saveAs=g,\"undefined\"!=typeof module&&(module.exports=g)});\n\n//# sourceMappingURL=FileSaver.min.js.map","//! moment.js\n//! version : 2.29.4\n//! authors : Tim Wood, Iskren Chernev, Moment.js contributors\n//! license : MIT\n//! momentjs.com\n\n;(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    global.moment = factory()\n}(this, (function () { 'use strict';\n\n    var hookCallback;\n\n    function hooks() {\n        return hookCallback.apply(null, arguments);\n    }\n\n    // This is done to register the method called with moment()\n    // without creating circular dependencies.\n    function setHookCallback(callback) {\n        hookCallback = callback;\n    }\n\n    function isArray(input) {\n        return (\n            input instanceof Array ||\n            Object.prototype.toString.call(input) === '[object Array]'\n        );\n    }\n\n    function isObject(input) {\n        // IE8 will treat undefined and null as object if it wasn't for\n        // input != null\n        return (\n            input != null &&\n            Object.prototype.toString.call(input) === '[object Object]'\n        );\n    }\n\n    function hasOwnProp(a, b) {\n        return Object.prototype.hasOwnProperty.call(a, b);\n    }\n\n    function isObjectEmpty(obj) {\n        if (Object.getOwnPropertyNames) {\n            return Object.getOwnPropertyNames(obj).length === 0;\n        } else {\n            var k;\n            for (k in obj) {\n                if (hasOwnProp(obj, k)) {\n                    return false;\n                }\n            }\n            return true;\n        }\n    }\n\n    function isUndefined(input) {\n        return input === void 0;\n    }\n\n    function isNumber(input) {\n        return (\n            typeof input === 'number' ||\n            Object.prototype.toString.call(input) === '[object Number]'\n        );\n    }\n\n    function isDate(input) {\n        return (\n            input instanceof Date ||\n            Object.prototype.toString.call(input) === '[object Date]'\n        );\n    }\n\n    function map(arr, fn) {\n        var res = [],\n            i,\n            arrLen = arr.length;\n        for (i = 0; i < arrLen; ++i) {\n            res.push(fn(arr[i], i));\n        }\n        return res;\n    }\n\n    function extend(a, b) {\n        for (var i in b) {\n            if (hasOwnProp(b, i)) {\n                a[i] = b[i];\n            }\n        }\n\n        if (hasOwnProp(b, 'toString')) {\n            a.toString = b.toString;\n        }\n\n        if (hasOwnProp(b, 'valueOf')) {\n            a.valueOf = b.valueOf;\n        }\n\n        return a;\n    }\n\n    function createUTC(input, format, locale, strict) {\n        return createLocalOrUTC(input, format, locale, strict, true).utc();\n    }\n\n    function defaultParsingFlags() {\n        // We need to deep clone this object.\n        return {\n            empty: false,\n            unusedTokens: [],\n            unusedInput: [],\n            overflow: -2,\n            charsLeftOver: 0,\n            nullInput: false,\n            invalidEra: null,\n            invalidMonth: null,\n            invalidFormat: false,\n            userInvalidated: false,\n            iso: false,\n            parsedDateParts: [],\n            era: null,\n            meridiem: null,\n            rfc2822: false,\n            weekdayMismatch: false,\n        };\n    }\n\n    function getParsingFlags(m) {\n        if (m._pf == null) {\n            m._pf = defaultParsingFlags();\n        }\n        return m._pf;\n    }\n\n    var some;\n    if (Array.prototype.some) {\n        some = Array.prototype.some;\n    } else {\n        some = function (fun) {\n            var t = Object(this),\n                len = t.length >>> 0,\n                i;\n\n            for (i = 0; i < len; i++) {\n                if (i in t && fun.call(this, t[i], i, t)) {\n                    return true;\n                }\n            }\n\n            return false;\n        };\n    }\n\n    function isValid(m) {\n        if (m._isValid == null) {\n            var flags = getParsingFlags(m),\n                parsedParts = some.call(flags.parsedDateParts, function (i) {\n                    return i != null;\n                }),\n                isNowValid =\n                    !isNaN(m._d.getTime()) &&\n                    flags.overflow < 0 &&\n                    !flags.empty &&\n                    !flags.invalidEra &&\n                    !flags.invalidMonth &&\n                    !flags.invalidWeekday &&\n                    !flags.weekdayMismatch &&\n                    !flags.nullInput &&\n                    !flags.invalidFormat &&\n                    !flags.userInvalidated &&\n                    (!flags.meridiem || (flags.meridiem && parsedParts));\n\n            if (m._strict) {\n                isNowValid =\n                    isNowValid &&\n                    flags.charsLeftOver === 0 &&\n                    flags.unusedTokens.length === 0 &&\n                    flags.bigHour === undefined;\n            }\n\n            if (Object.isFrozen == null || !Object.isFrozen(m)) {\n                m._isValid = isNowValid;\n            } else {\n                return isNowValid;\n            }\n        }\n        return m._isValid;\n    }\n\n    function createInvalid(flags) {\n        var m = createUTC(NaN);\n        if (flags != null) {\n            extend(getParsingFlags(m), flags);\n        } else {\n            getParsingFlags(m).userInvalidated = true;\n        }\n\n        return m;\n    }\n\n    // Plugins that add properties should also add the key here (null value),\n    // so we can properly clone ourselves.\n    var momentProperties = (hooks.momentProperties = []),\n        updateInProgress = false;\n\n    function copyConfig(to, from) {\n        var i,\n            prop,\n            val,\n            momentPropertiesLen = momentProperties.length;\n\n        if (!isUndefined(from._isAMomentObject)) {\n            to._isAMomentObject = from._isAMomentObject;\n        }\n        if (!isUndefined(from._i)) {\n            to._i = from._i;\n        }\n        if (!isUndefined(from._f)) {\n            to._f = from._f;\n        }\n        if (!isUndefined(from._l)) {\n            to._l = from._l;\n        }\n        if (!isUndefined(from._strict)) {\n            to._strict = from._strict;\n        }\n        if (!isUndefined(from._tzm)) {\n            to._tzm = from._tzm;\n        }\n        if (!isUndefined(from._isUTC)) {\n            to._isUTC = from._isUTC;\n        }\n        if (!isUndefined(from._offset)) {\n            to._offset = from._offset;\n        }\n        if (!isUndefined(from._pf)) {\n            to._pf = getParsingFlags(from);\n        }\n        if (!isUndefined(from._locale)) {\n            to._locale = from._locale;\n        }\n\n        if (momentPropertiesLen > 0) {\n            for (i = 0; i < momentPropertiesLen; i++) {\n                prop = momentProperties[i];\n                val = from[prop];\n                if (!isUndefined(val)) {\n                    to[prop] = val;\n                }\n            }\n        }\n\n        return to;\n    }\n\n    // Moment prototype object\n    function Moment(config) {\n        copyConfig(this, config);\n        this._d = new Date(config._d != null ? config._d.getTime() : NaN);\n        if (!this.isValid()) {\n            this._d = new Date(NaN);\n        }\n        // Prevent infinite loop in case updateOffset creates new moment\n        // objects.\n        if (updateInProgress === false) {\n            updateInProgress = true;\n            hooks.updateOffset(this);\n            updateInProgress = false;\n        }\n    }\n\n    function isMoment(obj) {\n        return (\n            obj instanceof Moment || (obj != null && obj._isAMomentObject != null)\n        );\n    }\n\n    function warn(msg) {\n        if (\n            hooks.suppressDeprecationWarnings === false &&\n            typeof console !== 'undefined' &&\n            console.warn\n        ) {\n            console.warn('Deprecation warning: ' + msg);\n        }\n    }\n\n    function deprecate(msg, fn) {\n        var firstTime = true;\n\n        return extend(function () {\n            if (hooks.deprecationHandler != null) {\n                hooks.deprecationHandler(null, msg);\n            }\n            if (firstTime) {\n                var args = [],\n                    arg,\n                    i,\n                    key,\n                    argLen = arguments.length;\n                for (i = 0; i < argLen; i++) {\n                    arg = '';\n                    if (typeof arguments[i] === 'object') {\n                        arg += '\\n[' + i + '] ';\n                        for (key in arguments[0]) {\n                            if (hasOwnProp(arguments[0], key)) {\n                                arg += key + ': ' + arguments[0][key] + ', ';\n                            }\n                        }\n                        arg = arg.slice(0, -2); // Remove trailing comma and space\n                    } else {\n                        arg = arguments[i];\n                    }\n                    args.push(arg);\n                }\n                warn(\n                    msg +\n                        '\\nArguments: ' +\n                        Array.prototype.slice.call(args).join('') +\n                        '\\n' +\n                        new Error().stack\n                );\n                firstTime = false;\n            }\n            return fn.apply(this, arguments);\n        }, fn);\n    }\n\n    var deprecations = {};\n\n    function deprecateSimple(name, msg) {\n        if (hooks.deprecationHandler != null) {\n            hooks.deprecationHandler(name, msg);\n        }\n        if (!deprecations[name]) {\n            warn(msg);\n            deprecations[name] = true;\n        }\n    }\n\n    hooks.suppressDeprecationWarnings = false;\n    hooks.deprecationHandler = null;\n\n    function isFunction(input) {\n        return (\n            (typeof Function !== 'undefined' && input instanceof Function) ||\n            Object.prototype.toString.call(input) === '[object Function]'\n        );\n    }\n\n    function set(config) {\n        var prop, i;\n        for (i in config) {\n            if (hasOwnProp(config, i)) {\n                prop = config[i];\n                if (isFunction(prop)) {\n                    this[i] = prop;\n                } else {\n                    this['_' + i] = prop;\n                }\n            }\n        }\n        this._config = config;\n        // Lenient ordinal parsing accepts just a number in addition to\n        // number + (possibly) stuff coming from _dayOfMonthOrdinalParse.\n        // TODO: Remove \"ordinalParse\" fallback in next major release.\n        this._dayOfMonthOrdinalParseLenient = new RegExp(\n            (this._dayOfMonthOrdinalParse.source || this._ordinalParse.source) +\n                '|' +\n                /\\d{1,2}/.source\n        );\n    }\n\n    function mergeConfigs(parentConfig, childConfig) {\n        var res = extend({}, parentConfig),\n            prop;\n        for (prop in childConfig) {\n            if (hasOwnProp(childConfig, prop)) {\n                if (isObject(parentConfig[prop]) && isObject(childConfig[prop])) {\n                    res[prop] = {};\n                    extend(res[prop], parentConfig[prop]);\n                    extend(res[prop], childConfig[prop]);\n                } else if (childConfig[prop] != null) {\n                    res[prop] = childConfig[prop];\n                } else {\n                    delete res[prop];\n                }\n            }\n        }\n        for (prop in parentConfig) {\n            if (\n                hasOwnProp(parentConfig, prop) &&\n                !hasOwnProp(childConfig, prop) &&\n                isObject(parentConfig[prop])\n            ) {\n                // make sure changes to properties don't modify parent config\n                res[prop] = extend({}, res[prop]);\n            }\n        }\n        return res;\n    }\n\n    function Locale(config) {\n        if (config != null) {\n            this.set(config);\n        }\n    }\n\n    var keys;\n\n    if (Object.keys) {\n        keys = Object.keys;\n    } else {\n        keys = function (obj) {\n            var i,\n                res = [];\n            for (i in obj) {\n                if (hasOwnProp(obj, i)) {\n                    res.push(i);\n                }\n            }\n            return res;\n        };\n    }\n\n    var defaultCalendar = {\n        sameDay: '[Today at] LT',\n        nextDay: '[Tomorrow at] LT',\n        nextWeek: 'dddd [at] LT',\n        lastDay: '[Yesterday at] LT',\n        lastWeek: '[Last] dddd [at] LT',\n        sameElse: 'L',\n    };\n\n    function calendar(key, mom, now) {\n        var output = this._calendar[key] || this._calendar['sameElse'];\n        return isFunction(output) ? output.call(mom, now) : output;\n    }\n\n    function zeroFill(number, targetLength, forceSign) {\n        var absNumber = '' + Math.abs(number),\n            zerosToFill = targetLength - absNumber.length,\n            sign = number >= 0;\n        return (\n            (sign ? (forceSign ? '+' : '') : '-') +\n            Math.pow(10, Math.max(0, zerosToFill)).toString().substr(1) +\n            absNumber\n        );\n    }\n\n    var formattingTokens =\n            /(\\[[^\\[]*\\])|(\\\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,\n        localFormattingTokens = /(\\[[^\\[]*\\])|(\\\\)?(LTS|LT|LL?L?L?|l{1,4})/g,\n        formatFunctions = {},\n        formatTokenFunctions = {};\n\n    // token:    'M'\n    // padded:   ['MM', 2]\n    // ordinal:  'Mo'\n    // callback: function () { this.month() + 1 }\n    function addFormatToken(token, padded, ordinal, callback) {\n        var func = callback;\n        if (typeof callback === 'string') {\n            func = function () {\n                return this[callback]();\n            };\n        }\n        if (token) {\n            formatTokenFunctions[token] = func;\n        }\n        if (padded) {\n            formatTokenFunctions[padded[0]] = function () {\n                return zeroFill(func.apply(this, arguments), padded[1], padded[2]);\n            };\n        }\n        if (ordinal) {\n            formatTokenFunctions[ordinal] = function () {\n                return this.localeData().ordinal(\n                    func.apply(this, arguments),\n                    token\n                );\n            };\n        }\n    }\n\n    function removeFormattingTokens(input) {\n        if (input.match(/\\[[\\s\\S]/)) {\n            return input.replace(/^\\[|\\]$/g, '');\n        }\n        return input.replace(/\\\\/g, '');\n    }\n\n    function makeFormatFunction(format) {\n        var array = format.match(formattingTokens),\n            i,\n            length;\n\n        for (i = 0, length = array.length; i < length; i++) {\n            if (formatTokenFunctions[array[i]]) {\n                array[i] = formatTokenFunctions[array[i]];\n            } else {\n                array[i] = removeFormattingTokens(array[i]);\n            }\n        }\n\n        return function (mom) {\n            var output = '',\n                i;\n            for (i = 0; i < length; i++) {\n                output += isFunction(array[i])\n                    ? array[i].call(mom, format)\n                    : array[i];\n            }\n            return output;\n        };\n    }\n\n    // format date using native date object\n    function formatMoment(m, format) {\n        if (!m.isValid()) {\n            return m.localeData().invalidDate();\n        }\n\n        format = expandFormat(format, m.localeData());\n        formatFunctions[format] =\n            formatFunctions[format] || makeFormatFunction(format);\n\n        return formatFunctions[format](m);\n    }\n\n    function expandFormat(format, locale) {\n        var i = 5;\n\n        function replaceLongDateFormatTokens(input) {\n            return locale.longDateFormat(input) || input;\n        }\n\n        localFormattingTokens.lastIndex = 0;\n        while (i >= 0 && localFormattingTokens.test(format)) {\n            format = format.replace(\n                localFormattingTokens,\n                replaceLongDateFormatTokens\n            );\n            localFormattingTokens.lastIndex = 0;\n            i -= 1;\n        }\n\n        return format;\n    }\n\n    var defaultLongDateFormat = {\n        LTS: 'h:mm:ss A',\n        LT: 'h:mm A',\n        L: 'MM/DD/YYYY',\n        LL: 'MMMM D, YYYY',\n        LLL: 'MMMM D, YYYY h:mm A',\n        LLLL: 'dddd, MMMM D, YYYY h:mm A',\n    };\n\n    function longDateFormat(key) {\n        var format = this._longDateFormat[key],\n            formatUpper = this._longDateFormat[key.toUpperCase()];\n\n        if (format || !formatUpper) {\n            return format;\n        }\n\n        this._longDateFormat[key] = formatUpper\n            .match(formattingTokens)\n            .map(function (tok) {\n                if (\n                    tok === 'MMMM' ||\n                    tok === 'MM' ||\n                    tok === 'DD' ||\n                    tok === 'dddd'\n                ) {\n                    return tok.slice(1);\n                }\n                return tok;\n            })\n            .join('');\n\n        return this._longDateFormat[key];\n    }\n\n    var defaultInvalidDate = 'Invalid date';\n\n    function invalidDate() {\n        return this._invalidDate;\n    }\n\n    var defaultOrdinal = '%d',\n        defaultDayOfMonthOrdinalParse = /\\d{1,2}/;\n\n    function ordinal(number) {\n        return this._ordinal.replace('%d', number);\n    }\n\n    var defaultRelativeTime = {\n        future: 'in %s',\n        past: '%s ago',\n        s: 'a few seconds',\n        ss: '%d seconds',\n        m: 'a minute',\n        mm: '%d minutes',\n        h: 'an hour',\n        hh: '%d hours',\n        d: 'a day',\n        dd: '%d days',\n        w: 'a week',\n        ww: '%d weeks',\n        M: 'a month',\n        MM: '%d months',\n        y: 'a year',\n        yy: '%d years',\n    };\n\n    function relativeTime(number, withoutSuffix, string, isFuture) {\n        var output = this._relativeTime[string];\n        return isFunction(output)\n            ? output(number, withoutSuffix, string, isFuture)\n            : output.replace(/%d/i, number);\n    }\n\n    function pastFuture(diff, output) {\n        var format = this._relativeTime[diff > 0 ? 'future' : 'past'];\n        return isFunction(format) ? format(output) : format.replace(/%s/i, output);\n    }\n\n    var aliases = {};\n\n    function addUnitAlias(unit, shorthand) {\n        var lowerCase = unit.toLowerCase();\n        aliases[lowerCase] = aliases[lowerCase + 's'] = aliases[shorthand] = unit;\n    }\n\n    function normalizeUnits(units) {\n        return typeof units === 'string'\n            ? aliases[units] || aliases[units.toLowerCase()]\n            : undefined;\n    }\n\n    function normalizeObjectUnits(inputObject) {\n        var normalizedInput = {},\n            normalizedProp,\n            prop;\n\n        for (prop in inputObject) {\n            if (hasOwnProp(inputObject, prop)) {\n                normalizedProp = normalizeUnits(prop);\n                if (normalizedProp) {\n                    normalizedInput[normalizedProp] = inputObject[prop];\n                }\n            }\n        }\n\n        return normalizedInput;\n    }\n\n    var priorities = {};\n\n    function addUnitPriority(unit, priority) {\n        priorities[unit] = priority;\n    }\n\n    function getPrioritizedUnits(unitsObj) {\n        var units = [],\n            u;\n        for (u in unitsObj) {\n            if (hasOwnProp(unitsObj, u)) {\n                units.push({ unit: u, priority: priorities[u] });\n            }\n        }\n        units.sort(function (a, b) {\n            return a.priority - b.priority;\n        });\n        return units;\n    }\n\n    function isLeapYear(year) {\n        return (year % 4 === 0 && year % 100 !== 0) || year % 400 === 0;\n    }\n\n    function absFloor(number) {\n        if (number < 0) {\n            // -0 -> 0\n            return Math.ceil(number) || 0;\n        } else {\n            return Math.floor(number);\n        }\n    }\n\n    function toInt(argumentForCoercion) {\n        var coercedNumber = +argumentForCoercion,\n            value = 0;\n\n        if (coercedNumber !== 0 && isFinite(coercedNumber)) {\n            value = absFloor(coercedNumber);\n        }\n\n        return value;\n    }\n\n    function makeGetSet(unit, keepTime) {\n        return function (value) {\n            if (value != null) {\n                set$1(this, unit, value);\n                hooks.updateOffset(this, keepTime);\n                return this;\n            } else {\n                return get(this, unit);\n            }\n        };\n    }\n\n    function get(mom, unit) {\n        return mom.isValid()\n            ? mom._d['get' + (mom._isUTC ? 'UTC' : '') + unit]()\n            : NaN;\n    }\n\n    function set$1(mom, unit, value) {\n        if (mom.isValid() && !isNaN(value)) {\n            if (\n                unit === 'FullYear' &&\n                isLeapYear(mom.year()) &&\n                mom.month() === 1 &&\n                mom.date() === 29\n            ) {\n                value = toInt(value);\n                mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](\n                    value,\n                    mom.month(),\n                    daysInMonth(value, mom.month())\n                );\n            } else {\n                mom._d['set' + (mom._isUTC ? 'UTC' : '') + unit](value);\n            }\n        }\n    }\n\n    // MOMENTS\n\n    function stringGet(units) {\n        units = normalizeUnits(units);\n        if (isFunction(this[units])) {\n            return this[units]();\n        }\n        return this;\n    }\n\n    function stringSet(units, value) {\n        if (typeof units === 'object') {\n            units = normalizeObjectUnits(units);\n            var prioritized = getPrioritizedUnits(units),\n                i,\n                prioritizedLen = prioritized.length;\n            for (i = 0; i < prioritizedLen; i++) {\n                this[prioritized[i].unit](units[prioritized[i].unit]);\n            }\n        } else {\n            units = normalizeUnits(units);\n            if (isFunction(this[units])) {\n                return this[units](value);\n            }\n        }\n        return this;\n    }\n\n    var match1 = /\\d/, //       0 - 9\n        match2 = /\\d\\d/, //      00 - 99\n        match3 = /\\d{3}/, //     000 - 999\n        match4 = /\\d{4}/, //    0000 - 9999\n        match6 = /[+-]?\\d{6}/, // -999999 - 999999\n        match1to2 = /\\d\\d?/, //       0 - 99\n        match3to4 = /\\d\\d\\d\\d?/, //     999 - 9999\n        match5to6 = /\\d\\d\\d\\d\\d\\d?/, //   99999 - 999999\n        match1to3 = /\\d{1,3}/, //       0 - 999\n        match1to4 = /\\d{1,4}/, //       0 - 9999\n        match1to6 = /[+-]?\\d{1,6}/, // -999999 - 999999\n        matchUnsigned = /\\d+/, //       0 - inf\n        matchSigned = /[+-]?\\d+/, //    -inf - inf\n        matchOffset = /Z|[+-]\\d\\d:?\\d\\d/gi, // +00:00 -00:00 +0000 -0000 or Z\n        matchShortOffset = /Z|[+-]\\d\\d(?::?\\d\\d)?/gi, // +00 -00 +00:00 -00:00 +0000 -0000 or Z\n        matchTimestamp = /[+-]?\\d+(\\.\\d{1,3})?/, // 123456789 123456789.123\n        // any word (or two) characters or numbers including two/three word month in arabic.\n        // includes scottish gaelic two word and hyphenated months\n        matchWord =\n            /[0-9]{0,256}['a-z\\u00A0-\\u05FF\\u0700-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFF07\\uFF10-\\uFFEF]{1,256}|[\\u0600-\\u06FF\\/]{1,256}(\\s*?[\\u0600-\\u06FF]{1,256}){1,2}/i,\n        regexes;\n\n    regexes = {};\n\n    function addRegexToken(token, regex, strictRegex) {\n        regexes[token] = isFunction(regex)\n            ? regex\n            : function (isStrict, localeData) {\n                  return isStrict && strictRegex ? strictRegex : regex;\n              };\n    }\n\n    function getParseRegexForToken(token, config) {\n        if (!hasOwnProp(regexes, token)) {\n            return new RegExp(unescapeFormat(token));\n        }\n\n        return regexes[token](config._strict, config._locale);\n    }\n\n    // Code from http://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\n    function unescapeFormat(s) {\n        return regexEscape(\n            s\n                .replace('\\\\', '')\n                .replace(\n                    /\\\\(\\[)|\\\\(\\])|\\[([^\\]\\[]*)\\]|\\\\(.)/g,\n                    function (matched, p1, p2, p3, p4) {\n                        return p1 || p2 || p3 || p4;\n                    }\n                )\n        );\n    }\n\n    function regexEscape(s) {\n        return s.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n    }\n\n    var tokens = {};\n\n    function addParseToken(token, callback) {\n        var i,\n            func = callback,\n            tokenLen;\n        if (typeof token === 'string') {\n            token = [token];\n        }\n        if (isNumber(callback)) {\n            func = function (input, array) {\n                array[callback] = toInt(input);\n            };\n        }\n        tokenLen = token.length;\n        for (i = 0; i < tokenLen; i++) {\n            tokens[token[i]] = func;\n        }\n    }\n\n    function addWeekParseToken(token, callback) {\n        addParseToken(token, function (input, array, config, token) {\n            config._w = config._w || {};\n            callback(input, config._w, config, token);\n        });\n    }\n\n    function addTimeToArrayFromToken(token, input, config) {\n        if (input != null && hasOwnProp(tokens, token)) {\n            tokens[token](input, config._a, config, token);\n        }\n    }\n\n    var YEAR = 0,\n        MONTH = 1,\n        DATE = 2,\n        HOUR = 3,\n        MINUTE = 4,\n        SECOND = 5,\n        MILLISECOND = 6,\n        WEEK = 7,\n        WEEKDAY = 8;\n\n    function mod(n, x) {\n        return ((n % x) + x) % x;\n    }\n\n    var indexOf;\n\n    if (Array.prototype.indexOf) {\n        indexOf = Array.prototype.indexOf;\n    } else {\n        indexOf = function (o) {\n            // I know\n            var i;\n            for (i = 0; i < this.length; ++i) {\n                if (this[i] === o) {\n                    return i;\n                }\n            }\n            return -1;\n        };\n    }\n\n    function daysInMonth(year, month) {\n        if (isNaN(year) || isNaN(month)) {\n            return NaN;\n        }\n        var modMonth = mod(month, 12);\n        year += (month - modMonth) / 12;\n        return modMonth === 1\n            ? isLeapYear(year)\n                ? 29\n                : 28\n            : 31 - ((modMonth % 7) % 2);\n    }\n\n    // FORMATTING\n\n    addFormatToken('M', ['MM', 2], 'Mo', function () {\n        return this.month() + 1;\n    });\n\n    addFormatToken('MMM', 0, 0, function (format) {\n        return this.localeData().monthsShort(this, format);\n    });\n\n    addFormatToken('MMMM', 0, 0, function (format) {\n        return this.localeData().months(this, format);\n    });\n\n    // ALIASES\n\n    addUnitAlias('month', 'M');\n\n    // PRIORITY\n\n    addUnitPriority('month', 8);\n\n    // PARSING\n\n    addRegexToken('M', match1to2);\n    addRegexToken('MM', match1to2, match2);\n    addRegexToken('MMM', function (isStrict, locale) {\n        return locale.monthsShortRegex(isStrict);\n    });\n    addRegexToken('MMMM', function (isStrict, locale) {\n        return locale.monthsRegex(isStrict);\n    });\n\n    addParseToken(['M', 'MM'], function (input, array) {\n        array[MONTH] = toInt(input) - 1;\n    });\n\n    addParseToken(['MMM', 'MMMM'], function (input, array, config, token) {\n        var month = config._locale.monthsParse(input, token, config._strict);\n        // if we didn't find a month name, mark the date as invalid.\n        if (month != null) {\n            array[MONTH] = month;\n        } else {\n            getParsingFlags(config).invalidMonth = input;\n        }\n    });\n\n    // LOCALES\n\n    var defaultLocaleMonths =\n            'January_February_March_April_May_June_July_August_September_October_November_December'.split(\n                '_'\n            ),\n        defaultLocaleMonthsShort =\n            'Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec'.split('_'),\n        MONTHS_IN_FORMAT = /D[oD]?(\\[[^\\[\\]]*\\]|\\s)+MMMM?/,\n        defaultMonthsShortRegex = matchWord,\n        defaultMonthsRegex = matchWord;\n\n    function localeMonths(m, format) {\n        if (!m) {\n            return isArray(this._months)\n                ? this._months\n                : this._months['standalone'];\n        }\n        return isArray(this._months)\n            ? this._months[m.month()]\n            : this._months[\n                  (this._months.isFormat || MONTHS_IN_FORMAT).test(format)\n                      ? 'format'\n                      : 'standalone'\n              ][m.month()];\n    }\n\n    function localeMonthsShort(m, format) {\n        if (!m) {\n            return isArray(this._monthsShort)\n                ? this._monthsShort\n                : this._monthsShort['standalone'];\n        }\n        return isArray(this._monthsShort)\n            ? this._monthsShort[m.month()]\n            : this._monthsShort[\n                  MONTHS_IN_FORMAT.test(format) ? 'format' : 'standalone'\n              ][m.month()];\n    }\n\n    function handleStrictParse(monthName, format, strict) {\n        var i,\n            ii,\n            mom,\n            llc = monthName.toLocaleLowerCase();\n        if (!this._monthsParse) {\n            // this is not used\n            this._monthsParse = [];\n            this._longMonthsParse = [];\n            this._shortMonthsParse = [];\n            for (i = 0; i < 12; ++i) {\n                mom = createUTC([2000, i]);\n                this._shortMonthsParse[i] = this.monthsShort(\n                    mom,\n                    ''\n                ).toLocaleLowerCase();\n                this._longMonthsParse[i] = this.months(mom, '').toLocaleLowerCase();\n            }\n        }\n\n        if (strict) {\n            if (format === 'MMM') {\n                ii = indexOf.call(this._shortMonthsParse, llc);\n                return ii !== -1 ? ii : null;\n            } else {\n                ii = indexOf.call(this._longMonthsParse, llc);\n                return ii !== -1 ? ii : null;\n            }\n        } else {\n            if (format === 'MMM') {\n                ii = indexOf.call(this._shortMonthsParse, llc);\n                if (ii !== -1) {\n                    return ii;\n                }\n                ii = indexOf.call(this._longMonthsParse, llc);\n                return ii !== -1 ? ii : null;\n            } else {\n                ii = indexOf.call(this._longMonthsParse, llc);\n                if (ii !== -1) {\n                    return ii;\n                }\n                ii = indexOf.call(this._shortMonthsParse, llc);\n                return ii !== -1 ? ii : null;\n            }\n        }\n    }\n\n    function localeMonthsParse(monthName, format, strict) {\n        var i, mom, regex;\n\n        if (this._monthsParseExact) {\n            return handleStrictParse.call(this, monthName, format, strict);\n        }\n\n        if (!this._monthsParse) {\n            this._monthsParse = [];\n            this._longMonthsParse = [];\n            this._shortMonthsParse = [];\n        }\n\n        // TODO: add sorting\n        // Sorting makes sure if one month (or abbr) is a prefix of another\n        // see sorting in computeMonthsParse\n        for (i = 0; i < 12; i++) {\n            // make the regex if we don't have it already\n            mom = createUTC([2000, i]);\n            if (strict && !this._longMonthsParse[i]) {\n                this._longMonthsParse[i] = new RegExp(\n                    '^' + this.months(mom, '').replace('.', '') + '$',\n                    'i'\n                );\n                this._shortMonthsParse[i] = new RegExp(\n                    '^' + this.monthsShort(mom, '').replace('.', '') + '$',\n                    'i'\n                );\n            }\n            if (!strict && !this._monthsParse[i]) {\n                regex =\n                    '^' + this.months(mom, '') + '|^' + this.monthsShort(mom, '');\n                this._monthsParse[i] = new RegExp(regex.replace('.', ''), 'i');\n            }\n            // test the regex\n            if (\n                strict &&\n                format === 'MMMM' &&\n                this._longMonthsParse[i].test(monthName)\n            ) {\n                return i;\n            } else if (\n                strict &&\n                format === 'MMM' &&\n                this._shortMonthsParse[i].test(monthName)\n            ) {\n                return i;\n            } else if (!strict && this._monthsParse[i].test(monthName)) {\n                return i;\n            }\n        }\n    }\n\n    // MOMENTS\n\n    function setMonth(mom, value) {\n        var dayOfMonth;\n\n        if (!mom.isValid()) {\n            // No op\n            return mom;\n        }\n\n        if (typeof value === 'string') {\n            if (/^\\d+$/.test(value)) {\n                value = toInt(value);\n            } else {\n                value = mom.localeData().monthsParse(value);\n                // TODO: Another silent failure?\n                if (!isNumber(value)) {\n                    return mom;\n                }\n            }\n        }\n\n        dayOfMonth = Math.min(mom.date(), daysInMonth(mom.year(), value));\n        mom._d['set' + (mom._isUTC ? 'UTC' : '') + 'Month'](value, dayOfMonth);\n        return mom;\n    }\n\n    function getSetMonth(value) {\n        if (value != null) {\n            setMonth(this, value);\n            hooks.updateOffset(this, true);\n            return this;\n        } else {\n            return get(this, 'Month');\n        }\n    }\n\n    function getDaysInMonth() {\n        return daysInMonth(this.year(), this.month());\n    }\n\n    function monthsShortRegex(isStrict) {\n        if (this._monthsParseExact) {\n            if (!hasOwnProp(this, '_monthsRegex')) {\n                computeMonthsParse.call(this);\n            }\n            if (isStrict) {\n                return this._monthsShortStrictRegex;\n            } else {\n                return this._monthsShortRegex;\n            }\n        } else {\n            if (!hasOwnProp(this, '_monthsShortRegex')) {\n                this._monthsShortRegex = defaultMonthsShortRegex;\n            }\n            return this._monthsShortStrictRegex && isStrict\n                ? this._monthsShortStrictRegex\n                : this._monthsShortRegex;\n        }\n    }\n\n    function monthsRegex(isStrict) {\n        if (this._monthsParseExact) {\n            if (!hasOwnProp(this, '_monthsRegex')) {\n                computeMonthsParse.call(this);\n            }\n            if (isStrict) {\n                return this._monthsStrictRegex;\n            } else {\n                return this._monthsRegex;\n            }\n        } else {\n            if (!hasOwnProp(this, '_monthsRegex')) {\n                this._monthsRegex = defaultMonthsRegex;\n            }\n            return this._monthsStrictRegex && isStrict\n                ? this._monthsStrictRegex\n                : this._monthsRegex;\n        }\n    }\n\n    function computeMonthsParse() {\n        function cmpLenRev(a, b) {\n            return b.length - a.length;\n        }\n\n        var shortPieces = [],\n            longPieces = [],\n            mixedPieces = [],\n            i,\n            mom;\n        for (i = 0; i < 12; i++) {\n            // make the regex if we don't have it already\n            mom = createUTC([2000, i]);\n            shortPieces.push(this.monthsShort(mom, ''));\n            longPieces.push(this.months(mom, ''));\n            mixedPieces.push(this.months(mom, ''));\n            mixedPieces.push(this.monthsShort(mom, ''));\n        }\n        // Sorting makes sure if one month (or abbr) is a prefix of another it\n        // will match the longer piece.\n        shortPieces.sort(cmpLenRev);\n        longPieces.sort(cmpLenRev);\n        mixedPieces.sort(cmpLenRev);\n        for (i = 0; i < 12; i++) {\n            shortPieces[i] = regexEscape(shortPieces[i]);\n            longPieces[i] = regexEscape(longPieces[i]);\n        }\n        for (i = 0; i < 24; i++) {\n            mixedPieces[i] = regexEscape(mixedPieces[i]);\n        }\n\n        this._monthsRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');\n        this._monthsShortRegex = this._monthsRegex;\n        this._monthsStrictRegex = new RegExp(\n            '^(' + longPieces.join('|') + ')',\n            'i'\n        );\n        this._monthsShortStrictRegex = new RegExp(\n            '^(' + shortPieces.join('|') + ')',\n            'i'\n        );\n    }\n\n    // FORMATTING\n\n    addFormatToken('Y', 0, 0, function () {\n        var y = this.year();\n        return y <= 9999 ? zeroFill(y, 4) : '+' + y;\n    });\n\n    addFormatToken(0, ['YY', 2], 0, function () {\n        return this.year() % 100;\n    });\n\n    addFormatToken(0, ['YYYY', 4], 0, 'year');\n    addFormatToken(0, ['YYYYY', 5], 0, 'year');\n    addFormatToken(0, ['YYYYYY', 6, true], 0, 'year');\n\n    // ALIASES\n\n    addUnitAlias('year', 'y');\n\n    // PRIORITIES\n\n    addUnitPriority('year', 1);\n\n    // PARSING\n\n    addRegexToken('Y', matchSigned);\n    addRegexToken('YY', match1to2, match2);\n    addRegexToken('YYYY', match1to4, match4);\n    addRegexToken('YYYYY', match1to6, match6);\n    addRegexToken('YYYYYY', match1to6, match6);\n\n    addParseToken(['YYYYY', 'YYYYYY'], YEAR);\n    addParseToken('YYYY', function (input, array) {\n        array[YEAR] =\n            input.length === 2 ? hooks.parseTwoDigitYear(input) : toInt(input);\n    });\n    addParseToken('YY', function (input, array) {\n        array[YEAR] = hooks.parseTwoDigitYear(input);\n    });\n    addParseToken('Y', function (input, array) {\n        array[YEAR] = parseInt(input, 10);\n    });\n\n    // HELPERS\n\n    function daysInYear(year) {\n        return isLeapYear(year) ? 366 : 365;\n    }\n\n    // HOOKS\n\n    hooks.parseTwoDigitYear = function (input) {\n        return toInt(input) + (toInt(input) > 68 ? 1900 : 2000);\n    };\n\n    // MOMENTS\n\n    var getSetYear = makeGetSet('FullYear', true);\n\n    function getIsLeapYear() {\n        return isLeapYear(this.year());\n    }\n\n    function createDate(y, m, d, h, M, s, ms) {\n        // can't just apply() to create a date:\n        // https://stackoverflow.com/q/181348\n        var date;\n        // the date constructor remaps years 0-99 to 1900-1999\n        if (y < 100 && y >= 0) {\n            // preserve leap years using a full 400 year cycle, then reset\n            date = new Date(y + 400, m, d, h, M, s, ms);\n            if (isFinite(date.getFullYear())) {\n                date.setFullYear(y);\n            }\n        } else {\n            date = new Date(y, m, d, h, M, s, ms);\n        }\n\n        return date;\n    }\n\n    function createUTCDate(y) {\n        var date, args;\n        // the Date.UTC function remaps years 0-99 to 1900-1999\n        if (y < 100 && y >= 0) {\n            args = Array.prototype.slice.call(arguments);\n            // preserve leap years using a full 400 year cycle, then reset\n            args[0] = y + 400;\n            date = new Date(Date.UTC.apply(null, args));\n            if (isFinite(date.getUTCFullYear())) {\n                date.setUTCFullYear(y);\n            }\n        } else {\n            date = new Date(Date.UTC.apply(null, arguments));\n        }\n\n        return date;\n    }\n\n    // start-of-first-week - start-of-year\n    function firstWeekOffset(year, dow, doy) {\n        var // first-week day -- which january is always in the first week (4 for iso, 1 for other)\n            fwd = 7 + dow - doy,\n            // first-week day local weekday -- which local weekday is fwd\n            fwdlw = (7 + createUTCDate(year, 0, fwd).getUTCDay() - dow) % 7;\n\n        return -fwdlw + fwd - 1;\n    }\n\n    // https://en.wikipedia.org/wiki/ISO_week_date#Calculating_a_date_given_the_year.2C_week_number_and_weekday\n    function dayOfYearFromWeeks(year, week, weekday, dow, doy) {\n        var localWeekday = (7 + weekday - dow) % 7,\n            weekOffset = firstWeekOffset(year, dow, doy),\n            dayOfYear = 1 + 7 * (week - 1) + localWeekday + weekOffset,\n            resYear,\n            resDayOfYear;\n\n        if (dayOfYear <= 0) {\n            resYear = year - 1;\n            resDayOfYear = daysInYear(resYear) + dayOfYear;\n        } else if (dayOfYear > daysInYear(year)) {\n            resYear = year + 1;\n            resDayOfYear = dayOfYear - daysInYear(year);\n        } else {\n            resYear = year;\n            resDayOfYear = dayOfYear;\n        }\n\n        return {\n            year: resYear,\n            dayOfYear: resDayOfYear,\n        };\n    }\n\n    function weekOfYear(mom, dow, doy) {\n        var weekOffset = firstWeekOffset(mom.year(), dow, doy),\n            week = Math.floor((mom.dayOfYear() - weekOffset - 1) / 7) + 1,\n            resWeek,\n            resYear;\n\n        if (week < 1) {\n            resYear = mom.year() - 1;\n            resWeek = week + weeksInYear(resYear, dow, doy);\n        } else if (week > weeksInYear(mom.year(), dow, doy)) {\n            resWeek = week - weeksInYear(mom.year(), dow, doy);\n            resYear = mom.year() + 1;\n        } else {\n            resYear = mom.year();\n            resWeek = week;\n        }\n\n        return {\n            week: resWeek,\n            year: resYear,\n        };\n    }\n\n    function weeksInYear(year, dow, doy) {\n        var weekOffset = firstWeekOffset(year, dow, doy),\n            weekOffsetNext = firstWeekOffset(year + 1, dow, doy);\n        return (daysInYear(year) - weekOffset + weekOffsetNext) / 7;\n    }\n\n    // FORMATTING\n\n    addFormatToken('w', ['ww', 2], 'wo', 'week');\n    addFormatToken('W', ['WW', 2], 'Wo', 'isoWeek');\n\n    // ALIASES\n\n    addUnitAlias('week', 'w');\n    addUnitAlias('isoWeek', 'W');\n\n    // PRIORITIES\n\n    addUnitPriority('week', 5);\n    addUnitPriority('isoWeek', 5);\n\n    // PARSING\n\n    addRegexToken('w', match1to2);\n    addRegexToken('ww', match1to2, match2);\n    addRegexToken('W', match1to2);\n    addRegexToken('WW', match1to2, match2);\n\n    addWeekParseToken(\n        ['w', 'ww', 'W', 'WW'],\n        function (input, week, config, token) {\n            week[token.substr(0, 1)] = toInt(input);\n        }\n    );\n\n    // HELPERS\n\n    // LOCALES\n\n    function localeWeek(mom) {\n        return weekOfYear(mom, this._week.dow, this._week.doy).week;\n    }\n\n    var defaultLocaleWeek = {\n        dow: 0, // Sunday is the first day of the week.\n        doy: 6, // The week that contains Jan 6th is the first week of the year.\n    };\n\n    function localeFirstDayOfWeek() {\n        return this._week.dow;\n    }\n\n    function localeFirstDayOfYear() {\n        return this._week.doy;\n    }\n\n    // MOMENTS\n\n    function getSetWeek(input) {\n        var week = this.localeData().week(this);\n        return input == null ? week : this.add((input - week) * 7, 'd');\n    }\n\n    function getSetISOWeek(input) {\n        var week = weekOfYear(this, 1, 4).week;\n        return input == null ? week : this.add((input - week) * 7, 'd');\n    }\n\n    // FORMATTING\n\n    addFormatToken('d', 0, 'do', 'day');\n\n    addFormatToken('dd', 0, 0, function (format) {\n        return this.localeData().weekdaysMin(this, format);\n    });\n\n    addFormatToken('ddd', 0, 0, function (format) {\n        return this.localeData().weekdaysShort(this, format);\n    });\n\n    addFormatToken('dddd', 0, 0, function (format) {\n        return this.localeData().weekdays(this, format);\n    });\n\n    addFormatToken('e', 0, 0, 'weekday');\n    addFormatToken('E', 0, 0, 'isoWeekday');\n\n    // ALIASES\n\n    addUnitAlias('day', 'd');\n    addUnitAlias('weekday', 'e');\n    addUnitAlias('isoWeekday', 'E');\n\n    // PRIORITY\n    addUnitPriority('day', 11);\n    addUnitPriority('weekday', 11);\n    addUnitPriority('isoWeekday', 11);\n\n    // PARSING\n\n    addRegexToken('d', match1to2);\n    addRegexToken('e', match1to2);\n    addRegexToken('E', match1to2);\n    addRegexToken('dd', function (isStrict, locale) {\n        return locale.weekdaysMinRegex(isStrict);\n    });\n    addRegexToken('ddd', function (isStrict, locale) {\n        return locale.weekdaysShortRegex(isStrict);\n    });\n    addRegexToken('dddd', function (isStrict, locale) {\n        return locale.weekdaysRegex(isStrict);\n    });\n\n    addWeekParseToken(['dd', 'ddd', 'dddd'], function (input, week, config, token) {\n        var weekday = config._locale.weekdaysParse(input, token, config._strict);\n        // if we didn't get a weekday name, mark the date as invalid\n        if (weekday != null) {\n            week.d = weekday;\n        } else {\n            getParsingFlags(config).invalidWeekday = input;\n        }\n    });\n\n    addWeekParseToken(['d', 'e', 'E'], function (input, week, config, token) {\n        week[token] = toInt(input);\n    });\n\n    // HELPERS\n\n    function parseWeekday(input, locale) {\n        if (typeof input !== 'string') {\n            return input;\n        }\n\n        if (!isNaN(input)) {\n            return parseInt(input, 10);\n        }\n\n        input = locale.weekdaysParse(input);\n        if (typeof input === 'number') {\n            return input;\n        }\n\n        return null;\n    }\n\n    function parseIsoWeekday(input, locale) {\n        if (typeof input === 'string') {\n            return locale.weekdaysParse(input) % 7 || 7;\n        }\n        return isNaN(input) ? null : input;\n    }\n\n    // LOCALES\n    function shiftWeekdays(ws, n) {\n        return ws.slice(n, 7).concat(ws.slice(0, n));\n    }\n\n    var defaultLocaleWeekdays =\n            'Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday'.split('_'),\n        defaultLocaleWeekdaysShort = 'Sun_Mon_Tue_Wed_Thu_Fri_Sat'.split('_'),\n        defaultLocaleWeekdaysMin = 'Su_Mo_Tu_We_Th_Fr_Sa'.split('_'),\n        defaultWeekdaysRegex = matchWord,\n        defaultWeekdaysShortRegex = matchWord,\n        defaultWeekdaysMinRegex = matchWord;\n\n    function localeWeekdays(m, format) {\n        var weekdays = isArray(this._weekdays)\n            ? this._weekdays\n            : this._weekdays[\n                  m && m !== true && this._weekdays.isFormat.test(format)\n                      ? 'format'\n                      : 'standalone'\n              ];\n        return m === true\n            ? shiftWeekdays(weekdays, this._week.dow)\n            : m\n            ? weekdays[m.day()]\n            : weekdays;\n    }\n\n    function localeWeekdaysShort(m) {\n        return m === true\n            ? shiftWeekdays(this._weekdaysShort, this._week.dow)\n            : m\n            ? this._weekdaysShort[m.day()]\n            : this._weekdaysShort;\n    }\n\n    function localeWeekdaysMin(m) {\n        return m === true\n            ? shiftWeekdays(this._weekdaysMin, this._week.dow)\n            : m\n            ? this._weekdaysMin[m.day()]\n            : this._weekdaysMin;\n    }\n\n    function handleStrictParse$1(weekdayName, format, strict) {\n        var i,\n            ii,\n            mom,\n            llc = weekdayName.toLocaleLowerCase();\n        if (!this._weekdaysParse) {\n            this._weekdaysParse = [];\n            this._shortWeekdaysParse = [];\n            this._minWeekdaysParse = [];\n\n            for (i = 0; i < 7; ++i) {\n                mom = createUTC([2000, 1]).day(i);\n                this._minWeekdaysParse[i] = this.weekdaysMin(\n                    mom,\n                    ''\n                ).toLocaleLowerCase();\n                this._shortWeekdaysParse[i] = this.weekdaysShort(\n                    mom,\n                    ''\n                ).toLocaleLowerCase();\n                this._weekdaysParse[i] = this.weekdays(mom, '').toLocaleLowerCase();\n            }\n        }\n\n        if (strict) {\n            if (format === 'dddd') {\n                ii = indexOf.call(this._weekdaysParse, llc);\n                return ii !== -1 ? ii : null;\n            } else if (format === 'ddd') {\n                ii = indexOf.call(this._shortWeekdaysParse, llc);\n                return ii !== -1 ? ii : null;\n            } else {\n                ii = indexOf.call(this._minWeekdaysParse, llc);\n                return ii !== -1 ? ii : null;\n            }\n        } else {\n            if (format === 'dddd') {\n                ii = indexOf.call(this._weekdaysParse, llc);\n                if (ii !== -1) {\n                    return ii;\n                }\n                ii = indexOf.call(this._shortWeekdaysParse, llc);\n                if (ii !== -1) {\n                    return ii;\n                }\n                ii = indexOf.call(this._minWeekdaysParse, llc);\n                return ii !== -1 ? ii : null;\n            } else if (format === 'ddd') {\n                ii = indexOf.call(this._shortWeekdaysParse, llc);\n                if (ii !== -1) {\n                    return ii;\n                }\n                ii = indexOf.call(this._weekdaysParse, llc);\n                if (ii !== -1) {\n                    return ii;\n                }\n                ii = indexOf.call(this._minWeekdaysParse, llc);\n                return ii !== -1 ? ii : null;\n            } else {\n                ii = indexOf.call(this._minWeekdaysParse, llc);\n                if (ii !== -1) {\n                    return ii;\n                }\n                ii = indexOf.call(this._weekdaysParse, llc);\n                if (ii !== -1) {\n                    return ii;\n                }\n                ii = indexOf.call(this._shortWeekdaysParse, llc);\n                return ii !== -1 ? ii : null;\n            }\n        }\n    }\n\n    function localeWeekdaysParse(weekdayName, format, strict) {\n        var i, mom, regex;\n\n        if (this._weekdaysParseExact) {\n            return handleStrictParse$1.call(this, weekdayName, format, strict);\n        }\n\n        if (!this._weekdaysParse) {\n            this._weekdaysParse = [];\n            this._minWeekdaysParse = [];\n            this._shortWeekdaysParse = [];\n            this._fullWeekdaysParse = [];\n        }\n\n        for (i = 0; i < 7; i++) {\n            // make the regex if we don't have it already\n\n            mom = createUTC([2000, 1]).day(i);\n            if (strict && !this._fullWeekdaysParse[i]) {\n                this._fullWeekdaysParse[i] = new RegExp(\n                    '^' + this.weekdays(mom, '').replace('.', '\\\\.?') + '$',\n                    'i'\n                );\n                this._shortWeekdaysParse[i] = new RegExp(\n                    '^' + this.weekdaysShort(mom, '').replace('.', '\\\\.?') + '$',\n                    'i'\n                );\n                this._minWeekdaysParse[i] = new RegExp(\n                    '^' + this.weekdaysMin(mom, '').replace('.', '\\\\.?') + '$',\n                    'i'\n                );\n            }\n            if (!this._weekdaysParse[i]) {\n                regex =\n                    '^' +\n                    this.weekdays(mom, '') +\n                    '|^' +\n                    this.weekdaysShort(mom, '') +\n                    '|^' +\n                    this.weekdaysMin(mom, '');\n                this._weekdaysParse[i] = new RegExp(regex.replace('.', ''), 'i');\n            }\n            // test the regex\n            if (\n                strict &&\n                format === 'dddd' &&\n                this._fullWeekdaysParse[i].test(weekdayName)\n            ) {\n                return i;\n            } else if (\n                strict &&\n                format === 'ddd' &&\n                this._shortWeekdaysParse[i].test(weekdayName)\n            ) {\n                return i;\n            } else if (\n                strict &&\n                format === 'dd' &&\n                this._minWeekdaysParse[i].test(weekdayName)\n            ) {\n                return i;\n            } else if (!strict && this._weekdaysParse[i].test(weekdayName)) {\n                return i;\n            }\n        }\n    }\n\n    // MOMENTS\n\n    function getSetDayOfWeek(input) {\n        if (!this.isValid()) {\n            return input != null ? this : NaN;\n        }\n        var day = this._isUTC ? this._d.getUTCDay() : this._d.getDay();\n        if (input != null) {\n            input = parseWeekday(input, this.localeData());\n            return this.add(input - day, 'd');\n        } else {\n            return day;\n        }\n    }\n\n    function getSetLocaleDayOfWeek(input) {\n        if (!this.isValid()) {\n            return input != null ? this : NaN;\n        }\n        var weekday = (this.day() + 7 - this.localeData()._week.dow) % 7;\n        return input == null ? weekday : this.add(input - weekday, 'd');\n    }\n\n    function getSetISODayOfWeek(input) {\n        if (!this.isValid()) {\n            return input != null ? this : NaN;\n        }\n\n        // behaves the same as moment#day except\n        // as a getter, returns 7 instead of 0 (1-7 range instead of 0-6)\n        // as a setter, sunday should belong to the previous week.\n\n        if (input != null) {\n            var weekday = parseIsoWeekday(input, this.localeData());\n            return this.day(this.day() % 7 ? weekday : weekday - 7);\n        } else {\n            return this.day() || 7;\n        }\n    }\n\n    function weekdaysRegex(isStrict) {\n        if (this._weekdaysParseExact) {\n            if (!hasOwnProp(this, '_weekdaysRegex')) {\n                computeWeekdaysParse.call(this);\n            }\n            if (isStrict) {\n                return this._weekdaysStrictRegex;\n            } else {\n                return this._weekdaysRegex;\n            }\n        } else {\n            if (!hasOwnProp(this, '_weekdaysRegex')) {\n                this._weekdaysRegex = defaultWeekdaysRegex;\n            }\n            return this._weekdaysStrictRegex && isStrict\n                ? this._weekdaysStrictRegex\n                : this._weekdaysRegex;\n        }\n    }\n\n    function weekdaysShortRegex(isStrict) {\n        if (this._weekdaysParseExact) {\n            if (!hasOwnProp(this, '_weekdaysRegex')) {\n                computeWeekdaysParse.call(this);\n            }\n            if (isStrict) {\n                return this._weekdaysShortStrictRegex;\n            } else {\n                return this._weekdaysShortRegex;\n            }\n        } else {\n            if (!hasOwnProp(this, '_weekdaysShortRegex')) {\n                this._weekdaysShortRegex = defaultWeekdaysShortRegex;\n            }\n            return this._weekdaysShortStrictRegex && isStrict\n                ? this._weekdaysShortStrictRegex\n                : this._weekdaysShortRegex;\n        }\n    }\n\n    function weekdaysMinRegex(isStrict) {\n        if (this._weekdaysParseExact) {\n            if (!hasOwnProp(this, '_weekdaysRegex')) {\n                computeWeekdaysParse.call(this);\n            }\n            if (isStrict) {\n                return this._weekdaysMinStrictRegex;\n            } else {\n                return this._weekdaysMinRegex;\n            }\n        } else {\n            if (!hasOwnProp(this, '_weekdaysMinRegex')) {\n                this._weekdaysMinRegex = defaultWeekdaysMinRegex;\n            }\n            return this._weekdaysMinStrictRegex && isStrict\n                ? this._weekdaysMinStrictRegex\n                : this._weekdaysMinRegex;\n        }\n    }\n\n    function computeWeekdaysParse() {\n        function cmpLenRev(a, b) {\n            return b.length - a.length;\n        }\n\n        var minPieces = [],\n            shortPieces = [],\n            longPieces = [],\n            mixedPieces = [],\n            i,\n            mom,\n            minp,\n            shortp,\n            longp;\n        for (i = 0; i < 7; i++) {\n            // make the regex if we don't have it already\n            mom = createUTC([2000, 1]).day(i);\n            minp = regexEscape(this.weekdaysMin(mom, ''));\n            shortp = regexEscape(this.weekdaysShort(mom, ''));\n            longp = regexEscape(this.weekdays(mom, ''));\n            minPieces.push(minp);\n            shortPieces.push(shortp);\n            longPieces.push(longp);\n            mixedPieces.push(minp);\n            mixedPieces.push(shortp);\n            mixedPieces.push(longp);\n        }\n        // Sorting makes sure if one weekday (or abbr) is a prefix of another it\n        // will match the longer piece.\n        minPieces.sort(cmpLenRev);\n        shortPieces.sort(cmpLenRev);\n        longPieces.sort(cmpLenRev);\n        mixedPieces.sort(cmpLenRev);\n\n        this._weekdaysRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');\n        this._weekdaysShortRegex = this._weekdaysRegex;\n        this._weekdaysMinRegex = this._weekdaysRegex;\n\n        this._weekdaysStrictRegex = new RegExp(\n            '^(' + longPieces.join('|') + ')',\n            'i'\n        );\n        this._weekdaysShortStrictRegex = new RegExp(\n            '^(' + shortPieces.join('|') + ')',\n            'i'\n        );\n        this._weekdaysMinStrictRegex = new RegExp(\n            '^(' + minPieces.join('|') + ')',\n            'i'\n        );\n    }\n\n    // FORMATTING\n\n    function hFormat() {\n        return this.hours() % 12 || 12;\n    }\n\n    function kFormat() {\n        return this.hours() || 24;\n    }\n\n    addFormatToken('H', ['HH', 2], 0, 'hour');\n    addFormatToken('h', ['hh', 2], 0, hFormat);\n    addFormatToken('k', ['kk', 2], 0, kFormat);\n\n    addFormatToken('hmm', 0, 0, function () {\n        return '' + hFormat.apply(this) + zeroFill(this.minutes(), 2);\n    });\n\n    addFormatToken('hmmss', 0, 0, function () {\n        return (\n            '' +\n            hFormat.apply(this) +\n            zeroFill(this.minutes(), 2) +\n            zeroFill(this.seconds(), 2)\n        );\n    });\n\n    addFormatToken('Hmm', 0, 0, function () {\n        return '' + this.hours() + zeroFill(this.minutes(), 2);\n    });\n\n    addFormatToken('Hmmss', 0, 0, function () {\n        return (\n            '' +\n            this.hours() +\n            zeroFill(this.minutes(), 2) +\n            zeroFill(this.seconds(), 2)\n        );\n    });\n\n    function meridiem(token, lowercase) {\n        addFormatToken(token, 0, 0, function () {\n            return this.localeData().meridiem(\n                this.hours(),\n                this.minutes(),\n                lowercase\n            );\n        });\n    }\n\n    meridiem('a', true);\n    meridiem('A', false);\n\n    // ALIASES\n\n    addUnitAlias('hour', 'h');\n\n    // PRIORITY\n    addUnitPriority('hour', 13);\n\n    // PARSING\n\n    function matchMeridiem(isStrict, locale) {\n        return locale._meridiemParse;\n    }\n\n    addRegexToken('a', matchMeridiem);\n    addRegexToken('A', matchMeridiem);\n    addRegexToken('H', match1to2);\n    addRegexToken('h', match1to2);\n    addRegexToken('k', match1to2);\n    addRegexToken('HH', match1to2, match2);\n    addRegexToken('hh', match1to2, match2);\n    addRegexToken('kk', match1to2, match2);\n\n    addRegexToken('hmm', match3to4);\n    addRegexToken('hmmss', match5to6);\n    addRegexToken('Hmm', match3to4);\n    addRegexToken('Hmmss', match5to6);\n\n    addParseToken(['H', 'HH'], HOUR);\n    addParseToken(['k', 'kk'], function (input, array, config) {\n        var kInput = toInt(input);\n        array[HOUR] = kInput === 24 ? 0 : kInput;\n    });\n    addParseToken(['a', 'A'], function (input, array, config) {\n        config._isPm = config._locale.isPM(input);\n        config._meridiem = input;\n    });\n    addParseToken(['h', 'hh'], function (input, array, config) {\n        array[HOUR] = toInt(input);\n        getParsingFlags(config).bigHour = true;\n    });\n    addParseToken('hmm', function (input, array, config) {\n        var pos = input.length - 2;\n        array[HOUR] = toInt(input.substr(0, pos));\n        array[MINUTE] = toInt(input.substr(pos));\n        getParsingFlags(config).bigHour = true;\n    });\n    addParseToken('hmmss', function (input, array, config) {\n        var pos1 = input.length - 4,\n            pos2 = input.length - 2;\n        array[HOUR] = toInt(input.substr(0, pos1));\n        array[MINUTE] = toInt(input.substr(pos1, 2));\n        array[SECOND] = toInt(input.substr(pos2));\n        getParsingFlags(config).bigHour = true;\n    });\n    addParseToken('Hmm', function (input, array, config) {\n        var pos = input.length - 2;\n        array[HOUR] = toInt(input.substr(0, pos));\n        array[MINUTE] = toInt(input.substr(pos));\n    });\n    addParseToken('Hmmss', function (input, array, config) {\n        var pos1 = input.length - 4,\n            pos2 = input.length - 2;\n        array[HOUR] = toInt(input.substr(0, pos1));\n        array[MINUTE] = toInt(input.substr(pos1, 2));\n        array[SECOND] = toInt(input.substr(pos2));\n    });\n\n    // LOCALES\n\n    function localeIsPM(input) {\n        // IE8 Quirks Mode & IE7 Standards Mode do not allow accessing strings like arrays\n        // Using charAt should be more compatible.\n        return (input + '').toLowerCase().charAt(0) === 'p';\n    }\n\n    var defaultLocaleMeridiemParse = /[ap]\\.?m?\\.?/i,\n        // Setting the hour should keep the time, because the user explicitly\n        // specified which hour they want. So trying to maintain the same hour (in\n        // a new timezone) makes sense. Adding/subtracting hours does not follow\n        // this rule.\n        getSetHour = makeGetSet('Hours', true);\n\n    function localeMeridiem(hours, minutes, isLower) {\n        if (hours > 11) {\n            return isLower ? 'pm' : 'PM';\n        } else {\n            return isLower ? 'am' : 'AM';\n        }\n    }\n\n    var baseConfig = {\n        calendar: defaultCalendar,\n        longDateFormat: defaultLongDateFormat,\n        invalidDate: defaultInvalidDate,\n        ordinal: defaultOrdinal,\n        dayOfMonthOrdinalParse: defaultDayOfMonthOrdinalParse,\n        relativeTime: defaultRelativeTime,\n\n        months: defaultLocaleMonths,\n        monthsShort: defaultLocaleMonthsShort,\n\n        week: defaultLocaleWeek,\n\n        weekdays: defaultLocaleWeekdays,\n        weekdaysMin: defaultLocaleWeekdaysMin,\n        weekdaysShort: defaultLocaleWeekdaysShort,\n\n        meridiemParse: defaultLocaleMeridiemParse,\n    };\n\n    // internal storage for locale config files\n    var locales = {},\n        localeFamilies = {},\n        globalLocale;\n\n    function commonPrefix(arr1, arr2) {\n        var i,\n            minl = Math.min(arr1.length, arr2.length);\n        for (i = 0; i < minl; i += 1) {\n            if (arr1[i] !== arr2[i]) {\n                return i;\n            }\n        }\n        return minl;\n    }\n\n    function normalizeLocale(key) {\n        return key ? key.toLowerCase().replace('_', '-') : key;\n    }\n\n    // pick the locale from the array\n    // try ['en-au', 'en-gb'] as 'en-au', 'en-gb', 'en', as in move through the list trying each\n    // substring from most specific to least, but move to the next array item if it's a more specific variant than the current root\n    function chooseLocale(names) {\n        var i = 0,\n            j,\n            next,\n            locale,\n            split;\n\n        while (i < names.length) {\n            split = normalizeLocale(names[i]).split('-');\n            j = split.length;\n            next = normalizeLocale(names[i + 1]);\n            next = next ? next.split('-') : null;\n            while (j > 0) {\n                locale = loadLocale(split.slice(0, j).join('-'));\n                if (locale) {\n                    return locale;\n                }\n                if (\n                    next &&\n                    next.length >= j &&\n                    commonPrefix(split, next) >= j - 1\n                ) {\n                    //the next array item is better than a shallower substring of this one\n                    break;\n                }\n                j--;\n            }\n            i++;\n        }\n        return globalLocale;\n    }\n\n    function isLocaleNameSane(name) {\n        // Prevent names that look like filesystem paths, i.e contain '/' or '\\'\n        return name.match('^[^/\\\\\\\\]*$') != null;\n    }\n\n    function loadLocale(name) {\n        var oldLocale = null,\n            aliasedRequire;\n        // TODO: Find a better way to register and load all the locales in Node\n        if (\n            locales[name] === undefined &&\n            typeof module !== 'undefined' &&\n            module &&\n            module.exports &&\n            isLocaleNameSane(name)\n        ) {\n            try {\n                oldLocale = globalLocale._abbr;\n                aliasedRequire = require;\n                aliasedRequire('./locale/' + name);\n                getSetGlobalLocale(oldLocale);\n            } catch (e) {\n                // mark as not found to avoid repeating expensive file require call causing high CPU\n                // when trying to find en-US, en_US, en-us for every format call\n                locales[name] = null; // null means not found\n            }\n        }\n        return locales[name];\n    }\n\n    // This function will load locale and then set the global locale.  If\n    // no arguments are passed in, it will simply return the current global\n    // locale key.\n    function getSetGlobalLocale(key, values) {\n        var data;\n        if (key) {\n            if (isUndefined(values)) {\n                data = getLocale(key);\n            } else {\n                data = defineLocale(key, values);\n            }\n\n            if (data) {\n                // moment.duration._locale = moment._locale = data;\n                globalLocale = data;\n            } else {\n                if (typeof console !== 'undefined' && console.warn) {\n                    //warn user if arguments are passed but the locale could not be set\n                    console.warn(\n                        'Locale ' + key + ' not found. Did you forget to load it?'\n                    );\n                }\n            }\n        }\n\n        return globalLocale._abbr;\n    }\n\n    function defineLocale(name, config) {\n        if (config !== null) {\n            var locale,\n                parentConfig = baseConfig;\n            config.abbr = name;\n            if (locales[name] != null) {\n                deprecateSimple(\n                    'defineLocaleOverride',\n                    'use moment.updateLocale(localeName, config) to change ' +\n                        'an existing locale. moment.defineLocale(localeName, ' +\n                        'config) should only be used for creating a new locale ' +\n                        'See http://momentjs.com/guides/#/warnings/define-locale/ for more info.'\n                );\n                parentConfig = locales[name]._config;\n            } else if (config.parentLocale != null) {\n                if (locales[config.parentLocale] != null) {\n                    parentConfig = locales[config.parentLocale]._config;\n                } else {\n                    locale = loadLocale(config.parentLocale);\n                    if (locale != null) {\n                        parentConfig = locale._config;\n                    } else {\n                        if (!localeFamilies[config.parentLocale]) {\n                            localeFamilies[config.parentLocale] = [];\n                        }\n                        localeFamilies[config.parentLocale].push({\n                            name: name,\n                            config: config,\n                        });\n                        return null;\n                    }\n                }\n            }\n            locales[name] = new Locale(mergeConfigs(parentConfig, config));\n\n            if (localeFamilies[name]) {\n                localeFamilies[name].forEach(function (x) {\n                    defineLocale(x.name, x.config);\n                });\n            }\n\n            // backwards compat for now: also set the locale\n            // make sure we set the locale AFTER all child locales have been\n            // created, so we won't end up with the child locale set.\n            getSetGlobalLocale(name);\n\n            return locales[name];\n        } else {\n            // useful for testing\n            delete locales[name];\n            return null;\n        }\n    }\n\n    function updateLocale(name, config) {\n        if (config != null) {\n            var locale,\n                tmpLocale,\n                parentConfig = baseConfig;\n\n            if (locales[name] != null && locales[name].parentLocale != null) {\n                // Update existing child locale in-place to avoid memory-leaks\n                locales[name].set(mergeConfigs(locales[name]._config, config));\n            } else {\n                // MERGE\n                tmpLocale = loadLocale(name);\n                if (tmpLocale != null) {\n                    parentConfig = tmpLocale._config;\n                }\n                config = mergeConfigs(parentConfig, config);\n                if (tmpLocale == null) {\n                    // updateLocale is called for creating a new locale\n                    // Set abbr so it will have a name (getters return\n                    // undefined otherwise).\n                    config.abbr = name;\n                }\n                locale = new Locale(config);\n                locale.parentLocale = locales[name];\n                locales[name] = locale;\n            }\n\n            // backwards compat for now: also set the locale\n            getSetGlobalLocale(name);\n        } else {\n            // pass null for config to unupdate, useful for tests\n            if (locales[name] != null) {\n                if (locales[name].parentLocale != null) {\n                    locales[name] = locales[name].parentLocale;\n                    if (name === getSetGlobalLocale()) {\n                        getSetGlobalLocale(name);\n                    }\n                } else if (locales[name] != null) {\n                    delete locales[name];\n                }\n            }\n        }\n        return locales[name];\n    }\n\n    // returns locale data\n    function getLocale(key) {\n        var locale;\n\n        if (key && key._locale && key._locale._abbr) {\n            key = key._locale._abbr;\n        }\n\n        if (!key) {\n            return globalLocale;\n        }\n\n        if (!isArray(key)) {\n            //short-circuit everything else\n            locale = loadLocale(key);\n            if (locale) {\n                return locale;\n            }\n            key = [key];\n        }\n\n        return chooseLocale(key);\n    }\n\n    function listLocales() {\n        return keys(locales);\n    }\n\n    function checkOverflow(m) {\n        var overflow,\n            a = m._a;\n\n        if (a && getParsingFlags(m).overflow === -2) {\n            overflow =\n                a[MONTH] < 0 || a[MONTH] > 11\n                    ? MONTH\n                    : a[DATE] < 1 || a[DATE] > daysInMonth(a[YEAR], a[MONTH])\n                    ? DATE\n                    : a[HOUR] < 0 ||\n                      a[HOUR] > 24 ||\n                      (a[HOUR] === 24 &&\n                          (a[MINUTE] !== 0 ||\n                              a[SECOND] !== 0 ||\n                              a[MILLISECOND] !== 0))\n                    ? HOUR\n                    : a[MINUTE] < 0 || a[MINUTE] > 59\n                    ? MINUTE\n                    : a[SECOND] < 0 || a[SECOND] > 59\n                    ? SECOND\n                    : a[MILLISECOND] < 0 || a[MILLISECOND] > 999\n                    ? MILLISECOND\n                    : -1;\n\n            if (\n                getParsingFlags(m)._overflowDayOfYear &&\n                (overflow < YEAR || overflow > DATE)\n            ) {\n                overflow = DATE;\n            }\n            if (getParsingFlags(m)._overflowWeeks && overflow === -1) {\n                overflow = WEEK;\n            }\n            if (getParsingFlags(m)._overflowWeekday && overflow === -1) {\n                overflow = WEEKDAY;\n            }\n\n            getParsingFlags(m).overflow = overflow;\n        }\n\n        return m;\n    }\n\n    // iso 8601 regex\n    // 0000-00-00 0000-W00 or 0000-W00-0 + T + 00 or 00:00 or 00:00:00 or 00:00:00.000 + +00:00 or +0000 or +00)\n    var extendedIsoRegex =\n            /^\\s*((?:[+-]\\d{6}|\\d{4})-(?:\\d\\d-\\d\\d|W\\d\\d-\\d|W\\d\\d|\\d\\d\\d|\\d\\d))(?:(T| )(\\d\\d(?::\\d\\d(?::\\d\\d(?:[.,]\\d+)?)?)?)([+-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/,\n        basicIsoRegex =\n            /^\\s*((?:[+-]\\d{6}|\\d{4})(?:\\d\\d\\d\\d|W\\d\\d\\d|W\\d\\d|\\d\\d\\d|\\d\\d|))(?:(T| )(\\d\\d(?:\\d\\d(?:\\d\\d(?:[.,]\\d+)?)?)?)([+-]\\d\\d(?::?\\d\\d)?|\\s*Z)?)?$/,\n        tzRegex = /Z|[+-]\\d\\d(?::?\\d\\d)?/,\n        isoDates = [\n            ['YYYYYY-MM-DD', /[+-]\\d{6}-\\d\\d-\\d\\d/],\n            ['YYYY-MM-DD', /\\d{4}-\\d\\d-\\d\\d/],\n            ['GGGG-[W]WW-E', /\\d{4}-W\\d\\d-\\d/],\n            ['GGGG-[W]WW', /\\d{4}-W\\d\\d/, false],\n            ['YYYY-DDD', /\\d{4}-\\d{3}/],\n            ['YYYY-MM', /\\d{4}-\\d\\d/, false],\n            ['YYYYYYMMDD', /[+-]\\d{10}/],\n            ['YYYYMMDD', /\\d{8}/],\n            ['GGGG[W]WWE', /\\d{4}W\\d{3}/],\n            ['GGGG[W]WW', /\\d{4}W\\d{2}/, false],\n            ['YYYYDDD', /\\d{7}/],\n            ['YYYYMM', /\\d{6}/, false],\n            ['YYYY', /\\d{4}/, false],\n        ],\n        // iso time formats and regexes\n        isoTimes = [\n            ['HH:mm:ss.SSSS', /\\d\\d:\\d\\d:\\d\\d\\.\\d+/],\n            ['HH:mm:ss,SSSS', /\\d\\d:\\d\\d:\\d\\d,\\d+/],\n            ['HH:mm:ss', /\\d\\d:\\d\\d:\\d\\d/],\n            ['HH:mm', /\\d\\d:\\d\\d/],\n            ['HHmmss.SSSS', /\\d\\d\\d\\d\\d\\d\\.\\d+/],\n            ['HHmmss,SSSS', /\\d\\d\\d\\d\\d\\d,\\d+/],\n            ['HHmmss', /\\d\\d\\d\\d\\d\\d/],\n            ['HHmm', /\\d\\d\\d\\d/],\n            ['HH', /\\d\\d/],\n        ],\n        aspNetJsonRegex = /^\\/?Date\\((-?\\d+)/i,\n        // RFC 2822 regex: For details see https://tools.ietf.org/html/rfc2822#section-3.3\n        rfc2822 =\n            /^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\\s)?(\\d{1,2})\\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\\s(\\d{2,4})\\s(\\d\\d):(\\d\\d)(?::(\\d\\d))?\\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\\d{4}))$/,\n        obsOffsets = {\n            UT: 0,\n            GMT: 0,\n            EDT: -4 * 60,\n            EST: -5 * 60,\n            CDT: -5 * 60,\n            CST: -6 * 60,\n            MDT: -6 * 60,\n            MST: -7 * 60,\n            PDT: -7 * 60,\n            PST: -8 * 60,\n        };\n\n    // date from iso format\n    function configFromISO(config) {\n        var i,\n            l,\n            string = config._i,\n            match = extendedIsoRegex.exec(string) || basicIsoRegex.exec(string),\n            allowTime,\n            dateFormat,\n            timeFormat,\n            tzFormat,\n            isoDatesLen = isoDates.length,\n            isoTimesLen = isoTimes.length;\n\n        if (match) {\n            getParsingFlags(config).iso = true;\n            for (i = 0, l = isoDatesLen; i < l; i++) {\n                if (isoDates[i][1].exec(match[1])) {\n                    dateFormat = isoDates[i][0];\n                    allowTime = isoDates[i][2] !== false;\n                    break;\n                }\n            }\n            if (dateFormat == null) {\n                config._isValid = false;\n                return;\n            }\n            if (match[3]) {\n                for (i = 0, l = isoTimesLen; i < l; i++) {\n                    if (isoTimes[i][1].exec(match[3])) {\n                        // match[2] should be 'T' or space\n                        timeFormat = (match[2] || ' ') + isoTimes[i][0];\n                        break;\n                    }\n                }\n                if (timeFormat == null) {\n                    config._isValid = false;\n                    return;\n                }\n            }\n            if (!allowTime && timeFormat != null) {\n                config._isValid = false;\n                return;\n            }\n            if (match[4]) {\n                if (tzRegex.exec(match[4])) {\n                    tzFormat = 'Z';\n                } else {\n                    config._isValid = false;\n                    return;\n                }\n            }\n            config._f = dateFormat + (timeFormat || '') + (tzFormat || '');\n            configFromStringAndFormat(config);\n        } else {\n            config._isValid = false;\n        }\n    }\n\n    function extractFromRFC2822Strings(\n        yearStr,\n        monthStr,\n        dayStr,\n        hourStr,\n        minuteStr,\n        secondStr\n    ) {\n        var result = [\n            untruncateYear(yearStr),\n            defaultLocaleMonthsShort.indexOf(monthStr),\n            parseInt(dayStr, 10),\n            parseInt(hourStr, 10),\n            parseInt(minuteStr, 10),\n        ];\n\n        if (secondStr) {\n            result.push(parseInt(secondStr, 10));\n        }\n\n        return result;\n    }\n\n    function untruncateYear(yearStr) {\n        var year = parseInt(yearStr, 10);\n        if (year <= 49) {\n            return 2000 + year;\n        } else if (year <= 999) {\n            return 1900 + year;\n        }\n        return year;\n    }\n\n    function preprocessRFC2822(s) {\n        // Remove comments and folding whitespace and replace multiple-spaces with a single space\n        return s\n            .replace(/\\([^()]*\\)|[\\n\\t]/g, ' ')\n            .replace(/(\\s\\s+)/g, ' ')\n            .replace(/^\\s\\s*/, '')\n            .replace(/\\s\\s*$/, '');\n    }\n\n    function checkWeekday(weekdayStr, parsedInput, config) {\n        if (weekdayStr) {\n            // TODO: Replace the vanilla JS Date object with an independent day-of-week check.\n            var weekdayProvided = defaultLocaleWeekdaysShort.indexOf(weekdayStr),\n                weekdayActual = new Date(\n                    parsedInput[0],\n                    parsedInput[1],\n                    parsedInput[2]\n                ).getDay();\n            if (weekdayProvided !== weekdayActual) {\n                getParsingFlags(config).weekdayMismatch = true;\n                config._isValid = false;\n                return false;\n            }\n        }\n        return true;\n    }\n\n    function calculateOffset(obsOffset, militaryOffset, numOffset) {\n        if (obsOffset) {\n            return obsOffsets[obsOffset];\n        } else if (militaryOffset) {\n            // the only allowed military tz is Z\n            return 0;\n        } else {\n            var hm = parseInt(numOffset, 10),\n                m = hm % 100,\n                h = (hm - m) / 100;\n            return h * 60 + m;\n        }\n    }\n\n    // date and time from ref 2822 format\n    function configFromRFC2822(config) {\n        var match = rfc2822.exec(preprocessRFC2822(config._i)),\n            parsedArray;\n        if (match) {\n            parsedArray = extractFromRFC2822Strings(\n                match[4],\n                match[3],\n                match[2],\n                match[5],\n                match[6],\n                match[7]\n            );\n            if (!checkWeekday(match[1], parsedArray, config)) {\n                return;\n            }\n\n            config._a = parsedArray;\n            config._tzm = calculateOffset(match[8], match[9], match[10]);\n\n            config._d = createUTCDate.apply(null, config._a);\n            config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);\n\n            getParsingFlags(config).rfc2822 = true;\n        } else {\n            config._isValid = false;\n        }\n    }\n\n    // date from 1) ASP.NET, 2) ISO, 3) RFC 2822 formats, or 4) optional fallback if parsing isn't strict\n    function configFromString(config) {\n        var matched = aspNetJsonRegex.exec(config._i);\n        if (matched !== null) {\n            config._d = new Date(+matched[1]);\n            return;\n        }\n\n        configFromISO(config);\n        if (config._isValid === false) {\n            delete config._isValid;\n        } else {\n            return;\n        }\n\n        configFromRFC2822(config);\n        if (config._isValid === false) {\n            delete config._isValid;\n        } else {\n            return;\n        }\n\n        if (config._strict) {\n            config._isValid = false;\n        } else {\n            // Final attempt, use Input Fallback\n            hooks.createFromInputFallback(config);\n        }\n    }\n\n    hooks.createFromInputFallback = deprecate(\n        'value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), ' +\n            'which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are ' +\n            'discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.',\n        function (config) {\n            config._d = new Date(config._i + (config._useUTC ? ' UTC' : ''));\n        }\n    );\n\n    // Pick the first defined of two or three arguments.\n    function defaults(a, b, c) {\n        if (a != null) {\n            return a;\n        }\n        if (b != null) {\n            return b;\n        }\n        return c;\n    }\n\n    function currentDateArray(config) {\n        // hooks is actually the exported moment object\n        var nowValue = new Date(hooks.now());\n        if (config._useUTC) {\n            return [\n                nowValue.getUTCFullYear(),\n                nowValue.getUTCMonth(),\n                nowValue.getUTCDate(),\n            ];\n        }\n        return [nowValue.getFullYear(), nowValue.getMonth(), nowValue.getDate()];\n    }\n\n    // convert an array to a date.\n    // the array should mirror the parameters below\n    // note: all values past the year are optional and will default to the lowest possible value.\n    // [year, month, day , hour, minute, second, millisecond]\n    function configFromArray(config) {\n        var i,\n            date,\n            input = [],\n            currentDate,\n            expectedWeekday,\n            yearToUse;\n\n        if (config._d) {\n            return;\n        }\n\n        currentDate = currentDateArray(config);\n\n        //compute day of the year from weeks and weekdays\n        if (config._w && config._a[DATE] == null && config._a[MONTH] == null) {\n            dayOfYearFromWeekInfo(config);\n        }\n\n        //if the day of the year is set, figure out what it is\n        if (config._dayOfYear != null) {\n            yearToUse = defaults(config._a[YEAR], currentDate[YEAR]);\n\n            if (\n                config._dayOfYear > daysInYear(yearToUse) ||\n                config._dayOfYear === 0\n            ) {\n                getParsingFlags(config)._overflowDayOfYear = true;\n            }\n\n            date = createUTCDate(yearToUse, 0, config._dayOfYear);\n            config._a[MONTH] = date.getUTCMonth();\n            config._a[DATE] = date.getUTCDate();\n        }\n\n        // Default to current date.\n        // * if no year, month, day of month are given, default to today\n        // * if day of month is given, default month and year\n        // * if month is given, default only year\n        // * if year is given, don't default anything\n        for (i = 0; i < 3 && config._a[i] == null; ++i) {\n            config._a[i] = input[i] = currentDate[i];\n        }\n\n        // Zero out whatever was not defaulted, including time\n        for (; i < 7; i++) {\n            config._a[i] = input[i] =\n                config._a[i] == null ? (i === 2 ? 1 : 0) : config._a[i];\n        }\n\n        // Check for 24:00:00.000\n        if (\n            config._a[HOUR] === 24 &&\n            config._a[MINUTE] === 0 &&\n            config._a[SECOND] === 0 &&\n            config._a[MILLISECOND] === 0\n        ) {\n            config._nextDay = true;\n            config._a[HOUR] = 0;\n        }\n\n        config._d = (config._useUTC ? createUTCDate : createDate).apply(\n            null,\n            input\n        );\n        expectedWeekday = config._useUTC\n            ? config._d.getUTCDay()\n            : config._d.getDay();\n\n        // Apply timezone offset from input. The actual utcOffset can be changed\n        // with parseZone.\n        if (config._tzm != null) {\n            config._d.setUTCMinutes(config._d.getUTCMinutes() - config._tzm);\n        }\n\n        if (config._nextDay) {\n            config._a[HOUR] = 24;\n        }\n\n        // check for mismatching day of week\n        if (\n            config._w &&\n            typeof config._w.d !== 'undefined' &&\n            config._w.d !== expectedWeekday\n        ) {\n            getParsingFlags(config).weekdayMismatch = true;\n        }\n    }\n\n    function dayOfYearFromWeekInfo(config) {\n        var w, weekYear, week, weekday, dow, doy, temp, weekdayOverflow, curWeek;\n\n        w = config._w;\n        if (w.GG != null || w.W != null || w.E != null) {\n            dow = 1;\n            doy = 4;\n\n            // TODO: We need to take the current isoWeekYear, but that depends on\n            // how we interpret now (local, utc, fixed offset). So create\n            // a now version of current config (take local/utc/offset flags, and\n            // create now).\n            weekYear = defaults(\n                w.GG,\n                config._a[YEAR],\n                weekOfYear(createLocal(), 1, 4).year\n            );\n            week = defaults(w.W, 1);\n            weekday = defaults(w.E, 1);\n            if (weekday < 1 || weekday > 7) {\n                weekdayOverflow = true;\n            }\n        } else {\n            dow = config._locale._week.dow;\n            doy = config._locale._week.doy;\n\n            curWeek = weekOfYear(createLocal(), dow, doy);\n\n            weekYear = defaults(w.gg, config._a[YEAR], curWeek.year);\n\n            // Default to current week.\n            week = defaults(w.w, curWeek.week);\n\n            if (w.d != null) {\n                // weekday -- low day numbers are considered next week\n                weekday = w.d;\n                if (weekday < 0 || weekday > 6) {\n                    weekdayOverflow = true;\n                }\n            } else if (w.e != null) {\n                // local weekday -- counting starts from beginning of week\n                weekday = w.e + dow;\n                if (w.e < 0 || w.e > 6) {\n                    weekdayOverflow = true;\n                }\n            } else {\n                // default to beginning of week\n                weekday = dow;\n            }\n        }\n        if (week < 1 || week > weeksInYear(weekYear, dow, doy)) {\n            getParsingFlags(config)._overflowWeeks = true;\n        } else if (weekdayOverflow != null) {\n            getParsingFlags(config)._overflowWeekday = true;\n        } else {\n            temp = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy);\n            config._a[YEAR] = temp.year;\n            config._dayOfYear = temp.dayOfYear;\n        }\n    }\n\n    // constant that refers to the ISO standard\n    hooks.ISO_8601 = function () {};\n\n    // constant that refers to the RFC 2822 form\n    hooks.RFC_2822 = function () {};\n\n    // date from string and format string\n    function configFromStringAndFormat(config) {\n        // TODO: Move this to another part of the creation flow to prevent circular deps\n        if (config._f === hooks.ISO_8601) {\n            configFromISO(config);\n            return;\n        }\n        if (config._f === hooks.RFC_2822) {\n            configFromRFC2822(config);\n            return;\n        }\n        config._a = [];\n        getParsingFlags(config).empty = true;\n\n        // This array is used to make a Date, either with `new Date` or `Date.UTC`\n        var string = '' + config._i,\n            i,\n            parsedInput,\n            tokens,\n            token,\n            skipped,\n            stringLength = string.length,\n            totalParsedInputLength = 0,\n            era,\n            tokenLen;\n\n        tokens =\n            expandFormat(config._f, config._locale).match(formattingTokens) || [];\n        tokenLen = tokens.length;\n        for (i = 0; i < tokenLen; i++) {\n            token = tokens[i];\n            parsedInput = (string.match(getParseRegexForToken(token, config)) ||\n                [])[0];\n            if (parsedInput) {\n                skipped = string.substr(0, string.indexOf(parsedInput));\n                if (skipped.length > 0) {\n                    getParsingFlags(config).unusedInput.push(skipped);\n                }\n                string = string.slice(\n                    string.indexOf(parsedInput) + parsedInput.length\n                );\n                totalParsedInputLength += parsedInput.length;\n            }\n            // don't parse if it's not a known token\n            if (formatTokenFunctions[token]) {\n                if (parsedInput) {\n                    getParsingFlags(config).empty = false;\n                } else {\n                    getParsingFlags(config).unusedTokens.push(token);\n                }\n                addTimeToArrayFromToken(token, parsedInput, config);\n            } else if (config._strict && !parsedInput) {\n                getParsingFlags(config).unusedTokens.push(token);\n            }\n        }\n\n        // add remaining unparsed input length to the string\n        getParsingFlags(config).charsLeftOver =\n            stringLength - totalParsedInputLength;\n        if (string.length > 0) {\n            getParsingFlags(config).unusedInput.push(string);\n        }\n\n        // clear _12h flag if hour is <= 12\n        if (\n            config._a[HOUR] <= 12 &&\n            getParsingFlags(config).bigHour === true &&\n            config._a[HOUR] > 0\n        ) {\n            getParsingFlags(config).bigHour = undefined;\n        }\n\n        getParsingFlags(config).parsedDateParts = config._a.slice(0);\n        getParsingFlags(config).meridiem = config._meridiem;\n        // handle meridiem\n        config._a[HOUR] = meridiemFixWrap(\n            config._locale,\n            config._a[HOUR],\n            config._meridiem\n        );\n\n        // handle era\n        era = getParsingFlags(config).era;\n        if (era !== null) {\n            config._a[YEAR] = config._locale.erasConvertYear(era, config._a[YEAR]);\n        }\n\n        configFromArray(config);\n        checkOverflow(config);\n    }\n\n    function meridiemFixWrap(locale, hour, meridiem) {\n        var isPm;\n\n        if (meridiem == null) {\n            // nothing to do\n            return hour;\n        }\n        if (locale.meridiemHour != null) {\n            return locale.meridiemHour(hour, meridiem);\n        } else if (locale.isPM != null) {\n            // Fallback\n            isPm = locale.isPM(meridiem);\n            if (isPm && hour < 12) {\n                hour += 12;\n            }\n            if (!isPm && hour === 12) {\n                hour = 0;\n            }\n            return hour;\n        } else {\n            // this is not supposed to happen\n            return hour;\n        }\n    }\n\n    // date from string and array of format strings\n    function configFromStringAndArray(config) {\n        var tempConfig,\n            bestMoment,\n            scoreToBeat,\n            i,\n            currentScore,\n            validFormatFound,\n            bestFormatIsValid = false,\n            configfLen = config._f.length;\n\n        if (configfLen === 0) {\n            getParsingFlags(config).invalidFormat = true;\n            config._d = new Date(NaN);\n            return;\n        }\n\n        for (i = 0; i < configfLen; i++) {\n            currentScore = 0;\n            validFormatFound = false;\n            tempConfig = copyConfig({}, config);\n            if (config._useUTC != null) {\n                tempConfig._useUTC = config._useUTC;\n            }\n            tempConfig._f = config._f[i];\n            configFromStringAndFormat(tempConfig);\n\n            if (isValid(tempConfig)) {\n                validFormatFound = true;\n            }\n\n            // if there is any input that was not parsed add a penalty for that format\n            currentScore += getParsingFlags(tempConfig).charsLeftOver;\n\n            //or tokens\n            currentScore += getParsingFlags(tempConfig).unusedTokens.length * 10;\n\n            getParsingFlags(tempConfig).score = currentScore;\n\n            if (!bestFormatIsValid) {\n                if (\n                    scoreToBeat == null ||\n                    currentScore < scoreToBeat ||\n                    validFormatFound\n                ) {\n                    scoreToBeat = currentScore;\n                    bestMoment = tempConfig;\n                    if (validFormatFound) {\n                        bestFormatIsValid = true;\n                    }\n                }\n            } else {\n                if (currentScore < scoreToBeat) {\n                    scoreToBeat = currentScore;\n                    bestMoment = tempConfig;\n                }\n            }\n        }\n\n        extend(config, bestMoment || tempConfig);\n    }\n\n    function configFromObject(config) {\n        if (config._d) {\n            return;\n        }\n\n        var i = normalizeObjectUnits(config._i),\n            dayOrDate = i.day === undefined ? i.date : i.day;\n        config._a = map(\n            [i.year, i.month, dayOrDate, i.hour, i.minute, i.second, i.millisecond],\n            function (obj) {\n                return obj && parseInt(obj, 10);\n            }\n        );\n\n        configFromArray(config);\n    }\n\n    function createFromConfig(config) {\n        var res = new Moment(checkOverflow(prepareConfig(config)));\n        if (res._nextDay) {\n            // Adding is smart enough around DST\n            res.add(1, 'd');\n            res._nextDay = undefined;\n        }\n\n        return res;\n    }\n\n    function prepareConfig(config) {\n        var input = config._i,\n            format = config._f;\n\n        config._locale = config._locale || getLocale(config._l);\n\n        if (input === null || (format === undefined && input === '')) {\n            return createInvalid({ nullInput: true });\n        }\n\n        if (typeof input === 'string') {\n            config._i = input = config._locale.preparse(input);\n        }\n\n        if (isMoment(input)) {\n            return new Moment(checkOverflow(input));\n        } else if (isDate(input)) {\n            config._d = input;\n        } else if (isArray(format)) {\n            configFromStringAndArray(config);\n        } else if (format) {\n            configFromStringAndFormat(config);\n        } else {\n            configFromInput(config);\n        }\n\n        if (!isValid(config)) {\n            config._d = null;\n        }\n\n        return config;\n    }\n\n    function configFromInput(config) {\n        var input = config._i;\n        if (isUndefined(input)) {\n            config._d = new Date(hooks.now());\n        } else if (isDate(input)) {\n            config._d = new Date(input.valueOf());\n        } else if (typeof input === 'string') {\n            configFromString(config);\n        } else if (isArray(input)) {\n            config._a = map(input.slice(0), function (obj) {\n                return parseInt(obj, 10);\n            });\n            configFromArray(config);\n        } else if (isObject(input)) {\n            configFromObject(config);\n        } else if (isNumber(input)) {\n            // from milliseconds\n            config._d = new Date(input);\n        } else {\n            hooks.createFromInputFallback(config);\n        }\n    }\n\n    function createLocalOrUTC(input, format, locale, strict, isUTC) {\n        var c = {};\n\n        if (format === true || format === false) {\n            strict = format;\n            format = undefined;\n        }\n\n        if (locale === true || locale === false) {\n            strict = locale;\n            locale = undefined;\n        }\n\n        if (\n            (isObject(input) && isObjectEmpty(input)) ||\n            (isArray(input) && input.length === 0)\n        ) {\n            input = undefined;\n        }\n        // object construction must be done this way.\n        // https://github.com/moment/moment/issues/1423\n        c._isAMomentObject = true;\n        c._useUTC = c._isUTC = isUTC;\n        c._l = locale;\n        c._i = input;\n        c._f = format;\n        c._strict = strict;\n\n        return createFromConfig(c);\n    }\n\n    function createLocal(input, format, locale, strict) {\n        return createLocalOrUTC(input, format, locale, strict, false);\n    }\n\n    var prototypeMin = deprecate(\n            'moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/',\n            function () {\n                var other = createLocal.apply(null, arguments);\n                if (this.isValid() && other.isValid()) {\n                    return other < this ? this : other;\n                } else {\n                    return createInvalid();\n                }\n            }\n        ),\n        prototypeMax = deprecate(\n            'moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/',\n            function () {\n                var other = createLocal.apply(null, arguments);\n                if (this.isValid() && other.isValid()) {\n                    return other > this ? this : other;\n                } else {\n                    return createInvalid();\n                }\n            }\n        );\n\n    // Pick a moment m from moments so that m[fn](other) is true for all\n    // other. This relies on the function fn to be transitive.\n    //\n    // moments should either be an array of moment objects or an array, whose\n    // first element is an array of moment objects.\n    function pickBy(fn, moments) {\n        var res, i;\n        if (moments.length === 1 && isArray(moments[0])) {\n            moments = moments[0];\n        }\n        if (!moments.length) {\n            return createLocal();\n        }\n        res = moments[0];\n        for (i = 1; i < moments.length; ++i) {\n            if (!moments[i].isValid() || moments[i][fn](res)) {\n                res = moments[i];\n            }\n        }\n        return res;\n    }\n\n    // TODO: Use [].sort instead?\n    function min() {\n        var args = [].slice.call(arguments, 0);\n\n        return pickBy('isBefore', args);\n    }\n\n    function max() {\n        var args = [].slice.call(arguments, 0);\n\n        return pickBy('isAfter', args);\n    }\n\n    var now = function () {\n        return Date.now ? Date.now() : +new Date();\n    };\n\n    var ordering = [\n        'year',\n        'quarter',\n        'month',\n        'week',\n        'day',\n        'hour',\n        'minute',\n        'second',\n        'millisecond',\n    ];\n\n    function isDurationValid(m) {\n        var key,\n            unitHasDecimal = false,\n            i,\n            orderLen = ordering.length;\n        for (key in m) {\n            if (\n                hasOwnProp(m, key) &&\n                !(\n                    indexOf.call(ordering, key) !== -1 &&\n                    (m[key] == null || !isNaN(m[key]))\n                )\n            ) {\n                return false;\n            }\n        }\n\n        for (i = 0; i < orderLen; ++i) {\n            if (m[ordering[i]]) {\n                if (unitHasDecimal) {\n                    return false; // only allow non-integers for smallest unit\n                }\n                if (parseFloat(m[ordering[i]]) !== toInt(m[ordering[i]])) {\n                    unitHasDecimal = true;\n                }\n            }\n        }\n\n        return true;\n    }\n\n    function isValid$1() {\n        return this._isValid;\n    }\n\n    function createInvalid$1() {\n        return createDuration(NaN);\n    }\n\n    function Duration(duration) {\n        var normalizedInput = normalizeObjectUnits(duration),\n            years = normalizedInput.year || 0,\n            quarters = normalizedInput.quarter || 0,\n            months = normalizedInput.month || 0,\n            weeks = normalizedInput.week || normalizedInput.isoWeek || 0,\n            days = normalizedInput.day || 0,\n            hours = normalizedInput.hour || 0,\n            minutes = normalizedInput.minute || 0,\n            seconds = normalizedInput.second || 0,\n            milliseconds = normalizedInput.millisecond || 0;\n\n        this._isValid = isDurationValid(normalizedInput);\n\n        // representation for dateAddRemove\n        this._milliseconds =\n            +milliseconds +\n            seconds * 1e3 + // 1000\n            minutes * 6e4 + // 1000 * 60\n            hours * 1000 * 60 * 60; //using 1000 * 60 * 60 instead of 36e5 to avoid floating point rounding errors https://github.com/moment/moment/issues/2978\n        // Because of dateAddRemove treats 24 hours as different from a\n        // day when working around DST, we need to store them separately\n        this._days = +days + weeks * 7;\n        // It is impossible to translate months into days without knowing\n        // which months you are are talking about, so we have to store\n        // it separately.\n        this._months = +months + quarters * 3 + years * 12;\n\n        this._data = {};\n\n        this._locale = getLocale();\n\n        this._bubble();\n    }\n\n    function isDuration(obj) {\n        return obj instanceof Duration;\n    }\n\n    function absRound(number) {\n        if (number < 0) {\n            return Math.round(-1 * number) * -1;\n        } else {\n            return Math.round(number);\n        }\n    }\n\n    // compare two arrays, return the number of differences\n    function compareArrays(array1, array2, dontConvert) {\n        var len = Math.min(array1.length, array2.length),\n            lengthDiff = Math.abs(array1.length - array2.length),\n            diffs = 0,\n            i;\n        for (i = 0; i < len; i++) {\n            if (\n                (dontConvert && array1[i] !== array2[i]) ||\n                (!dontConvert && toInt(array1[i]) !== toInt(array2[i]))\n            ) {\n                diffs++;\n            }\n        }\n        return diffs + lengthDiff;\n    }\n\n    // FORMATTING\n\n    function offset(token, separator) {\n        addFormatToken(token, 0, 0, function () {\n            var offset = this.utcOffset(),\n                sign = '+';\n            if (offset < 0) {\n                offset = -offset;\n                sign = '-';\n            }\n            return (\n                sign +\n                zeroFill(~~(offset / 60), 2) +\n                separator +\n                zeroFill(~~offset % 60, 2)\n            );\n        });\n    }\n\n    offset('Z', ':');\n    offset('ZZ', '');\n\n    // PARSING\n\n    addRegexToken('Z', matchShortOffset);\n    addRegexToken('ZZ', matchShortOffset);\n    addParseToken(['Z', 'ZZ'], function (input, array, config) {\n        config._useUTC = true;\n        config._tzm = offsetFromString(matchShortOffset, input);\n    });\n\n    // HELPERS\n\n    // timezone chunker\n    // '+10:00' > ['10',  '00']\n    // '-1530'  > ['-15', '30']\n    var chunkOffset = /([\\+\\-]|\\d\\d)/gi;\n\n    function offsetFromString(matcher, string) {\n        var matches = (string || '').match(matcher),\n            chunk,\n            parts,\n            minutes;\n\n        if (matches === null) {\n            return null;\n        }\n\n        chunk = matches[matches.length - 1] || [];\n        parts = (chunk + '').match(chunkOffset) || ['-', 0, 0];\n        minutes = +(parts[1] * 60) + toInt(parts[2]);\n\n        return minutes === 0 ? 0 : parts[0] === '+' ? minutes : -minutes;\n    }\n\n    // Return a moment from input, that is local/utc/zone equivalent to model.\n    function cloneWithOffset(input, model) {\n        var res, diff;\n        if (model._isUTC) {\n            res = model.clone();\n            diff =\n                (isMoment(input) || isDate(input)\n                    ? input.valueOf()\n                    : createLocal(input).valueOf()) - res.valueOf();\n            // Use low-level api, because this fn is low-level api.\n            res._d.setTime(res._d.valueOf() + diff);\n            hooks.updateOffset(res, false);\n            return res;\n        } else {\n            return createLocal(input).local();\n        }\n    }\n\n    function getDateOffset(m) {\n        // On Firefox.24 Date#getTimezoneOffset returns a floating point.\n        // https://github.com/moment/moment/pull/1871\n        return -Math.round(m._d.getTimezoneOffset());\n    }\n\n    // HOOKS\n\n    // This function will be called whenever a moment is mutated.\n    // It is intended to keep the offset in sync with the timezone.\n    hooks.updateOffset = function () {};\n\n    // MOMENTS\n\n    // keepLocalTime = true means only change the timezone, without\n    // affecting the local hour. So 5:31:26 +0300 --[utcOffset(2, true)]-->\n    // 5:31:26 +0200 It is possible that 5:31:26 doesn't exist with offset\n    // +0200, so we adjust the time as needed, to be valid.\n    //\n    // Keeping the time actually adds/subtracts (one hour)\n    // from the actual represented time. That is why we call updateOffset\n    // a second time. In case it wants us to change the offset again\n    // _changeInProgress == true case, then we have to adjust, because\n    // there is no such time in the given timezone.\n    function getSetOffset(input, keepLocalTime, keepMinutes) {\n        var offset = this._offset || 0,\n            localAdjust;\n        if (!this.isValid()) {\n            return input != null ? this : NaN;\n        }\n        if (input != null) {\n            if (typeof input === 'string') {\n                input = offsetFromString(matchShortOffset, input);\n                if (input === null) {\n                    return this;\n                }\n            } else if (Math.abs(input) < 16 && !keepMinutes) {\n                input = input * 60;\n            }\n            if (!this._isUTC && keepLocalTime) {\n                localAdjust = getDateOffset(this);\n            }\n            this._offset = input;\n            this._isUTC = true;\n            if (localAdjust != null) {\n                this.add(localAdjust, 'm');\n            }\n            if (offset !== input) {\n                if (!keepLocalTime || this._changeInProgress) {\n                    addSubtract(\n                        this,\n                        createDuration(input - offset, 'm'),\n                        1,\n                        false\n                    );\n                } else if (!this._changeInProgress) {\n                    this._changeInProgress = true;\n                    hooks.updateOffset(this, true);\n                    this._changeInProgress = null;\n                }\n            }\n            return this;\n        } else {\n            return this._isUTC ? offset : getDateOffset(this);\n        }\n    }\n\n    function getSetZone(input, keepLocalTime) {\n        if (input != null) {\n            if (typeof input !== 'string') {\n                input = -input;\n            }\n\n            this.utcOffset(input, keepLocalTime);\n\n            return this;\n        } else {\n            return -this.utcOffset();\n        }\n    }\n\n    function setOffsetToUTC(keepLocalTime) {\n        return this.utcOffset(0, keepLocalTime);\n    }\n\n    function setOffsetToLocal(keepLocalTime) {\n        if (this._isUTC) {\n            this.utcOffset(0, keepLocalTime);\n            this._isUTC = false;\n\n            if (keepLocalTime) {\n                this.subtract(getDateOffset(this), 'm');\n            }\n        }\n        return this;\n    }\n\n    function setOffsetToParsedOffset() {\n        if (this._tzm != null) {\n            this.utcOffset(this._tzm, false, true);\n        } else if (typeof this._i === 'string') {\n            var tZone = offsetFromString(matchOffset, this._i);\n            if (tZone != null) {\n                this.utcOffset(tZone);\n            } else {\n                this.utcOffset(0, true);\n            }\n        }\n        return this;\n    }\n\n    function hasAlignedHourOffset(input) {\n        if (!this.isValid()) {\n            return false;\n        }\n        input = input ? createLocal(input).utcOffset() : 0;\n\n        return (this.utcOffset() - input) % 60 === 0;\n    }\n\n    function isDaylightSavingTime() {\n        return (\n            this.utcOffset() > this.clone().month(0).utcOffset() ||\n            this.utcOffset() > this.clone().month(5).utcOffset()\n        );\n    }\n\n    function isDaylightSavingTimeShifted() {\n        if (!isUndefined(this._isDSTShifted)) {\n            return this._isDSTShifted;\n        }\n\n        var c = {},\n            other;\n\n        copyConfig(c, this);\n        c = prepareConfig(c);\n\n        if (c._a) {\n            other = c._isUTC ? createUTC(c._a) : createLocal(c._a);\n            this._isDSTShifted =\n                this.isValid() && compareArrays(c._a, other.toArray()) > 0;\n        } else {\n            this._isDSTShifted = false;\n        }\n\n        return this._isDSTShifted;\n    }\n\n    function isLocal() {\n        return this.isValid() ? !this._isUTC : false;\n    }\n\n    function isUtcOffset() {\n        return this.isValid() ? this._isUTC : false;\n    }\n\n    function isUtc() {\n        return this.isValid() ? this._isUTC && this._offset === 0 : false;\n    }\n\n    // ASP.NET json date format regex\n    var aspNetRegex = /^(-|\\+)?(?:(\\d*)[. ])?(\\d+):(\\d+)(?::(\\d+)(\\.\\d*)?)?$/,\n        // from http://docs.closure-library.googlecode.com/git/closure_goog_date_date.js.source.html\n        // somewhat more in line with 4.4.3.2 2004 spec, but allows decimal anywhere\n        // and further modified to allow for strings containing both week and day\n        isoRegex =\n            /^(-|\\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;\n\n    function createDuration(input, key) {\n        var duration = input,\n            // matching against regexp is expensive, do it on demand\n            match = null,\n            sign,\n            ret,\n            diffRes;\n\n        if (isDuration(input)) {\n            duration = {\n                ms: input._milliseconds,\n                d: input._days,\n                M: input._months,\n            };\n        } else if (isNumber(input) || !isNaN(+input)) {\n            duration = {};\n            if (key) {\n                duration[key] = +input;\n            } else {\n                duration.milliseconds = +input;\n            }\n        } else if ((match = aspNetRegex.exec(input))) {\n            sign = match[1] === '-' ? -1 : 1;\n            duration = {\n                y: 0,\n                d: toInt(match[DATE]) * sign,\n                h: toInt(match[HOUR]) * sign,\n                m: toInt(match[MINUTE]) * sign,\n                s: toInt(match[SECOND]) * sign,\n                ms: toInt(absRound(match[MILLISECOND] * 1000)) * sign, // the millisecond decimal point is included in the match\n            };\n        } else if ((match = isoRegex.exec(input))) {\n            sign = match[1] === '-' ? -1 : 1;\n            duration = {\n                y: parseIso(match[2], sign),\n                M: parseIso(match[3], sign),\n                w: parseIso(match[4], sign),\n                d: parseIso(match[5], sign),\n                h: parseIso(match[6], sign),\n                m: parseIso(match[7], sign),\n                s: parseIso(match[8], sign),\n            };\n        } else if (duration == null) {\n            // checks for null or undefined\n            duration = {};\n        } else if (\n            typeof duration === 'object' &&\n            ('from' in duration || 'to' in duration)\n        ) {\n            diffRes = momentsDifference(\n                createLocal(duration.from),\n                createLocal(duration.to)\n            );\n\n            duration = {};\n            duration.ms = diffRes.milliseconds;\n            duration.M = diffRes.months;\n        }\n\n        ret = new Duration(duration);\n\n        if (isDuration(input) && hasOwnProp(input, '_locale')) {\n            ret._locale = input._locale;\n        }\n\n        if (isDuration(input) && hasOwnProp(input, '_isValid')) {\n            ret._isValid = input._isValid;\n        }\n\n        return ret;\n    }\n\n    createDuration.fn = Duration.prototype;\n    createDuration.invalid = createInvalid$1;\n\n    function parseIso(inp, sign) {\n        // We'd normally use ~~inp for this, but unfortunately it also\n        // converts floats to ints.\n        // inp may be undefined, so careful calling replace on it.\n        var res = inp && parseFloat(inp.replace(',', '.'));\n        // apply sign while we're at it\n        return (isNaN(res) ? 0 : res) * sign;\n    }\n\n    function positiveMomentsDifference(base, other) {\n        var res = {};\n\n        res.months =\n            other.month() - base.month() + (other.year() - base.year()) * 12;\n        if (base.clone().add(res.months, 'M').isAfter(other)) {\n            --res.months;\n        }\n\n        res.milliseconds = +other - +base.clone().add(res.months, 'M');\n\n        return res;\n    }\n\n    function momentsDifference(base, other) {\n        var res;\n        if (!(base.isValid() && other.isValid())) {\n            return { milliseconds: 0, months: 0 };\n        }\n\n        other = cloneWithOffset(other, base);\n        if (base.isBefore(other)) {\n            res = positiveMomentsDifference(base, other);\n        } else {\n            res = positiveMomentsDifference(other, base);\n            res.milliseconds = -res.milliseconds;\n            res.months = -res.months;\n        }\n\n        return res;\n    }\n\n    // TODO: remove 'name' arg after deprecation is removed\n    function createAdder(direction, name) {\n        return function (val, period) {\n            var dur, tmp;\n            //invert the arguments, but complain about it\n            if (period !== null && !isNaN(+period)) {\n                deprecateSimple(\n                    name,\n                    'moment().' +\n                        name +\n                        '(period, number) is deprecated. Please use moment().' +\n                        name +\n                        '(number, period). ' +\n                        'See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.'\n                );\n                tmp = val;\n                val = period;\n                period = tmp;\n            }\n\n            dur = createDuration(val, period);\n            addSubtract(this, dur, direction);\n            return this;\n        };\n    }\n\n    function addSubtract(mom, duration, isAdding, updateOffset) {\n        var milliseconds = duration._milliseconds,\n            days = absRound(duration._days),\n            months = absRound(duration._months);\n\n        if (!mom.isValid()) {\n            // No op\n            return;\n        }\n\n        updateOffset = updateOffset == null ? true : updateOffset;\n\n        if (months) {\n            setMonth(mom, get(mom, 'Month') + months * isAdding);\n        }\n        if (days) {\n            set$1(mom, 'Date', get(mom, 'Date') + days * isAdding);\n        }\n        if (milliseconds) {\n            mom._d.setTime(mom._d.valueOf() + milliseconds * isAdding);\n        }\n        if (updateOffset) {\n            hooks.updateOffset(mom, days || months);\n        }\n    }\n\n    var add = createAdder(1, 'add'),\n        subtract = createAdder(-1, 'subtract');\n\n    function isString(input) {\n        return typeof input === 'string' || input instanceof String;\n    }\n\n    // type MomentInput = Moment | Date | string | number | (number | string)[] | MomentInputObject | void; // null | undefined\n    function isMomentInput(input) {\n        return (\n            isMoment(input) ||\n            isDate(input) ||\n            isString(input) ||\n            isNumber(input) ||\n            isNumberOrStringArray(input) ||\n            isMomentInputObject(input) ||\n            input === null ||\n            input === undefined\n        );\n    }\n\n    function isMomentInputObject(input) {\n        var objectTest = isObject(input) && !isObjectEmpty(input),\n            propertyTest = false,\n            properties = [\n                'years',\n                'year',\n                'y',\n                'months',\n                'month',\n                'M',\n                'days',\n                'day',\n                'd',\n                'dates',\n                'date',\n                'D',\n                'hours',\n                'hour',\n                'h',\n                'minutes',\n                'minute',\n                'm',\n                'seconds',\n                'second',\n                's',\n                'milliseconds',\n                'millisecond',\n                'ms',\n            ],\n            i,\n            property,\n            propertyLen = properties.length;\n\n        for (i = 0; i < propertyLen; i += 1) {\n            property = properties[i];\n            propertyTest = propertyTest || hasOwnProp(input, property);\n        }\n\n        return objectTest && propertyTest;\n    }\n\n    function isNumberOrStringArray(input) {\n        var arrayTest = isArray(input),\n            dataTypeTest = false;\n        if (arrayTest) {\n            dataTypeTest =\n                input.filter(function (item) {\n                    return !isNumber(item) && isString(input);\n                }).length === 0;\n        }\n        return arrayTest && dataTypeTest;\n    }\n\n    function isCalendarSpec(input) {\n        var objectTest = isObject(input) && !isObjectEmpty(input),\n            propertyTest = false,\n            properties = [\n                'sameDay',\n                'nextDay',\n                'lastDay',\n                'nextWeek',\n                'lastWeek',\n                'sameElse',\n            ],\n            i,\n            property;\n\n        for (i = 0; i < properties.length; i += 1) {\n            property = properties[i];\n            propertyTest = propertyTest || hasOwnProp(input, property);\n        }\n\n        return objectTest && propertyTest;\n    }\n\n    function getCalendarFormat(myMoment, now) {\n        var diff = myMoment.diff(now, 'days', true);\n        return diff < -6\n            ? 'sameElse'\n            : diff < -1\n            ? 'lastWeek'\n            : diff < 0\n            ? 'lastDay'\n            : diff < 1\n            ? 'sameDay'\n            : diff < 2\n            ? 'nextDay'\n            : diff < 7\n            ? 'nextWeek'\n            : 'sameElse';\n    }\n\n    function calendar$1(time, formats) {\n        // Support for single parameter, formats only overload to the calendar function\n        if (arguments.length === 1) {\n            if (!arguments[0]) {\n                time = undefined;\n                formats = undefined;\n            } else if (isMomentInput(arguments[0])) {\n                time = arguments[0];\n                formats = undefined;\n            } else if (isCalendarSpec(arguments[0])) {\n                formats = arguments[0];\n                time = undefined;\n            }\n        }\n        // We want to compare the start of today, vs this.\n        // Getting start-of-today depends on whether we're local/utc/offset or not.\n        var now = time || createLocal(),\n            sod = cloneWithOffset(now, this).startOf('day'),\n            format = hooks.calendarFormat(this, sod) || 'sameElse',\n            output =\n                formats &&\n                (isFunction(formats[format])\n                    ? formats[format].call(this, now)\n                    : formats[format]);\n\n        return this.format(\n            output || this.localeData().calendar(format, this, createLocal(now))\n        );\n    }\n\n    function clone() {\n        return new Moment(this);\n    }\n\n    function isAfter(input, units) {\n        var localInput = isMoment(input) ? input : createLocal(input);\n        if (!(this.isValid() && localInput.isValid())) {\n            return false;\n        }\n        units = normalizeUnits(units) || 'millisecond';\n        if (units === 'millisecond') {\n            return this.valueOf() > localInput.valueOf();\n        } else {\n            return localInput.valueOf() < this.clone().startOf(units).valueOf();\n        }\n    }\n\n    function isBefore(input, units) {\n        var localInput = isMoment(input) ? input : createLocal(input);\n        if (!(this.isValid() && localInput.isValid())) {\n            return false;\n        }\n        units = normalizeUnits(units) || 'millisecond';\n        if (units === 'millisecond') {\n            return this.valueOf() < localInput.valueOf();\n        } else {\n            return this.clone().endOf(units).valueOf() < localInput.valueOf();\n        }\n    }\n\n    function isBetween(from, to, units, inclusivity) {\n        var localFrom = isMoment(from) ? from : createLocal(from),\n            localTo = isMoment(to) ? to : createLocal(to);\n        if (!(this.isValid() && localFrom.isValid() && localTo.isValid())) {\n            return false;\n        }\n        inclusivity = inclusivity || '()';\n        return (\n            (inclusivity[0] === '('\n                ? this.isAfter(localFrom, units)\n                : !this.isBefore(localFrom, units)) &&\n            (inclusivity[1] === ')'\n                ? this.isBefore(localTo, units)\n                : !this.isAfter(localTo, units))\n        );\n    }\n\n    function isSame(input, units) {\n        var localInput = isMoment(input) ? input : createLocal(input),\n            inputMs;\n        if (!(this.isValid() && localInput.isValid())) {\n            return false;\n        }\n        units = normalizeUnits(units) || 'millisecond';\n        if (units === 'millisecond') {\n            return this.valueOf() === localInput.valueOf();\n        } else {\n            inputMs = localInput.valueOf();\n            return (\n                this.clone().startOf(units).valueOf() <= inputMs &&\n                inputMs <= this.clone().endOf(units).valueOf()\n            );\n        }\n    }\n\n    function isSameOrAfter(input, units) {\n        return this.isSame(input, units) || this.isAfter(input, units);\n    }\n\n    function isSameOrBefore(input, units) {\n        return this.isSame(input, units) || this.isBefore(input, units);\n    }\n\n    function diff(input, units, asFloat) {\n        var that, zoneDelta, output;\n\n        if (!this.isValid()) {\n            return NaN;\n        }\n\n        that = cloneWithOffset(input, this);\n\n        if (!that.isValid()) {\n            return NaN;\n        }\n\n        zoneDelta = (that.utcOffset() - this.utcOffset()) * 6e4;\n\n        units = normalizeUnits(units);\n\n        switch (units) {\n            case 'year':\n                output = monthDiff(this, that) / 12;\n                break;\n            case 'month':\n                output = monthDiff(this, that);\n                break;\n            case 'quarter':\n                output = monthDiff(this, that) / 3;\n                break;\n            case 'second':\n                output = (this - that) / 1e3;\n                break; // 1000\n            case 'minute':\n                output = (this - that) / 6e4;\n                break; // 1000 * 60\n            case 'hour':\n                output = (this - that) / 36e5;\n                break; // 1000 * 60 * 60\n            case 'day':\n                output = (this - that - zoneDelta) / 864e5;\n                break; // 1000 * 60 * 60 * 24, negate dst\n            case 'week':\n                output = (this - that - zoneDelta) / 6048e5;\n                break; // 1000 * 60 * 60 * 24 * 7, negate dst\n            default:\n                output = this - that;\n        }\n\n        return asFloat ? output : absFloor(output);\n    }\n\n    function monthDiff(a, b) {\n        if (a.date() < b.date()) {\n            // end-of-month calculations work correct when the start month has more\n            // days than the end month.\n            return -monthDiff(b, a);\n        }\n        // difference in months\n        var wholeMonthDiff = (b.year() - a.year()) * 12 + (b.month() - a.month()),\n            // b is in (anchor - 1 month, anchor + 1 month)\n            anchor = a.clone().add(wholeMonthDiff, 'months'),\n            anchor2,\n            adjust;\n\n        if (b - anchor < 0) {\n            anchor2 = a.clone().add(wholeMonthDiff - 1, 'months');\n            // linear across the month\n            adjust = (b - anchor) / (anchor - anchor2);\n        } else {\n            anchor2 = a.clone().add(wholeMonthDiff + 1, 'months');\n            // linear across the month\n            adjust = (b - anchor) / (anchor2 - anchor);\n        }\n\n        //check for negative zero, return zero if negative zero\n        return -(wholeMonthDiff + adjust) || 0;\n    }\n\n    hooks.defaultFormat = 'YYYY-MM-DDTHH:mm:ssZ';\n    hooks.defaultFormatUtc = 'YYYY-MM-DDTHH:mm:ss[Z]';\n\n    function toString() {\n        return this.clone().locale('en').format('ddd MMM DD YYYY HH:mm:ss [GMT]ZZ');\n    }\n\n    function toISOString(keepOffset) {\n        if (!this.isValid()) {\n            return null;\n        }\n        var utc = keepOffset !== true,\n            m = utc ? this.clone().utc() : this;\n        if (m.year() < 0 || m.year() > 9999) {\n            return formatMoment(\n                m,\n                utc\n                    ? 'YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]'\n                    : 'YYYYYY-MM-DD[T]HH:mm:ss.SSSZ'\n            );\n        }\n        if (isFunction(Date.prototype.toISOString)) {\n            // native implementation is ~50x faster, use it when we can\n            if (utc) {\n                return this.toDate().toISOString();\n            } else {\n                return new Date(this.valueOf() + this.utcOffset() * 60 * 1000)\n                    .toISOString()\n                    .replace('Z', formatMoment(m, 'Z'));\n            }\n        }\n        return formatMoment(\n            m,\n            utc ? 'YYYY-MM-DD[T]HH:mm:ss.SSS[Z]' : 'YYYY-MM-DD[T]HH:mm:ss.SSSZ'\n        );\n    }\n\n    /**\n     * Return a human readable representation of a moment that can\n     * also be evaluated to get a new moment which is the same\n     *\n     * @link https://nodejs.org/dist/latest/docs/api/util.html#util_custom_inspect_function_on_objects\n     */\n    function inspect() {\n        if (!this.isValid()) {\n            return 'moment.invalid(/* ' + this._i + ' */)';\n        }\n        var func = 'moment',\n            zone = '',\n            prefix,\n            year,\n            datetime,\n            suffix;\n        if (!this.isLocal()) {\n            func = this.utcOffset() === 0 ? 'moment.utc' : 'moment.parseZone';\n            zone = 'Z';\n        }\n        prefix = '[' + func + '(\"]';\n        year = 0 <= this.year() && this.year() <= 9999 ? 'YYYY' : 'YYYYYY';\n        datetime = '-MM-DD[T]HH:mm:ss.SSS';\n        suffix = zone + '[\")]';\n\n        return this.format(prefix + year + datetime + suffix);\n    }\n\n    function format(inputString) {\n        if (!inputString) {\n            inputString = this.isUtc()\n                ? hooks.defaultFormatUtc\n                : hooks.defaultFormat;\n        }\n        var output = formatMoment(this, inputString);\n        return this.localeData().postformat(output);\n    }\n\n    function from(time, withoutSuffix) {\n        if (\n            this.isValid() &&\n            ((isMoment(time) && time.isValid()) || createLocal(time).isValid())\n        ) {\n            return createDuration({ to: this, from: time })\n                .locale(this.locale())\n                .humanize(!withoutSuffix);\n        } else {\n            return this.localeData().invalidDate();\n        }\n    }\n\n    function fromNow(withoutSuffix) {\n        return this.from(createLocal(), withoutSuffix);\n    }\n\n    function to(time, withoutSuffix) {\n        if (\n            this.isValid() &&\n            ((isMoment(time) && time.isValid()) || createLocal(time).isValid())\n        ) {\n            return createDuration({ from: this, to: time })\n                .locale(this.locale())\n                .humanize(!withoutSuffix);\n        } else {\n            return this.localeData().invalidDate();\n        }\n    }\n\n    function toNow(withoutSuffix) {\n        return this.to(createLocal(), withoutSuffix);\n    }\n\n    // If passed a locale key, it will set the locale for this\n    // instance.  Otherwise, it will return the locale configuration\n    // variables for this instance.\n    function locale(key) {\n        var newLocaleData;\n\n        if (key === undefined) {\n            return this._locale._abbr;\n        } else {\n            newLocaleData = getLocale(key);\n            if (newLocaleData != null) {\n                this._locale = newLocaleData;\n            }\n            return this;\n        }\n    }\n\n    var lang = deprecate(\n        'moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.',\n        function (key) {\n            if (key === undefined) {\n                return this.localeData();\n            } else {\n                return this.locale(key);\n            }\n        }\n    );\n\n    function localeData() {\n        return this._locale;\n    }\n\n    var MS_PER_SECOND = 1000,\n        MS_PER_MINUTE = 60 * MS_PER_SECOND,\n        MS_PER_HOUR = 60 * MS_PER_MINUTE,\n        MS_PER_400_YEARS = (365 * 400 + 97) * 24 * MS_PER_HOUR;\n\n    // actual modulo - handles negative numbers (for dates before 1970):\n    function mod$1(dividend, divisor) {\n        return ((dividend % divisor) + divisor) % divisor;\n    }\n\n    function localStartOfDate(y, m, d) {\n        // the date constructor remaps years 0-99 to 1900-1999\n        if (y < 100 && y >= 0) {\n            // preserve leap years using a full 400 year cycle, then reset\n            return new Date(y + 400, m, d) - MS_PER_400_YEARS;\n        } else {\n            return new Date(y, m, d).valueOf();\n        }\n    }\n\n    function utcStartOfDate(y, m, d) {\n        // Date.UTC remaps years 0-99 to 1900-1999\n        if (y < 100 && y >= 0) {\n            // preserve leap years using a full 400 year cycle, then reset\n            return Date.UTC(y + 400, m, d) - MS_PER_400_YEARS;\n        } else {\n            return Date.UTC(y, m, d);\n        }\n    }\n\n    function startOf(units) {\n        var time, startOfDate;\n        units = normalizeUnits(units);\n        if (units === undefined || units === 'millisecond' || !this.isValid()) {\n            return this;\n        }\n\n        startOfDate = this._isUTC ? utcStartOfDate : localStartOfDate;\n\n        switch (units) {\n            case 'year':\n                time = startOfDate(this.year(), 0, 1);\n                break;\n            case 'quarter':\n                time = startOfDate(\n                    this.year(),\n                    this.month() - (this.month() % 3),\n                    1\n                );\n                break;\n            case 'month':\n                time = startOfDate(this.year(), this.month(), 1);\n                break;\n            case 'week':\n                time = startOfDate(\n                    this.year(),\n                    this.month(),\n                    this.date() - this.weekday()\n                );\n                break;\n            case 'isoWeek':\n                time = startOfDate(\n                    this.year(),\n                    this.month(),\n                    this.date() - (this.isoWeekday() - 1)\n                );\n                break;\n            case 'day':\n            case 'date':\n                time = startOfDate(this.year(), this.month(), this.date());\n                break;\n            case 'hour':\n                time = this._d.valueOf();\n                time -= mod$1(\n                    time + (this._isUTC ? 0 : this.utcOffset() * MS_PER_MINUTE),\n                    MS_PER_HOUR\n                );\n                break;\n            case 'minute':\n                time = this._d.valueOf();\n                time -= mod$1(time, MS_PER_MINUTE);\n                break;\n            case 'second':\n                time = this._d.valueOf();\n                time -= mod$1(time, MS_PER_SECOND);\n                break;\n        }\n\n        this._d.setTime(time);\n        hooks.updateOffset(this, true);\n        return this;\n    }\n\n    function endOf(units) {\n        var time, startOfDate;\n        units = normalizeUnits(units);\n        if (units === undefined || units === 'millisecond' || !this.isValid()) {\n            return this;\n        }\n\n        startOfDate = this._isUTC ? utcStartOfDate : localStartOfDate;\n\n        switch (units) {\n            case 'year':\n                time = startOfDate(this.year() + 1, 0, 1) - 1;\n                break;\n            case 'quarter':\n                time =\n                    startOfDate(\n                        this.year(),\n                        this.month() - (this.month() % 3) + 3,\n                        1\n                    ) - 1;\n                break;\n            case 'month':\n                time = startOfDate(this.year(), this.month() + 1, 1) - 1;\n                break;\n            case 'week':\n                time =\n                    startOfDate(\n                        this.year(),\n                        this.month(),\n                        this.date() - this.weekday() + 7\n                    ) - 1;\n                break;\n            case 'isoWeek':\n                time =\n                    startOfDate(\n                        this.year(),\n                        this.month(),\n                        this.date() - (this.isoWeekday() - 1) + 7\n                    ) - 1;\n                break;\n            case 'day':\n            case 'date':\n                time = startOfDate(this.year(), this.month(), this.date() + 1) - 1;\n                break;\n            case 'hour':\n                time = this._d.valueOf();\n                time +=\n                    MS_PER_HOUR -\n                    mod$1(\n                        time + (this._isUTC ? 0 : this.utcOffset() * MS_PER_MINUTE),\n                        MS_PER_HOUR\n                    ) -\n                    1;\n                break;\n            case 'minute':\n                time = this._d.valueOf();\n                time += MS_PER_MINUTE - mod$1(time, MS_PER_MINUTE) - 1;\n                break;\n            case 'second':\n                time = this._d.valueOf();\n                time += MS_PER_SECOND - mod$1(time, MS_PER_SECOND) - 1;\n                break;\n        }\n\n        this._d.setTime(time);\n        hooks.updateOffset(this, true);\n        return this;\n    }\n\n    function valueOf() {\n        return this._d.valueOf() - (this._offset || 0) * 60000;\n    }\n\n    function unix() {\n        return Math.floor(this.valueOf() / 1000);\n    }\n\n    function toDate() {\n        return new Date(this.valueOf());\n    }\n\n    function toArray() {\n        var m = this;\n        return [\n            m.year(),\n            m.month(),\n            m.date(),\n            m.hour(),\n            m.minute(),\n            m.second(),\n            m.millisecond(),\n        ];\n    }\n\n    function toObject() {\n        var m = this;\n        return {\n            years: m.year(),\n            months: m.month(),\n            date: m.date(),\n            hours: m.hours(),\n            minutes: m.minutes(),\n            seconds: m.seconds(),\n            milliseconds: m.milliseconds(),\n        };\n    }\n\n    function toJSON() {\n        // new Date(NaN).toJSON() === null\n        return this.isValid() ? this.toISOString() : null;\n    }\n\n    function isValid$2() {\n        return isValid(this);\n    }\n\n    function parsingFlags() {\n        return extend({}, getParsingFlags(this));\n    }\n\n    function invalidAt() {\n        return getParsingFlags(this).overflow;\n    }\n\n    function creationData() {\n        return {\n            input: this._i,\n            format: this._f,\n            locale: this._locale,\n            isUTC: this._isUTC,\n            strict: this._strict,\n        };\n    }\n\n    addFormatToken('N', 0, 0, 'eraAbbr');\n    addFormatToken('NN', 0, 0, 'eraAbbr');\n    addFormatToken('NNN', 0, 0, 'eraAbbr');\n    addFormatToken('NNNN', 0, 0, 'eraName');\n    addFormatToken('NNNNN', 0, 0, 'eraNarrow');\n\n    addFormatToken('y', ['y', 1], 'yo', 'eraYear');\n    addFormatToken('y', ['yy', 2], 0, 'eraYear');\n    addFormatToken('y', ['yyy', 3], 0, 'eraYear');\n    addFormatToken('y', ['yyyy', 4], 0, 'eraYear');\n\n    addRegexToken('N', matchEraAbbr);\n    addRegexToken('NN', matchEraAbbr);\n    addRegexToken('NNN', matchEraAbbr);\n    addRegexToken('NNNN', matchEraName);\n    addRegexToken('NNNNN', matchEraNarrow);\n\n    addParseToken(\n        ['N', 'NN', 'NNN', 'NNNN', 'NNNNN'],\n        function (input, array, config, token) {\n            var era = config._locale.erasParse(input, token, config._strict);\n            if (era) {\n                getParsingFlags(config).era = era;\n            } else {\n                getParsingFlags(config).invalidEra = input;\n            }\n        }\n    );\n\n    addRegexToken('y', matchUnsigned);\n    addRegexToken('yy', matchUnsigned);\n    addRegexToken('yyy', matchUnsigned);\n    addRegexToken('yyyy', matchUnsigned);\n    addRegexToken('yo', matchEraYearOrdinal);\n\n    addParseToken(['y', 'yy', 'yyy', 'yyyy'], YEAR);\n    addParseToken(['yo'], function (input, array, config, token) {\n        var match;\n        if (config._locale._eraYearOrdinalRegex) {\n            match = input.match(config._locale._eraYearOrdinalRegex);\n        }\n\n        if (config._locale.eraYearOrdinalParse) {\n            array[YEAR] = config._locale.eraYearOrdinalParse(input, match);\n        } else {\n            array[YEAR] = parseInt(input, 10);\n        }\n    });\n\n    function localeEras(m, format) {\n        var i,\n            l,\n            date,\n            eras = this._eras || getLocale('en')._eras;\n        for (i = 0, l = eras.length; i < l; ++i) {\n            switch (typeof eras[i].since) {\n                case 'string':\n                    // truncate time\n                    date = hooks(eras[i].since).startOf('day');\n                    eras[i].since = date.valueOf();\n                    break;\n            }\n\n            switch (typeof eras[i].until) {\n                case 'undefined':\n                    eras[i].until = +Infinity;\n                    break;\n                case 'string':\n                    // truncate time\n                    date = hooks(eras[i].until).startOf('day').valueOf();\n                    eras[i].until = date.valueOf();\n                    break;\n            }\n        }\n        return eras;\n    }\n\n    function localeErasParse(eraName, format, strict) {\n        var i,\n            l,\n            eras = this.eras(),\n            name,\n            abbr,\n            narrow;\n        eraName = eraName.toUpperCase();\n\n        for (i = 0, l = eras.length; i < l; ++i) {\n            name = eras[i].name.toUpperCase();\n            abbr = eras[i].abbr.toUpperCase();\n            narrow = eras[i].narrow.toUpperCase();\n\n            if (strict) {\n                switch (format) {\n                    case 'N':\n                    case 'NN':\n                    case 'NNN':\n                        if (abbr === eraName) {\n                            return eras[i];\n                        }\n                        break;\n\n                    case 'NNNN':\n                        if (name === eraName) {\n                            return eras[i];\n                        }\n                        break;\n\n                    case 'NNNNN':\n                        if (narrow === eraName) {\n                            return eras[i];\n                        }\n                        break;\n                }\n            } else if ([name, abbr, narrow].indexOf(eraName) >= 0) {\n                return eras[i];\n            }\n        }\n    }\n\n    function localeErasConvertYear(era, year) {\n        var dir = era.since <= era.until ? +1 : -1;\n        if (year === undefined) {\n            return hooks(era.since).year();\n        } else {\n            return hooks(era.since).year() + (year - era.offset) * dir;\n        }\n    }\n\n    function getEraName() {\n        var i,\n            l,\n            val,\n            eras = this.localeData().eras();\n        for (i = 0, l = eras.length; i < l; ++i) {\n            // truncate time\n            val = this.clone().startOf('day').valueOf();\n\n            if (eras[i].since <= val && val <= eras[i].until) {\n                return eras[i].name;\n            }\n            if (eras[i].until <= val && val <= eras[i].since) {\n                return eras[i].name;\n            }\n        }\n\n        return '';\n    }\n\n    function getEraNarrow() {\n        var i,\n            l,\n            val,\n            eras = this.localeData().eras();\n        for (i = 0, l = eras.length; i < l; ++i) {\n            // truncate time\n            val = this.clone().startOf('day').valueOf();\n\n            if (eras[i].since <= val && val <= eras[i].until) {\n                return eras[i].narrow;\n            }\n            if (eras[i].until <= val && val <= eras[i].since) {\n                return eras[i].narrow;\n            }\n        }\n\n        return '';\n    }\n\n    function getEraAbbr() {\n        var i,\n            l,\n            val,\n            eras = this.localeData().eras();\n        for (i = 0, l = eras.length; i < l; ++i) {\n            // truncate time\n            val = this.clone().startOf('day').valueOf();\n\n            if (eras[i].since <= val && val <= eras[i].until) {\n                return eras[i].abbr;\n            }\n            if (eras[i].until <= val && val <= eras[i].since) {\n                return eras[i].abbr;\n            }\n        }\n\n        return '';\n    }\n\n    function getEraYear() {\n        var i,\n            l,\n            dir,\n            val,\n            eras = this.localeData().eras();\n        for (i = 0, l = eras.length; i < l; ++i) {\n            dir = eras[i].since <= eras[i].until ? +1 : -1;\n\n            // truncate time\n            val = this.clone().startOf('day').valueOf();\n\n            if (\n                (eras[i].since <= val && val <= eras[i].until) ||\n                (eras[i].until <= val && val <= eras[i].since)\n            ) {\n                return (\n                    (this.year() - hooks(eras[i].since).year()) * dir +\n                    eras[i].offset\n                );\n            }\n        }\n\n        return this.year();\n    }\n\n    function erasNameRegex(isStrict) {\n        if (!hasOwnProp(this, '_erasNameRegex')) {\n            computeErasParse.call(this);\n        }\n        return isStrict ? this._erasNameRegex : this._erasRegex;\n    }\n\n    function erasAbbrRegex(isStrict) {\n        if (!hasOwnProp(this, '_erasAbbrRegex')) {\n            computeErasParse.call(this);\n        }\n        return isStrict ? this._erasAbbrRegex : this._erasRegex;\n    }\n\n    function erasNarrowRegex(isStrict) {\n        if (!hasOwnProp(this, '_erasNarrowRegex')) {\n            computeErasParse.call(this);\n        }\n        return isStrict ? this._erasNarrowRegex : this._erasRegex;\n    }\n\n    function matchEraAbbr(isStrict, locale) {\n        return locale.erasAbbrRegex(isStrict);\n    }\n\n    function matchEraName(isStrict, locale) {\n        return locale.erasNameRegex(isStrict);\n    }\n\n    function matchEraNarrow(isStrict, locale) {\n        return locale.erasNarrowRegex(isStrict);\n    }\n\n    function matchEraYearOrdinal(isStrict, locale) {\n        return locale._eraYearOrdinalRegex || matchUnsigned;\n    }\n\n    function computeErasParse() {\n        var abbrPieces = [],\n            namePieces = [],\n            narrowPieces = [],\n            mixedPieces = [],\n            i,\n            l,\n            eras = this.eras();\n\n        for (i = 0, l = eras.length; i < l; ++i) {\n            namePieces.push(regexEscape(eras[i].name));\n            abbrPieces.push(regexEscape(eras[i].abbr));\n            narrowPieces.push(regexEscape(eras[i].narrow));\n\n            mixedPieces.push(regexEscape(eras[i].name));\n            mixedPieces.push(regexEscape(eras[i].abbr));\n            mixedPieces.push(regexEscape(eras[i].narrow));\n        }\n\n        this._erasRegex = new RegExp('^(' + mixedPieces.join('|') + ')', 'i');\n        this._erasNameRegex = new RegExp('^(' + namePieces.join('|') + ')', 'i');\n        this._erasAbbrRegex = new RegExp('^(' + abbrPieces.join('|') + ')', 'i');\n        this._erasNarrowRegex = new RegExp(\n            '^(' + narrowPieces.join('|') + ')',\n            'i'\n        );\n    }\n\n    // FORMATTING\n\n    addFormatToken(0, ['gg', 2], 0, function () {\n        return this.weekYear() % 100;\n    });\n\n    addFormatToken(0, ['GG', 2], 0, function () {\n        return this.isoWeekYear() % 100;\n    });\n\n    function addWeekYearFormatToken(token, getter) {\n        addFormatToken(0, [token, token.length], 0, getter);\n    }\n\n    addWeekYearFormatToken('gggg', 'weekYear');\n    addWeekYearFormatToken('ggggg', 'weekYear');\n    addWeekYearFormatToken('GGGG', 'isoWeekYear');\n    addWeekYearFormatToken('GGGGG', 'isoWeekYear');\n\n    // ALIASES\n\n    addUnitAlias('weekYear', 'gg');\n    addUnitAlias('isoWeekYear', 'GG');\n\n    // PRIORITY\n\n    addUnitPriority('weekYear', 1);\n    addUnitPriority('isoWeekYear', 1);\n\n    // PARSING\n\n    addRegexToken('G', matchSigned);\n    addRegexToken('g', matchSigned);\n    addRegexToken('GG', match1to2, match2);\n    addRegexToken('gg', match1to2, match2);\n    addRegexToken('GGGG', match1to4, match4);\n    addRegexToken('gggg', match1to4, match4);\n    addRegexToken('GGGGG', match1to6, match6);\n    addRegexToken('ggggg', match1to6, match6);\n\n    addWeekParseToken(\n        ['gggg', 'ggggg', 'GGGG', 'GGGGG'],\n        function (input, week, config, token) {\n            week[token.substr(0, 2)] = toInt(input);\n        }\n    );\n\n    addWeekParseToken(['gg', 'GG'], function (input, week, config, token) {\n        week[token] = hooks.parseTwoDigitYear(input);\n    });\n\n    // MOMENTS\n\n    function getSetWeekYear(input) {\n        return getSetWeekYearHelper.call(\n            this,\n            input,\n            this.week(),\n            this.weekday(),\n            this.localeData()._week.dow,\n            this.localeData()._week.doy\n        );\n    }\n\n    function getSetISOWeekYear(input) {\n        return getSetWeekYearHelper.call(\n            this,\n            input,\n            this.isoWeek(),\n            this.isoWeekday(),\n            1,\n            4\n        );\n    }\n\n    function getISOWeeksInYear() {\n        return weeksInYear(this.year(), 1, 4);\n    }\n\n    function getISOWeeksInISOWeekYear() {\n        return weeksInYear(this.isoWeekYear(), 1, 4);\n    }\n\n    function getWeeksInYear() {\n        var weekInfo = this.localeData()._week;\n        return weeksInYear(this.year(), weekInfo.dow, weekInfo.doy);\n    }\n\n    function getWeeksInWeekYear() {\n        var weekInfo = this.localeData()._week;\n        return weeksInYear(this.weekYear(), weekInfo.dow, weekInfo.doy);\n    }\n\n    function getSetWeekYearHelper(input, week, weekday, dow, doy) {\n        var weeksTarget;\n        if (input == null) {\n            return weekOfYear(this, dow, doy).year;\n        } else {\n            weeksTarget = weeksInYear(input, dow, doy);\n            if (week > weeksTarget) {\n                week = weeksTarget;\n            }\n            return setWeekAll.call(this, input, week, weekday, dow, doy);\n        }\n    }\n\n    function setWeekAll(weekYear, week, weekday, dow, doy) {\n        var dayOfYearData = dayOfYearFromWeeks(weekYear, week, weekday, dow, doy),\n            date = createUTCDate(dayOfYearData.year, 0, dayOfYearData.dayOfYear);\n\n        this.year(date.getUTCFullYear());\n        this.month(date.getUTCMonth());\n        this.date(date.getUTCDate());\n        return this;\n    }\n\n    // FORMATTING\n\n    addFormatToken('Q', 0, 'Qo', 'quarter');\n\n    // ALIASES\n\n    addUnitAlias('quarter', 'Q');\n\n    // PRIORITY\n\n    addUnitPriority('quarter', 7);\n\n    // PARSING\n\n    addRegexToken('Q', match1);\n    addParseToken('Q', function (input, array) {\n        array[MONTH] = (toInt(input) - 1) * 3;\n    });\n\n    // MOMENTS\n\n    function getSetQuarter(input) {\n        return input == null\n            ? Math.ceil((this.month() + 1) / 3)\n            : this.month((input - 1) * 3 + (this.month() % 3));\n    }\n\n    // FORMATTING\n\n    addFormatToken('D', ['DD', 2], 'Do', 'date');\n\n    // ALIASES\n\n    addUnitAlias('date', 'D');\n\n    // PRIORITY\n    addUnitPriority('date', 9);\n\n    // PARSING\n\n    addRegexToken('D', match1to2);\n    addRegexToken('DD', match1to2, match2);\n    addRegexToken('Do', function (isStrict, locale) {\n        // TODO: Remove \"ordinalParse\" fallback in next major release.\n        return isStrict\n            ? locale._dayOfMonthOrdinalParse || locale._ordinalParse\n            : locale._dayOfMonthOrdinalParseLenient;\n    });\n\n    addParseToken(['D', 'DD'], DATE);\n    addParseToken('Do', function (input, array) {\n        array[DATE] = toInt(input.match(match1to2)[0]);\n    });\n\n    // MOMENTS\n\n    var getSetDayOfMonth = makeGetSet('Date', true);\n\n    // FORMATTING\n\n    addFormatToken('DDD', ['DDDD', 3], 'DDDo', 'dayOfYear');\n\n    // ALIASES\n\n    addUnitAlias('dayOfYear', 'DDD');\n\n    // PRIORITY\n    addUnitPriority('dayOfYear', 4);\n\n    // PARSING\n\n    addRegexToken('DDD', match1to3);\n    addRegexToken('DDDD', match3);\n    addParseToken(['DDD', 'DDDD'], function (input, array, config) {\n        config._dayOfYear = toInt(input);\n    });\n\n    // HELPERS\n\n    // MOMENTS\n\n    function getSetDayOfYear(input) {\n        var dayOfYear =\n            Math.round(\n                (this.clone().startOf('day') - this.clone().startOf('year')) / 864e5\n            ) + 1;\n        return input == null ? dayOfYear : this.add(input - dayOfYear, 'd');\n    }\n\n    // FORMATTING\n\n    addFormatToken('m', ['mm', 2], 0, 'minute');\n\n    // ALIASES\n\n    addUnitAlias('minute', 'm');\n\n    // PRIORITY\n\n    addUnitPriority('minute', 14);\n\n    // PARSING\n\n    addRegexToken('m', match1to2);\n    addRegexToken('mm', match1to2, match2);\n    addParseToken(['m', 'mm'], MINUTE);\n\n    // MOMENTS\n\n    var getSetMinute = makeGetSet('Minutes', false);\n\n    // FORMATTING\n\n    addFormatToken('s', ['ss', 2], 0, 'second');\n\n    // ALIASES\n\n    addUnitAlias('second', 's');\n\n    // PRIORITY\n\n    addUnitPriority('second', 15);\n\n    // PARSING\n\n    addRegexToken('s', match1to2);\n    addRegexToken('ss', match1to2, match2);\n    addParseToken(['s', 'ss'], SECOND);\n\n    // MOMENTS\n\n    var getSetSecond = makeGetSet('Seconds', false);\n\n    // FORMATTING\n\n    addFormatToken('S', 0, 0, function () {\n        return ~~(this.millisecond() / 100);\n    });\n\n    addFormatToken(0, ['SS', 2], 0, function () {\n        return ~~(this.millisecond() / 10);\n    });\n\n    addFormatToken(0, ['SSS', 3], 0, 'millisecond');\n    addFormatToken(0, ['SSSS', 4], 0, function () {\n        return this.millisecond() * 10;\n    });\n    addFormatToken(0, ['SSSSS', 5], 0, function () {\n        return this.millisecond() * 100;\n    });\n    addFormatToken(0, ['SSSSSS', 6], 0, function () {\n        return this.millisecond() * 1000;\n    });\n    addFormatToken(0, ['SSSSSSS', 7], 0, function () {\n        return this.millisecond() * 10000;\n    });\n    addFormatToken(0, ['SSSSSSSS', 8], 0, function () {\n        return this.millisecond() * 100000;\n    });\n    addFormatToken(0, ['SSSSSSSSS', 9], 0, function () {\n        return this.millisecond() * 1000000;\n    });\n\n    // ALIASES\n\n    addUnitAlias('millisecond', 'ms');\n\n    // PRIORITY\n\n    addUnitPriority('millisecond', 16);\n\n    // PARSING\n\n    addRegexToken('S', match1to3, match1);\n    addRegexToken('SS', match1to3, match2);\n    addRegexToken('SSS', match1to3, match3);\n\n    var token, getSetMillisecond;\n    for (token = 'SSSS'; token.length <= 9; token += 'S') {\n        addRegexToken(token, matchUnsigned);\n    }\n\n    function parseMs(input, array) {\n        array[MILLISECOND] = toInt(('0.' + input) * 1000);\n    }\n\n    for (token = 'S'; token.length <= 9; token += 'S') {\n        addParseToken(token, parseMs);\n    }\n\n    getSetMillisecond = makeGetSet('Milliseconds', false);\n\n    // FORMATTING\n\n    addFormatToken('z', 0, 0, 'zoneAbbr');\n    addFormatToken('zz', 0, 0, 'zoneName');\n\n    // MOMENTS\n\n    function getZoneAbbr() {\n        return this._isUTC ? 'UTC' : '';\n    }\n\n    function getZoneName() {\n        return this._isUTC ? 'Coordinated Universal Time' : '';\n    }\n\n    var proto = Moment.prototype;\n\n    proto.add = add;\n    proto.calendar = calendar$1;\n    proto.clone = clone;\n    proto.diff = diff;\n    proto.endOf = endOf;\n    proto.format = format;\n    proto.from = from;\n    proto.fromNow = fromNow;\n    proto.to = to;\n    proto.toNow = toNow;\n    proto.get = stringGet;\n    proto.invalidAt = invalidAt;\n    proto.isAfter = isAfter;\n    proto.isBefore = isBefore;\n    proto.isBetween = isBetween;\n    proto.isSame = isSame;\n    proto.isSameOrAfter = isSameOrAfter;\n    proto.isSameOrBefore = isSameOrBefore;\n    proto.isValid = isValid$2;\n    proto.lang = lang;\n    proto.locale = locale;\n    proto.localeData = localeData;\n    proto.max = prototypeMax;\n    proto.min = prototypeMin;\n    proto.parsingFlags = parsingFlags;\n    proto.set = stringSet;\n    proto.startOf = startOf;\n    proto.subtract = subtract;\n    proto.toArray = toArray;\n    proto.toObject = toObject;\n    proto.toDate = toDate;\n    proto.toISOString = toISOString;\n    proto.inspect = inspect;\n    if (typeof Symbol !== 'undefined' && Symbol.for != null) {\n        proto[Symbol.for('nodejs.util.inspect.custom')] = function () {\n            return 'Moment<' + this.format() + '>';\n        };\n    }\n    proto.toJSON = toJSON;\n    proto.toString = toString;\n    proto.unix = unix;\n    proto.valueOf = valueOf;\n    proto.creationData = creationData;\n    proto.eraName = getEraName;\n    proto.eraNarrow = getEraNarrow;\n    proto.eraAbbr = getEraAbbr;\n    proto.eraYear = getEraYear;\n    proto.year = getSetYear;\n    proto.isLeapYear = getIsLeapYear;\n    proto.weekYear = getSetWeekYear;\n    proto.isoWeekYear = getSetISOWeekYear;\n    proto.quarter = proto.quarters = getSetQuarter;\n    proto.month = getSetMonth;\n    proto.daysInMonth = getDaysInMonth;\n    proto.week = proto.weeks = getSetWeek;\n    proto.isoWeek = proto.isoWeeks = getSetISOWeek;\n    proto.weeksInYear = getWeeksInYear;\n    proto.weeksInWeekYear = getWeeksInWeekYear;\n    proto.isoWeeksInYear = getISOWeeksInYear;\n    proto.isoWeeksInISOWeekYear = getISOWeeksInISOWeekYear;\n    proto.date = getSetDayOfMonth;\n    proto.day = proto.days = getSetDayOfWeek;\n    proto.weekday = getSetLocaleDayOfWeek;\n    proto.isoWeekday = getSetISODayOfWeek;\n    proto.dayOfYear = getSetDayOfYear;\n    proto.hour = proto.hours = getSetHour;\n    proto.minute = proto.minutes = getSetMinute;\n    proto.second = proto.seconds = getSetSecond;\n    proto.millisecond = proto.milliseconds = getSetMillisecond;\n    proto.utcOffset = getSetOffset;\n    proto.utc = setOffsetToUTC;\n    proto.local = setOffsetToLocal;\n    proto.parseZone = setOffsetToParsedOffset;\n    proto.hasAlignedHourOffset = hasAlignedHourOffset;\n    proto.isDST = isDaylightSavingTime;\n    proto.isLocal = isLocal;\n    proto.isUtcOffset = isUtcOffset;\n    proto.isUtc = isUtc;\n    proto.isUTC = isUtc;\n    proto.zoneAbbr = getZoneAbbr;\n    proto.zoneName = getZoneName;\n    proto.dates = deprecate(\n        'dates accessor is deprecated. Use date instead.',\n        getSetDayOfMonth\n    );\n    proto.months = deprecate(\n        'months accessor is deprecated. Use month instead',\n        getSetMonth\n    );\n    proto.years = deprecate(\n        'years accessor is deprecated. Use year instead',\n        getSetYear\n    );\n    proto.zone = deprecate(\n        'moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/',\n        getSetZone\n    );\n    proto.isDSTShifted = deprecate(\n        'isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information',\n        isDaylightSavingTimeShifted\n    );\n\n    function createUnix(input) {\n        return createLocal(input * 1000);\n    }\n\n    function createInZone() {\n        return createLocal.apply(null, arguments).parseZone();\n    }\n\n    function preParsePostFormat(string) {\n        return string;\n    }\n\n    var proto$1 = Locale.prototype;\n\n    proto$1.calendar = calendar;\n    proto$1.longDateFormat = longDateFormat;\n    proto$1.invalidDate = invalidDate;\n    proto$1.ordinal = ordinal;\n    proto$1.preparse = preParsePostFormat;\n    proto$1.postformat = preParsePostFormat;\n    proto$1.relativeTime = relativeTime;\n    proto$1.pastFuture = pastFuture;\n    proto$1.set = set;\n    proto$1.eras = localeEras;\n    proto$1.erasParse = localeErasParse;\n    proto$1.erasConvertYear = localeErasConvertYear;\n    proto$1.erasAbbrRegex = erasAbbrRegex;\n    proto$1.erasNameRegex = erasNameRegex;\n    proto$1.erasNarrowRegex = erasNarrowRegex;\n\n    proto$1.months = localeMonths;\n    proto$1.monthsShort = localeMonthsShort;\n    proto$1.monthsParse = localeMonthsParse;\n    proto$1.monthsRegex = monthsRegex;\n    proto$1.monthsShortRegex = monthsShortRegex;\n    proto$1.week = localeWeek;\n    proto$1.firstDayOfYear = localeFirstDayOfYear;\n    proto$1.firstDayOfWeek = localeFirstDayOfWeek;\n\n    proto$1.weekdays = localeWeekdays;\n    proto$1.weekdaysMin = localeWeekdaysMin;\n    proto$1.weekdaysShort = localeWeekdaysShort;\n    proto$1.weekdaysParse = localeWeekdaysParse;\n\n    proto$1.weekdaysRegex = weekdaysRegex;\n    proto$1.weekdaysShortRegex = weekdaysShortRegex;\n    proto$1.weekdaysMinRegex = weekdaysMinRegex;\n\n    proto$1.isPM = localeIsPM;\n    proto$1.meridiem = localeMeridiem;\n\n    function get$1(format, index, field, setter) {\n        var locale = getLocale(),\n            utc = createUTC().set(setter, index);\n        return locale[field](utc, format);\n    }\n\n    function listMonthsImpl(format, index, field) {\n        if (isNumber(format)) {\n            index = format;\n            format = undefined;\n        }\n\n        format = format || '';\n\n        if (index != null) {\n            return get$1(format, index, field, 'month');\n        }\n\n        var i,\n            out = [];\n        for (i = 0; i < 12; i++) {\n            out[i] = get$1(format, i, field, 'month');\n        }\n        return out;\n    }\n\n    // ()\n    // (5)\n    // (fmt, 5)\n    // (fmt)\n    // (true)\n    // (true, 5)\n    // (true, fmt, 5)\n    // (true, fmt)\n    function listWeekdaysImpl(localeSorted, format, index, field) {\n        if (typeof localeSorted === 'boolean') {\n            if (isNumber(format)) {\n                index = format;\n                format = undefined;\n            }\n\n            format = format || '';\n        } else {\n            format = localeSorted;\n            index = format;\n            localeSorted = false;\n\n            if (isNumber(format)) {\n                index = format;\n                format = undefined;\n            }\n\n            format = format || '';\n        }\n\n        var locale = getLocale(),\n            shift = localeSorted ? locale._week.dow : 0,\n            i,\n            out = [];\n\n        if (index != null) {\n            return get$1(format, (index + shift) % 7, field, 'day');\n        }\n\n        for (i = 0; i < 7; i++) {\n            out[i] = get$1(format, (i + shift) % 7, field, 'day');\n        }\n        return out;\n    }\n\n    function listMonths(format, index) {\n        return listMonthsImpl(format, index, 'months');\n    }\n\n    function listMonthsShort(format, index) {\n        return listMonthsImpl(format, index, 'monthsShort');\n    }\n\n    function listWeekdays(localeSorted, format, index) {\n        return listWeekdaysImpl(localeSorted, format, index, 'weekdays');\n    }\n\n    function listWeekdaysShort(localeSorted, format, index) {\n        return listWeekdaysImpl(localeSorted, format, index, 'weekdaysShort');\n    }\n\n    function listWeekdaysMin(localeSorted, format, index) {\n        return listWeekdaysImpl(localeSorted, format, index, 'weekdaysMin');\n    }\n\n    getSetGlobalLocale('en', {\n        eras: [\n            {\n                since: '0001-01-01',\n                until: +Infinity,\n                offset: 1,\n                name: 'Anno Domini',\n                narrow: 'AD',\n                abbr: 'AD',\n            },\n            {\n                since: '0000-12-31',\n                until: -Infinity,\n                offset: 1,\n                name: 'Before Christ',\n                narrow: 'BC',\n                abbr: 'BC',\n            },\n        ],\n        dayOfMonthOrdinalParse: /\\d{1,2}(th|st|nd|rd)/,\n        ordinal: function (number) {\n            var b = number % 10,\n                output =\n                    toInt((number % 100) / 10) === 1\n                        ? 'th'\n                        : b === 1\n                        ? 'st'\n                        : b === 2\n                        ? 'nd'\n                        : b === 3\n                        ? 'rd'\n                        : 'th';\n            return number + output;\n        },\n    });\n\n    // Side effect imports\n\n    hooks.lang = deprecate(\n        'moment.lang is deprecated. Use moment.locale instead.',\n        getSetGlobalLocale\n    );\n    hooks.langData = deprecate(\n        'moment.langData is deprecated. Use moment.localeData instead.',\n        getLocale\n    );\n\n    var mathAbs = Math.abs;\n\n    function abs() {\n        var data = this._data;\n\n        this._milliseconds = mathAbs(this._milliseconds);\n        this._days = mathAbs(this._days);\n        this._months = mathAbs(this._months);\n\n        data.milliseconds = mathAbs(data.milliseconds);\n        data.seconds = mathAbs(data.seconds);\n        data.minutes = mathAbs(data.minutes);\n        data.hours = mathAbs(data.hours);\n        data.months = mathAbs(data.months);\n        data.years = mathAbs(data.years);\n\n        return this;\n    }\n\n    function addSubtract$1(duration, input, value, direction) {\n        var other = createDuration(input, value);\n\n        duration._milliseconds += direction * other._milliseconds;\n        duration._days += direction * other._days;\n        duration._months += direction * other._months;\n\n        return duration._bubble();\n    }\n\n    // supports only 2.0-style add(1, 's') or add(duration)\n    function add$1(input, value) {\n        return addSubtract$1(this, input, value, 1);\n    }\n\n    // supports only 2.0-style subtract(1, 's') or subtract(duration)\n    function subtract$1(input, value) {\n        return addSubtract$1(this, input, value, -1);\n    }\n\n    function absCeil(number) {\n        if (number < 0) {\n            return Math.floor(number);\n        } else {\n            return Math.ceil(number);\n        }\n    }\n\n    function bubble() {\n        var milliseconds = this._milliseconds,\n            days = this._days,\n            months = this._months,\n            data = this._data,\n            seconds,\n            minutes,\n            hours,\n            years,\n            monthsFromDays;\n\n        // if we have a mix of positive and negative values, bubble down first\n        // check: https://github.com/moment/moment/issues/2166\n        if (\n            !(\n                (milliseconds >= 0 && days >= 0 && months >= 0) ||\n                (milliseconds <= 0 && days <= 0 && months <= 0)\n            )\n        ) {\n            milliseconds += absCeil(monthsToDays(months) + days) * 864e5;\n            days = 0;\n            months = 0;\n        }\n\n        // The following code bubbles up values, see the tests for\n        // examples of what that means.\n        data.milliseconds = milliseconds % 1000;\n\n        seconds = absFloor(milliseconds / 1000);\n        data.seconds = seconds % 60;\n\n        minutes = absFloor(seconds / 60);\n        data.minutes = minutes % 60;\n\n        hours = absFloor(minutes / 60);\n        data.hours = hours % 24;\n\n        days += absFloor(hours / 24);\n\n        // convert days to months\n        monthsFromDays = absFloor(daysToMonths(days));\n        months += monthsFromDays;\n        days -= absCeil(monthsToDays(monthsFromDays));\n\n        // 12 months -> 1 year\n        years = absFloor(months / 12);\n        months %= 12;\n\n        data.days = days;\n        data.months = months;\n        data.years = years;\n\n        return this;\n    }\n\n    function daysToMonths(days) {\n        // 400 years have 146097 days (taking into account leap year rules)\n        // 400 years have 12 months === 4800\n        return (days * 4800) / 146097;\n    }\n\n    function monthsToDays(months) {\n        // the reverse of daysToMonths\n        return (months * 146097) / 4800;\n    }\n\n    function as(units) {\n        if (!this.isValid()) {\n            return NaN;\n        }\n        var days,\n            months,\n            milliseconds = this._milliseconds;\n\n        units = normalizeUnits(units);\n\n        if (units === 'month' || units === 'quarter' || units === 'year') {\n            days = this._days + milliseconds / 864e5;\n            months = this._months + daysToMonths(days);\n            switch (units) {\n                case 'month':\n                    return months;\n                case 'quarter':\n                    return months / 3;\n                case 'year':\n                    return months / 12;\n            }\n        } else {\n            // handle milliseconds separately because of floating point math errors (issue #1867)\n            days = this._days + Math.round(monthsToDays(this._months));\n            switch (units) {\n                case 'week':\n                    return days / 7 + milliseconds / 6048e5;\n                case 'day':\n                    return days + milliseconds / 864e5;\n                case 'hour':\n                    return days * 24 + milliseconds / 36e5;\n                case 'minute':\n                    return days * 1440 + milliseconds / 6e4;\n                case 'second':\n                    return days * 86400 + milliseconds / 1000;\n                // Math.floor prevents floating point math errors here\n                case 'millisecond':\n                    return Math.floor(days * 864e5) + milliseconds;\n                default:\n                    throw new Error('Unknown unit ' + units);\n            }\n        }\n    }\n\n    // TODO: Use this.as('ms')?\n    function valueOf$1() {\n        if (!this.isValid()) {\n            return NaN;\n        }\n        return (\n            this._milliseconds +\n            this._days * 864e5 +\n            (this._months % 12) * 2592e6 +\n            toInt(this._months / 12) * 31536e6\n        );\n    }\n\n    function makeAs(alias) {\n        return function () {\n            return this.as(alias);\n        };\n    }\n\n    var asMilliseconds = makeAs('ms'),\n        asSeconds = makeAs('s'),\n        asMinutes = makeAs('m'),\n        asHours = makeAs('h'),\n        asDays = makeAs('d'),\n        asWeeks = makeAs('w'),\n        asMonths = makeAs('M'),\n        asQuarters = makeAs('Q'),\n        asYears = makeAs('y');\n\n    function clone$1() {\n        return createDuration(this);\n    }\n\n    function get$2(units) {\n        units = normalizeUnits(units);\n        return this.isValid() ? this[units + 's']() : NaN;\n    }\n\n    function makeGetter(name) {\n        return function () {\n            return this.isValid() ? this._data[name] : NaN;\n        };\n    }\n\n    var milliseconds = makeGetter('milliseconds'),\n        seconds = makeGetter('seconds'),\n        minutes = makeGetter('minutes'),\n        hours = makeGetter('hours'),\n        days = makeGetter('days'),\n        months = makeGetter('months'),\n        years = makeGetter('years');\n\n    function weeks() {\n        return absFloor(this.days() / 7);\n    }\n\n    var round = Math.round,\n        thresholds = {\n            ss: 44, // a few seconds to seconds\n            s: 45, // seconds to minute\n            m: 45, // minutes to hour\n            h: 22, // hours to day\n            d: 26, // days to month/week\n            w: null, // weeks to month\n            M: 11, // months to year\n        };\n\n    // helper function for moment.fn.from, moment.fn.fromNow, and moment.duration.fn.humanize\n    function substituteTimeAgo(string, number, withoutSuffix, isFuture, locale) {\n        return locale.relativeTime(number || 1, !!withoutSuffix, string, isFuture);\n    }\n\n    function relativeTime$1(posNegDuration, withoutSuffix, thresholds, locale) {\n        var duration = createDuration(posNegDuration).abs(),\n            seconds = round(duration.as('s')),\n            minutes = round(duration.as('m')),\n            hours = round(duration.as('h')),\n            days = round(duration.as('d')),\n            months = round(duration.as('M')),\n            weeks = round(duration.as('w')),\n            years = round(duration.as('y')),\n            a =\n                (seconds <= thresholds.ss && ['s', seconds]) ||\n                (seconds < thresholds.s && ['ss', seconds]) ||\n                (minutes <= 1 && ['m']) ||\n                (minutes < thresholds.m && ['mm', minutes]) ||\n                (hours <= 1 && ['h']) ||\n                (hours < thresholds.h && ['hh', hours]) ||\n                (days <= 1 && ['d']) ||\n                (days < thresholds.d && ['dd', days]);\n\n        if (thresholds.w != null) {\n            a =\n                a ||\n                (weeks <= 1 && ['w']) ||\n                (weeks < thresholds.w && ['ww', weeks]);\n        }\n        a = a ||\n            (months <= 1 && ['M']) ||\n            (months < thresholds.M && ['MM', months]) ||\n            (years <= 1 && ['y']) || ['yy', years];\n\n        a[2] = withoutSuffix;\n        a[3] = +posNegDuration > 0;\n        a[4] = locale;\n        return substituteTimeAgo.apply(null, a);\n    }\n\n    // This function allows you to set the rounding function for relative time strings\n    function getSetRelativeTimeRounding(roundingFunction) {\n        if (roundingFunction === undefined) {\n            return round;\n        }\n        if (typeof roundingFunction === 'function') {\n            round = roundingFunction;\n            return true;\n        }\n        return false;\n    }\n\n    // This function allows you to set a threshold for relative time strings\n    function getSetRelativeTimeThreshold(threshold, limit) {\n        if (thresholds[threshold] === undefined) {\n            return false;\n        }\n        if (limit === undefined) {\n            return thresholds[threshold];\n        }\n        thresholds[threshold] = limit;\n        if (threshold === 's') {\n            thresholds.ss = limit - 1;\n        }\n        return true;\n    }\n\n    function humanize(argWithSuffix, argThresholds) {\n        if (!this.isValid()) {\n            return this.localeData().invalidDate();\n        }\n\n        var withSuffix = false,\n            th = thresholds,\n            locale,\n            output;\n\n        if (typeof argWithSuffix === 'object') {\n            argThresholds = argWithSuffix;\n            argWithSuffix = false;\n        }\n        if (typeof argWithSuffix === 'boolean') {\n            withSuffix = argWithSuffix;\n        }\n        if (typeof argThresholds === 'object') {\n            th = Object.assign({}, thresholds, argThresholds);\n            if (argThresholds.s != null && argThresholds.ss == null) {\n                th.ss = argThresholds.s - 1;\n            }\n        }\n\n        locale = this.localeData();\n        output = relativeTime$1(this, !withSuffix, th, locale);\n\n        if (withSuffix) {\n            output = locale.pastFuture(+this, output);\n        }\n\n        return locale.postformat(output);\n    }\n\n    var abs$1 = Math.abs;\n\n    function sign(x) {\n        return (x > 0) - (x < 0) || +x;\n    }\n\n    function toISOString$1() {\n        // for ISO strings we do not use the normal bubbling rules:\n        //  * milliseconds bubble up until they become hours\n        //  * days do not bubble at all\n        //  * months bubble up until they become years\n        // This is because there is no context-free conversion between hours and days\n        // (think of clock changes)\n        // and also not between days and months (28-31 days per month)\n        if (!this.isValid()) {\n            return this.localeData().invalidDate();\n        }\n\n        var seconds = abs$1(this._milliseconds) / 1000,\n            days = abs$1(this._days),\n            months = abs$1(this._months),\n            minutes,\n            hours,\n            years,\n            s,\n            total = this.asSeconds(),\n            totalSign,\n            ymSign,\n            daysSign,\n            hmsSign;\n\n        if (!total) {\n            // this is the same as C#'s (Noda) and python (isodate)...\n            // but not other JS (goog.date)\n            return 'P0D';\n        }\n\n        // 3600 seconds -> 60 minutes -> 1 hour\n        minutes = absFloor(seconds / 60);\n        hours = absFloor(minutes / 60);\n        seconds %= 60;\n        minutes %= 60;\n\n        // 12 months -> 1 year\n        years = absFloor(months / 12);\n        months %= 12;\n\n        // inspired by https://github.com/dordille/moment-isoduration/blob/master/moment.isoduration.js\n        s = seconds ? seconds.toFixed(3).replace(/\\.?0+$/, '') : '';\n\n        totalSign = total < 0 ? '-' : '';\n        ymSign = sign(this._months) !== sign(total) ? '-' : '';\n        daysSign = sign(this._days) !== sign(total) ? '-' : '';\n        hmsSign = sign(this._milliseconds) !== sign(total) ? '-' : '';\n\n        return (\n            totalSign +\n            'P' +\n            (years ? ymSign + years + 'Y' : '') +\n            (months ? ymSign + months + 'M' : '') +\n            (days ? daysSign + days + 'D' : '') +\n            (hours || minutes || seconds ? 'T' : '') +\n            (hours ? hmsSign + hours + 'H' : '') +\n            (minutes ? hmsSign + minutes + 'M' : '') +\n            (seconds ? hmsSign + s + 'S' : '')\n        );\n    }\n\n    var proto$2 = Duration.prototype;\n\n    proto$2.isValid = isValid$1;\n    proto$2.abs = abs;\n    proto$2.add = add$1;\n    proto$2.subtract = subtract$1;\n    proto$2.as = as;\n    proto$2.asMilliseconds = asMilliseconds;\n    proto$2.asSeconds = asSeconds;\n    proto$2.asMinutes = asMinutes;\n    proto$2.asHours = asHours;\n    proto$2.asDays = asDays;\n    proto$2.asWeeks = asWeeks;\n    proto$2.asMonths = asMonths;\n    proto$2.asQuarters = asQuarters;\n    proto$2.asYears = asYears;\n    proto$2.valueOf = valueOf$1;\n    proto$2._bubble = bubble;\n    proto$2.clone = clone$1;\n    proto$2.get = get$2;\n    proto$2.milliseconds = milliseconds;\n    proto$2.seconds = seconds;\n    proto$2.minutes = minutes;\n    proto$2.hours = hours;\n    proto$2.days = days;\n    proto$2.weeks = weeks;\n    proto$2.months = months;\n    proto$2.years = years;\n    proto$2.humanize = humanize;\n    proto$2.toISOString = toISOString$1;\n    proto$2.toString = toISOString$1;\n    proto$2.toJSON = toISOString$1;\n    proto$2.locale = locale;\n    proto$2.localeData = localeData;\n\n    proto$2.toIsoString = deprecate(\n        'toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)',\n        toISOString$1\n    );\n    proto$2.lang = lang;\n\n    // FORMATTING\n\n    addFormatToken('X', 0, 0, 'unix');\n    addFormatToken('x', 0, 0, 'valueOf');\n\n    // PARSING\n\n    addRegexToken('x', matchSigned);\n    addRegexToken('X', matchTimestamp);\n    addParseToken('X', function (input, array, config) {\n        config._d = new Date(parseFloat(input) * 1000);\n    });\n    addParseToken('x', function (input, array, config) {\n        config._d = new Date(toInt(input));\n    });\n\n    //! moment.js\n\n    hooks.version = '2.29.4';\n\n    setHookCallback(createLocal);\n\n    hooks.fn = proto;\n    hooks.min = min;\n    hooks.max = max;\n    hooks.now = now;\n    hooks.utc = createUTC;\n    hooks.unix = createUnix;\n    hooks.months = listMonths;\n    hooks.isDate = isDate;\n    hooks.locale = getSetGlobalLocale;\n    hooks.invalid = createInvalid;\n    hooks.duration = createDuration;\n    hooks.isMoment = isMoment;\n    hooks.weekdays = listWeekdays;\n    hooks.parseZone = createInZone;\n    hooks.localeData = getLocale;\n    hooks.isDuration = isDuration;\n    hooks.monthsShort = listMonthsShort;\n    hooks.weekdaysMin = listWeekdaysMin;\n    hooks.defineLocale = defineLocale;\n    hooks.updateLocale = updateLocale;\n    hooks.locales = listLocales;\n    hooks.weekdaysShort = listWeekdaysShort;\n    hooks.normalizeUnits = normalizeUnits;\n    hooks.relativeTimeRounding = getSetRelativeTimeRounding;\n    hooks.relativeTimeThreshold = getSetRelativeTimeThreshold;\n    hooks.calendarFormat = getCalendarFormat;\n    hooks.prototype = proto;\n\n    // currently HTML5 input type only supports 24-hour formats\n    hooks.HTML5_FMT = {\n        DATETIME_LOCAL: 'YYYY-MM-DDTHH:mm', // <input type=\"datetime-local\" />\n        DATETIME_LOCAL_SECONDS: 'YYYY-MM-DDTHH:mm:ss', // <input type=\"datetime-local\" step=\"1\" />\n        DATETIME_LOCAL_MS: 'YYYY-MM-DDTHH:mm:ss.SSS', // <input type=\"datetime-local\" step=\"0.001\" />\n        DATE: 'YYYY-MM-DD', // <input type=\"date\" />\n        TIME: 'HH:mm', // <input type=\"time\" />\n        TIME_SECONDS: 'HH:mm:ss', // <input type=\"time\" step=\"1\" />\n        TIME_MS: 'HH:mm:ss.SSS', // <input type=\"time\" step=\"0.001\" />\n        WEEK: 'GGGG-[W]WW', // <input type=\"week\" />\n        MONTH: 'YYYY-MM', // <input type=\"month\" />\n    };\n\n    return hooks;\n\n})));\n","<template>\n    <div class=\"c-jcl-header\">\n        <div class=\"c-jcl-left\">\n            <a href=\"/jcl\" class=\"u-logo\">\n                <img src=\"@/assets/img/jcl/common/jcl.svg\" alt=\"jcl-logo\" />\n            </a>\n        </div>\n        <div class=\"c-jcl-content\">\n            <slot></slot>\n        </div>\n        <nav class=\"c-jcl-right\">\n            <router-link class=\"u-link\" to=\"/public\">我的仓库</router-link>\n            <router-link class=\"u-link\" to=\"/mine\">数据大厅</router-link>\n            <a href=\"javascript:;\" class=\"u-link\" @click=\"open()\"> 上传数据 </a>\n            <a href=\"javascript:;\" class=\"u-link\" @click=\"toggleFullscreen()\"> 全屏 </a>\n            <a href=\"/tool/22456\" class=\"u-link\"> 帮助 </a>\n        </nav>\n        <file-select ref=\"fileSelectRef\"></file-select>\n    </div>\n</template>\n\n<script setup>\nimport { ref } from \"vue\";\nimport FileSelect from \"@/components/jcl/common/file_select\";\nconst fileSelectRef = ref(null);\n\nconst open = () => {\n    fileSelectRef.value.open(\"team\");\n};\n\n// / 封装全屏功能的函数\nfunction toggleFullscreen() {\n    const element = document.getElementById(\"m-jcl-main\");\n    if (\n        !document.fullscreenElement && // W3C 标准\n        !document.mozFullScreenElement && // Firefox\n        !document.webkitFullscreenElement && // Chrome, Safari 和 Opera\n        !document.msFullscreenElement\n    ) {\n        // IE/Edge\n        if (element.requestFullscreen) {\n            element.requestFullscreen();\n        } else if (element.mozRequestFullScreen) {\n            // Firefox\n            element.mozRequestFullScreen();\n        } else if (element.webkitRequestFullscreen) {\n            // Chrome, Safari 和 Opera\n            element.webkitRequestFullscreen();\n        } else if (element.msRequestFullscreen) {\n            // IE/Edge\n            element.msRequestFullscreen();\n        }\n    } else {\n        if (document.exitFullscreen) {\n            document.exitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n            // Firefox\n            document.mozCancelFullScreen();\n        } else if (document.webkitExitFullscreen) {\n            // Chrome, Safari 和 Opera\n            document.webkitExitFullscreen();\n        } else if (document.msExitFullscreen) {\n            // IE/Edge\n            document.msExitFullscreen();\n        }\n    }\n}\n</script>\n\n<style lang=\"less\">\n@import \"@/assets/css/jcl/common/jcl_header.less\";\n</style>\n","import script from \"./jcl_header.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./jcl_header.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./jcl_header.vue?vue&type=style&index=0&id=4e69ad55&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","export const raid_analysis_constant = {\n    // 时间轴常量\n    timeline_enable_mapId: [\n        // 110级\n        468,\n        469, // 剑冢惊变\n        477,\n        478, // 梧桐山庄\n        479,\n        480, // 罗汉门\n        476,\n        481, // 梦入集真岛\n        482,\n        483,\n        484, // 达摩洞\n        489,\n        490, // 月落三星\n        518,\n        519,\n        520, // 白帝江关\n        521,\n        522, // 漳水南路\n        559,\n        560,\n        561, // 雷域大泽\n        563,\n        564, // 武氏别院\n        573,\n        574,\n        575, // 河阳之战\n        // 120级\n        586,\n        587,\n        588, // 西津渡\n        596,\n        597, // 沃石院\n        598,\n        599, // 镇海阁地井\n        606,\n        607, // 幽藤馆\n        622,\n        623, // 江天夜宴\n        636,\n        637,\n        638, // 武狱黑牢\n        639,\n        640, // 鹿桥驿\n        648,\n        649,\n        650, // 九老洞\n        658,\n        659, // 栖灵洞天\n        668,\n        669,\n        670, // 冷龙峰\n        686,\n        687,\n        688,\n    ],\n    bossName: {\n        468: [\"陈骇\", \"雾影千斩\", \"千机伞·拂晓\", \"千机伞·琉璃\", \"千机伞·落雨\", \"千机伞·飞星\", \"陈徽\"],\n        469: [\"陈骇\", \"雾影千斩\", \"千机伞·拂晓\", \"千机伞·琉璃\", \"千机伞·落雨\", \"千机伞·飞星\", \"陈徽\"],\n        477: [\"雀卿\", \"鸩鸟\", \"阮梅\", \"罗刀\"],\n        478: [\"雀卿\", \"鸩鸟\", \"阮梅\", \"罗刀\"],\n        479: [\"宓果\", \"刘细\", \"郝大雪\"],\n        480: [\"宓果\", \"刘细\", \"郝大雪\"],\n        476: [\"花子\", \"观勒\", \"天空\"],\n        481: [\"花子\", \"观勒\", \"天空\"],\n        482: [\"余晖\", \"宓桃\", \"武雪散\", \"鬼门针\", \"猿飞\", \"毗流驮迦·增长天王\", \"毗留博叉·广目天王\", \"岳琳\", \"岳琅\"],\n        483: [\n            \"余晖\",\n            \"宓桃\",\n            \"武雪散\",\n            \"鬼门针\",\n            \"猿飞\",\n            \"毗流驮迦·增长天王\",\n            \"毗留博叉·广目天王\",\n            \"岳琳\",\n            \"岳琅\",\n            \"天欲宫弟子\",\n            \"天欲宫男宠\",\n            \"充能核心\",\n            \"蜂群胖墩\",\n            \"蜂群莽夫\",\n        ],\n        484: [\n            \"余晖\",\n            \"宓桃\",\n            \"武雪散\",\n            \"鬼门针\",\n            \"猿飞\",\n            \"毗流驮迦·增长天王\",\n            \"毗留博叉·广目天王\",\n            \"岳琳\",\n            \"岳琅\",\n            \"天欲宫弟子\",\n            \"天欲宫男宠\",\n            \"充能核心\",\n            \"蜂群胖墩\",\n            \"蜂群莽夫\",\n            \"蜂群弩手\",\n            \"提多罗吒·持国天王\",\n            \"木人·乾闼婆\",\n        ],\n        489: [\"苏凤楼\", \"韩敬青\", \"藤原夕夏\", \"蝴蝶式神\", \"阵眼\"],\n        490: [\"苏凤楼\", \"韩敬青\", \"藤原夕夏\", \"蝴蝶式神\", \"阵眼\"],\n        518: [\n            \"罗芬\",\n            \"胡汤\",\n            \"赵八嫂\",\n            \"海荼\",\n            \"天怒惊霆戟\",\n            \"姜集苦\",\n            \"宇文灭\",\n            \"宫威\",\n            \"十二连环坞高阶精英弓手\",\n            \"宫傲\",\n        ],\n        519: [\n            \"罗芬\",\n            \"胡汤\",\n            \"赵八嫂\",\n            \"鱼木寨喽啰\",\n            \"机关弩箭\",\n            \"海荼\",\n            \"天怒惊霆戟\",\n            \"姜集苦\",\n            \"宇文灭\",\n            \"宫威\",\n            \"十二连环坞高阶精英弓手\",\n            \"宫傲\",\n        ],\n        520: [\n            \"罗芬\",\n            \"胡汤\",\n            \"赵八嫂\",\n            \"鱼木寨喽啰\",\n            \"机关弩箭\",\n            \"海荼\",\n            \"天怒惊霆戟\",\n            \"姜集苦\",\n            \"宇文灭\",\n            \"宫威\",\n            \"十二连环坞高阶精英弓手\",\n            \"宫傲\",\n            \"尚水泡影\",\n        ],\n        521: [\"史孝\", \"曹达干\", \"阎清怀\", \"战车\", \"弩车\"],\n        522: [\"史孝\", \"曹达干\", \"阎清怀\", \"战车\", \"弩车\"],\n        559: [\n            \"巨型尖吻凤\",\n            \"衣旎\",\n            \"桑乔\",\n            \"悉达罗摩\",\n            \"灵虫\",\n            \"赐恩血瘤\",\n            \"尸腐秽血草\",\n            \"摄魂鬼虫\",\n            \"秽血勇虫\",\n            \"血蛊巢心\",\n            \"月泉淮\",\n            \"暗梦仙游剑\",\n            \"曲云\",\n            \"乌蒙贵\",\n            \"黑条巨蛾\",\n            \"蓄积的内力\",\n        ],\n        560: [\n            \"巨型尖吻凤\",\n            \"衣旎\",\n            \"桑乔\",\n            \"悉达罗摩\",\n            \"灵虫\",\n            \"赐恩血瘤\",\n            \"尸腐秽血草\",\n            \"摄魂鬼虫\",\n            \"秽血勇虫\",\n            \"血蛊巢心\",\n            \"月泉淮\",\n            \"暗梦仙游剑\",\n            \"曲云\",\n            \"乌蒙贵\",\n            \"黑条巨蛾\",\n            \"触手\",\n            \"蓄积的内力\",\n            \"食腐毒飞虫\",\n        ],\n        561: [\n            \"巨型尖吻凤\",\n            \"衣旎\",\n            \"桑乔\",\n            \"悉达罗摩\",\n            \"灵虫\",\n            \"赐恩血瘤\",\n            \"尸腐秽血草\",\n            \"摄魂鬼虫\",\n            \"秽血勇虫\",\n            \"血蛊巢心\",\n            \"月泉淮\",\n            \"暗梦仙游剑\",\n            \"曲云\",\n            \"乌蒙贵\",\n            \"黑条巨蛾\",\n            \"触手\",\n            \"蓄积的内力\",\n            \"亡命卫虫\",\n            \"食腐毒飞虫\",\n        ],\n        563: [\"李君竹\", \"剑宗高级弟子\", \"解秀朝\", \"武云阙\"],\n        564: [\"李君竹\", \"剑宗高级弟子\", \"解秀朝\", \"武云阙\"],\n        573: [\"勒齐那\", \"阿阁诺\", \"周通忌\", \"狼牙精锐\", \"李秦授\", \"周贽\", \"常宿\"],\n        574: [\"勒齐那\", \"阿阁诺\", \"周通忌\", \"狼牙精锐\", \"李秦授\", \"周贽\", \"常宿\"],\n        575: [\"勒齐那\", \"阿阁诺\", \"周通忌\", \"狼牙精锐\", \"李秦授\", \"周贽\", \"狼牙持旗手\", \"常宿\"],\n        586: [\n            \"张景超\",\n            \"张法雷\",\n            \"刘展\",\n            \"弓手指挥\",\n            \"枪卫首领\",\n            \"苏凤楼\",\n            \"韩敬青\",\n            \"藤原佑野\",\n            \"四方结界\",\n            \"李重茂\",\n            \"永王叛军长枪兵\",\n            \"一刀流精锐武士\",\n        ],\n        587: [\n            \"张景超\",\n            \"张法雷\",\n            \"刘展\",\n            \"弓手指挥\",\n            \"枪卫首领\",\n            \"斧卫首领\",\n            \"苏凤楼\",\n            \"凌雪阁杀手\",\n            \"剧毒孢子\",\n            \"韩敬青\",\n            \"藤原佑野\",\n            \"四方结界\",\n            \"李重茂\",\n            \"永王叛军长枪兵\",\n            \"一刀流精锐武士\",\n            \"永王叛军剑卫\",\n        ],\n        588: [\n            \"张景超\",\n            \"张法雷\",\n            \"刘展\",\n            \"弓手指挥\",\n            \"弩手指挥\",\n            \"枪卫首领\",\n            \"斧卫首领\",\n            \"苏凤楼\",\n            \"凌雪阁杀手\",\n            \"剧毒孢子\",\n            \"另一个苏凤楼\",\n            \"韩敬青\",\n            \"藤原佑野\",\n            \"四方结界\",\n            \"李重茂\",\n            \"永王叛军长枪兵\",\n            \"一刀流精锐武士\",\n            \"永王叛军剑卫\",\n            \"镜影·李重茂\",\n        ],\n        596: [\"孟承\", \"吕一平\", \"时风\"],\n        597: [\"孟承\", \"吕一平\", \"时风\"],\n        598: [\"关八天\", \"苍森\", \"巨型何罗\"],\n        599: [\"关八天\", \"苍森\", \"巨型何罗\"],\n        606: [\"吴添明\", \"阵眼\", \"阵灵\", \"阵心\", \"藤原佑野\", \"藤原广嗣\", \"谢云流\"],\n        607: [\"吴添明\", \"阵眼\", \"阵灵\", \"阵心\", \"藤原佑野\", \"藤原广嗣\", \"谢云流\"],\n        622: [\"笑妆娘\", \"白兆霆\", \"邙赫达\", \"桑来照\", \"傅七殊\"],\n        623: [\"笑妆娘\", \"白兆霆\", \"邙赫达\", \"桑来照\", \"傅七殊\"],\n        636: [\"时风\", \"乐临川\", \"牛波\", \"黑熊\", \"鹰\", \"和正\", \"武云阙\", \"解兰舟\", \"翁幼之\"],\n        637: [\"时风\", \"乐临川\", \"牛波\", \"黑熊\", \"鹰\", \"恶虎\", \"和正\", \"武云阙\", \"解兰舟\", \"翁幼之\"],\n        638: [\"时风\", \"乐临川\", \"牛波\", \"黑熊\", \"鹰\", \"恶虎\", \"巨象\", \"和正\", \"武云阙\", \"解兰舟\", \"翁幼之\", \"囚魂心牢\"],\n        639: [\"骨面天君\", \"曹毅\", \"辛万时\", \"弓箭兵\", \"长枪兵\", \"刀兵\"],\n        640: [\"骨面天君\", \"曹毅\", \"辛万时\", \"弓箭兵\", \"长枪兵\", \"刀兵\"],\n        648: [\"魏华\", \"钟不归\", \"寒山剑\", \"岑伤\", \"鬼筹\", \"麒麟\", \"暗梦仙体\", \"暗梦仙体的幻影\"],\n        649: [\n            \"魏华\",\n            \"钟不归\",\n            \"寒山剑\",\n            \"岑伤\",\n            \"幻念剑影\",\n            \"鬼筹\",\n            \"麒麟\",\n            \"暗梦仙体\",\n            \"暗梦仙体的幻影\",\n            \"金翅鸟化身\",\n            \"月泉淮\",\n        ],\n        650: [\n            \"魏华\",\n            \"钟不归\",\n            \"寒山剑\",\n            \"岑伤\",\n            \"幻念剑影\",\n            \"鬼筹\",\n            \"麒麟\",\n            \"灵护麒麟\",\n            \"魔剑幻影\",\n            \"暗梦仙体\",\n            \"暗梦仙体的幻影\",\n            \"金翅鸟化身\",\n            \"月泉淮\",\n            \"掩日\",\n        ],\n        658: [\"辛仕徽\", \"宣骄\", \"魏鑫\"],\n        659: [\"辛仕徽\", \"宣骄\", \"魏鑫\"],\n        668: [\"葛木寒\", \"戮夜游·刀盾兵\", \"雨轻红\", \"喜雅\", \"鹰眼客\", \"赤幽明\", \"赤厄明\"],\n        669: [\"葛木寒\", \"戮夜游·刀盾兵\", \"戮夜游·锁链手\", \"雨轻红\", \"喜雅\", \"鹰眼客\", \"赤幽明\", \"赤厄明\", \"游荡黑影\"],\n        670: [\n            \"葛木寒\",\n            \"戮夜游·刀盾兵\",\n            \"戮夜游·锁链手\",\n            \"戮夜游·弓箭手\",\n            \"雨轻红\",\n            \"喜雅\",\n            \"鹰眼客\",\n            \"赤幽明\",\n            \"赤厄明\",\n            \"游荡黑影\",\n            \"灵蝶\",\n        ],\n        686: [\"骆耀阳\", \"韦柔丝\", \"宋泉\", \"冰晶花\", \"伍靖远\", \"苏什\", \"芭德\"],\n        687: [\"骆耀阳\", \"韦柔丝\", \"宋泉\", \"冰晶花\", \"伍靖远\", \"苏什\", \"芭德\"],\n        688: [\n            \"骆耀阳\",\n            \"韦柔丝\",\n            \"逆心转脉\",\n            \"地裂\",\n            \"宋泉\",\n            \"冰晶花\",\n            \"水分身\",\n            \"伍靖远\",\n            \"苏什\",\n            \"芭德\",\n            \"图腾\",\n            \"阵剑\",\n        ],\n    },\n\n    noChannel_skillId: {\n        669: [37498, 37075, 37002],\n        670: [37498, 37075, 37002],\n        686: [38226, 38113, 38114],\n        687: [38226, 38221, 38113, 38114],\n        688: [38226, 38221, 38113, 38114],\n    },\n\n    templateTable: {\n        669: {\n            127357: \"戮夜游·锁链手\",\n            127369: \"戮夜游·刀盾兵\",\n            127348: \"落冰\",\n            126934: \"黑镜\",\n            127310: \"漆黑泥沼\",\n            123781: \"游荡黑影\",\n        },\n        670: {\n            127460: \"戮夜游·锁链手\",\n            127464: \"戮夜游·刀盾兵\",\n            127442: \"落冰\",\n            126934: \"黑镜\",\n            127434: \"漆黑泥沼\",\n            127476: \"游荡黑影\",\n        },\n        686: {\n            128368: \"冰晶球\",\n            128440: \"冰晶花\",\n            128581: \"落石\",\n        },\n        687: {\n            129417: \"冰晶花\",\n            129404: \"冰晶球\",\n            129497: \"落石\",\n            129510: \"黄砂气旋\",\n        },\n        688: {\n            129535: \"冰晶花\",\n            129523: \"冰晶球\",\n            129600: \"落石\",\n            129544: \"水分身\",\n            129542: \"地裂\",\n            129598: \"逆心转脉\",\n            129540: \"阵剑\",\n        },\n    },\n    // 查锅更常量\n    // 注意10人请不要启用这个\n    blame_enable_mapId: [669, 670, 687, 688],\n    buffTable: {\n        // 25人普通冷龙峰\n        669: {\n            17200: 8, // 精神匮乏，记录减疗超过40%的玩家\n            17201: 8, // 耐力损耗，记录易伤超过40%的玩家\n            27878: 3, // 风起潮涌\n            28295: 3, // 狂躁的诺布心诀内力\n            27922: 3, // 烈毒\n            27940: 1, // 死寂\n            27938: 4, // 悚然\n            27939: 1, // 光耀炫目\n            28267: 1, // 影秽\n        },\n        // 25人英雄冷龙峰\n        670: {\n            17200: 8, // 精神匮乏，记录减疗超过40%的玩家\n            17201: 8, // 耐力损耗，记录易伤超过40%的玩家\n            27878: 3, // 风起潮涌\n            28295: 1, // 狂躁的诺布心诀内力\n            27922: 3, // 烈毒\n            27940: 1, // 死寂\n            27937: 1, // 阴火弹\n            27938: 4, // 悚然\n            27939: 1, // 光耀炫目\n            28267: 1, // 影秽\n        },\n        //25人普通一之窟\n        687: {\n            17200: 8, // 精神匮乏，记录减疗超过40%的玩家\n            17201: 8, // 耐力损耗，记录易伤超过40%的玩家\n            29056: 1, // 经脉不畅\n            28972: 1, // 失血(30易伤)\n            28862: 1, // 冻结(死亡前buff)\n            28982: 1, // 沙尘入肺\n            28985: 1, // 沙暴（玩家位置不对）\n            29004: 1, // 气旋束缚（进入黄沙气旋）\n        },\n        //25人英雄一之窟\n        688: {\n            17200: 8, // 精神匮乏，记录减疗超过40%的玩家\n            17201: 8, // 耐力损耗，记录易伤超过40%的玩家\n            29056: 1, // 经脉不畅\n            28972: 1, // 失血(30易伤)\n            28862: 1, // 冻结(死亡前buff)\n            28982: 1, // 沙尘入肺\n            28985: 1, // 沙暴（玩家位置不对）\n            29004: 1, // 气旋束缚（进入黄沙气旋）\n            29027: 1, // 重伤（老一)\n        },\n    },\n    buff2name: {\n        17200: \"精神匮乏\",\n        17201: \"耐力损耗\",\n        27278: \"风起潮涌\",\n        28295: \"狂暴的诺布心决内力\",\n        27922: \"烈毒\",\n        27940: \"死寂\",\n        27938: \"悚然\",\n        27939: \"光耀炫目\",\n        27937: \"阴火弹灼烧\",\n        28267: \"影秽\",\n        29056: \"经脉不畅\",\n        28972: \"失血\",\n        28862: \"冻结\",\n        28982: \"沙尘入肺\",\n        28985: \"沙暴\",\n        29004: \"气旋束缚\",\n        29027: \"重伤\",\n    },\n};\n","import { useStore } from \"@/pages/jcl/store\";\nconst store = useStore();\n\n// 每次调用的时候检查队列中是否有还在等待的任务，\nconst workerTaskQueue = [];\nlet busy = false;\nasync function processQueue() {\n    if (workerTaskQueue.length === 0 || busy) return;\n    const worker = store.worker;\n    if (!worker) return;\n    busy = true;\n    const { action, data, resolve } = workerTaskQueue.shift();\n    const result = await new Promise((resolve) => {\n        worker.onmessage = ({ data }) => resolve(data);\n        worker.onerror = (error) => resolve({ error });\n        worker.postMessage({ action, data });\n    });\n    resolve(result);\n    busy = false;\n    processQueue();\n}\n\nexport default async function getWorkerResponse(action, data) {\n    return new Promise((resolve) => {\n        workerTaskQueue.push({ action, data, resolve });\n        processQueue();\n    });\n}\n\nexport function workerBusy() {\n    return busy;\n}\n","import { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, vShow as _vShow, createElementVNode as _createElementVNode, withDirectives as _withDirectives, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-pve-tabs\"\n};\nconst _hoisted_2 = [\"onClick\"];\nconst _hoisted_3 = [\"src\"];\nconst _hoisted_4 = [\"src\"];\nimport { raid_analysis_constant } from \"@/assets/data/jcl/raid_constant\";\nimport { workerBusy } from \"@/utils/jcl/worker\";\nimport { ElMessage } from \"element-plus\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store\";\nexport default {\n  __name: 'header_tabs',\n  setup(__props) {\n    const {\n      mainTab\n    } = toRefs(usePve());\n    const store = useStore();\n    const tabList = [{\n      name: \"overview\",\n      icon: require(\"@/assets/img/jcl/pve/header_overview_default.svg\"),\n      activedIcon: require(\"@/assets/img/jcl/pve/header_overview_actived.svg\"),\n      title: \"全局总览\"\n    }, {\n      name: \"detail\",\n      icon: require(\"@/assets/img/jcl/pve/header_detail_default.svg\"),\n      activedIcon: require(\"@/assets/img/jcl/pve/header_detail_actived.svg\"),\n      title: \"单位详情\"\n    }, {\n      name: \"compare\",\n      icon: require(\"@/assets/img/jcl/pve/header_compare_default.svg\"),\n      activedIcon: require(\"@/assets/img/jcl/pve/header_compare_actived.svg\"),\n      title: \"单位对比\"\n    }, {\n      name: \"blame\",\n      icon: require(\"@/assets/img/jcl/pve/header_compare_default.svg\"),\n      activedIcon: require(\"@/assets/img/jcl/pve/header_compare_actived.svg\"),\n      title: \"团员分析\"\n    }, {\n      name: \"time_line\",\n      icon: require(\"@/assets/img/jcl/pve/header_timer_default.svg\"),\n      activedIcon: require(\"@/assets/img/jcl/pve/header_timer_actived.svg\"),\n      title: \"首领技能轴\"\n    }, {\n      name: \"buff_coverage_main\",\n      icon: require(\"@/assets/img/jcl/pve/header_buff_default.svg\"),\n      activedIcon: require(\"@/assets/img/jcl/pve/header_buff_actived.svg\"),\n      title: \"团队增益\"\n    }, {\n      name: \"video\",\n      icon: require(\"@/assets/img/jcl/pve/header_video_default.svg\"),\n      activedIcon: require(\"@/assets/img/jcl/pve/header_video_actived.svg\"),\n      title: \"视频回放\"\n    }, {\n      name: \"logs\",\n      icon: require(\"@/assets/img/jcl/pve/header_logs_default.svg\"),\n      activedIcon: require(\"@/assets/img/jcl/pve/header_logs_actived.svg\"),\n      title: \"全部记录\"\n    }, {\n      name: \"upload\",\n      icon: require(\"@/assets/img/jcl/common/upload.svg\"),\n      title: \"云端保存\"\n    }];\n    const showTab = computed(() => {\n      return tabList.filter(tab => {\n        //if (tab.name === \"blame\") return false;\n        if (tab.name === \"upload\" && store.info.title) return false;\n        if (tab.name === \"video\" && !store.info.video_identifier) return false;\n        if (tab.name == \"blame\" && (!raid_analysis_constant.blame_enable_mapId.includes(store.result.map) || store.result.client == \"origin\")) return false;\n        if (tab.name == \"time_line\" && (!raid_analysis_constant.timeline_enable_mapId.includes(store.result.map) || store.result.client == \"origin\")) {\n          return false;\n        }\n        return true;\n      });\n    });\n    const switchTab = tab => {\n      // 检查是否有worker在处理数据\n      if (workerBusy()) return ElMessage.error(\"当前页面正在处理数据，请稍后再试\");\n      if (mainTab.value == tab) return;\n      mainTab.value = tab;\n    };\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(showTab), (tab, index) => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          class: _normalizeClass([\"u-tab\", {\n            'is-active': _unref(mainTab) === tab.name,\n            [tab.name]: true\n          }]),\n          key: index,\n          onClick: $event => switchTab(tab.name, tab)\n        }, [_withDirectives(_createElementVNode(\"img\", {\n          class: \"u-tab-icon\",\n          src: tab.activedIcon,\n          draggable: false\n        }, null, 8, _hoisted_3), [[_vShow, _unref(mainTab) === tab.name]]), _withDirectives(_createElementVNode(\"img\", {\n          class: \"u-tab-icon\",\n          src: tab.icon,\n          draggable: false\n        }, null, 8, _hoisted_4), [[_vShow, _unref(mainTab) !== tab.name]])], 10, _hoisted_2);\n      }), 128))]);\n    };\n  }\n};","import script from \"./header_tabs.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./header_tabs.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./header_tabs.vue?vue&type=style&index=0&id=671cbaec&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-671cbaec\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-card-list\">\n        <div class=\"m-card-item\">\n            <p class=\"u-label\">作战目标</p>\n            <p class=\"u-stress\">{{ displayOverview.target }}</p>\n            <p class=\"u-small-value\">{{ displayOverview.totalDuration }}</p>\n        </div>\n        <div class=\"m-card-item\">\n            <p class=\"u-label\">总伤害</p>\n            <p class=\"u-value\">\n                {{ displayOverview.totalDamage?.value }}\n                <span class=\"u-suffix\">{{ displayOverview.totalDamage?.unit }}</span>\n            </p>\n            <p class=\"u-value\">\n                {{ displayOverview.teamDps?.value }}\n                <span class=\"u-suffix\">{{ displayOverview.teamDps?.unit }}/s</span>\n            </p>\n        </div>\n        <div class=\"m-card-item\">\n            <p class=\"u-label\">总治疗</p>\n            <p class=\"u-value\">\n                {{ displayOverview.totalTreat?.value }}\n                <span class=\"u-suffix\">{{ displayOverview.totalTreat?.unit }}</span>\n            </p>\n            <p class=\"u-value\">\n                {{ displayOverview.teamHps?.value }} <span class=\"u-suffix\">{{ displayOverview.teamHps?.unit }}/s</span>\n            </p>\n        </div>\n        <div class=\"m-card-item\">\n            <p class=\"u-label\">总承伤</p>\n            <p class=\"u-value\">\n                {{ displayOverview.totalBeDamaged?.value }}\n                <span class=\"u-suffix\">{{ displayOverview.totalBeDamaged?.unit }}</span>\n            </p>\n            <p class=\"u-value\">\n                {{ displayOverview.teamDeDps?.value }}\n                <span class=\"u-suffix\">{{ displayOverview.teamDeDps?.unit }}/s</span>\n            </p>\n        </div>\n        <div class=\"m-card-item\">\n            <p class=\"u-label\">总承疗</p>\n            <p class=\"u-value\">\n                {{ displayOverview.totalBeTreat?.value }}\n                <span class=\"u-suffix\">{{ displayOverview.totalBeTreat?.unit }}</span>\n            </p>\n            <p class=\"u-value\">\n                {{ displayOverview.teamBeHps?.value }}\n                <span class=\"u-suffix\">{{ displayOverview.teamBeHps?.unit }}/s</span>\n            </p>\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { computed } from \"vue\";\nimport { displayDuration, displayBigNumberAndUnit } from \"@/utils/jcl/commonNoStore\";\nimport { useStore } from \"@/pages/jcl/store\";\n\nconst store = useStore();\nconst displayOverview = computed(() => {\n    const { stats, entities, end } = store.result;\n    if (!entities) return [];\n    // 求目标NPC，应该是承伤最高的那个\n    let target = \"-\";\n    let maxBeDamaged = 0;\n    for (let entity in stats.beDamaged) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") continue;\n        const beDamagedValue = stats.beDamaged[entity].value;\n        if (beDamagedValue > maxBeDamaged) {\n            maxBeDamaged = beDamagedValue;\n            target = entities[entity].name;\n        }\n    }\n    // 求全团伤害\n    let totalDamage = 0;\n    let totalTreat = 0;\n    let totalBeDamaged = 0;\n    let totalBeTreat = 0;\n    for (let entity in stats.damage) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") {\n            totalDamage += stats.damage[entity].value;\n        }\n    }\n    for (let entity in stats.treat) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") {\n            totalTreat += stats.treat[entity].value;\n        }\n    }\n    for (let entity in stats.beDamaged) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") {\n            totalBeDamaged += stats.beDamaged[entity].value;\n        }\n    }\n    for (let entity in stats.beTreated) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") {\n            totalBeTreat += stats.beTreated[entity]?.value ?? 0;\n        }\n    }\n\n    return {\n        // 作战目标\n        target,\n        // 总伤害\n        totalDamage: displayBigNumberAndUnit(totalDamage),\n        // 团队秒伤\n        teamDps: displayBigNumberAndUnit(totalDamage / end.sec),\n        // 总治疗\n        totalTreat: displayBigNumberAndUnit(totalTreat),\n        // 团队秒疗\n        teamHps: displayBigNumberAndUnit(totalTreat / end.sec),\n        // 团队承伤\n        totalBeDamaged: displayBigNumberAndUnit(totalBeDamaged),\n        // 团队秒承伤\n        teamDeDps: displayBigNumberAndUnit(totalBeDamaged / end.sec),\n        // 团队承疗\n        totalBeTreat: displayBigNumberAndUnit(totalBeTreat),\n        // 团队每秒承疗\n        teamBeHps: displayBigNumberAndUnit(totalBeTreat / end.sec),\n        // 总时长\n        totalDuration: displayDuration(end.sec),\n    };\n});\n</script>\n\n<style lang=\"less\" scoped>\n.m-card-list {\n    .flex;\n    gap: 30px;\n    width: 100%;\n    .m-card-item {\n        flex: 1;\n        padding: 20px;\n        border-radius: 16px;\n        background-color: #282828;\n\n        .u-label {\n            .fz(14px, 14px);\n            margin-bottom: 10px;\n        }\n        .u-stress {\n            .bold;\n            .fz(32px,42px);\n            margin-bottom: 6px;\n        }\n        .u-value {\n            .fz(24px,30px);\n            .bold;\n        }\n        // .u-suffix {\n        //     font-size: 14px;\n        // }\n        .u-small-value {\n            .bold;\n            font-size: 12px;\n        }\n    }\n}\n</style>\n","import script from \"./overview_info.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./overview_info.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./overview_info.vue?vue&type=style&index=0&id=62a3f88a&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-62a3f88a\"]])\n\nexport default __exports__","import * as Vue from 'vue'\n\nvar isVue2 = false\nvar isVue3 = true\nvar Vue2 = undefined\n\nfunction install() {}\n\nexport function set(target, key, val) {\n  if (Array.isArray(target)) {\n    target.length = Math.max(target.length, key)\n    target.splice(key, 1, val)\n    return val\n  }\n  target[key] = val\n  return val\n}\n\nexport function del(target, key) {\n  if (Array.isArray(target)) {\n    target.splice(key, 1)\n    return\n  }\n  delete target[key]\n}\n\nexport * from 'vue'\nexport {\n  Vue,\n  Vue2,\n  isVue2,\n  isVue3,\n  install,\n}\n","import { watch, isRef, unref, inject, computed, watchEffect, Vue2, defineComponent, shallowRef, toRefs, getCurrentInstance, onMounted, onBeforeUnmount, h, nextTick } from 'vue-demi';\nimport { throttle, init } from 'echarts/core';\n\nconst METHOD_NAMES = [\n  \"getWidth\",\n  \"getHeight\",\n  \"getDom\",\n  \"getOption\",\n  \"resize\",\n  \"dispatchAction\",\n  \"convertToPixel\",\n  \"convertFromPixel\",\n  \"containPixel\",\n  \"getDataURL\",\n  \"getConnectedDataURL\",\n  \"appendData\",\n  \"clear\",\n  \"isDisposed\",\n  \"dispose\"\n];\nfunction usePublicAPI(chart) {\n  function makePublicMethod(name) {\n    return (...args) => {\n      if (!chart.value) {\n        throw new Error(\"ECharts is not initialized yet.\");\n      }\n      return chart.value[name].apply(chart.value, args);\n    };\n  }\n  function makePublicMethods() {\n    const methods = /* @__PURE__ */ Object.create(null);\n    METHOD_NAMES.forEach((name) => {\n      methods[name] = makePublicMethod(name);\n    });\n    return methods;\n  }\n  return makePublicMethods();\n}\n\nfunction useAutoresize(chart, autoresize, root) {\n  watch(\n    [root, chart, autoresize],\n    ([root2, chart2, autoresize2], _, onCleanup) => {\n      let ro = null;\n      if (root2 && chart2 && autoresize2) {\n        const { offsetWidth, offsetHeight } = root2;\n        const autoresizeOptions = autoresize2 === true ? {} : autoresize2;\n        const { throttle: wait = 100, onResize } = autoresizeOptions;\n        let initialResizeTriggered = false;\n        const callback = () => {\n          chart2.resize();\n          onResize?.();\n        };\n        const resizeCallback = wait ? throttle(callback, wait) : callback;\n        ro = new ResizeObserver(() => {\n          if (!initialResizeTriggered) {\n            initialResizeTriggered = true;\n            if (root2.offsetWidth === offsetWidth && root2.offsetHeight === offsetHeight) {\n              return;\n            }\n          }\n          resizeCallback();\n        });\n        ro.observe(root2);\n      }\n      onCleanup(() => {\n        if (ro) {\n          ro.disconnect();\n          ro = null;\n        }\n      });\n    }\n  );\n}\nconst autoresizeProps = {\n  autoresize: [Boolean, Object]\n};\n\nconst onRE = /^on[^a-z]/;\nconst isOn = (key) => onRE.test(key);\nfunction omitOn(attrs) {\n  const result = {};\n  for (const key in attrs) {\n    if (!isOn(key)) {\n      result[key] = attrs[key];\n    }\n  }\n  return result;\n}\nfunction unwrapInjected(injection, defaultValue) {\n  const value = isRef(injection) ? unref(injection) : injection;\n  if (value && typeof value === \"object\" && \"value\" in value) {\n    return value.value || defaultValue;\n  }\n  return value || defaultValue;\n}\n\nconst LOADING_OPTIONS_KEY = \"ecLoadingOptions\";\nfunction useLoading(chart, loading, loadingOptions) {\n  const defaultLoadingOptions = inject(LOADING_OPTIONS_KEY, {});\n  const realLoadingOptions = computed(() => ({\n    ...unwrapInjected(defaultLoadingOptions, {}),\n    ...loadingOptions?.value\n  }));\n  watchEffect(() => {\n    const instance = chart.value;\n    if (!instance) {\n      return;\n    }\n    if (loading.value) {\n      instance.showLoading(realLoadingOptions.value);\n    } else {\n      instance.hideLoading();\n    }\n  });\n}\nconst loadingProps = {\n  loading: Boolean,\n  loadingOptions: Object\n};\n\nlet registered = null;\nconst TAG_NAME = \"x-vue-echarts\";\nfunction register() {\n  if (registered != null) {\n    return registered;\n  }\n  if (typeof HTMLElement === \"undefined\" || typeof customElements === \"undefined\") {\n    return registered = false;\n  }\n  try {\n    const reg = new Function(\n      \"tag\",\n      // Use esbuild repl to keep build process simple\n      // https://esbuild.github.io/try/#dAAwLjIzLjAALS1taW5pZnkAY2xhc3MgRUNoYXJ0c0VsZW1lbnQgZXh0ZW5kcyBIVE1MRWxlbWVudCB7CiAgX19kaXNwb3NlID0gbnVsbDsKCiAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7CiAgICBpZiAodGhpcy5fX2Rpc3Bvc2UpIHsKICAgICAgdGhpcy5fX2Rpc3Bvc2UoKTsKICAgICAgdGhpcy5fX2Rpc3Bvc2UgPSBudWxsOwogICAgfQogIH0KfQoKaWYgKGN1c3RvbUVsZW1lbnRzLmdldCh0YWcpID09IG51bGwpIHsKICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnLCBFQ2hhcnRzRWxlbWVudCk7Cn0K\n      \"class EChartsElement extends HTMLElement{__dispose=null;disconnectedCallback(){this.__dispose&&(this.__dispose(),this.__dispose=null)}}customElements.get(tag)==null&&customElements.define(tag,EChartsElement);\"\n    );\n    reg(TAG_NAME);\n  } catch (e) {\n    return registered = false;\n  }\n  return registered = true;\n}\n\ndocument.head.appendChild(document.createElement('style')).textContent=\"x-vue-echarts{display:block;width:100%;height:100%;min-width:0}\\n\";\n\nconst wcRegistered = register();\nif (Vue2) {\n  Vue2.config.ignoredElements.push(TAG_NAME);\n}\nconst THEME_KEY = \"ecTheme\";\nconst INIT_OPTIONS_KEY = \"ecInitOptions\";\nconst UPDATE_OPTIONS_KEY = \"ecUpdateOptions\";\nconst NATIVE_EVENT_RE = /(^&?~?!?)native:/;\nvar ECharts = defineComponent({\n  name: \"echarts\",\n  props: {\n    option: Object,\n    theme: {\n      type: [Object, String]\n    },\n    initOptions: Object,\n    updateOptions: Object,\n    group: String,\n    manualUpdate: Boolean,\n    ...autoresizeProps,\n    ...loadingProps\n  },\n  emits: {},\n  inheritAttrs: false,\n  setup(props, { attrs }) {\n    const root = shallowRef();\n    const chart = shallowRef();\n    const manualOption = shallowRef();\n    const defaultTheme = inject(THEME_KEY, null);\n    const defaultInitOptions = inject(INIT_OPTIONS_KEY, null);\n    const defaultUpdateOptions = inject(UPDATE_OPTIONS_KEY, null);\n    const { autoresize, manualUpdate, loading, loadingOptions } = toRefs(props);\n    const realOption = computed(\n      () => manualOption.value || props.option || null\n    );\n    const realTheme = computed(\n      () => props.theme || unwrapInjected(defaultTheme, {})\n    );\n    const realInitOptions = computed(\n      () => props.initOptions || unwrapInjected(defaultInitOptions, {})\n    );\n    const realUpdateOptions = computed(\n      () => props.updateOptions || unwrapInjected(defaultUpdateOptions, {})\n    );\n    const nonEventAttrs = computed(() => omitOn(attrs));\n    const nativeListeners = {};\n    const listeners = getCurrentInstance().proxy.$listeners;\n    const realListeners = {};\n    if (!listeners) {\n      Object.keys(attrs).filter((key) => isOn(key)).forEach((key) => {\n        let event = key.charAt(2).toLowerCase() + key.slice(3);\n        if (event.indexOf(\"native:\") === 0) {\n          const nativeKey = `on${event.charAt(7).toUpperCase()}${event.slice(\n            8\n          )}`;\n          nativeListeners[nativeKey] = attrs[key];\n          return;\n        }\n        if (event.substring(event.length - 4) === \"Once\") {\n          event = `~${event.substring(0, event.length - 4)}`;\n        }\n        realListeners[event] = attrs[key];\n      });\n    } else {\n      Object.keys(listeners).forEach((key) => {\n        if (NATIVE_EVENT_RE.test(key)) {\n          nativeListeners[key.replace(NATIVE_EVENT_RE, \"$1\")] = listeners[key];\n        } else {\n          realListeners[key] = listeners[key];\n        }\n      });\n    }\n    function init$1(option) {\n      if (!root.value) {\n        return;\n      }\n      const instance = chart.value = init(\n        root.value,\n        realTheme.value,\n        realInitOptions.value\n      );\n      if (props.group) {\n        instance.group = props.group;\n      }\n      Object.keys(realListeners).forEach((key) => {\n        let handler = realListeners[key];\n        if (!handler) {\n          return;\n        }\n        let event = key.toLowerCase();\n        if (event.charAt(0) === \"~\") {\n          event = event.substring(1);\n          handler.__once__ = true;\n        }\n        let target = instance;\n        if (event.indexOf(\"zr:\") === 0) {\n          target = instance.getZr();\n          event = event.substring(3);\n        }\n        if (handler.__once__) {\n          delete handler.__once__;\n          const raw = handler;\n          handler = (...args) => {\n            raw(...args);\n            target.off(event, handler);\n          };\n        }\n        target.on(event, handler);\n      });\n      function resize() {\n        if (instance && !instance.isDisposed()) {\n          instance.resize();\n        }\n      }\n      function commit() {\n        const opt = option || realOption.value;\n        if (opt) {\n          instance.setOption(opt, realUpdateOptions.value);\n        }\n      }\n      if (autoresize.value) {\n        nextTick(() => {\n          resize();\n          commit();\n        });\n      } else {\n        commit();\n      }\n    }\n    function setOption(option, updateOptions) {\n      if (props.manualUpdate) {\n        manualOption.value = option;\n      }\n      if (!chart.value) {\n        init$1(option);\n      } else {\n        chart.value.setOption(option, updateOptions || {});\n      }\n    }\n    function cleanup() {\n      if (chart.value) {\n        chart.value.dispose();\n        chart.value = void 0;\n      }\n    }\n    let unwatchOption = null;\n    watch(\n      manualUpdate,\n      (manualUpdate2) => {\n        if (typeof unwatchOption === \"function\") {\n          unwatchOption();\n          unwatchOption = null;\n        }\n        if (!manualUpdate2) {\n          unwatchOption = watch(\n            () => props.option,\n            (option, oldOption) => {\n              if (!option) {\n                return;\n              }\n              if (!chart.value) {\n                init$1();\n              } else {\n                chart.value.setOption(option, {\n                  // mutating `option` will lead to `notMerge: false` and\n                  // replacing it with new reference will lead to `notMerge: true`\n                  notMerge: option !== oldOption,\n                  ...realUpdateOptions.value\n                });\n              }\n            },\n            { deep: true }\n          );\n        }\n      },\n      {\n        immediate: true\n      }\n    );\n    watch(\n      [realTheme, realInitOptions],\n      () => {\n        cleanup();\n        init$1();\n      },\n      {\n        deep: true\n      }\n    );\n    watchEffect(() => {\n      if (props.group && chart.value) {\n        chart.value.group = props.group;\n      }\n    });\n    const publicApi = usePublicAPI(chart);\n    useLoading(chart, loading, loadingOptions);\n    useAutoresize(chart, autoresize, root);\n    onMounted(() => {\n      init$1();\n    });\n    onBeforeUnmount(() => {\n      if (wcRegistered && root.value) {\n        root.value.__dispose = cleanup;\n      } else {\n        cleanup();\n      }\n    });\n    return {\n      chart,\n      root,\n      setOption,\n      nonEventAttrs,\n      nativeListeners,\n      ...publicApi\n    };\n  },\n  render() {\n    const attrs = Vue2 ? { attrs: this.nonEventAttrs, on: this.nativeListeners } : { ...this.nonEventAttrs, ...this.nativeListeners };\n    attrs.ref = \"root\";\n    attrs.class = attrs.class ? [\"echarts\"].concat(attrs.class) : \"echarts\";\n    return h(TAG_NAME, attrs);\n  }\n});\n\nexport { INIT_OPTIONS_KEY, LOADING_OPTIONS_KEY, THEME_KEY, UPDATE_OPTIONS_KEY, ECharts as default };\n//# sourceMappingURL=index.js.map\n","/*\n * @Author: X3ZvaWQ x3zvawq@gmail.com\n * @Date: 2023-03-22 08:47:25\n * @LastEditors: X3ZvaWQ x3zvawq@gmail.com\n * @LastEditTime: 2023-03-22 15:32:20\n * @FilePath: /jcl/src/utils/common.js\n * @Description:\n */\n\nimport { showMountIcon, iconLink } from \"@jx3box/jx3box-common/js/utils\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport {\n    getResource as _getResource,\n    getResourceIcon as _getResourceIcon,\n    getResourceName as _getResourceName,\n    getEntityColor as _getEntityColor,\n    getEntity as _getEntity,\n    getEntityName as _getEntityName,\n} from \"./commonNoStore\";\n\nconst store = useStore();\n\nexport function getResource(_key) {\n    return _getResource(_key, store.result);\n}\n\nexport function getResourceIcon(key, { url = true } = {}) {\n    return _getResourceIcon(key, store.result, { url });\n}\n\nexport function getResourceName(key, { showID = false } = {}) {\n    return _getResourceName(key, store.result, { showID });\n}\n\nexport function getMountIcon(id) {\n    const { entities } = store.result;\n    const entity = entities[id];\n    if (!entity) return iconLink(0);\n    const mount = entity.mount;\n    if (mount) return showMountIcon(mount);\n    return require(\"@/assets/img/jcl/pve/target_57.png\");\n}\n\nexport function getEntityColor(entityID) {\n    return _getEntityColor(entityID, store.result);\n}\n\nexport function getEntity(id) {\n    return _getEntity(id, store.result);\n}\n\nexport function getEntityName(id, { showID = false, showOrder = false, showRegion = false } = {}) {\n    return _getEntityName(id, store.result, { showID, showOrder, showRegion });\n}\n","<template>\n    <div class=\"m-overview-chart\">\n        <div class=\"w-card m-top-items\">\n            <div class=\"u-top-item\">\n                <p class=\"u-label\">重伤</p>\n                <p class=\"u-value\">{{ data.deathTotal }}</p>\n            </div>\n            <div class=\"u-top-item\">\n                <p class=\"u-label\">特殊BUFF</p>\n                <p class=\"u-value\">{{ data.buffTotal }}</p>\n            </div>\n            <div class=\"u-top-item\" v-for=\"buff in data.buffs\" :key=\"buff.name\">\n                <p class=\"u-label\">{{ buff.name }}</p>\n                <p class=\"u-value\">{{ buff.count }}</p>\n            </div>\n        </div>\n\n        <div class=\"m-chart-box\">\n            <div class=\"u-filter-items\">\n                <div\n                    v-for=\"(tab, index) in tabs\"\n                    :key=\"index\"\n                    :class=\"{ 'is-active': statType == tab.name }\"\n                    @click=\"switchType(tab.name)\"\n                    class=\"u-filter-item\"\n                >\n                    {{ tab.title }}\n                </div>\n            </div>\n            <v-chart\n                class=\"u-chart\"\n                ref=\"echart\"\n                theme=\"dark\"\n                :option=\"option\"\n                autoresize\n                @legendselectchanged=\"handleSelect\"\n                @datazoom=\"handleDatazoom\"\n            />\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport VChart from \"vue-echarts\";\nimport { computed, ref, toRefs, watchPostEffect } from \"vue\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nimport { debounce } from \"lodash-es\";\nimport { getResourceName } from \"@/utils/jcl/common\";\n\nconst store = useStore();\nconst {\n    result: { end: _end },\n} = useStore();\nconst { statType, timeRange, focusEntitieName } = toRefs(usePve());\n\n// tab切换相关逻辑\nconst tabs = [\n    {\n        name: \"damage\",\n        title: \"伤害\",\n    },\n    {\n        name: \"treat\",\n        title: \"治疗\",\n    },\n    {\n        name: \"beDamaged\",\n        title: \"承伤\",\n    },\n    {\n        name: \"beTreated\",\n        title: \"承疗\",\n    },\n];\n\nconst switchType = (tab) => {\n    if (tab === statType.value) return;\n    statType.value = tab;\n};\n\nconst data = computed(() => {\n    const { player_death, buff_blame } = store.result;\n    const buffObj = {};\n\n    for (const player_id in buff_blame) {\n        for (const buff_id in buff_blame[player_id]) {\n            if (buffObj[buff_id]) {\n                buffObj[buff_id].count += 1;\n            } else {\n                let name = getResourceName(`buff:${buff_id}`);\n                const sp = name.split(\"_\");\n                if (sp.length > 1) {\n                    name = sp[1];\n                }\n                buffObj[buff_id] = {\n                    name: name,\n                    count: 1,\n                };\n            }\n        }\n    }\n    // 取前三个 并且转为数组\n    const buffs = Object.values(buffObj)\n        .sort((a, b) => b.count - a.count)\n        .slice(0, 3);\n    return {\n        deathTotal: player_death ? Object.values(player_death).length : 0,\n        buffTotal: buff_blame ? Object.values(buff_blame).length : 0,\n        buffs,\n    };\n}, [store.result]);\n\n// 被选中的人的名字\nconst loading = ref(false);\nconst xData = ref([]);\nconst yData = ref([]);\n// legend的名字\nconst legendNames = computed(() => {\n    return yData.value?.map((x) => x.name) || [];\n}, [yData]);\n// 图的option\nconst option = computed(() => {\n    return {\n        tooltip: {\n            trigger: \"axis\",\n            order: \"valueDesc\",\n        },\n        legend: {\n            show: true,\n            icon: \"roundRect\",\n            type: \"scroll\",\n            orient: \"horizontal\",\n            top: 10,\n            data: legendNames.value,\n            selected: legendNames.value.reduce((obj, name) => {\n                if (focusEntitieName.value == null) {\n                    if (name === \"【全局】\") obj[name] = true;\n                    else obj[name] = false;\n                } else {\n                    if (focusEntitieName.value == name) obj[name] = true;\n                    else obj[name] = false;\n                }\n                return obj;\n            }, {}),\n        },\n        backgroundColor: \"#282828\",\n        xAxis: {\n            type: \"category\",\n            boundaryGap: [0.1, 0.1],\n            data: xData.value,\n            triggerEvent: true,\n        },\n        yAxis: {\n            type: \"value\",\n            boundaryGap: [0, 0.2],\n        },\n        dataZoom: [\n            {\n                type: \"slider\",\n                filterMode: \"filter\",\n                bottom: 15,\n                start: 0,\n                end: 10,\n            },\n        ],\n        series: yData.value,\n        grid: {\n            top: 55,\n            left: 75,\n            right: 0,\n        },\n    };\n}, [xData, yData, focusEntitieName]);\n\nconst handleSelect = ({ name, selected }) => {\n    for (const key in selected) {\n        if (key !== name) {\n            selected[key] = false;\n        }\n    }\n\n    if (name == \"【全局】\") {\n        focusEntitieName.value = null;\n    } else {\n        focusEntitieName.value = name;\n    }\n};\n\n// 缩放/时间范围逻辑\nconst endMicro = computed(() => _end?.micro || 0);\n\nconst handleDatazoom = debounce(\n    (e) => {\n        const { start, end } = e;\n        timeRange.value = [(start * endMicro.value) / 100, (end * endMicro.value) / 100];\n    },\n    500,\n    { leading: true }\n);\n\n// 数据更新逻辑\nconst updateData = () => {\n    loading.value = true;\n    getWorkerResponse(\"get_pve_overview_chart\", { statType: statType.value }).then((data) => {\n        xData.value = data.xData;\n        yData.value = data.yData;\n        loading.value = false;\n        timeRange.value = [0, endMicro.value];\n    });\n};\nwatchPostEffect(updateData);\n</script>\n\n<style lang=\"less\" scoped>\n.m-top-items {\n    .flex;\n    gap: 10px;\n\n    color: #939393;\n    margin-bottom: 30px;\n    .u-top-item {\n        flex: 1;\n        background: #1c1c1c;\n        border-radius: 16px;\n        height: 80px;\n        display: flex;\n        flex-direction: column;\n        justify-content: space-between;\n        padding: 10px;\n        .u-label {\n            white-space: nowrap;\n        }\n        .u-value {\n            .fz(32px, 42px);\n            font-weight: bold;\n            color: #fff;\n        }\n    }\n}\n\n.m-chart-box {\n    height: 390px;\n    padding: 20px;\n    border-radius: 16px;\n    background: #282828;\n    display: flex;\n    flex-direction: column;\n    .u-filter-items {\n        display: flex;\n        gap: 10px;\n        height: 26px;\n        .u-filter-item {\n            cursor: pointer;\n            .fz(20px,26px);\n            color: rgba(255, 255, 255, 0.3);\n            font-weight: bold;\n            &.is-active {\n                color: #fff;\n            }\n        }\n    }\n    .m-chart {\n        flex: 1;\n    }\n}\n</style>\n","import script from \"./overview_chart.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./overview_chart.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./overview_chart.vue?vue&type=style&index=0&id=16a98881&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-16a98881\"]])\n\nexport default __exports__","import { ref, computed } from \"vue\";\n\nexport const usePaginate = (data, pageSize) => {\n    if (!pageSize.value) pageSize = { value: pageSize };\n    const currentPage = ref(1);\n    const currentData = computed(() => {\n        const start = (currentPage.value - 1) * pageSize.value;\n        const end = start + pageSize.value;\n        return data.value.slice(start, end);\n    }, [data, currentPage]);\n    const total = computed(() => data.value.length, [data]);\n\n    return {\n        currentPage,\n        currentData,\n        total,\n    };\n};\n","<template>\n    <div class=\"w-card m-overview-list\">\n        <p class=\"u-title\">单位详情</p>\n        <el-table\n            v-loading=\"loading\"\n            class=\"u-table w-table\"\n            :data=\"currentData\"\n            :border=\"false\"\n            :fit=\"false\"\n            @sort-change=\"sort\"\n            @row-click=\"click\"\n            :row-class-name=\"rowClass\"\n        >\n            <el-table-column label=\"单位\" width=\"140\">\n                <template #default=\"{ row }\">\n                    <div class=\"u-center\" :title=\"getEntityName(row.id, { showRegion: true })\">\n                        <img class=\"u-mount-icon\" :src=\"getMountIcon(row.id)\" alt=\"\" />\n                        <span class=\"u-entity-name\">{{ getEntityName(row.id) }}</span>\n                    </div>\n                </template>\n            </el-table-column>\n            <el-table-column prop=\"value\" label=\"总数值\" width=\"100\" sortable=\"custom\">\n                <template #default=\"{ row }\">\n                    <span>{{ row.value.toLocaleString() }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"秒伤\" width=\"110\">\n                <template #default=\"{ row }\">\n                    <span>{{ row.vps.toFixed(0) }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"占比\" width=\"78\">\n                <template #default=\"{ row }\">\n                    {{ displayPercent(row.rate) }}\n                    <!-- <div class=\"u-rate-wrapper\">\n                            <div class=\"u-rate-value\">{{ displayPercent(row.rate) }}</div>\n                        </div> -->\n                </template>\n            </el-table-column>\n        </el-table>\n        <el-pagination\n            class=\"w-pagination\"\n            small\n            background\n            layout=\"pager\"\n            :page-size=\"pageSize\"\n            :total=\"total\"\n            :hide-on-single-page=\"true\"\n            :current-page=\"currentPage\"\n            @update:currentPage=\"currentPage = $event\"\n        />\n    </div>\n</template>\n\n<script setup>\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { getMountIcon, getEntityName } from \"@/utils/jcl/common\";\nimport { displayPercent } from \"@/utils/jcl/commonNoStore\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { ref, watchPostEffect, toRefs, toRaw } from \"vue\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\n\nconst global = usePve();\n\n// 数据\nconst loading = ref(false);\nconst data = ref([]);\nconst pageSize = 13;\nconst { focusEntitie, focusEntitieName, statType, timeRange } = toRefs(global);\nconst { currentPage, currentData, total } = usePaginate(data, ref(pageSize));\n// methods\nconst sort = ({ prop, order }) => {\n    data.value = data.value.sort((a, b) => {\n        if (order === \"ascending\") {\n            return a[prop] - b[prop];\n        } else {\n            return b[prop] - a[prop];\n        }\n    });\n};\nconst click = (row) => {\n    focusEntitie.value = row;\n    focusEntitieName.value = row.name;\n};\nconst rowClass = ({ row }) => {\n    if (focusEntitieName.value == row.name) {\n        focusEntitie.value = row;\n        return \"is-focus\";\n    }\n    return \"\";\n};\nconst updateData = () => {\n    loading.value = true;\n    getWorkerResponse(\"get_pve_overview_list\", {\n        statType: statType.value,\n        timeRange: toRaw(timeRange.value),\n    }).then((result) => {\n        loading.value = false;\n        data.value = result;\n        sort({ prop: \"value\", order: \"descending\" });\n        currentPage.value = 1;\n    });\n};\n\nwatchPostEffect(() => {\n    if (focusEntitieName.value) {\n        const row = data.value.find((item) => item.name === focusEntitieName.value);\n        if (row) {\n            focusEntitie.value = row;\n        } else {\n            focusEntitie.value = null;\n        }\n    } else {\n        focusEntitie.value = null;\n    }\n});\n\nwatchPostEffect(updateData);\n</script>\n\n<style lang=\"less\" scoped>\n@import \"@/assets/css/jcl/pve/overview_list.less\";\n.m-overview-list {\n    width: 468px;\n    .u-table {\n        flex-grow: 1;\n        :deep(.el-table__row) {\n            cursor: pointer;\n        }\n    }\n}\n</style>\n","import script from \"./overview_entity_list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./overview_entity_list.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./overview_entity_list.vue?vue&type=style&index=0&id=266acc09&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-266acc09\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-empty-guide\" :style=\"innerStyle\">\n        <img class=\"u-empty-icon\" src=\"@/assets/img/jcl/common/circle_arrow.svg\" :style=\"iconStyle\" />\n        <div class=\"u-empty-tips\" :style=\"tipsStyle\">\n            <div v-for=\"(tip, index) in tips\" :key=\"index\" class=\"u-empty-tip\">{{ tip }}</div>\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { toRefs, computed } from \"vue\";\n\nconst props = defineProps({\n    rotate: {\n        type: Number,\n        default: 0,\n    },\n    tips: {\n        type: [String, Array],\n        default: () => [\"在上方选择一项查看详情\"],\n    },\n    to: {\n        type: String,\n        default: \"column\",\n    },\n    position: {\n        type: String,\n        default: \"center\",\n    },\n    align: {\n        type: String,\n        default: \"center\",\n    },\n    textAlign: {\n        type: String,\n        default: \"center\",\n    },\n    grow: {\n        type: Boolean,\n        default: true,\n    },\n    size: {\n        type: Number,\n        default: 95,\n    },\n});\nconst { rotate, to, tips, align, textAlign, position, size, grow } = toRefs(props);\n\nconst innerStyle = computed(() => ({\n    textAlign: textAlign.value,\n    alignItems: align.value,\n    justifyContent: position.value,\n    flexDirection: to.value,\n    flexGrow: grow.value ? 1 : 0,\n}));\nconst iconStyle = computed(() => ({\n    width: `${size.value}px`,\n    height: `${size.value}px`,\n    transform: `rotate(${rotate.value}deg)`,\n}));\nconst tipsStyle = computed(() => {\n    const result = {\n        textAlign: textAlign.value,\n    };\n    if (to.value == \"row\" || to.value == \"row-reverse\") {\n        result.height = `${size.value}px`;\n        result.justifyContent = \"center\";\n    }\n    return result;\n});\n</script>\n\n<style lang=\"less\">\n.m-empty-guide {\n    box-sizing: border-box;\n    display: flex;\n    flex-grow: 1;\n    flex-direction: column;\n    height: 100%;\n    width: 100%;\n    padding: 20px;\n    color: #717273;\n    .bold;\n    .fz(20px,26px);\n    gap: 20px;\n\n    .u-empty-tips {\n        display: flex;\n        flex-direction: column;\n        gap: 10px;\n    }\n}\n</style>\n","import script from \"./empty_guide.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./empty_guide.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./empty_guide.vue?vue&type=style&index=0&id=36cf0f2c&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    <div class=\"m-overview-list__box\" tag=\"div\">\n        <empty-guide\n            class=\"w-card\"\n            v-if=\"!entityID\"\n            :rotate=\"-90\"\n            :tips=\"['在左侧选择一个实体后', '此处会展示该实体的详细技能数']\"\n        ></empty-guide>\n        <div class=\"w-card m-overview-list\" v-else>\n            <p class=\"u-title\">\n                <img class=\"u-entity-icon\" :src=\"getMountIcon(entityID)\" alt=\"\" />\n                {{ getEntityName(entityID) }}\n            </p>\n            <div class=\"m-list-info\">\n                <div class=\"u-li\">\n                    <p>\n                        <span class=\"u-label\">招式数</span>\n                        <span class=\"u-value\">{{ focusEntitie?.count }}</span>\n                    </p>\n                    <p>\n                        <span class=\"u-label\">会心数</span>\n                        <span class=\"u-value\">{{ focusEntitie?.criticalCount }}</span>\n                    </p>\n                </div>\n                <div class=\"u-li\">\n                    <p>\n                        <span class=\"u-label\">单次最小</span>\n                        <span class=\"u-value\">{{ focusEntitie?.min }}</span>\n                    </p>\n                    <p>\n                        <span class=\"u-label\">单次最大</span>\n                        <span class=\"u-value\">{{ focusEntitie?.max }}</span>\n                    </p>\n                </div>\n                <div class=\"u-li\">\n                    <p>\n                        <span class=\"u-label\">总数值</span>\n                        <span class=\"u-value\">{{ focusEntitie?.value }}</span>\n                    </p>\n                    <p>\n                        <span class=\"u-label\">秒伤</span>\n                        <span class=\"u-value\">{{ displayDigits(focusEntitie?.vps) }}/s</span>\n                    </p>\n                </div>\n            </div>\n            <el-table\n                v-if=\"currentData.length <= pageSize\"\n                v-loading=\"loading\"\n                class=\"u-table w-table\"\n                :data=\"currentData\"\n                :border=\"false\"\n                :row-class-name=\"rowClass\"\n            >\n                <el-table-column label=\"招式\" :align=\"'left'\">\n                    <template #default=\"{ row }\">{{ row.name }}</template>\n                </el-table-column>\n                <el-table-column prop=\"count\" label=\"命中\"></el-table-column>\n                <el-table-column prop=\"criticalCount\" label=\"会心\"></el-table-column>\n                <el-table-column label=\"占比\">\n                    <template #default=\"{ row }\">{{ displayPercent(row.rate) }}</template>\n                </el-table-column>\n            </el-table>\n            <el-pagination\n                class=\"w-pagination\"\n                small\n                background\n                layout=\"pager\"\n                :page-size=\"pageSize\"\n                :total=\"total\"\n                :hide-on-single-page=\"true\"\n                :current-page=\"currentPage\"\n                @update:currentPage=\"currentPage = $event\"\n            />\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { displayPercent, displayDigits } from \"@/utils/jcl/commonNoStore\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport EmptyGuide from \"@/components/jcl/common/empty_guide.vue\";\nimport { ref, watchPostEffect, toRefs, toRaw } from \"vue\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nimport { getMountIcon, getEntityName } from \"@/utils/jcl/common\";\n\nconst global = usePve();\nconst { focusEntitie } = toRefs(usePve());\n\nconst loading = ref(false);\nconst data = ref([]);\nconst pageSize = ref(11);\nconst { statType, timeRange } = toRefs(global);\nconst { currentPage, currentData, total } = usePaginate(data, pageSize);\n// methods\n\nconst entityID = ref(focusEntitie.value?.id);\n\nwatchPostEffect(() => {\n    entityID.value = focusEntitie.value?.id;\n});\n\nconst updateData = () => {\n    if (!entityID.value) return;\n    loading.value = true;\n    getWorkerResponse(\"get_pve_overview_focus\", {\n        statType: statType.value,\n        entityID: entityID.value,\n        timeRange: toRaw(timeRange.value),\n    }).then((result) => {\n        data.value = result;\n        loading.value = false;\n    });\n};\nwatchPostEffect(updateData);\n</script>\n\n<style lang=\"less\" scoped>\n.m-overview-list__box {\n    min-width: 386px;\n}\n@import \"@/assets/css/jcl/pve/overview_list.less\";\n</style>\n","import script from \"./overview_focus_list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./overview_focus_list.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./overview_focus_list.vue?vue&type=style&index=0&id=fc9332d6&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-fc9332d6\"]])\n\nexport default __exports__","import script from \"./pve_overview.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./pve_overview.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./pve_overview.vue?vue&type=style&index=0&id=00ba0ff9&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-00ba0ff9\"]])\n\nexport default __exports__","import { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createVNode as _createVNode, resolveComponent as _resolveComponent, withModifiers as _withModifiers, withCtx as _withCtx, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-tools-bar\"\n};\nconst _hoisted_2 = [\"onClick\"];\nconst _hoisted_3 = [\"src\"];\nconst _hoisted_4 = {\n  class: \"u-entity-name\"\n};\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { getMountIcon, getEntityName } from \"@/utils/jcl/common\";\nimport { Close } from \"@element-plus/icons-vue\";\nexport default {\n  __name: 'header_bar',\n  setup(__props) {\n    const {\n      entityList,\n      entitySelectVisible,\n      entity\n    } = toRefs(usePve());\n    const delEntity = id => {\n      const list = entityList.value.filter(item => item !== id);\n      if (id == entity.value && list.length) {\n        entity.value = list[0];\n      } else if (id == entity.value && !list.length) {\n        entity.value = null;\n        entitySelectVisible.value = true;\n      }\n      entityList.value = list;\n    };\n    const selectEntity = id => {\n      entity.value = id;\n    };\n    const showSelectEntityView = () => {\n      entitySelectVisible.value = true;\n    };\n    return (_ctx, _cache) => {\n      const _component_el_icon = _resolveComponent(\"el-icon\");\n      const _component_Plus = _resolveComponent(\"Plus\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(entityList), id => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: id,\n          class: _normalizeClass([\"m-entity-item\", {\n            'is-active': _unref(entity) == id\n          }]),\n          onClick: _withModifiers($event => selectEntity(id), [\"stop\"])\n        }, [_createElementVNode(\"img\", {\n          class: \"u-mount-icon\",\n          src: _unref(getMountIcon)(id),\n          alt: \"\"\n        }, null, 8, _hoisted_3), _createElementVNode(\"span\", _hoisted_4, _toDisplayString(_unref(getEntityName)(id)), 1), _createVNode(_component_el_icon, {\n          class: \"u-close-icon\",\n          onClick: _withModifiers($event => delEntity(id), [\"stop\"])\n        }, {\n          default: _withCtx(() => [_createVNode(_unref(Close))]),\n          _: 2\n        }, 1032, [\"onClick\"])], 10, _hoisted_2);\n      }), 128)), _createElementVNode(\"div\", {\n        class: \"u-add-icon\",\n        onClick: _cache[0] || (_cache[0] = $event => showSelectEntityView())\n      }, [_createVNode(_component_el_icon, null, {\n        default: _withCtx(() => [_createVNode(_component_Plus)]),\n        _: 1\n      })])]);\n    };\n  }\n};","import script from \"./header_bar.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./header_bar.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./header_bar.vue?vue&type=style&index=0&id=608463a0&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-608463a0\"]])\n\nexport default __exports__","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { __extends } from \"tslib\";\nimport * as zrUtil from 'zrender/lib/core/util.js';\nimport * as graphic from '../../util/graphic.js';\nimport { getECData } from '../../util/innerStore.js';\nimport { createTextStyle } from '../../label/labelStyle.js';\nimport { getLayoutRect } from '../../util/layout.js';\nimport ComponentModel from '../../model/Component.js';\nimport ComponentView from '../../view/Component.js';\nimport { windowOpen } from '../../util/format.js';\nvar TitleModel = /** @class */function (_super) {\n  __extends(TitleModel, _super);\n  function TitleModel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.type = TitleModel.type;\n    _this.layoutMode = {\n      type: 'box',\n      ignoreSize: true\n    };\n    return _this;\n  }\n  TitleModel.type = 'title';\n  TitleModel.defaultOption = {\n    // zlevel: 0,\n    z: 6,\n    show: true,\n    text: '',\n    target: 'blank',\n    subtext: '',\n    subtarget: 'blank',\n    left: 0,\n    top: 0,\n    backgroundColor: 'rgba(0,0,0,0)',\n    borderColor: '#ccc',\n    borderWidth: 0,\n    padding: 5,\n    itemGap: 10,\n    textStyle: {\n      fontSize: 18,\n      fontWeight: 'bold',\n      color: '#464646'\n    },\n    subtextStyle: {\n      fontSize: 12,\n      color: '#6E7079'\n    }\n  };\n  return TitleModel;\n}(ComponentModel);\n// View\nvar TitleView = /** @class */function (_super) {\n  __extends(TitleView, _super);\n  function TitleView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.type = TitleView.type;\n    return _this;\n  }\n  TitleView.prototype.render = function (titleModel, ecModel, api) {\n    this.group.removeAll();\n    if (!titleModel.get('show')) {\n      return;\n    }\n    var group = this.group;\n    var textStyleModel = titleModel.getModel('textStyle');\n    var subtextStyleModel = titleModel.getModel('subtextStyle');\n    var textAlign = titleModel.get('textAlign');\n    var textVerticalAlign = zrUtil.retrieve2(titleModel.get('textBaseline'), titleModel.get('textVerticalAlign'));\n    var textEl = new graphic.Text({\n      style: createTextStyle(textStyleModel, {\n        text: titleModel.get('text'),\n        fill: textStyleModel.getTextColor()\n      }, {\n        disableBox: true\n      }),\n      z2: 10\n    });\n    var textRect = textEl.getBoundingRect();\n    var subText = titleModel.get('subtext');\n    var subTextEl = new graphic.Text({\n      style: createTextStyle(subtextStyleModel, {\n        text: subText,\n        fill: subtextStyleModel.getTextColor(),\n        y: textRect.height + titleModel.get('itemGap'),\n        verticalAlign: 'top'\n      }, {\n        disableBox: true\n      }),\n      z2: 10\n    });\n    var link = titleModel.get('link');\n    var sublink = titleModel.get('sublink');\n    var triggerEvent = titleModel.get('triggerEvent', true);\n    textEl.silent = !link && !triggerEvent;\n    subTextEl.silent = !sublink && !triggerEvent;\n    if (link) {\n      textEl.on('click', function () {\n        windowOpen(link, '_' + titleModel.get('target'));\n      });\n    }\n    if (sublink) {\n      subTextEl.on('click', function () {\n        windowOpen(sublink, '_' + titleModel.get('subtarget'));\n      });\n    }\n    getECData(textEl).eventData = getECData(subTextEl).eventData = triggerEvent ? {\n      componentType: 'title',\n      componentIndex: titleModel.componentIndex\n    } : null;\n    group.add(textEl);\n    subText && group.add(subTextEl);\n    // If no subText, but add subTextEl, there will be an empty line.\n    var groupRect = group.getBoundingRect();\n    var layoutOption = titleModel.getBoxLayoutParams();\n    layoutOption.width = groupRect.width;\n    layoutOption.height = groupRect.height;\n    var layoutRect = getLayoutRect(layoutOption, {\n      width: api.getWidth(),\n      height: api.getHeight()\n    }, titleModel.get('padding'));\n    // Adjust text align based on position\n    if (!textAlign) {\n      // Align left if title is on the left. center and right is same\n      textAlign = titleModel.get('left') || titleModel.get('right');\n      // @ts-ignore\n      if (textAlign === 'middle') {\n        textAlign = 'center';\n      }\n      // Adjust layout by text align\n      if (textAlign === 'right') {\n        layoutRect.x += layoutRect.width;\n      } else if (textAlign === 'center') {\n        layoutRect.x += layoutRect.width / 2;\n      }\n    }\n    if (!textVerticalAlign) {\n      textVerticalAlign = titleModel.get('top') || titleModel.get('bottom');\n      // @ts-ignore\n      if (textVerticalAlign === 'center') {\n        textVerticalAlign = 'middle';\n      }\n      if (textVerticalAlign === 'bottom') {\n        layoutRect.y += layoutRect.height;\n      } else if (textVerticalAlign === 'middle') {\n        layoutRect.y += layoutRect.height / 2;\n      }\n      textVerticalAlign = textVerticalAlign || 'top';\n    }\n    group.x = layoutRect.x;\n    group.y = layoutRect.y;\n    group.markRedraw();\n    var alignStyle = {\n      align: textAlign,\n      verticalAlign: textVerticalAlign\n    };\n    textEl.setStyle(alignStyle);\n    subTextEl.setStyle(alignStyle);\n    // Render background\n    // Get groupRect again because textAlign has been changed\n    groupRect = group.getBoundingRect();\n    var padding = layoutRect.margin;\n    var style = titleModel.getItemStyle(['color', 'opacity']);\n    style.fill = titleModel.get('backgroundColor');\n    var rect = new graphic.Rect({\n      shape: {\n        x: groupRect.x - padding[3],\n        y: groupRect.y - padding[0],\n        width: groupRect.width + padding[1] + padding[3],\n        height: groupRect.height + padding[0] + padding[2],\n        r: titleModel.get('borderRadius')\n      },\n      style: style,\n      subPixelOptimize: true,\n      silent: true\n    });\n    group.add(rect);\n  };\n  TitleView.type = 'title';\n  return TitleView;\n}(ComponentView);\nexport function install(registers) {\n  registers.registerComponentModel(TitleModel);\n  registers.registerComponentView(TitleView);\n}","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { use } from '../extension.js';\nimport { install } from './title/install.js';\nuse(install);","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { parsePercent, linearMap } from '../../util/number.js';\nimport * as layout from '../../util/layout.js';\nimport * as zrUtil from 'zrender/lib/core/util.js';\nimport { normalizeArcAngles } from 'zrender/lib/core/PathProxy.js';\nimport { makeInner } from '../../util/model.js';\nvar PI2 = Math.PI * 2;\nvar RADIAN = Math.PI / 180;\nfunction getViewRect(seriesModel, api) {\n  return layout.getLayoutRect(seriesModel.getBoxLayoutParams(), {\n    width: api.getWidth(),\n    height: api.getHeight()\n  });\n}\nexport function getBasicPieLayout(seriesModel, api) {\n  var viewRect = getViewRect(seriesModel, api);\n  // center can be string or number when coordinateSystem is specified\n  var center = seriesModel.get('center');\n  var radius = seriesModel.get('radius');\n  if (!zrUtil.isArray(radius)) {\n    radius = [0, radius];\n  }\n  var width = parsePercent(viewRect.width, api.getWidth());\n  var height = parsePercent(viewRect.height, api.getHeight());\n  var size = Math.min(width, height);\n  var r0 = parsePercent(radius[0], size / 2);\n  var r = parsePercent(radius[1], size / 2);\n  var cx;\n  var cy;\n  var coordSys = seriesModel.coordinateSystem;\n  if (coordSys) {\n    // percentage is not allowed when coordinate system is specified\n    var point = coordSys.dataToPoint(center);\n    cx = point[0] || 0;\n    cy = point[1] || 0;\n  } else {\n    if (!zrUtil.isArray(center)) {\n      center = [center, center];\n    }\n    cx = parsePercent(center[0], width) + viewRect.x;\n    cy = parsePercent(center[1], height) + viewRect.y;\n  }\n  return {\n    cx: cx,\n    cy: cy,\n    r0: r0,\n    r: r\n  };\n}\nexport default function pieLayout(seriesType, ecModel, api) {\n  ecModel.eachSeriesByType(seriesType, function (seriesModel) {\n    var data = seriesModel.getData();\n    var valueDim = data.mapDimension('value');\n    var viewRect = getViewRect(seriesModel, api);\n    var _a = getBasicPieLayout(seriesModel, api),\n      cx = _a.cx,\n      cy = _a.cy,\n      r = _a.r,\n      r0 = _a.r0;\n    var startAngle = -seriesModel.get('startAngle') * RADIAN;\n    var endAngle = seriesModel.get('endAngle');\n    var padAngle = seriesModel.get('padAngle') * RADIAN;\n    endAngle = endAngle === 'auto' ? startAngle - PI2 : -endAngle * RADIAN;\n    var minAngle = seriesModel.get('minAngle') * RADIAN;\n    var minAndPadAngle = minAngle + padAngle;\n    var validDataCount = 0;\n    data.each(valueDim, function (value) {\n      !isNaN(value) && validDataCount++;\n    });\n    var sum = data.getSum(valueDim);\n    // Sum may be 0\n    var unitRadian = Math.PI / (sum || validDataCount) * 2;\n    var clockwise = seriesModel.get('clockwise');\n    var roseType = seriesModel.get('roseType');\n    var stillShowZeroSum = seriesModel.get('stillShowZeroSum');\n    // [0...max]\n    var extent = data.getDataExtent(valueDim);\n    extent[0] = 0;\n    var dir = clockwise ? 1 : -1;\n    var angles = [startAngle, endAngle];\n    var halfPadAngle = dir * padAngle / 2;\n    normalizeArcAngles(angles, !clockwise);\n    startAngle = angles[0], endAngle = angles[1];\n    var layoutData = getSeriesLayoutData(seriesModel);\n    layoutData.startAngle = startAngle;\n    layoutData.endAngle = endAngle;\n    layoutData.clockwise = clockwise;\n    var angleRange = Math.abs(endAngle - startAngle);\n    // In the case some sector angle is smaller than minAngle\n    var restAngle = angleRange;\n    var valueSumLargerThanMinAngle = 0;\n    var currentAngle = startAngle;\n    data.setLayout({\n      viewRect: viewRect,\n      r: r\n    });\n    data.each(valueDim, function (value, idx) {\n      var angle;\n      if (isNaN(value)) {\n        data.setItemLayout(idx, {\n          angle: NaN,\n          startAngle: NaN,\n          endAngle: NaN,\n          clockwise: clockwise,\n          cx: cx,\n          cy: cy,\n          r0: r0,\n          r: roseType ? NaN : r\n        });\n        return;\n      }\n      // FIXME 兼容 2.0 但是 roseType 是 area 的时候才是这样？\n      if (roseType !== 'area') {\n        angle = sum === 0 && stillShowZeroSum ? unitRadian : value * unitRadian;\n      } else {\n        angle = angleRange / validDataCount;\n      }\n      if (angle < minAndPadAngle) {\n        angle = minAndPadAngle;\n        restAngle -= minAndPadAngle;\n      } else {\n        valueSumLargerThanMinAngle += value;\n      }\n      var endAngle = currentAngle + dir * angle;\n      // calculate display angle\n      var actualStartAngle = 0;\n      var actualEndAngle = 0;\n      if (padAngle > angle) {\n        actualStartAngle = currentAngle + dir * angle / 2;\n        actualEndAngle = actualStartAngle;\n      } else {\n        actualStartAngle = currentAngle + halfPadAngle;\n        actualEndAngle = endAngle - halfPadAngle;\n      }\n      data.setItemLayout(idx, {\n        angle: angle,\n        startAngle: actualStartAngle,\n        endAngle: actualEndAngle,\n        clockwise: clockwise,\n        cx: cx,\n        cy: cy,\n        r0: r0,\n        r: roseType ? linearMap(value, extent, [r0, r]) : r\n      });\n      currentAngle = endAngle;\n    });\n    // Some sector is constrained by minAngle and padAngle\n    // Rest sectors needs recalculate angle\n    if (restAngle < PI2 && validDataCount) {\n      // Average the angle if rest angle is not enough after all angles is\n      // Constrained by minAngle and padAngle\n      if (restAngle <= 1e-3) {\n        var angle_1 = angleRange / validDataCount;\n        data.each(valueDim, function (value, idx) {\n          if (!isNaN(value)) {\n            var layout_1 = data.getItemLayout(idx);\n            layout_1.angle = angle_1;\n            var actualStartAngle = 0;\n            var actualEndAngle = 0;\n            if (angle_1 < padAngle) {\n              actualStartAngle = startAngle + dir * (idx + 1 / 2) * angle_1;\n              actualEndAngle = actualStartAngle;\n            } else {\n              actualStartAngle = startAngle + dir * idx * angle_1 + halfPadAngle;\n              actualEndAngle = startAngle + dir * (idx + 1) * angle_1 - halfPadAngle;\n            }\n            layout_1.startAngle = actualStartAngle;\n            layout_1.endAngle = actualEndAngle;\n          }\n        });\n      } else {\n        unitRadian = restAngle / valueSumLargerThanMinAngle;\n        currentAngle = startAngle;\n        data.each(valueDim, function (value, idx) {\n          if (!isNaN(value)) {\n            var layout_2 = data.getItemLayout(idx);\n            var angle = layout_2.angle === minAndPadAngle ? minAndPadAngle : value * unitRadian;\n            var actualStartAngle = 0;\n            var actualEndAngle = 0;\n            if (angle < padAngle) {\n              actualStartAngle = currentAngle + dir * angle / 2;\n              actualEndAngle = actualStartAngle;\n            } else {\n              actualStartAngle = currentAngle + halfPadAngle;\n              actualEndAngle = currentAngle + dir * angle - halfPadAngle;\n            }\n            layout_2.startAngle = actualStartAngle;\n            layout_2.endAngle = actualEndAngle;\n            currentAngle += dir * angle;\n          }\n        });\n      }\n    }\n  });\n}\nexport var getSeriesLayoutData = makeInner();","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nexport default function dataFilter(seriesType) {\n  return {\n    seriesType: seriesType,\n    reset: function (seriesModel, ecModel) {\n      var legendModels = ecModel.findComponents({\n        mainType: 'legend'\n      });\n      if (!legendModels || !legendModels.length) {\n        return;\n      }\n      var data = seriesModel.getData();\n      data.filterSelf(function (idx) {\n        var name = data.getName(idx);\n        // If in any legend component the status is not selected.\n        for (var i = 0; i < legendModels.length; i++) {\n          // @ts-ignore FIXME: LegendModel\n          if (!legendModels[i].isSelected(name)) {\n            return false;\n          }\n        }\n        return true;\n      });\n    }\n  };\n}","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { Point, Path, Polyline } from '../util/graphic.js';\nimport PathProxy from 'zrender/lib/core/PathProxy.js';\nimport { normalizeRadian } from 'zrender/lib/contain/util.js';\nimport { cubicProjectPoint, quadraticProjectPoint } from 'zrender/lib/core/curve.js';\nimport { defaults, retrieve2 } from 'zrender/lib/core/util.js';\nimport { invert } from 'zrender/lib/core/matrix.js';\nimport * as vector from 'zrender/lib/core/vector.js';\nimport { DISPLAY_STATES, SPECIAL_STATES } from '../util/states.js';\nvar PI2 = Math.PI * 2;\nvar CMD = PathProxy.CMD;\nvar DEFAULT_SEARCH_SPACE = ['top', 'right', 'bottom', 'left'];\nfunction getCandidateAnchor(pos, distance, rect, outPt, outDir) {\n  var width = rect.width;\n  var height = rect.height;\n  switch (pos) {\n    case 'top':\n      outPt.set(rect.x + width / 2, rect.y - distance);\n      outDir.set(0, -1);\n      break;\n    case 'bottom':\n      outPt.set(rect.x + width / 2, rect.y + height + distance);\n      outDir.set(0, 1);\n      break;\n    case 'left':\n      outPt.set(rect.x - distance, rect.y + height / 2);\n      outDir.set(-1, 0);\n      break;\n    case 'right':\n      outPt.set(rect.x + width + distance, rect.y + height / 2);\n      outDir.set(1, 0);\n      break;\n  }\n}\nfunction projectPointToArc(cx, cy, r, startAngle, endAngle, anticlockwise, x, y, out) {\n  x -= cx;\n  y -= cy;\n  var d = Math.sqrt(x * x + y * y);\n  x /= d;\n  y /= d;\n  // Intersect point.\n  var ox = x * r + cx;\n  var oy = y * r + cy;\n  if (Math.abs(startAngle - endAngle) % PI2 < 1e-4) {\n    // Is a circle\n    out[0] = ox;\n    out[1] = oy;\n    return d - r;\n  }\n  if (anticlockwise) {\n    var tmp = startAngle;\n    startAngle = normalizeRadian(endAngle);\n    endAngle = normalizeRadian(tmp);\n  } else {\n    startAngle = normalizeRadian(startAngle);\n    endAngle = normalizeRadian(endAngle);\n  }\n  if (startAngle > endAngle) {\n    endAngle += PI2;\n  }\n  var angle = Math.atan2(y, x);\n  if (angle < 0) {\n    angle += PI2;\n  }\n  if (angle >= startAngle && angle <= endAngle || angle + PI2 >= startAngle && angle + PI2 <= endAngle) {\n    // Project point is on the arc.\n    out[0] = ox;\n    out[1] = oy;\n    return d - r;\n  }\n  var x1 = r * Math.cos(startAngle) + cx;\n  var y1 = r * Math.sin(startAngle) + cy;\n  var x2 = r * Math.cos(endAngle) + cx;\n  var y2 = r * Math.sin(endAngle) + cy;\n  var d1 = (x1 - x) * (x1 - x) + (y1 - y) * (y1 - y);\n  var d2 = (x2 - x) * (x2 - x) + (y2 - y) * (y2 - y);\n  if (d1 < d2) {\n    out[0] = x1;\n    out[1] = y1;\n    return Math.sqrt(d1);\n  } else {\n    out[0] = x2;\n    out[1] = y2;\n    return Math.sqrt(d2);\n  }\n}\nfunction projectPointToLine(x1, y1, x2, y2, x, y, out, limitToEnds) {\n  var dx = x - x1;\n  var dy = y - y1;\n  var dx1 = x2 - x1;\n  var dy1 = y2 - y1;\n  var lineLen = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n  dx1 /= lineLen;\n  dy1 /= lineLen;\n  // dot product\n  var projectedLen = dx * dx1 + dy * dy1;\n  var t = projectedLen / lineLen;\n  if (limitToEnds) {\n    t = Math.min(Math.max(t, 0), 1);\n  }\n  t *= lineLen;\n  var ox = out[0] = x1 + t * dx1;\n  var oy = out[1] = y1 + t * dy1;\n  return Math.sqrt((ox - x) * (ox - x) + (oy - y) * (oy - y));\n}\nfunction projectPointToRect(x1, y1, width, height, x, y, out) {\n  if (width < 0) {\n    x1 = x1 + width;\n    width = -width;\n  }\n  if (height < 0) {\n    y1 = y1 + height;\n    height = -height;\n  }\n  var x2 = x1 + width;\n  var y2 = y1 + height;\n  var ox = out[0] = Math.min(Math.max(x, x1), x2);\n  var oy = out[1] = Math.min(Math.max(y, y1), y2);\n  return Math.sqrt((ox - x) * (ox - x) + (oy - y) * (oy - y));\n}\nvar tmpPt = [];\nfunction nearestPointOnRect(pt, rect, out) {\n  var dist = projectPointToRect(rect.x, rect.y, rect.width, rect.height, pt.x, pt.y, tmpPt);\n  out.set(tmpPt[0], tmpPt[1]);\n  return dist;\n}\n/**\r\n * Calculate min distance corresponding point.\r\n * This method won't evaluate if point is in the path.\r\n */\nfunction nearestPointOnPath(pt, path, out) {\n  var xi = 0;\n  var yi = 0;\n  var x0 = 0;\n  var y0 = 0;\n  var x1;\n  var y1;\n  var minDist = Infinity;\n  var data = path.data;\n  var x = pt.x;\n  var y = pt.y;\n  for (var i = 0; i < data.length;) {\n    var cmd = data[i++];\n    if (i === 1) {\n      xi = data[i];\n      yi = data[i + 1];\n      x0 = xi;\n      y0 = yi;\n    }\n    var d = minDist;\n    switch (cmd) {\n      case CMD.M:\n        // moveTo 命令重新创建一个新的 subpath, 并且更新新的起点\n        // 在 closePath 的时候使用\n        x0 = data[i++];\n        y0 = data[i++];\n        xi = x0;\n        yi = y0;\n        break;\n      case CMD.L:\n        d = projectPointToLine(xi, yi, data[i], data[i + 1], x, y, tmpPt, true);\n        xi = data[i++];\n        yi = data[i++];\n        break;\n      case CMD.C:\n        d = cubicProjectPoint(xi, yi, data[i++], data[i++], data[i++], data[i++], data[i], data[i + 1], x, y, tmpPt);\n        xi = data[i++];\n        yi = data[i++];\n        break;\n      case CMD.Q:\n        d = quadraticProjectPoint(xi, yi, data[i++], data[i++], data[i], data[i + 1], x, y, tmpPt);\n        xi = data[i++];\n        yi = data[i++];\n        break;\n      case CMD.A:\n        // TODO Arc 判断的开销比较大\n        var cx = data[i++];\n        var cy = data[i++];\n        var rx = data[i++];\n        var ry = data[i++];\n        var theta = data[i++];\n        var dTheta = data[i++];\n        // TODO Arc 旋转\n        i += 1;\n        var anticlockwise = !!(1 - data[i++]);\n        x1 = Math.cos(theta) * rx + cx;\n        y1 = Math.sin(theta) * ry + cy;\n        // 不是直接使用 arc 命令\n        if (i <= 1) {\n          // 第一个命令起点还未定义\n          x0 = x1;\n          y0 = y1;\n        }\n        // zr 使用scale来模拟椭圆, 这里也对x做一定的缩放\n        var _x = (x - cx) * ry / rx + cx;\n        d = projectPointToArc(cx, cy, ry, theta, theta + dTheta, anticlockwise, _x, y, tmpPt);\n        xi = Math.cos(theta + dTheta) * rx + cx;\n        yi = Math.sin(theta + dTheta) * ry + cy;\n        break;\n      case CMD.R:\n        x0 = xi = data[i++];\n        y0 = yi = data[i++];\n        var width = data[i++];\n        var height = data[i++];\n        d = projectPointToRect(x0, y0, width, height, x, y, tmpPt);\n        break;\n      case CMD.Z:\n        d = projectPointToLine(xi, yi, x0, y0, x, y, tmpPt, true);\n        xi = x0;\n        yi = y0;\n        break;\n    }\n    if (d < minDist) {\n      minDist = d;\n      out.set(tmpPt[0], tmpPt[1]);\n    }\n  }\n  return minDist;\n}\n// Temporal variable for intermediate usage.\nvar pt0 = new Point();\nvar pt1 = new Point();\nvar pt2 = new Point();\nvar dir = new Point();\nvar dir2 = new Point();\n/**\r\n * Calculate a proper guide line based on the label position and graphic element definition\r\n * @param label\r\n * @param labelRect\r\n * @param target\r\n * @param targetRect\r\n */\nexport function updateLabelLinePoints(target, labelLineModel) {\n  if (!target) {\n    return;\n  }\n  var labelLine = target.getTextGuideLine();\n  var label = target.getTextContent();\n  // Needs to create text guide in each charts.\n  if (!(label && labelLine)) {\n    return;\n  }\n  var labelGuideConfig = target.textGuideLineConfig || {};\n  var points = [[0, 0], [0, 0], [0, 0]];\n  var searchSpace = labelGuideConfig.candidates || DEFAULT_SEARCH_SPACE;\n  var labelRect = label.getBoundingRect().clone();\n  labelRect.applyTransform(label.getComputedTransform());\n  var minDist = Infinity;\n  var anchorPoint = labelGuideConfig.anchor;\n  var targetTransform = target.getComputedTransform();\n  var targetInversedTransform = targetTransform && invert([], targetTransform);\n  var len = labelLineModel.get('length2') || 0;\n  if (anchorPoint) {\n    pt2.copy(anchorPoint);\n  }\n  for (var i = 0; i < searchSpace.length; i++) {\n    var candidate = searchSpace[i];\n    getCandidateAnchor(candidate, 0, labelRect, pt0, dir);\n    Point.scaleAndAdd(pt1, pt0, dir, len);\n    // Transform to target coord space.\n    pt1.transform(targetInversedTransform);\n    // Note: getBoundingRect will ensure the `path` being created.\n    var boundingRect = target.getBoundingRect();\n    var dist = anchorPoint ? anchorPoint.distance(pt1) : target instanceof Path ? nearestPointOnPath(pt1, target.path, pt2) : nearestPointOnRect(pt1, boundingRect, pt2);\n    // TODO pt2 is in the path\n    if (dist < minDist) {\n      minDist = dist;\n      // Transform back to global space.\n      pt1.transform(targetTransform);\n      pt2.transform(targetTransform);\n      pt2.toArray(points[0]);\n      pt1.toArray(points[1]);\n      pt0.toArray(points[2]);\n    }\n  }\n  limitTurnAngle(points, labelLineModel.get('minTurnAngle'));\n  labelLine.setShape({\n    points: points\n  });\n}\n// Temporal variable for the limitTurnAngle function\nvar tmpArr = [];\nvar tmpProjPoint = new Point();\n/**\r\n * Reduce the line segment attached to the label to limit the turn angle between two segments.\r\n * @param linePoints\r\n * @param minTurnAngle Radian of minimum turn angle. 0 - 180\r\n */\nexport function limitTurnAngle(linePoints, minTurnAngle) {\n  if (!(minTurnAngle <= 180 && minTurnAngle > 0)) {\n    return;\n  }\n  minTurnAngle = minTurnAngle / 180 * Math.PI;\n  // The line points can be\n  //      /pt1----pt2 (label)\n  //     /\n  // pt0/\n  pt0.fromArray(linePoints[0]);\n  pt1.fromArray(linePoints[1]);\n  pt2.fromArray(linePoints[2]);\n  Point.sub(dir, pt0, pt1);\n  Point.sub(dir2, pt2, pt1);\n  var len1 = dir.len();\n  var len2 = dir2.len();\n  if (len1 < 1e-3 || len2 < 1e-3) {\n    return;\n  }\n  dir.scale(1 / len1);\n  dir2.scale(1 / len2);\n  var angleCos = dir.dot(dir2);\n  var minTurnAngleCos = Math.cos(minTurnAngle);\n  if (minTurnAngleCos < angleCos) {\n    // Smaller than minTurnAngle\n    // Calculate project point of pt0 on pt1-pt2\n    var d = projectPointToLine(pt1.x, pt1.y, pt2.x, pt2.y, pt0.x, pt0.y, tmpArr, false);\n    tmpProjPoint.fromArray(tmpArr);\n    // Calculate new projected length with limited minTurnAngle and get the new connect point\n    tmpProjPoint.scaleAndAdd(dir2, d / Math.tan(Math.PI - minTurnAngle));\n    // Limit the new calculated connect point between pt1 and pt2.\n    var t = pt2.x !== pt1.x ? (tmpProjPoint.x - pt1.x) / (pt2.x - pt1.x) : (tmpProjPoint.y - pt1.y) / (pt2.y - pt1.y);\n    if (isNaN(t)) {\n      return;\n    }\n    if (t < 0) {\n      Point.copy(tmpProjPoint, pt1);\n    } else if (t > 1) {\n      Point.copy(tmpProjPoint, pt2);\n    }\n    tmpProjPoint.toArray(linePoints[1]);\n  }\n}\n/**\r\n * Limit the angle of line and the surface\r\n * @param maxSurfaceAngle Radian of minimum turn angle. 0 - 180. 0 is same direction to normal. 180 is opposite\r\n */\nexport function limitSurfaceAngle(linePoints, surfaceNormal, maxSurfaceAngle) {\n  if (!(maxSurfaceAngle <= 180 && maxSurfaceAngle > 0)) {\n    return;\n  }\n  maxSurfaceAngle = maxSurfaceAngle / 180 * Math.PI;\n  pt0.fromArray(linePoints[0]);\n  pt1.fromArray(linePoints[1]);\n  pt2.fromArray(linePoints[2]);\n  Point.sub(dir, pt1, pt0);\n  Point.sub(dir2, pt2, pt1);\n  var len1 = dir.len();\n  var len2 = dir2.len();\n  if (len1 < 1e-3 || len2 < 1e-3) {\n    return;\n  }\n  dir.scale(1 / len1);\n  dir2.scale(1 / len2);\n  var angleCos = dir.dot(surfaceNormal);\n  var maxSurfaceAngleCos = Math.cos(maxSurfaceAngle);\n  if (angleCos < maxSurfaceAngleCos) {\n    // Calculate project point of pt0 on pt1-pt2\n    var d = projectPointToLine(pt1.x, pt1.y, pt2.x, pt2.y, pt0.x, pt0.y, tmpArr, false);\n    tmpProjPoint.fromArray(tmpArr);\n    var HALF_PI = Math.PI / 2;\n    var angle2 = Math.acos(dir2.dot(surfaceNormal));\n    var newAngle = HALF_PI + angle2 - maxSurfaceAngle;\n    if (newAngle >= HALF_PI) {\n      // parallel\n      Point.copy(tmpProjPoint, pt2);\n    } else {\n      // Calculate new projected length with limited minTurnAngle and get the new connect point\n      tmpProjPoint.scaleAndAdd(dir2, d / Math.tan(Math.PI / 2 - newAngle));\n      // Limit the new calculated connect point between pt1 and pt2.\n      var t = pt2.x !== pt1.x ? (tmpProjPoint.x - pt1.x) / (pt2.x - pt1.x) : (tmpProjPoint.y - pt1.y) / (pt2.y - pt1.y);\n      if (isNaN(t)) {\n        return;\n      }\n      if (t < 0) {\n        Point.copy(tmpProjPoint, pt1);\n      } else if (t > 1) {\n        Point.copy(tmpProjPoint, pt2);\n      }\n    }\n    tmpProjPoint.toArray(linePoints[1]);\n  }\n}\nfunction setLabelLineState(labelLine, ignore, stateName, stateModel) {\n  var isNormal = stateName === 'normal';\n  var stateObj = isNormal ? labelLine : labelLine.ensureState(stateName);\n  // Make sure display.\n  stateObj.ignore = ignore;\n  // Set smooth\n  var smooth = stateModel.get('smooth');\n  if (smooth && smooth === true) {\n    smooth = 0.3;\n  }\n  stateObj.shape = stateObj.shape || {};\n  if (smooth > 0) {\n    stateObj.shape.smooth = smooth;\n  }\n  var styleObj = stateModel.getModel('lineStyle').getLineStyle();\n  isNormal ? labelLine.useStyle(styleObj) : stateObj.style = styleObj;\n}\nfunction buildLabelLinePath(path, shape) {\n  var smooth = shape.smooth;\n  var points = shape.points;\n  if (!points) {\n    return;\n  }\n  path.moveTo(points[0][0], points[0][1]);\n  if (smooth > 0 && points.length >= 3) {\n    var len1 = vector.dist(points[0], points[1]);\n    var len2 = vector.dist(points[1], points[2]);\n    if (!len1 || !len2) {\n      path.lineTo(points[1][0], points[1][1]);\n      path.lineTo(points[2][0], points[2][1]);\n      return;\n    }\n    var moveLen = Math.min(len1, len2) * smooth;\n    var midPoint0 = vector.lerp([], points[1], points[0], moveLen / len1);\n    var midPoint2 = vector.lerp([], points[1], points[2], moveLen / len2);\n    var midPoint1 = vector.lerp([], midPoint0, midPoint2, 0.5);\n    path.bezierCurveTo(midPoint0[0], midPoint0[1], midPoint0[0], midPoint0[1], midPoint1[0], midPoint1[1]);\n    path.bezierCurveTo(midPoint2[0], midPoint2[1], midPoint2[0], midPoint2[1], points[2][0], points[2][1]);\n  } else {\n    for (var i = 1; i < points.length; i++) {\n      path.lineTo(points[i][0], points[i][1]);\n    }\n  }\n}\n/**\r\n * Create a label line if necessary and set it's style.\r\n */\nexport function setLabelLineStyle(targetEl, statesModels, defaultStyle) {\n  var labelLine = targetEl.getTextGuideLine();\n  var label = targetEl.getTextContent();\n  if (!label) {\n    // Not show label line if there is no label.\n    if (labelLine) {\n      targetEl.removeTextGuideLine();\n    }\n    return;\n  }\n  var normalModel = statesModels.normal;\n  var showNormal = normalModel.get('show');\n  var labelIgnoreNormal = label.ignore;\n  for (var i = 0; i < DISPLAY_STATES.length; i++) {\n    var stateName = DISPLAY_STATES[i];\n    var stateModel = statesModels[stateName];\n    var isNormal = stateName === 'normal';\n    if (stateModel) {\n      var stateShow = stateModel.get('show');\n      var isLabelIgnored = isNormal ? labelIgnoreNormal : retrieve2(label.states[stateName] && label.states[stateName].ignore, labelIgnoreNormal);\n      if (isLabelIgnored // Not show when label is not shown in this state.\n      || !retrieve2(stateShow, showNormal) // Use normal state by default if not set.\n      ) {\n        var stateObj = isNormal ? labelLine : labelLine && labelLine.states[stateName];\n        if (stateObj) {\n          stateObj.ignore = true;\n        }\n        if (!!labelLine) {\n          setLabelLineState(labelLine, true, stateName, stateModel);\n        }\n        continue;\n      }\n      // Create labelLine if not exists\n      if (!labelLine) {\n        labelLine = new Polyline();\n        targetEl.setTextGuideLine(labelLine);\n        // Reset state of normal because it's new created.\n        // NOTE: NORMAL should always been the first!\n        if (!isNormal && (labelIgnoreNormal || !showNormal)) {\n          setLabelLineState(labelLine, true, 'normal', statesModels.normal);\n        }\n        // Use same state proxy.\n        if (targetEl.stateProxy) {\n          labelLine.stateProxy = targetEl.stateProxy;\n        }\n      }\n      setLabelLineState(labelLine, false, stateName, stateModel);\n    }\n  }\n  if (labelLine) {\n    defaults(labelLine.style, defaultStyle);\n    // Not fill.\n    labelLine.style.fill = null;\n    var showAbove = normalModel.get('showAbove');\n    var labelLineConfig = targetEl.textGuideLineConfig = targetEl.textGuideLineConfig || {};\n    labelLineConfig.showAbove = showAbove || false;\n    // Custom the buildPath.\n    labelLine.buildPath = buildLabelLinePath;\n  }\n}\nexport function getLabelLineStatesModels(itemModel, labelLineName) {\n  labelLineName = labelLineName || 'labelLine';\n  var statesModels = {\n    normal: itemModel.getModel(labelLineName)\n  };\n  for (var i = 0; i < SPECIAL_STATES.length; i++) {\n    var stateName = SPECIAL_STATES[i];\n    statesModels[stateName] = itemModel.getModel([stateName, labelLineName]);\n  }\n  return statesModels;\n}","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\n// FIXME emphasis label position is not same with normal label position\nimport { parsePercent } from '../../util/number.js';\nimport { Point } from '../../util/graphic.js';\nimport { each, isNumber } from 'zrender/lib/core/util.js';\nimport { limitTurnAngle, limitSurfaceAngle } from '../../label/labelGuideHelper.js';\nimport { shiftLayoutOnY } from '../../label/labelLayoutHelper.js';\nvar RADIAN = Math.PI / 180;\nfunction adjustSingleSide(list, cx, cy, r, dir, viewWidth, viewHeight, viewLeft, viewTop, farthestX) {\n  if (list.length < 2) {\n    return;\n  }\n  ;\n  function recalculateXOnSemiToAlignOnEllipseCurve(semi) {\n    var rB = semi.rB;\n    var rB2 = rB * rB;\n    for (var i = 0; i < semi.list.length; i++) {\n      var item = semi.list[i];\n      var dy = Math.abs(item.label.y - cy);\n      // horizontal r is always same with original r because x is not changed.\n      var rA = r + item.len;\n      var rA2 = rA * rA;\n      // Use ellipse implicit function to calculate x\n      var dx = Math.sqrt(Math.abs((1 - dy * dy / rB2) * rA2));\n      var newX = cx + (dx + item.len2) * dir;\n      var deltaX = newX - item.label.x;\n      var newTargetWidth = item.targetTextWidth - deltaX * dir;\n      // text x is changed, so need to recalculate width.\n      constrainTextWidth(item, newTargetWidth, true);\n      item.label.x = newX;\n    }\n  }\n  // Adjust X based on the shifted y. Make tight labels aligned on an ellipse curve.\n  function recalculateX(items) {\n    // Extremes of\n    var topSemi = {\n      list: [],\n      maxY: 0\n    };\n    var bottomSemi = {\n      list: [],\n      maxY: 0\n    };\n    for (var i = 0; i < items.length; i++) {\n      if (items[i].labelAlignTo !== 'none') {\n        continue;\n      }\n      var item = items[i];\n      var semi = item.label.y > cy ? bottomSemi : topSemi;\n      var dy = Math.abs(item.label.y - cy);\n      if (dy >= semi.maxY) {\n        var dx = item.label.x - cx - item.len2 * dir;\n        // horizontal r is always same with original r because x is not changed.\n        var rA = r + item.len;\n        // Canculate rB based on the topest / bottemest label.\n        var rB = Math.abs(dx) < rA ? Math.sqrt(dy * dy / (1 - dx * dx / rA / rA)) : rA;\n        semi.rB = rB;\n        semi.maxY = dy;\n      }\n      semi.list.push(item);\n    }\n    recalculateXOnSemiToAlignOnEllipseCurve(topSemi);\n    recalculateXOnSemiToAlignOnEllipseCurve(bottomSemi);\n  }\n  var len = list.length;\n  for (var i = 0; i < len; i++) {\n    if (list[i].position === 'outer' && list[i].labelAlignTo === 'labelLine') {\n      var dx = list[i].label.x - farthestX;\n      list[i].linePoints[1][0] += dx;\n      list[i].label.x = farthestX;\n    }\n  }\n  if (shiftLayoutOnY(list, viewTop, viewTop + viewHeight)) {\n    recalculateX(list);\n  }\n}\nfunction avoidOverlap(labelLayoutList, cx, cy, r, viewWidth, viewHeight, viewLeft, viewTop) {\n  var leftList = [];\n  var rightList = [];\n  var leftmostX = Number.MAX_VALUE;\n  var rightmostX = -Number.MAX_VALUE;\n  for (var i = 0; i < labelLayoutList.length; i++) {\n    var label = labelLayoutList[i].label;\n    if (isPositionCenter(labelLayoutList[i])) {\n      continue;\n    }\n    if (label.x < cx) {\n      leftmostX = Math.min(leftmostX, label.x);\n      leftList.push(labelLayoutList[i]);\n    } else {\n      rightmostX = Math.max(rightmostX, label.x);\n      rightList.push(labelLayoutList[i]);\n    }\n  }\n  for (var i = 0; i < labelLayoutList.length; i++) {\n    var layout = labelLayoutList[i];\n    if (!isPositionCenter(layout) && layout.linePoints) {\n      if (layout.labelStyleWidth != null) {\n        continue;\n      }\n      var label = layout.label;\n      var linePoints = layout.linePoints;\n      var targetTextWidth = void 0;\n      if (layout.labelAlignTo === 'edge') {\n        if (label.x < cx) {\n          targetTextWidth = linePoints[2][0] - layout.labelDistance - viewLeft - layout.edgeDistance;\n        } else {\n          targetTextWidth = viewLeft + viewWidth - layout.edgeDistance - linePoints[2][0] - layout.labelDistance;\n        }\n      } else if (layout.labelAlignTo === 'labelLine') {\n        if (label.x < cx) {\n          targetTextWidth = leftmostX - viewLeft - layout.bleedMargin;\n        } else {\n          targetTextWidth = viewLeft + viewWidth - rightmostX - layout.bleedMargin;\n        }\n      } else {\n        if (label.x < cx) {\n          targetTextWidth = label.x - viewLeft - layout.bleedMargin;\n        } else {\n          targetTextWidth = viewLeft + viewWidth - label.x - layout.bleedMargin;\n        }\n      }\n      layout.targetTextWidth = targetTextWidth;\n      constrainTextWidth(layout, targetTextWidth);\n    }\n  }\n  adjustSingleSide(rightList, cx, cy, r, 1, viewWidth, viewHeight, viewLeft, viewTop, rightmostX);\n  adjustSingleSide(leftList, cx, cy, r, -1, viewWidth, viewHeight, viewLeft, viewTop, leftmostX);\n  for (var i = 0; i < labelLayoutList.length; i++) {\n    var layout = labelLayoutList[i];\n    if (!isPositionCenter(layout) && layout.linePoints) {\n      var label = layout.label;\n      var linePoints = layout.linePoints;\n      var isAlignToEdge = layout.labelAlignTo === 'edge';\n      var padding = label.style.padding;\n      var paddingH = padding ? padding[1] + padding[3] : 0;\n      // textRect.width already contains paddingH if bgColor is set\n      var extraPaddingH = label.style.backgroundColor ? 0 : paddingH;\n      var realTextWidth = layout.rect.width + extraPaddingH;\n      var dist = linePoints[1][0] - linePoints[2][0];\n      if (isAlignToEdge) {\n        if (label.x < cx) {\n          linePoints[2][0] = viewLeft + layout.edgeDistance + realTextWidth + layout.labelDistance;\n        } else {\n          linePoints[2][0] = viewLeft + viewWidth - layout.edgeDistance - realTextWidth - layout.labelDistance;\n        }\n      } else {\n        if (label.x < cx) {\n          linePoints[2][0] = label.x + layout.labelDistance;\n        } else {\n          linePoints[2][0] = label.x - layout.labelDistance;\n        }\n        linePoints[1][0] = linePoints[2][0] + dist;\n      }\n      linePoints[1][1] = linePoints[2][1] = label.y;\n    }\n  }\n}\n/**\r\n * Set max width of each label, and then wrap each label to the max width.\r\n *\r\n * @param layout label layout\r\n * @param availableWidth max width for the label to display\r\n * @param forceRecalculate recaculate the text layout even if the current width\r\n * is smaller than `availableWidth`. This is useful when the text was previously\r\n * wrapped by calling `constrainTextWidth` but now `availableWidth` changed, in\r\n * which case, previous wrapping should be redo.\r\n */\nfunction constrainTextWidth(layout, availableWidth, forceRecalculate) {\n  if (forceRecalculate === void 0) {\n    forceRecalculate = false;\n  }\n  if (layout.labelStyleWidth != null) {\n    // User-defined style.width has the highest priority.\n    return;\n  }\n  var label = layout.label;\n  var style = label.style;\n  var textRect = layout.rect;\n  var bgColor = style.backgroundColor;\n  var padding = style.padding;\n  var paddingH = padding ? padding[1] + padding[3] : 0;\n  var overflow = style.overflow;\n  // textRect.width already contains paddingH if bgColor is set\n  var oldOuterWidth = textRect.width + (bgColor ? 0 : paddingH);\n  if (availableWidth < oldOuterWidth || forceRecalculate) {\n    var oldHeight = textRect.height;\n    if (overflow && overflow.match('break')) {\n      // Temporarily set background to be null to calculate\n      // the bounding box without background.\n      label.setStyle('backgroundColor', null);\n      // Set constraining width\n      label.setStyle('width', availableWidth - paddingH);\n      // This is the real bounding box of the text without padding.\n      var innerRect = label.getBoundingRect();\n      label.setStyle('width', Math.ceil(innerRect.width));\n      label.setStyle('backgroundColor', bgColor);\n    } else {\n      var availableInnerWidth = availableWidth - paddingH;\n      var newWidth = availableWidth < oldOuterWidth\n      // Current text is too wide, use `availableWidth` as max width.\n      ? availableInnerWidth :\n      // Current available width is enough, but the text may have\n      // already been wrapped with a smaller available width.\n      forceRecalculate ? availableInnerWidth > layout.unconstrainedWidth\n      // Current available is larger than text width,\n      // so don't constrain width (otherwise it may have\n      // empty space in the background).\n      ? null\n      // Current available is smaller than text width, so\n      // use the current available width as constraining\n      // width.\n      : availableInnerWidth\n      // Current available width is enough, so no need to\n      // constrain.\n      : null;\n      label.setStyle('width', newWidth);\n    }\n    var newRect = label.getBoundingRect();\n    textRect.width = newRect.width;\n    var margin = (label.style.margin || 0) + 2.1;\n    textRect.height = newRect.height + margin;\n    textRect.y -= (textRect.height - oldHeight) / 2;\n  }\n}\nfunction isPositionCenter(sectorShape) {\n  // Not change x for center label\n  return sectorShape.position === 'center';\n}\nexport default function pieLabelLayout(seriesModel) {\n  var data = seriesModel.getData();\n  var labelLayoutList = [];\n  var cx;\n  var cy;\n  var hasLabelRotate = false;\n  var minShowLabelRadian = (seriesModel.get('minShowLabelAngle') || 0) * RADIAN;\n  var viewRect = data.getLayout('viewRect');\n  var r = data.getLayout('r');\n  var viewWidth = viewRect.width;\n  var viewLeft = viewRect.x;\n  var viewTop = viewRect.y;\n  var viewHeight = viewRect.height;\n  function setNotShow(el) {\n    el.ignore = true;\n  }\n  function isLabelShown(label) {\n    if (!label.ignore) {\n      return true;\n    }\n    for (var key in label.states) {\n      if (label.states[key].ignore === false) {\n        return true;\n      }\n    }\n    return false;\n  }\n  data.each(function (idx) {\n    var sector = data.getItemGraphicEl(idx);\n    var sectorShape = sector.shape;\n    var label = sector.getTextContent();\n    var labelLine = sector.getTextGuideLine();\n    var itemModel = data.getItemModel(idx);\n    var labelModel = itemModel.getModel('label');\n    // Use position in normal or emphasis\n    var labelPosition = labelModel.get('position') || itemModel.get(['emphasis', 'label', 'position']);\n    var labelDistance = labelModel.get('distanceToLabelLine');\n    var labelAlignTo = labelModel.get('alignTo');\n    var edgeDistance = parsePercent(labelModel.get('edgeDistance'), viewWidth);\n    var bleedMargin = labelModel.get('bleedMargin');\n    var labelLineModel = itemModel.getModel('labelLine');\n    var labelLineLen = labelLineModel.get('length');\n    labelLineLen = parsePercent(labelLineLen, viewWidth);\n    var labelLineLen2 = labelLineModel.get('length2');\n    labelLineLen2 = parsePercent(labelLineLen2, viewWidth);\n    if (Math.abs(sectorShape.endAngle - sectorShape.startAngle) < minShowLabelRadian) {\n      each(label.states, setNotShow);\n      label.ignore = true;\n      if (labelLine) {\n        each(labelLine.states, setNotShow);\n        labelLine.ignore = true;\n      }\n      return;\n    }\n    if (!isLabelShown(label)) {\n      return;\n    }\n    var midAngle = (sectorShape.startAngle + sectorShape.endAngle) / 2;\n    var nx = Math.cos(midAngle);\n    var ny = Math.sin(midAngle);\n    var textX;\n    var textY;\n    var linePoints;\n    var textAlign;\n    cx = sectorShape.cx;\n    cy = sectorShape.cy;\n    var isLabelInside = labelPosition === 'inside' || labelPosition === 'inner';\n    if (labelPosition === 'center') {\n      textX = sectorShape.cx;\n      textY = sectorShape.cy;\n      textAlign = 'center';\n    } else {\n      var x1 = (isLabelInside ? (sectorShape.r + sectorShape.r0) / 2 * nx : sectorShape.r * nx) + cx;\n      var y1 = (isLabelInside ? (sectorShape.r + sectorShape.r0) / 2 * ny : sectorShape.r * ny) + cy;\n      textX = x1 + nx * 3;\n      textY = y1 + ny * 3;\n      if (!isLabelInside) {\n        // For roseType\n        var x2 = x1 + nx * (labelLineLen + r - sectorShape.r);\n        var y2 = y1 + ny * (labelLineLen + r - sectorShape.r);\n        var x3 = x2 + (nx < 0 ? -1 : 1) * labelLineLen2;\n        var y3 = y2;\n        if (labelAlignTo === 'edge') {\n          // Adjust textX because text align of edge is opposite\n          textX = nx < 0 ? viewLeft + edgeDistance : viewLeft + viewWidth - edgeDistance;\n        } else {\n          textX = x3 + (nx < 0 ? -labelDistance : labelDistance);\n        }\n        textY = y3;\n        linePoints = [[x1, y1], [x2, y2], [x3, y3]];\n      }\n      textAlign = isLabelInside ? 'center' : labelAlignTo === 'edge' ? nx > 0 ? 'right' : 'left' : nx > 0 ? 'left' : 'right';\n    }\n    var PI = Math.PI;\n    var labelRotate = 0;\n    var rotate = labelModel.get('rotate');\n    if (isNumber(rotate)) {\n      labelRotate = rotate * (PI / 180);\n    } else if (labelPosition === 'center') {\n      labelRotate = 0;\n    } else if (rotate === 'radial' || rotate === true) {\n      var radialAngle = nx < 0 ? -midAngle + PI : -midAngle;\n      labelRotate = radialAngle;\n    } else if (rotate === 'tangential' && labelPosition !== 'outside' && labelPosition !== 'outer') {\n      var rad = Math.atan2(nx, ny);\n      if (rad < 0) {\n        rad = PI * 2 + rad;\n      }\n      var isDown = ny > 0;\n      if (isDown) {\n        rad = PI + rad;\n      }\n      labelRotate = rad - PI;\n    }\n    hasLabelRotate = !!labelRotate;\n    label.x = textX;\n    label.y = textY;\n    label.rotation = labelRotate;\n    label.setStyle({\n      verticalAlign: 'middle'\n    });\n    // Not sectorShape the inside label\n    if (!isLabelInside) {\n      var textRect = label.getBoundingRect().clone();\n      textRect.applyTransform(label.getComputedTransform());\n      // Text has a default 1px stroke. Exclude this.\n      var margin = (label.style.margin || 0) + 2.1;\n      textRect.y -= margin / 2;\n      textRect.height += margin;\n      labelLayoutList.push({\n        label: label,\n        labelLine: labelLine,\n        position: labelPosition,\n        len: labelLineLen,\n        len2: labelLineLen2,\n        minTurnAngle: labelLineModel.get('minTurnAngle'),\n        maxSurfaceAngle: labelLineModel.get('maxSurfaceAngle'),\n        surfaceNormal: new Point(nx, ny),\n        linePoints: linePoints,\n        textAlign: textAlign,\n        labelDistance: labelDistance,\n        labelAlignTo: labelAlignTo,\n        edgeDistance: edgeDistance,\n        bleedMargin: bleedMargin,\n        rect: textRect,\n        unconstrainedWidth: textRect.width,\n        labelStyleWidth: label.style.width\n      });\n    } else {\n      label.setStyle({\n        align: textAlign\n      });\n      var selectState = label.states.select;\n      if (selectState) {\n        selectState.x += label.x;\n        selectState.y += label.y;\n      }\n    }\n    sector.setTextConfig({\n      inside: isLabelInside\n    });\n  });\n  if (!hasLabelRotate && seriesModel.get('avoidLabelOverlap')) {\n    avoidOverlap(labelLayoutList, cx, cy, r, viewWidth, viewHeight, viewLeft, viewTop);\n  }\n  for (var i = 0; i < labelLayoutList.length; i++) {\n    var layout = labelLayoutList[i];\n    var label = layout.label;\n    var labelLine = layout.labelLine;\n    var notShowLabel = isNaN(label.x) || isNaN(label.y);\n    if (label) {\n      label.setStyle({\n        align: layout.textAlign\n      });\n      if (notShowLabel) {\n        each(label.states, setNotShow);\n        label.ignore = true;\n      }\n      var selectState = label.states.select;\n      if (selectState) {\n        selectState.x += label.x;\n        selectState.y += label.y;\n      }\n    }\n    if (labelLine) {\n      var linePoints = layout.linePoints;\n      if (notShowLabel || !linePoints) {\n        each(labelLine.states, setNotShow);\n        labelLine.ignore = true;\n      } else {\n        limitTurnAngle(linePoints, layout.minTurnAngle);\n        limitSurfaceAngle(linePoints, layout.surfaceNormal, layout.maxSurfaceAngle);\n        labelLine.setShape({\n          points: linePoints\n        });\n        // Set the anchor to the midpoint of sector\n        label.__hostTarget.textGuideLineConfig = {\n          anchor: new Point(linePoints[0][0], linePoints[0][1])\n        };\n      }\n    }\n  }\n}","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { __extends } from \"tslib\";\nimport { extend, retrieve3 } from 'zrender/lib/core/util.js';\nimport * as graphic from '../../util/graphic.js';\nimport { setStatesStylesFromModel, toggleHoverEmphasis } from '../../util/states.js';\nimport ChartView from '../../view/Chart.js';\nimport labelLayout from './labelLayout.js';\nimport { setLabelLineStyle, getLabelLineStatesModels } from '../../label/labelGuideHelper.js';\nimport { setLabelStyle, getLabelStatesModels } from '../../label/labelStyle.js';\nimport { getSectorCornerRadius } from '../helper/sectorHelper.js';\nimport { saveOldStyle } from '../../animation/basicTransition.js';\nimport { getBasicPieLayout, getSeriesLayoutData } from './pieLayout.js';\n/**\r\n * Piece of pie including Sector, Label, LabelLine\r\n */\nvar PiePiece = /** @class */function (_super) {\n  __extends(PiePiece, _super);\n  function PiePiece(data, idx, startAngle) {\n    var _this = _super.call(this) || this;\n    _this.z2 = 2;\n    var text = new graphic.Text();\n    _this.setTextContent(text);\n    _this.updateData(data, idx, startAngle, true);\n    return _this;\n  }\n  PiePiece.prototype.updateData = function (data, idx, startAngle, firstCreate) {\n    var sector = this;\n    var seriesModel = data.hostModel;\n    var itemModel = data.getItemModel(idx);\n    var emphasisModel = itemModel.getModel('emphasis');\n    var layout = data.getItemLayout(idx);\n    // cornerRadius & innerCornerRadius doesn't exist in the item layout. Use `0` if null value is specified.\n    // see `setItemLayout` in `pieLayout.ts`.\n    var sectorShape = extend(getSectorCornerRadius(itemModel.getModel('itemStyle'), layout, true), layout);\n    // Ignore NaN data.\n    if (isNaN(sectorShape.startAngle)) {\n      // Use NaN shape to avoid drawing shape.\n      sector.setShape(sectorShape);\n      return;\n    }\n    if (firstCreate) {\n      sector.setShape(sectorShape);\n      var animationType = seriesModel.getShallow('animationType');\n      if (seriesModel.ecModel.ssr) {\n        // Use scale animation in SSR mode(opacity?)\n        // Because CSS SVG animation doesn't support very customized shape animation.\n        graphic.initProps(sector, {\n          scaleX: 0,\n          scaleY: 0\n        }, seriesModel, {\n          dataIndex: idx,\n          isFrom: true\n        });\n        sector.originX = sectorShape.cx;\n        sector.originY = sectorShape.cy;\n      } else if (animationType === 'scale') {\n        sector.shape.r = layout.r0;\n        graphic.initProps(sector, {\n          shape: {\n            r: layout.r\n          }\n        }, seriesModel, idx);\n      }\n      // Expansion\n      else {\n        if (startAngle != null) {\n          sector.setShape({\n            startAngle: startAngle,\n            endAngle: startAngle\n          });\n          graphic.initProps(sector, {\n            shape: {\n              startAngle: layout.startAngle,\n              endAngle: layout.endAngle\n            }\n          }, seriesModel, idx);\n        } else {\n          sector.shape.endAngle = layout.startAngle;\n          graphic.updateProps(sector, {\n            shape: {\n              endAngle: layout.endAngle\n            }\n          }, seriesModel, idx);\n        }\n      }\n    } else {\n      saveOldStyle(sector);\n      // Transition animation from the old shape\n      graphic.updateProps(sector, {\n        shape: sectorShape\n      }, seriesModel, idx);\n    }\n    sector.useStyle(data.getItemVisual(idx, 'style'));\n    setStatesStylesFromModel(sector, itemModel);\n    var midAngle = (layout.startAngle + layout.endAngle) / 2;\n    var offset = seriesModel.get('selectedOffset');\n    var dx = Math.cos(midAngle) * offset;\n    var dy = Math.sin(midAngle) * offset;\n    var cursorStyle = itemModel.getShallow('cursor');\n    cursorStyle && sector.attr('cursor', cursorStyle);\n    this._updateLabel(seriesModel, data, idx);\n    sector.ensureState('emphasis').shape = extend({\n      r: layout.r + (emphasisModel.get('scale') ? emphasisModel.get('scaleSize') || 0 : 0)\n    }, getSectorCornerRadius(emphasisModel.getModel('itemStyle'), layout));\n    extend(sector.ensureState('select'), {\n      x: dx,\n      y: dy,\n      shape: getSectorCornerRadius(itemModel.getModel(['select', 'itemStyle']), layout)\n    });\n    extend(sector.ensureState('blur'), {\n      shape: getSectorCornerRadius(itemModel.getModel(['blur', 'itemStyle']), layout)\n    });\n    var labelLine = sector.getTextGuideLine();\n    var labelText = sector.getTextContent();\n    labelLine && extend(labelLine.ensureState('select'), {\n      x: dx,\n      y: dy\n    });\n    // TODO: needs dx, dy in zrender?\n    extend(labelText.ensureState('select'), {\n      x: dx,\n      y: dy\n    });\n    toggleHoverEmphasis(this, emphasisModel.get('focus'), emphasisModel.get('blurScope'), emphasisModel.get('disabled'));\n  };\n  PiePiece.prototype._updateLabel = function (seriesModel, data, idx) {\n    var sector = this;\n    var itemModel = data.getItemModel(idx);\n    var labelLineModel = itemModel.getModel('labelLine');\n    var style = data.getItemVisual(idx, 'style');\n    var visualColor = style && style.fill;\n    var visualOpacity = style && style.opacity;\n    setLabelStyle(sector, getLabelStatesModels(itemModel), {\n      labelFetcher: data.hostModel,\n      labelDataIndex: idx,\n      inheritColor: visualColor,\n      defaultOpacity: visualOpacity,\n      defaultText: seriesModel.getFormattedLabel(idx, 'normal') || data.getName(idx)\n    });\n    var labelText = sector.getTextContent();\n    // Set textConfig on sector.\n    sector.setTextConfig({\n      // reset position, rotation\n      position: null,\n      rotation: null\n    });\n    // Make sure update style on labelText after setLabelStyle.\n    // Because setLabelStyle will replace a new style on it.\n    labelText.attr({\n      z2: 10\n    });\n    var labelPosition = seriesModel.get(['label', 'position']);\n    if (labelPosition !== 'outside' && labelPosition !== 'outer') {\n      sector.removeTextGuideLine();\n    } else {\n      var polyline = this.getTextGuideLine();\n      if (!polyline) {\n        polyline = new graphic.Polyline();\n        this.setTextGuideLine(polyline);\n      }\n      // Default use item visual color\n      setLabelLineStyle(this, getLabelLineStatesModels(itemModel), {\n        stroke: visualColor,\n        opacity: retrieve3(labelLineModel.get(['lineStyle', 'opacity']), visualOpacity, 1)\n      });\n    }\n  };\n  return PiePiece;\n}(graphic.Sector);\n// Pie view\nvar PieView = /** @class */function (_super) {\n  __extends(PieView, _super);\n  function PieView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.ignoreLabelLineUpdate = true;\n    return _this;\n  }\n  PieView.prototype.render = function (seriesModel, ecModel, api, payload) {\n    var data = seriesModel.getData();\n    var oldData = this._data;\n    var group = this.group;\n    var startAngle;\n    // First render\n    if (!oldData && data.count() > 0) {\n      var shape = data.getItemLayout(0);\n      for (var s = 1; isNaN(shape && shape.startAngle) && s < data.count(); ++s) {\n        shape = data.getItemLayout(s);\n      }\n      if (shape) {\n        startAngle = shape.startAngle;\n      }\n    }\n    // remove empty-circle if it exists\n    if (this._emptyCircleSector) {\n      group.remove(this._emptyCircleSector);\n    }\n    // when all data are filtered, show lightgray empty circle\n    if (data.count() === 0 && seriesModel.get('showEmptyCircle')) {\n      var layoutData = getSeriesLayoutData(seriesModel);\n      var sector = new graphic.Sector({\n        shape: extend(getBasicPieLayout(seriesModel, api), layoutData)\n      });\n      sector.useStyle(seriesModel.getModel('emptyCircleStyle').getItemStyle());\n      this._emptyCircleSector = sector;\n      group.add(sector);\n    }\n    data.diff(oldData).add(function (idx) {\n      var piePiece = new PiePiece(data, idx, startAngle);\n      data.setItemGraphicEl(idx, piePiece);\n      group.add(piePiece);\n    }).update(function (newIdx, oldIdx) {\n      var piePiece = oldData.getItemGraphicEl(oldIdx);\n      piePiece.updateData(data, newIdx, startAngle);\n      piePiece.off('click');\n      group.add(piePiece);\n      data.setItemGraphicEl(newIdx, piePiece);\n    }).remove(function (idx) {\n      var piePiece = oldData.getItemGraphicEl(idx);\n      graphic.removeElementWithFadeOut(piePiece, seriesModel, idx);\n    }).execute();\n    labelLayout(seriesModel);\n    // Always use initial animation.\n    if (seriesModel.get('animationTypeUpdate') !== 'expansion') {\n      this._data = data;\n    }\n  };\n  PieView.prototype.dispose = function () {};\n  PieView.prototype.containPoint = function (point, seriesModel) {\n    var data = seriesModel.getData();\n    var itemLayout = data.getItemLayout(0);\n    if (itemLayout) {\n      var dx = point[0] - itemLayout.cx;\n      var dy = point[1] - itemLayout.cy;\n      var radius = Math.sqrt(dx * dx + dy * dy);\n      return radius <= itemLayout.r && radius >= itemLayout.r0;\n    }\n  };\n  PieView.type = 'pie';\n  return PieView;\n}(ChartView);\nexport default PieView;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport prepareSeriesDataSchema from '../../data/helper/createDimensions.js';\nimport SeriesData from '../../data/SeriesData.js';\nimport { extend, isArray } from 'zrender/lib/core/util.js';\n/**\r\n * [Usage]:\r\n * (1)\r\n * createListSimply(seriesModel, ['value']);\r\n * (2)\r\n * createListSimply(seriesModel, {\r\n *     coordDimensions: ['value'],\r\n *     dimensionsCount: 5\r\n * });\r\n */\nexport default function createSeriesDataSimply(seriesModel, opt, nameList) {\n  opt = isArray(opt) && {\n    coordDimensions: opt\n  } || extend({\n    encodeDefine: seriesModel.getEncode()\n  }, opt);\n  var source = seriesModel.getSource();\n  var dimensions = prepareSeriesDataSchema(source, opt).dimensions;\n  var list = new SeriesData(dimensions, seriesModel);\n  list.initData(source, nameList);\n  return list;\n}","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\n/**\r\n * LegendVisualProvider is an bridge that pick encoded color from data and\r\n * provide to the legend component.\r\n */\nvar LegendVisualProvider = /** @class */function () {\n  function LegendVisualProvider(\n  // Function to get data after filtered. It stores all the encoding info\n  getDataWithEncodedVisual,\n  // Function to get raw data before filtered.\n  getRawData) {\n    this._getDataWithEncodedVisual = getDataWithEncodedVisual;\n    this._getRawData = getRawData;\n  }\n  LegendVisualProvider.prototype.getAllNames = function () {\n    var rawData = this._getRawData();\n    // We find the name from the raw data. In case it's filtered by the legend component.\n    // Normally, the name can be found in rawData, but can't be found in filtered data will display as gray.\n    return rawData.mapArray(rawData.getName);\n  };\n  LegendVisualProvider.prototype.containName = function (name) {\n    var rawData = this._getRawData();\n    return rawData.indexOfName(name) >= 0;\n  };\n  LegendVisualProvider.prototype.indexOfName = function (name) {\n    // Only get data when necessary.\n    // Because LegendVisualProvider constructor may be new in the stage that data is not prepared yet.\n    // Invoking Series#getData immediately will throw an error.\n    var dataWithEncodedVisual = this._getDataWithEncodedVisual();\n    return dataWithEncodedVisual.indexOfName(name);\n  };\n  LegendVisualProvider.prototype.getItemVisual = function (dataIndex, key) {\n    // Get encoded visual properties from final filtered data.\n    var dataWithEncodedVisual = this._getDataWithEncodedVisual();\n    return dataWithEncodedVisual.getItemVisual(dataIndex, key);\n  };\n  return LegendVisualProvider;\n}();\nexport default LegendVisualProvider;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { __extends } from \"tslib\";\nimport createSeriesDataSimply from '../helper/createSeriesDataSimply.js';\nimport * as zrUtil from 'zrender/lib/core/util.js';\nimport * as modelUtil from '../../util/model.js';\nimport { getPercentSeats } from '../../util/number.js';\nimport { makeSeriesEncodeForNameBased } from '../../data/helper/sourceHelper.js';\nimport LegendVisualProvider from '../../visual/LegendVisualProvider.js';\nimport SeriesModel from '../../model/Series.js';\nvar innerData = modelUtil.makeInner();\nvar PieSeriesModel = /** @class */function (_super) {\n  __extends(PieSeriesModel, _super);\n  function PieSeriesModel() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  /**\r\n   * @overwrite\r\n   */\n  PieSeriesModel.prototype.init = function (option) {\n    _super.prototype.init.apply(this, arguments);\n    // Enable legend selection for each data item\n    // Use a function instead of direct access because data reference may changed\n    this.legendVisualProvider = new LegendVisualProvider(zrUtil.bind(this.getData, this), zrUtil.bind(this.getRawData, this));\n    this._defaultLabelLine(option);\n  };\n  /**\r\n   * @overwrite\r\n   */\n  PieSeriesModel.prototype.mergeOption = function () {\n    _super.prototype.mergeOption.apply(this, arguments);\n  };\n  /**\r\n   * @overwrite\r\n   */\n  PieSeriesModel.prototype.getInitialData = function () {\n    return createSeriesDataSimply(this, {\n      coordDimensions: ['value'],\n      encodeDefaulter: zrUtil.curry(makeSeriesEncodeForNameBased, this)\n    });\n  };\n  /**\r\n   * @overwrite\r\n   */\n  PieSeriesModel.prototype.getDataParams = function (dataIndex) {\n    var data = this.getData();\n    // update seats when data is changed\n    var dataInner = innerData(data);\n    var seats = dataInner.seats;\n    if (!seats) {\n      var valueList_1 = [];\n      data.each(data.mapDimension('value'), function (value) {\n        valueList_1.push(value);\n      });\n      seats = dataInner.seats = getPercentSeats(valueList_1, data.hostModel.get('percentPrecision'));\n    }\n    var params = _super.prototype.getDataParams.call(this, dataIndex);\n    // seats may be empty when sum is 0\n    params.percent = seats[dataIndex] || 0;\n    params.$vars.push('percent');\n    return params;\n  };\n  PieSeriesModel.prototype._defaultLabelLine = function (option) {\n    // Extend labelLine emphasis\n    modelUtil.defaultEmphasis(option, 'labelLine', ['show']);\n    var labelLineNormalOpt = option.labelLine;\n    var labelLineEmphasisOpt = option.emphasis.labelLine;\n    // Not show label line if `label.normal.show = false`\n    labelLineNormalOpt.show = labelLineNormalOpt.show && option.label.show;\n    labelLineEmphasisOpt.show = labelLineEmphasisOpt.show && option.emphasis.label.show;\n  };\n  PieSeriesModel.type = 'series.pie';\n  PieSeriesModel.defaultOption = {\n    // zlevel: 0,\n    z: 2,\n    legendHoverLink: true,\n    colorBy: 'data',\n    // 默认全局居中\n    center: ['50%', '50%'],\n    radius: [0, '75%'],\n    // 默认顺时针\n    clockwise: true,\n    startAngle: 90,\n    endAngle: 'auto',\n    padAngle: 0,\n    // 最小角度改为0\n    minAngle: 0,\n    // If the angle of a sector less than `minShowLabelAngle`,\n    // the label will not be displayed.\n    minShowLabelAngle: 0,\n    // 选中时扇区偏移量\n    selectedOffset: 10,\n    // 选择模式，默认关闭，可选single，multiple\n    // selectedMode: false,\n    // 南丁格尔玫瑰图模式，'radius'（半径） | 'area'（面积）\n    // roseType: null,\n    percentPrecision: 2,\n    // If still show when all data zero.\n    stillShowZeroSum: true,\n    // cursor: null,\n    left: 0,\n    top: 0,\n    right: 0,\n    bottom: 0,\n    width: null,\n    height: null,\n    label: {\n      // color: 'inherit',\n      // If rotate around circle\n      rotate: 0,\n      show: true,\n      overflow: 'truncate',\n      // 'outer', 'inside', 'center'\n      position: 'outer',\n      // 'none', 'labelLine', 'edge'. Works only when position is 'outer'\n      alignTo: 'none',\n      // Closest distance between label and chart edge.\n      // Works only position is 'outer' and alignTo is 'edge'.\n      edgeDistance: '25%',\n      // Works only position is 'outer' and alignTo is not 'edge'.\n      bleedMargin: 10,\n      // Distance between text and label line.\n      distanceToLabelLine: 5\n      // formatter: 标签文本格式器，同 tooltip.formatter，不支持异步回调\n      // 默认使用全局文本样式，详见 textStyle\n      // distance: 当position为inner时有效，为label位置到圆心的距离与圆半径(环状图为内外半径和)的比例系数\n    },\n    // Enabled when label.normal.position is 'outer'\n    labelLine: {\n      show: true,\n      // 引导线两段中的第一段长度\n      length: 15,\n      // 引导线两段中的第二段长度\n      length2: 15,\n      smooth: false,\n      minTurnAngle: 90,\n      maxSurfaceAngle: 90,\n      lineStyle: {\n        // color: 各异,\n        width: 1,\n        type: 'solid'\n      }\n    },\n    itemStyle: {\n      borderWidth: 1,\n      borderJoin: 'round'\n    },\n    showEmptyCircle: true,\n    emptyCircleStyle: {\n      color: 'lightgray',\n      opacity: 1\n    },\n    labelLayout: {\n      // Hide the overlapped label.\n      hideOverlap: true\n    },\n    emphasis: {\n      scale: true,\n      scaleSize: 5\n    },\n    // If use strategy to avoid label overlapping\n    avoidLabelOverlap: true,\n    // Animation type. Valid values: expansion, scale\n    animationType: 'expansion',\n    animationDuration: 1000,\n    // Animation type when update. Valid values: transition, expansion\n    animationTypeUpdate: 'transition',\n    animationEasingUpdate: 'cubicInOut',\n    animationDurationUpdate: 500,\n    animationEasing: 'cubicInOut'\n  };\n  return PieSeriesModel;\n}(SeriesModel);\nexport default PieSeriesModel;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { isNumber } from 'zrender/lib/core/util.js';\nexport default function negativeDataFilter(seriesType) {\n  return {\n    seriesType: seriesType,\n    reset: function (seriesModel, ecModel) {\n      var data = seriesModel.getData();\n      data.filterSelf(function (idx) {\n        // handle negative value condition\n        var valueDim = data.mapDimension('value');\n        var curValue = data.get(valueDim, idx);\n        if (isNumber(curValue) && !isNaN(curValue) && curValue < 0) {\n          return false;\n        }\n        return true;\n      });\n    }\n  };\n}","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\r\n* Licensed to the Apache Software Foundation (ASF) under one\r\n* or more contributor license agreements.  See the NOTICE file\r\n* distributed with this work for additional information\r\n* regarding copyright ownership.  The ASF licenses this file\r\n* to you under the Apache License, Version 2.0 (the\r\n* \"License\"); you may not use this file except in compliance\r\n* with the License.  You may obtain a copy of the License at\r\n*\r\n*   http://www.apache.org/licenses/LICENSE-2.0\r\n*\r\n* Unless required by applicable law or agreed to in writing,\r\n* software distributed under the License is distributed on an\r\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n* KIND, either express or implied.  See the License for the\r\n* specific language governing permissions and limitations\r\n* under the License.\r\n*/\nimport { createLegacyDataSelectAction } from '../../legacy/dataSelectAction.js';\nimport pieLayout from '../pie/pieLayout.js';\nimport dataFilter from '../../processor/dataFilter.js';\nimport { curry } from 'zrender/lib/core/util.js';\nimport PieView from './PieView.js';\nimport PieSeriesModel from './PieSeries.js';\nimport negativeDataFilter from '../../processor/negativeDataFilter.js';\nexport function install(registers) {\n  registers.registerChartView(PieView);\n  registers.registerSeriesModel(PieSeriesModel);\n  createLegacyDataSelectAction('pie', registers.registerAction);\n  registers.registerLayout(curry(pieLayout, 'pie'));\n  registers.registerProcessor(dataFilter('pie'));\n  registers.registerProcessor(negativeDataFilter('pie'));\n}","import { unref as _unref, createVNode as _createVNode, resolveDirective as _resolveDirective, openBlock as _openBlock, createElementBlock as _createElementBlock, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-pie-card\"\n};\nconst _hoisted_2 = {\n  class: \"u-pie\"\n};\nconst _hoisted_3 = {\n  class: \"m-pie-info\"\n};\nconst _hoisted_4 = {\n  class: \"u-title\"\n};\nconst _hoisted_5 = {\n  class: \"u-value\"\n};\nimport VChart from \"vue-echarts\";\nimport { use } from \"echarts/core\";\nimport \"echarts/lib/component/title\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nimport { CanvasRenderer } from \"echarts/renderers\";\nimport { PieChart } from \"echarts/charts\";\nimport { TooltipComponent } from \"echarts/components\";\nimport { toRefs, ref, watchPostEffect } from \"vue\";\nimport { displayDigits, displayPercent } from \"@/utils/jcl/commonNoStore\";\nimport { usePve } from \"@/pages/jcl/store_pve.js\";\nimport { useStore } from \"@/pages/jcl/store\";\nexport default {\n  __name: 'entity_card_chart',\n  props: {\n    type: {\n      type: String,\n      required: true\n    }\n  },\n  setup(__props) {\n    use([CanvasRenderer, PieChart, TooltipComponent]);\n    const props = __props;\n    const tabs = [{\n      name: \"damage\",\n      title: \"伤害\"\n    }, {\n      name: \"treat\",\n      title: \"治疗\"\n    }, {\n      name: \"beDamaged\",\n      title: \"承伤\"\n    }, {\n      name: \"beTreated\",\n      title: \"承疗\"\n    }];\n    const title = computed(() => {\n      return tabs.find(tab => tab.name === props.type).title || \"-\";\n    });\n    // data\n    const loading = ref(false);\n    const {\n      entity\n    } = toRefs(usePve());\n    const option = computed(() => {\n      const overviewValue = overview.value.value || \"0\";\n      const value = overviewValue ? parseInt(overviewValue.replace(/,/g, \"\"), 10) : 0;\n      const total = totalValue.value - value;\n      const percentage = value ? (value / total * 100).toFixed(2) : \"0.00\";\n      return {\n        backgroundColor: \"#282828\",\n        title: {\n          text: `${percentage}`,\n          x: \"center\",\n          y: \"center\",\n          textStyle: {\n            fontSize: \"14px\",\n            fontWeight: \"normal\",\n            color: \"#fff\"\n          }\n        },\n        tooltip: {\n          trigger: \"item\",\n          formatter: \"{a} <br/>{b} : {c} ({d}%)\"\n        },\n        series: [{\n          name: \"数值占比\",\n          type: \"pie\",\n          radius: [\"50%\", \"90%\"],\n          center: [\"50%\", \"50%\"],\n          data: [{\n            value: total,\n            name: `团队${title.value}`,\n            itemStyle: {\n              color: \"#404040\"\n            }\n          }, {\n            value: value,\n            name: `单位${title.value}`,\n            itemStyle: {\n              color: \"#FF69B4\"\n            }\n          }],\n          label: {\n            show: false\n          },\n          labelLine: {\n            show: false\n          },\n          itemStyle: {\n            borderRadius: 5,\n            borderWidth: 2,\n            borderColor: \"#282828\"\n          }\n        }]\n      };\n    });\n    const store = useStore();\n    const totalValue = computed(() => {\n      const {\n        stats,\n        entities\n      } = store.result;\n      if (!entities) return [];\n      // 求目标NPC，应该是承伤最高的那个\n      for (let entity in stats.beDamaged) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") continue;\n      }\n      // 求全团伤害\n      let totalDamage = 0;\n      let totalTreat = 0;\n      let totalBeDamaged = 0;\n      let totalBeTreat = 0;\n      for (let entity in stats.damage) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") {\n          totalDamage += stats.damage[entity].value;\n        }\n      }\n      for (let entity in stats.treat) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") {\n          totalTreat += stats.treat[entity].value;\n        }\n      }\n      for (let entity in stats.beDamaged) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") {\n          totalBeDamaged += stats.beDamaged[entity].value;\n        }\n      }\n      for (let entity in stats.beTreated) {\n        if (!entities[entity]) continue;\n        if (entities[entity].type === \"player\") {\n          var _stats$beTreated$enti;\n          totalBeTreat += ((_stats$beTreated$enti = stats.beTreated[entity]) === null || _stats$beTreated$enti === void 0 ? void 0 : _stats$beTreated$enti.value) ?? 0;\n        }\n      }\n      switch (props.type) {\n        case \"damage\":\n          return totalDamage;\n        case \"treat\":\n          return totalTreat;\n        case \"beDamaged\":\n          return totalBeDamaged;\n        case \"beTreated\":\n          return totalBeTreat;\n        default:\n          break;\n      }\n    });\n    const overview = ref([]);\n    const echart = ref(null);\n    const updateData = () => {\n      loading.value = true;\n      getWorkerResponse(\"get_pve_entity_stat_chart\", {\n        entity: entity.value,\n        entityTab: props.type\n      }).then(data => {\n        overview.value = data.overview;\n        loading.value = false;\n      });\n    };\n    watchPostEffect(updateData);\n    return (_ctx, _cache) => {\n      const _directive_loading = _resolveDirective(\"loading\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode(_unref(VChart), {\n        ref_key: \"echart\",\n        ref: echart,\n        theme: \"dark\",\n        option: _unref(option),\n        autoresize: \"\"\n      }, null, 8, [\"option\"])])), [[_directive_loading, loading.value]]), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"p\", _hoisted_4, \"总\" + _toDisplayString(_unref(title)), 1), _createElementVNode(\"p\", _hoisted_5, _toDisplayString(overview.value.value || \"-\"), 1), _createElementVNode(\"p\", null, _toDisplayString(_unref(displayDigits)(overview.value.vps)) + \"/s 会心 \" + _toDisplayString(_unref(displayPercent)(overview.value.critRate)), 1)])]);\n    };\n  }\n};","import script from \"./entity_card_chart.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_card_chart.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_card_chart.vue?vue&type=style&index=0&id=3f400fc2&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3f400fc2\"]])\n\nexport default __exports__","import { unref as _unref, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-card-list\"\n};\nconst _hoisted_2 = {\n  class: \"w-card m-card-item\"\n};\nconst _hoisted_3 = {\n  class: \"m-player\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = [\"title\"];\nconst _hoisted_6 = {\n  class: \"m-card-info\"\n};\nconst _hoisted_7 = {\n  class: \"u-value\"\n};\nconst _hoisted_8 = {\n  class: \"u-value\"\n};\nconst _hoisted_9 = {\n  class: \"w-card m-card-item\"\n};\nconst _hoisted_10 = {\n  class: \"w-card m-card-item\"\n};\nconst _hoisted_11 = {\n  class: \"w-card m-card-item\"\n};\nconst _hoisted_12 = {\n  class: \"w-card m-card-item\"\n};\nimport { getMountIcon, getEntityName, getEntity } from \"@/utils/jcl/common\";\nimport EntityCardChart from \"./entity_card_chart.vue\";\nimport { watchPostEffect } from \"vue\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { displayDuration } from \"@/utils/jcl/commonNoStore\";\nexport default {\n  __name: 'detail_info',\n  setup(__props) {\n    const {\n      entity\n    } = toRefs(usePve());\n    // const { end } = store.result;\n\n    const entityInfo = computed(() => {\n      return getEntity(entity.value);\n    });\n\n    // 总时长\n    // const totalDuration = ref(0);\n    // 战斗时长\n    const fightDuration = ref(0);\n    const updateData = () => {\n      getWorkerResponse(\"get_pve_entity_stat_chart\", {\n        entity: entity.value,\n        entityTab: \"beDamaged\"\n      }).then(data => {\n        fightDuration.value = data.overview.duration;\n      });\n    };\n    watchPostEffect(updateData);\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"p\", _hoisted_3, [_createElementVNode(\"img\", {\n        class: \"u-mount-icon\",\n        src: _unref(getMountIcon)(_unref(entity)),\n        alt: \"心法\"\n      }, null, 8, _hoisted_4), _createElementVNode(\"span\", {\n        class: \"u-name\",\n        title: _unref(getEntityName)(_unref(entity), {\n          showRegion: true\n        })\n      }, _toDisplayString(_unref(getEntityName)(_unref(entity))), 9, _hoisted_5)]), _createElementVNode(\"ul\", _hoisted_6, [_createElementVNode(\"li\", null, [_cache[0] || (_cache[0] = _createElementVNode(\"span\", {\n        class: \"u-lable\"\n      }, \"类型：\", -1)), _createElementVNode(\"span\", _hoisted_7, _toDisplayString(_unref(entityInfo).type == \"player\" ? \"玩家 \" : \"NPC\") + \" (\" + _toDisplayString(_unref(entityInfo).id) + \")\", 1)]), _createElementVNode(\"li\", null, [_cache[1] || (_cache[1] = _createElementVNode(\"span\", {\n        class: \"u-lable\"\n      }, \"参战时长：\", -1)), _createElementVNode(\"span\", _hoisted_8, _toDisplayString(_unref(displayDuration)(_unref(fightDuration)) || \"-\") + \" (\" + _toDisplayString(_unref(fightDuration) ? \"100%\" : \"-\") + \"%)\", 1)])])]), _createElementVNode(\"div\", _hoisted_9, [_createVNode(EntityCardChart, {\n        type: \"damage\"\n      })]), _createElementVNode(\"div\", _hoisted_10, [_createVNode(EntityCardChart, {\n        type: \"treat\"\n      })]), _createElementVNode(\"div\", _hoisted_11, [_createVNode(EntityCardChart, {\n        type: \"beDamaged\"\n      })]), _createElementVNode(\"div\", _hoisted_12, [_createVNode(EntityCardChart, {\n        type: \"beTreated\"\n      })])]);\n    };\n  }\n};","import script from \"./detail_info.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./detail_info.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./detail_info.vue?vue&type=style&index=0&id=272d8d0e&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-272d8d0e\"]])\n\nexport default __exports__","import \"core-js/modules/es.array.push.js\";\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, Fragment as _Fragment, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-entity-skill-log w-card\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"w-card-title\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"w-card-title\"\n};\nconst _hoisted_4 = {\n  class: \"u-light\"\n};\nconst _hoisted_5 = {\n  key: 2,\n  class: \"w-card-title\"\n};\nconst _hoisted_6 = {\n  class: \"u-effect-icon\"\n};\nconst _hoisted_7 = [\"src\"];\nimport EmptyGuide from \"@/components/jcl/common/empty_guide.vue\";\nimport { displayDigits } from \"@/utils/jcl/commonNoStore\";\nimport { getResource, getEntityName, getResourceIcon } from \"@/utils/jcl/common\";\nimport { computed, toRefs } from \"vue\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\n// data\n\nexport default {\n  __name: 'entity_view_log',\n  setup(__props) {\n    const {\n      viewType,\n      target,\n      effect,\n      targetLogs,\n      targetLog,\n      effectLogs,\n      effectLog\n    } = toRefs(usePve());\n    const pageSize = ref(8);\n    // computed\n    const titleName = computed(() => {\n      if (viewType.value === \"target\") {\n        return `${getEntityName(target.value)}`;\n      } else if (viewType.value === \"effect\") {\n        const resource = getResource(effect.value);\n        return `${resource.name ?? resource.remark}`;\n      } else return \"\";\n    });\n    const data = computed(() => {\n      const source = [];\n      if (viewType.value === \"target\") source.push(...targetLogs.value);else if (viewType.value === \"effect\") source.push(...effectLogs.value);\n      if (!source.length) return [];\n      let index = 0;\n      for (let log of source) {\n        log.index = ++index;\n      }\n      return source;\n    });\n    const {\n      total,\n      currentPage,\n      currentData\n    } = usePaginate(data, pageSize);\n    const selectLog = row => {\n      if (viewType.value === \"target\") targetLog.value = row;else if (viewType.value === \"effect\") effectLog.value = row;\n    };\n    const rowClass = ({\n      row\n    }) => {\n      if (viewType.value === \"target\") {\n        var _targetLog$value;\n        if (row.index === ((_targetLog$value = targetLog.value) === null || _targetLog$value === void 0 ? void 0 : _targetLog$value.index)) return \"is-focus\";\n      } else if (viewType.value === \"effect\") {\n        var _effectLog$value;\n        if (row.index === ((_effectLog$value = effectLog.value) === null || _effectLog$value === void 0 ? void 0 : _effectLog$value.index)) return \"is-focus\";\n      }\n    };\n    return (_ctx, _cache) => {\n      const _component_el_table_column = _resolveComponent(\"el-table-column\");\n      const _component_el_table = _resolveComponent(\"el-table\");\n      const _component_el_pagination = _resolveComponent(\"el-pagination\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_unref(currentData).length === 0 ? (_openBlock(), _createElementBlock(_Fragment, {\n        key: 0\n      }, [_unref(viewType) === 'effect' ? (_openBlock(), _createBlock(EmptyGuide, {\n        key: 0,\n        rotate: -90,\n        tips: ['在左侧选择一个技能后', '此处会展示该技能的所有释放记录']\n      })) : _createCommentVNode(\"\", true), _unref(viewType) === 'target' ? (_openBlock(), _createBlock(EmptyGuide, {\n        key: 1,\n        \"text-align\": \"left\",\n        position: \"flex-start\",\n        rotate: -90,\n        to: \"row\",\n        grow: false,\n        tips: ['在左侧选择一个目标后', '此处会展示对目标施展的所有技能']\n      })) : _createCommentVNode(\"\", true)], 64)) : (_openBlock(), _createElementBlock(_Fragment, {\n        key: 1\n      }, [_unref(viewType) === 'target' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString(titleName.value), 1)) : _unref(viewType) === 'effect' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createElementVNode(\"span\", _hoisted_4, _toDisplayString(titleName.value), 1)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \"-\")), _createVNode(_component_el_table, {\n        class: \"u-table w-table\",\n        data: _unref(currentData),\n        border: false,\n        \"row-class-name\": rowClass,\n        onRowClick: selectLog\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_table_column, {\n          prop: \"index\",\n          width: \"50\",\n          label: \"#\",\n          align: \"center\"\n        }), _createVNode(_component_el_table_column, {\n          label: \"时间\",\n          width: \"75\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"span\", null, _toDisplayString(_unref(displayDigits)(row.micro / 1000) + \"s\"), 1)]),\n          _: 1\n        }), _unref(viewType) === 'target' ? (_openBlock(), _createBlock(_component_el_table_column, {\n          key: 0,\n          label: \"图标\",\n          align: \"center\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"img\", {\n            src: _unref(getResourceIcon)(row.effect),\n            alt: \"\"\n          }, null, 8, _hoisted_7)])]),\n          _: 1\n        })) : _createCommentVNode(\"\", true), _unref(viewType) === 'effect' ? (_openBlock(), _createBlock(_component_el_table_column, {\n          key: 1,\n          label: \"目标\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"span\", null, _toDisplayString(_unref(getEntityName)(row.target)), 1)]),\n          _: 1\n        })) : _createCommentVNode(\"\", true), _createVNode(_component_el_table_column, {\n          width: \"75\",\n          label: \"实际数值\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"span\", null, _toDisplayString(row.value), 1)]),\n          _: 1\n        })]),\n        _: 1\n      }, 8, [\"data\"]), _createVNode(_component_el_pagination, {\n        class: \"w-pagination\",\n        small: \"\",\n        background: \"\",\n        layout: \"pager\",\n        \"page-size\": _unref(pageSize),\n        total: _unref(total),\n        \"hide-on-single-page\": true,\n        \"current-page\": _unref(currentPage),\n        \"onUpdate:currentPage\": _cache[0] || (_cache[0] = $event => currentPage.value = $event)\n      }, null, 8, [\"page-size\", \"total\", \"current-page\"])], 64))]);\n    };\n  }\n};","import script from \"./entity_view_log.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_view_log.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_view_log.vue?vue&type=style&index=0&id=b2a978b8&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b2a978b8\"]])\n\nexport default __exports__","import { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, Fragment as _Fragment, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, resolveComponent as _resolveComponent, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"w-card\"\n};\nconst _hoisted_2 = {\n  key: 1,\n  class: \"m-entity-skill-wrap\"\n};\nconst _hoisted_3 = {\n  class: \"w-card-title\"\n};\nconst _hoisted_4 = {\n  class: \"m-entity-skill-detail\"\n};\nconst _hoisted_5 = {\n  class: \"u-left\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"u-effect-infos\"\n};\nconst _hoisted_7 = {\n  class: \"u-effect-info\"\n};\nconst _hoisted_8 = [\"src\"];\nconst _hoisted_9 = {\n  class: \"u-effect-info\"\n};\nconst _hoisted_10 = [\"src\"];\nconst _hoisted_11 = [\"title\"];\nconst _hoisted_12 = {\n  class: \"u-effect-info\"\n};\nconst _hoisted_13 = {\n  class: \"u-effect-info\"\n};\nconst _hoisted_14 = {\n  class: \"u-effect-info\"\n};\nconst _hoisted_15 = [\"src\"];\nconst _hoisted_16 = [\"title\"];\nconst _hoisted_17 = {\n  class: \"u-effect-info\"\n};\nconst _hoisted_18 = {\n  key: 0\n};\nconst _hoisted_19 = {\n  key: 1\n};\nconst _hoisted_20 = {\n  class: \"u-right w-card\"\n};\nconst _hoisted_21 = {\n  class: \"u-buff-list\"\n};\nconst _hoisted_22 = [\"title\"];\nconst _hoisted_23 = [\"src\"];\nconst _hoisted_24 = {\n  class: \"u-buff-stack\"\n};\nconst _hoisted_25 = {\n  class: \"u-buff-name\"\n};\nimport EmptyGuide from \"@/components/jcl/common/empty_guide.vue\";\nimport { getEntityName, getResourceIcon, getResourceName, getMountIcon } from \"@/utils/jcl/common\";\nimport { displayDigits } from \"@/utils/jcl/commonNoStore\";\nimport { computed, toRefs } from \"vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nexport default {\n  __name: 'entity_view_log_detail',\n  setup(__props) {\n    const {\n      viewType,\n      effectLog,\n      targetLog\n    } = toRefs(usePve());\n    const pageSize = ref(20);\n    const detail = computed(() => {\n      if (viewType.value === \"effect\") return effectLog.value;\n      if (viewType.value === \"target\") return targetLog.value;\n      return null;\n    });\n    const buffs = computed(() => {\n      if (!detail.value) return [];\n      return detail.value.buffs;\n    });\n    const {\n      total,\n      currentPage,\n      currentData\n    } = usePaginate(buffs, pageSize);\n    return (_ctx, _cache) => {\n      const _component_el_pagination = _resolveComponent(\"el-pagination\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [!detail.value ? (_openBlock(), _createElementBlock(_Fragment, {\n        key: 0\n      }, [_unref(viewType) === 'effect' ? (_openBlock(), _createBlock(EmptyGuide, {\n        key: 0,\n        rotate: -90,\n        tips: ['在左侧选择一个目标后', '此处会展示对目标施展的所有技能']\n      })) : _unref(viewType) === 'target' ? (_openBlock(), _createBlock(EmptyGuide, {\n        key: 1,\n        to: \"row-reverse\",\n        rotate: 90,\n        \"text-align\": \"right\",\n        tips: ['在右侧选择一个目标后', '此处会展示该次技能释放的所有详细数据']\n      })) : _createCommentVNode(\"\", true)], 64)) : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, \" 第\" + _toDisplayString(detail.value.index) + \"次 \" + _toDisplayString(_unref(getResourceName)(detail.value.effect, {\n        showID: false\n      })), 1), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [detail.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"div\", _hoisted_7, [_cache[1] || (_cache[1] = _createElementVNode(\"span\", null, \"招式：\", -1)), _createElementVNode(\"img\", {\n        src: _unref(getResourceIcon)(detail.value.effect)\n      }, null, 8, _hoisted_8), _createElementVNode(\"span\", null, _toDisplayString(_unref(getResourceName)(detail.value.effect, {\n        showID: false\n      })), 1)]), _createElementVNode(\"div\", _hoisted_9, [_cache[2] || (_cache[2] = _createElementVNode(\"span\", null, \"来源：\", -1)), _createElementVNode(\"img\", {\n        src: _unref(getMountIcon)(detail.value.caster)\n      }, null, 8, _hoisted_10), _createElementVNode(\"span\", {\n        title: _unref(getEntityName)(detail.value.caster, {\n          showRegion: true\n        })\n      }, _toDisplayString(_unref(getEntityName)(detail.value.caster)), 9, _hoisted_11)]), _createElementVNode(\"div\", _hoisted_12, [_cache[3] || (_cache[3] = _createElementVNode(\"span\", null, \"施展时间：\", -1)), _createElementVNode(\"span\", null, _toDisplayString(_unref(displayDigits)(detail.value.micro / 1000)) + \" s\", 1)]), _createElementVNode(\"div\", _hoisted_13, [_cache[4] || (_cache[4] = _createElementVNode(\"span\", null, \"实际数值：\", -1)), _createElementVNode(\"span\", null, _toDisplayString(detail.value.value), 1)]), _createElementVNode(\"div\", _hoisted_14, [_cache[5] || (_cache[5] = _createElementVNode(\"span\", null, \"目标：\", -1)), _createElementVNode(\"img\", {\n        src: _unref(getMountIcon)(detail.value.target)\n      }, null, 8, _hoisted_15), _createElementVNode(\"span\", {\n        title: _unref(getEntityName)(detail.value.target, {\n          showRegion: true\n        })\n      }, _toDisplayString(_unref(getEntityName)(detail.value.target)), 9, _hoisted_16)]), _createElementVNode(\"div\", _hoisted_17, [_cache[6] || (_cache[6] = _createElementVNode(\"span\", null, \"备注：\", -1)), detail.value.isCritical ? (_openBlock(), _createElementBlock(\"span\", _hoisted_18, \"会心\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_19, \" - \"))])])) : _createCommentVNode(\"\", true)]), _createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"div\", _hoisted_21, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(currentData), (buff, index) => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: index,\n          class: \"u-buff\",\n          title: _unref(getResourceName)('buff:' + buff.split('*')[0], {\n            showID: _ctx.tue\n          })\n        }, [_createElementVNode(\"img\", {\n          class: \"u-buff-icon\",\n          src: _unref(getResourceIcon)('buff:' + buff.split('*')[0])\n        }, null, 8, _hoisted_23), _createElementVNode(\"span\", _hoisted_24, _toDisplayString(buff.split(\"*\")[1]), 1), _createElementVNode(\"span\", _hoisted_25, _toDisplayString(_unref(getResourceName)(\"buff:\" + buff.split(\"*\")[0], {\n          showID: false\n        })), 1)], 8, _hoisted_22);\n      }), 128))]), _createVNode(_component_el_pagination, {\n        class: \"w-pagination\",\n        small: \"\",\n        background: \"\",\n        layout: \"pager\",\n        \"page-size\": _unref(pageSize),\n        total: _unref(total),\n        \"hide-on-single-page\": true,\n        \"current-page\": _unref(currentPage),\n        \"onUpdate:currentPage\": _cache[0] || (_cache[0] = $event => currentPage.value = $event)\n      }, null, 8, [\"page-size\", \"total\", \"current-page\"])])])]))]);\n    };\n  }\n};","import script from \"./entity_view_log_detail.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_view_log_detail.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_view_log_detail.vue?vue&type=style&index=0&id=ffa4e3de&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ffa4e3de\"]])\n\nexport default __exports__","import { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, Fragment as _Fragment, createElementBlock as _createElementBlock, resolveDirective as _resolveDirective, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-entity-view-effect\"\n};\nconst _hoisted_2 = {\n  class: \"u-left w-card\"\n};\nconst _hoisted_3 = {\n  class: \"w-card-title\"\n};\nconst _hoisted_4 = {\n  class: \"u-filters\"\n};\nconst _hoisted_5 = {\n  class: \"u-effect-title\"\n};\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = [\"title\"];\nconst _hoisted_8 = {\n  class: \"u-effect-title\"\n};\nconst _hoisted_9 = [\"src\"];\nconst _hoisted_10 = [\"title\"];\nconst _hoisted_11 = {\n  class: \"u-right\"\n};\nimport EmptyGuide from \"@/components/jcl/common/empty_guide.vue\";\nimport { ref, watch, toRefs, toRaw } from \"vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { getResourceIcon, getResourceName } from \"@/utils/jcl/common\";\nimport { displayDigits, displayPercent } from \"@/utils/jcl/commonNoStore\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nimport { getMountIcon, getEntityName } from \"@/utils/jcl/common\";\nimport EntitySkillLog from \"./entity_view_log.vue\";\nimport EntitySkillLogDetail from \"./entity_view_log_detail.vue\";\n// 注入的属性\n\nexport default {\n  __name: 'entity_view_effect',\n  setup(__props) {\n    const {\n      entityTab,\n      viewType,\n      entity,\n      entityTimeRange,\n      effect,\n      effectLogs,\n      effectLog,\n      target,\n      targetLog,\n      targetLogs\n    } = toRefs(usePve());\n\n    // 行点击事件\n    const click = row => {\n      if (viewType.value == \"target\") {\n        if (target.value === row.target) return;\n        target.value = row.target;\n        targetLogs.value = row.logs;\n        targetLog.value = row.logs[0];\n      } else {\n        if (effect.value === row.effect) return;\n        effect.value = row.effect;\n        effectLogs.value = row.logs;\n        effectLog.value = row.logs[0];\n      }\n    };\n\n    // computed\n    const targetLabel = computed(() => {\n      return viewType.value == \"target\" ? \"目标\" : \"招式\";\n    });\n\n    // 行样式\n    const rowClass = ({\n      row\n    }) => {\n      if (viewType.value == \"effect\") {\n        return effect.value === row.effect ? \"is-focus\" : \"\";\n      } else {\n        return target.value === row.target ? \"is-focus\" : \"\";\n      }\n    };\n    // 数据相关\n    const loading = ref(false);\n    const data = ref([]);\n    const pageSize = ref(8);\n    const {\n      currentPage,\n      currentData,\n      total\n    } = usePaginate(data, pageSize);\n\n    // 数据更新逻辑\n    const updateData = () => {\n      loading.value = true;\n      data.value = [];\n      const fun = viewType.value === \"effect\" ? \"get_pve_entity_view_effect\" : \"get_pve_entity_view_target\";\n      getWorkerResponse(fun, {\n        entityTab: entityTab.value,\n        entity: entity.value,\n        timeRange: toRaw(entityTimeRange.value[entity.value]),\n        skipNoNameTarget: true\n      }).then(result => {\n        data.value = result;\n        loading.value = false;\n        sort({\n          prop: \"value\",\n          order: \"descending\"\n        });\n      });\n    };\n    const sort = ({\n      prop,\n      order\n    }) => {\n      data.value = data.value.sort((a, b) => {\n        if (order === \"ascending\") {\n          return a[prop] - b[prop];\n        } else {\n          return b[prop] - a[prop];\n        }\n      });\n      let index = 1;\n      for (let item of data.value) {\n        item.index = index++;\n      }\n    };\n    watch([entity, () => entityTimeRange.value[entity.value], entityTab, viewType], ([newEntity], [oldEntity]) => {\n      if (oldEntity && newEntity !== oldEntity) clearLogs();\n      updateData();\n    }, {\n      immediate: true,\n      flush: \"post\"\n    });\n    const clearLogs = () => {\n      effect.value = null;\n      effectLogs.value = [];\n      effectLog.value = null;\n      target.value = null;\n      targetLogs.value = [];\n      targetLog.value = null;\n      if (data.value.length) {\n        click(data.value[0]);\n      }\n    };\n    watch(() => data.value, clearLogs, {\n      flush: \"post\"\n    });\n    return (_ctx, _cache) => {\n      const _component_el_table_column = _resolveComponent(\"el-table-column\");\n      const _component_el_table = _resolveComponent(\"el-table\");\n      const _component_el_pagination = _resolveComponent(\"el-pagination\");\n      const _directive_loading = _resolveDirective(\"loading\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_unref(currentData).length === 0 ? (_openBlock(), _createBlock(EmptyGuide, {\n        key: 0,\n        \"text-align\": \"left\",\n        to: \"row\",\n        position: \"flex-start\",\n        grow: false,\n        tips: ['在上方选择一个单位后', '此处会展示该单位的详细技能数']\n      })) : (_openBlock(), _createElementBlock(_Fragment, {\n        key: 1\n      }, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"span\", null, _toDisplayString(_unref(targetLabel)) + \"列表\", 1), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", {\n        class: _normalizeClass([\"u-tab\", {\n          'is-active': _unref(viewType) == 'effect'\n        }]),\n        onClick: _cache[0] || (_cache[0] = $event => viewType.value = 'effect')\n      }, \" 技能 \", 2), _createElementVNode(\"div\", {\n        class: _normalizeClass([\"u-tab\", {\n          'is-active': _unref(viewType) == 'target'\n        }]),\n        onClick: _cache[1] || (_cache[1] = $event => viewType.value = 'target')\n      }, \" 目标 \", 2)])]), _createVNode(_component_el_table, {\n        class: \"u-table w-table\",\n        data: _unref(currentData),\n        border: false,\n        onSortChange: sort,\n        onRowClick: click,\n        \"row-class-name\": rowClass\n      }, {\n        default: _withCtx(() => [_unref(viewType) == 'target' ? (_openBlock(), _createBlock(_component_el_table_column, {\n          key: 0,\n          label: _unref(targetLabel),\n          width: \"112\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"img\", {\n            class: \"u-effect-icon\",\n            src: _unref(getMountIcon)(row.target),\n            alt: \"\"\n          }, null, 8, _hoisted_6), _createElementVNode(\"span\", {\n            class: \"u-effect-name\",\n            title: _unref(getEntityName)(row.target, {\n              showRegion: true\n            })\n          }, _toDisplayString(_unref(getEntityName)(row.target)), 9, _hoisted_7)])]),\n          _: 1\n        }, 8, [\"label\"])) : (_openBlock(), _createBlock(_component_el_table_column, {\n          key: 1,\n          label: \"招式\",\n          width: \"130\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"img\", {\n            class: \"u-effect-icon\",\n            src: _unref(getResourceIcon)(row.effect),\n            alt: \"\"\n          }, null, 8, _hoisted_9), _createElementVNode(\"span\", {\n            class: \"u-effect-name\",\n            title: _unref(getResourceName)(row.effect, {\n              showID: true\n            })\n          }, _toDisplayString(_unref(getResourceName)(row.effect, {\n            showID: _ctx.flase\n          })), 9, _hoisted_10)])]),\n          _: 1\n        })), _createVNode(_component_el_table_column, {\n          prop: \"count\",\n          label: \"次数\",\n          width: \"80\",\n          sortable: \"custom\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value\",\n          label: \"数值\",\n          width: \"158\",\n          sortable: \"custom\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"span\", null, _toDisplayString(row.value), 1), _createElementVNode(\"span\", null, \" (\" + _toDisplayString(_unref(displayPercent)(row.valueRate)) + \")\", 1)]),\n          _: 1\n        }), _createVNode(_component_el_table_column, {\n          prop: \"critRate\",\n          label: \"会心\",\n          width: \"120\",\n          sortable: \"custom\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"span\", null, _toDisplayString(row.criticalCount), 1), _createElementVNode(\"span\", null, \" (\" + _toDisplayString(_unref(displayPercent)(row.criticalRate)) + \")\", 1)]),\n          _: 1\n        }), _createVNode(_component_el_table_column, {\n          prop: \"min\",\n          label: \"最小值\",\n          width: \"90\",\n          sortable: \"custom\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"max\",\n          label: \"最大值\",\n          width: \"98\",\n          sortable: \"custom\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"avg\",\n          label: \"平均值\",\n          width: \"98\",\n          sortable: \"custom\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"span\", null, _toDisplayString(_unref(displayDigits)(row.avg)), 1)]),\n          _: 1\n        })]),\n        _: 1\n      }, 8, [\"data\"]), _createVNode(_component_el_pagination, {\n        class: \"w-pagination\",\n        small: \"\",\n        background: \"\",\n        layout: \"pager\",\n        \"page-size\": pageSize.value,\n        total: _unref(total),\n        \"hide-on-single-page\": true,\n        \"current-page\": _unref(currentPage),\n        \"onUpdate:currentPage\": _cache[2] || (_cache[2] = $event => currentPage.value = $event)\n      }, null, 8, [\"page-size\", \"total\", \"current-page\"])], 64))])), [[_directive_loading, loading.value]]), _createElementVNode(\"div\", _hoisted_11, [_createVNode(EntitySkillLog), _createVNode(EntitySkillLogDetail)])]);\n    };\n  }\n};","import script from \"./entity_view_effect.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_view_effect.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_view_effect.vue?vue&type=style&index=0&id=1a8afc6e&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { unref as _unref, createVNode as _createVNode, resolveDirective as _resolveDirective, openBlock as _openBlock, createElementBlock as _createElementBlock, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-pie-card\"\n};\nconst _hoisted_2 = {\n  class: \"u-pie\"\n};\nconst _hoisted_3 = {\n  class: \"m-pie-info\"\n};\nconst _hoisted_4 = {\n  class: \"u-title\"\n};\nconst _hoisted_5 = {\n  class: \"u-value\"\n};\nimport VChart from \"vue-echarts\";\nimport { use } from \"echarts/core\";\nimport { CanvasRenderer } from \"echarts/renderers\";\nimport { PieChart } from \"echarts/charts\";\nimport { TooltipComponent } from \"echarts/components\";\nimport \"echarts/lib/component/title\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { displayDigits } from \"@/utils/jcl/commonNoStore\";\nimport { ref } from \"vue\";\nexport default {\n  __name: 'entity_skill_pie',\n  setup(__props) {\n    const {\n      selectedSkill\n    } = toRefs(usePve());\n    use([CanvasRenderer, PieChart, TooltipComponent]);\n    const loading = ref(false);\n    const option = ref({\n      backgroundColor: \"#282828\",\n      title: {\n        text: \"\",\n        x: \"center\",\n        y: \"center\",\n        textStyle: {\n          fontSize: \"14px\",\n          fontWeight: \"normal\",\n          color: \"#fff\"\n        }\n      },\n      tooltip: {\n        trigger: \"item\",\n        formatter: \"{a} <br/>{b} : {c} ({d}%)\"\n      },\n      series: [{\n        name: \"数值占比\",\n        type: \"pie\",\n        radius: [\"50%\", \"90%\"],\n        center: [\"50%\", \"50%\"],\n        data: [],\n        // selectedMode: \"multiple\",\n        label: {\n          show: false\n        },\n        labelLine: {\n          show: false\n        },\n        itemStyle: {\n          borderRadius: 5,\n          borderWidth: 2,\n          borderColor: \"#282828\"\n        }\n      }]\n    });\n    const echart = ref(null);\n    const updateData = () => {\n      var _selectedSkill$value, _selectedSkill$value2, _selectedSkill$value3;\n      loading.value = true;\n      option.value.series[0].data = [{\n        id: \"偏离\",\n        name: \"偏离\",\n        value: (_selectedSkill$value = selectedSkill.value) === null || _selectedSkill$value === void 0 ? void 0 : _selectedSkill$value.miss\n      }, {\n        id: \"命中\",\n        name: \"命中\",\n        value: (_selectedSkill$value2 = selectedSkill.value) === null || _selectedSkill$value2 === void 0 ? void 0 : _selectedSkill$value2.hit\n      }, {\n        id: \"运功\",\n        name: \"运功\",\n        value: (_selectedSkill$value3 = selectedSkill.value) === null || _selectedSkill$value3 === void 0 ? void 0 : _selectedSkill$value3.cast\n      }];\n      loading.value = false;\n    };\n    watchPostEffect(updateData);\n    return (_ctx, _cache) => {\n      var _unref2, _unref3, _unref4, _unref5, _unref6, _unref7;\n      const _directive_loading = _resolveDirective(\"loading\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createVNode(_unref(VChart), {\n        ref_key: \"echart\",\n        ref: echart,\n        theme: \"dark\",\n        option: option.value,\n        autoresize: \"\"\n      }, null, 8, [\"option\"])])), [[_directive_loading, loading.value]]), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"p\", _hoisted_4, _toDisplayString((_unref2 = _unref(selectedSkill)) === null || _unref2 === void 0 ? void 0 : _unref2.name), 1), _createElementVNode(\"p\", null, \"总次数 \" + _toDisplayString((_unref3 = _unref(selectedSkill)) === null || _unref3 === void 0 ? void 0 : _unref3.count), 1), _createElementVNode(\"p\", _hoisted_5, [_createElementVNode(\"span\", null, \" 命中 \" + _toDisplayString((_unref4 = _unref(selectedSkill)) === null || _unref4 === void 0 ? void 0 : _unref4.hit), 1), _createElementVNode(\"span\", null, \" 运功 \" + _toDisplayString((_unref5 = _unref(selectedSkill)) === null || _unref5 === void 0 ? void 0 : _unref5.cast), 1), _createElementVNode(\"span\", null, \" 偏离 \" + _toDisplayString((_unref6 = _unref(selectedSkill)) === null || _unref6 === void 0 ? void 0 : _unref6.miss), 1)]), _createElementVNode(\"p\", null, \"平均间隔 \" + _toDisplayString(_unref(displayDigits)((_unref7 = _unref(selectedSkill)) === null || _unref7 === void 0 ? void 0 : _unref7.interval)) + \"/s\", 1)])]);\n    };\n  }\n};","import script from \"./entity_skill_pie.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_skill_pie.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_skill_pie.vue?vue&type=style&index=0&id=465c9bee&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-465c9bee\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-timeline-wrapper\" :style=\"dynamicStyles\" ref=\"wrapper\">\n        <canvas id=\"timeline-canvas\"></canvas>\n        <div ref=\"tooltip\" class=\"u-tooltip\">\n            <div class=\"u-tooltip-item\" v-for=\"(v, k) in tooltipData\" :key=\"k\">\n                <span>{{ k }}: </span>\n                <span>{{ v }}</span>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { fabric } from \"fabric\";\nimport { cloneDeep } from \"lodash\";\nconst RECT_HEIGHT = 12;\n\nexport default {\n    name: \"CanvasTimeline\",\n    props: {\n        data: {\n            type: Array,\n            default: () => [],\n        },\n        linetime: {\n            //每一行展示多长时间\n            type: Number,\n            default: 60,\n        },\n        time: {\n            type: Number,\n            default: 300,\n        },\n        tooltip: {\n            type: Boolean,\n            default: true,\n        },\n        max_width: {\n            type: Number,\n            default: 1400,\n        },\n    },\n    data() {\n        return {\n            padding: 40,\n            width: null, // 初始化为 null 或默认值\n            canvas: null,\n            lastItem: null,\n            tooltipData: {},\n            color: \"#a798e6\",\n            itemCache: null,\n            layoutCache: null,\n            displayingItemGroup: [],\n        };\n    },\n    created() {\n        this.width = this.max_width; // 在 created 钩子中初始化 width\n    },\n\n    mounted: function () {\n        this.itemCache = {};\n        this.layoutCache = {};\n        this.$nextTick(() => {\n            this.initCanvas();\n            this.render();\n        });\n    },\n    methods: {\n        renderLines: function () {\n            if (this.layoutCache[this.linetime]) {\n                const group = this.layoutCache[this.linetime];\n                this.canvas.add(group);\n                return;\n            }\n            const group = new fabric.Group([], {\n                selectable: false,\n                objectCaching: false,\n            });\n\n            for (let i = 1; i <= this.lines; i++) {\n                const height = 2;\n                const top = (i - 1) * 60 + 29;\n                const line = new fabric.Line([0, top, this.width - this.padding, top], {\n                    stroke: \"#888\",\n                    strokeWidth: height,\n                    selectable: false,\n                    objectCaching: false,\n                });\n                const axisText = new fabric.Text(this.linetime * i + \"s\", {\n                    stroke: \"#fff\",\n                    left: this.width - this.padding + 4,\n                    top: top - 6,\n                    fontSize: 12,\n                    selectable: false,\n                    objectCaching: false,\n                });\n                group.add(line);\n                group.add(axisText);\n            }\n            group.addWithUpdate();\n            this.layoutCache[this.linetime] = group;\n            this.canvas.add(group);\n            return;\n        },\n        renderItems: function () {\n            const data = cloneDeep(this.data).sort((a, b) => a.time - b.time);\n            this.lastItem = null;\n            for (let item of data) {\n                const item_group = new fabric.Group([], {\n                    selectable: false,\n                    objectCaching: false,\n                });\n                const height = RECT_HEIGHT;\n                const { left, top } = this.itemPosition(item.time);\n                // 渲染小方块\n                const rect = new fabric.Rect({\n                    left: left,\n                    top: top,\n                    width: 6,\n                    height: height,\n                    fill: item.extra?.color ?? this.color,\n                });\n                item_group.add(rect);\n                // 如果上一个渲染的item和当前item的时间间隔太短就不渲染标签\n                if (this.lastItem) {\n                    const { left: lastLeft, top: lastTop } = this.itemPosition(this.lastItem.time);\n                    if (lastTop == top && left - lastLeft < 26) {\n                        continue;\n                    }\n                }\n                this.lastItem = item;\n\n                const nameText = new fabric.Text(item.content, {\n                    left: left,\n                    top: top - 16,\n                    fontSize: 12,\n                    fill: \"#aaa\",\n                });\n                let digits = {\n                    15: 2,\n                    30: 1,\n                    45: 1,\n                    60: 0,\n                };\n                let time = item.time.toFixed(digits[this.linetime]) + \"s\";\n                const timeText = new fabric.Text(time, {\n                    stroke: this.color,\n                    left: left,\n                    top: top + 14,\n                    fontSize: 12,\n                    selectable: false,\n                    objectCaching: false,\n                });\n                item_group.add(nameText);\n                item_group.add(timeText);\n                item_group.addWithUpdate();\n                if (this.tooltip) {\n                    item_group.on(\"mouseover\", () => {\n                        this.showTooltip(item);\n                    });\n                    item_group.on(\"mouseout\", () => {\n                        this.closeTooltip();\n                    });\n                    item_group.on(\"mousemove\", (e) => {\n                        let height = Object.keys(item.extra?.tooltip ?? {}).length * 12;\n                        this.moveTooltip(e.pointer, height);\n                    });\n                }\n                item_group[Symbol(\"item\")] = item;\n                this.canvas.add(item_group);\n            }\n            return;\n        },\n        patch: function () {\n            // TODO: 有bug！先不用\n            const objects = this.canvas.getObjects();\n            for (let obj of objects) {\n                if (!obj[Symbol(\"item\")]) continue;\n                if (!this.data.includes(obj[Symbol(\"item\")])) {\n                    this.canvas.remove(obj);\n                }\n            }\n            for (const item of this.data) {\n                if (this.itemCache[item.time]) {\n                    this.itemCache[item.time].push(item);\n                } else {\n                    const item_group = new fabric.Group([], {\n                        selectable: false,\n                        objectCaching: false,\n                    });\n                    const { left, top } = this.itemPosition(item.time);\n                    // 渲染小方块\n                    const rect = new fabric.Rect({\n                        left: left,\n                        top: top,\n                        width: 6,\n                        height: RECT_HEIGHT,\n                        fill: item.extra?.color ?? this.color,\n                    });\n                    item_group.add(rect);\n                    const nameText = new fabric.Text(item.content, {\n                        fontWeight: \"100\",\n                        stroke: \"#aaa\",\n                        left: left,\n                        top: top - 16,\n                        fontSize: 12,\n                    });\n                    let digits = {\n                        15: 2,\n                        30: 1,\n                        45: 1,\n                        60: 0,\n                    };\n                    let time = item.time.toFixed(digits[this.linetime]) + \"s\";\n                    const timeText = new fabric.Text(time, {\n                        stroke: this.color,\n                        left: left,\n                        top: top + 14,\n                        fontSize: 12,\n                        selectable: false,\n                        objectCaching: false,\n                    });\n                    item_group.add(nameText);\n                    item_group.add(timeText);\n                    item_group.addWithUpdate();\n                    if (\n                        this.canvas.getObjects().some((obj) => {\n                            return (\n                                obj.top == item_group.top &&\n                                obj.left < item_group.left + 32 &&\n                                obj.left > item_group.left - 32\n                            );\n                        })\n                    ) {\n                        item_group.remove(nameText);\n                        item_group.remove(timeText);\n                    }\n                    item_group.addWithUpdate();\n                    item_group[Symbol(\"item\")] = item;\n                    this.canvas.add(item_group);\n                }\n            }\n\n            this.canvas.renderAll();\n        },\n        render: function () {\n            if (!this.canvas) return;\n            this.canvas.setDimensions({\n                width: this.width,\n                height: this.height,\n            });\n            this.canvas.clear();\n            this.renderLines();\n            this.renderItems();\n            this.canvas.renderAll();\n            window.canvas = this.canvas;\n        },\n        initCanvas: function () {\n            this.canvas = new fabric.Canvas(\"timeline-canvas\", {\n                hoverCursor: \"pointer\",\n                renderOnAddRemove: false,\n                selectable: false,\n            });\n\n            this.canvas.on(\"mouse:wheel\", ({ e }) => {\n                if (e.altKey) {\n                    const delta = e.deltaY;\n                    let zoom = this.canvas.getZoom();\n                    zoom *= 0.999 ** delta;\n                    if (zoom > 10) zoom = 10;\n                    if (zoom < 1) zoom = 1;\n                    this.canvas.zoomToPoint({ x: e.offsetX, y: e.offsetY }, zoom);\n                    this.canvas.renderAll();\n                    e.preventDefault();\n                    e.stopPropagation();\n                }\n            });\n            this.canvas.on(\"mouse:down\", ({ e }) => {\n                if (e.altKey === true) {\n                    this.canvas.isDragging = true;\n                    this.canvas.lastPosX = e.clientX;\n                    this.canvas.lastPosY = e.clientY;\n                }\n            });\n            this.canvas.on(\"mouse:move\", ({ e }) => {\n                if (this.canvas.isDragging) {\n                    var vpt = this.canvas.viewportTransform;\n                    vpt[4] += e.clientX - this.canvas.lastPosX;\n                    const minXOffset = 200 * this.canvas.getZoom();\n                    const maxXOffset = -this.canvas.getWidth() + 100 * this.canvas.getZoom();\n                    if (vpt[4] >= minXOffset) {\n                        vpt[4] = minXOffset;\n                    } else if (vpt[4] < maxXOffset) {\n                        vpt[4] = maxXOffset;\n                    }\n                    vpt[5] += e.clientY - this.canvas.lastPosY;\n                    const minYOffset = 200 * this.canvas.getZoom();\n                    const maxYOffset = -this.canvas.getHeight() + 100 * this.canvas.getZoom();\n                    if (vpt[5] >= minYOffset) {\n                        vpt[5] = minYOffset;\n                    } else if (vpt[5] < maxYOffset) {\n                        vpt[5] = maxYOffset;\n                    }\n                    this.canvas.renderAll();\n                    this.canvas.lastPosX = e.clientX;\n                    this.canvas.lastPosY = e.clientY;\n                }\n            });\n            this.canvas.on(\"mouse:up\", () => {\n                this.canvas.setViewportTransform(this.canvas.viewportTransform);\n                this.canvas.isDragging = false;\n            });\n        },\n        itemPosition: function (time) {\n            const line = Math.max(0, Math.floor(time / this.linetime));\n            const top = line * 60 + 24;\n            const left = Math.max(0, ((time % this.linetime) / this.linetime) * (this.width - this.padding));\n            return { left, top };\n        },\n        closeTooltip: function () {\n            const tooltip = this.$refs.tooltip;\n            tooltip.style.visibility = \"hidden\";\n        },\n        showTooltip: function (item) {\n            this.tooltipData = item?.extra.tooltip ?? {};\n            if (!this.tooltipData) return;\n            const tooltip = this.$refs.tooltip;\n            tooltip.style.visibility = \"visible\";\n        },\n        moveTooltip: function (pointer, height) {\n            const tooltip = this.$refs.tooltip;\n            let x = Math.max(0, Math.min(pointer.x - 80, 1100));\n            let y = Math.max(40, pointer.y - height - 48);\n            tooltip.style.left = x + \"px\";\n            tooltip.style.top = y + \"px\";\n        },\n    },\n    computed: {\n        lines: function () {\n            return Math.ceil(this.time / this.linetime);\n        },\n        height: function () {\n            return this.lines * 60;\n        },\n        maxWidth() {\n            return this.width + 40;\n        },\n        dynamicStyles() {\n            return {\n                maxWidth: this.maxWidth + \"px\",\n                height: this.height + \"px\",\n            };\n        },\n    },\n    watch: {\n        data: {\n            handler: function () {\n                this.render();\n            },\n            deep: true,\n        },\n        linetime: function () {\n            this.render();\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n.m-timeline-wrapper {\n    overflow: hidden;\n    position: relative;\n    .u-tooltip {\n        position: absolute;\n        box-shadow: 0 0 2px #aaa;\n        background: #fff;\n        border-radius: 4px;\n        width: 200px;\n        padding: 8px;\n        visibility: hidden;\n        color: #303133;\n        font-size: 12px;\n    }\n}\n</style>\n","import { render } from \"./canvas_timeline.vue?vue&type=template&id=671e41be\"\nimport script from \"./canvas_timeline.vue?vue&type=script&lang=js\"\nexport * from \"./canvas_timeline.vue?vue&type=script&lang=js\"\n\nimport \"./canvas_timeline.vue?vue&type=style&index=0&id=671e41be&lang=less\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\n    <div class=\"m-entity-skill-timeline w-card\">\n        <div class=\"w-card-title\">\n            <span class=\"u-title\">主动招式轴 </span>\n            <el-radio-group v-model.number=\"linetime\" size=\"small\">\n                <el-radio-button :value=\"6\">每行06s</el-radio-button>\n                <el-radio-button :value=\"15\">每行15s</el-radio-button>\n                <el-radio-button :value=\"30\">每行30s</el-radio-button>\n                <el-radio-button :value=\"45\">每行45s</el-radio-button>\n                <el-radio-button :value=\"60\">每行60s</el-radio-button>\n            </el-radio-group>\n            <!-- <div class=\"u-setting-trigger\">\n                <el-icon><Setting /></el-icon>\n                选择技能\n                <entity-skill-filter class=\"u-setting-popper\"></entity-skill-filter>\n            </div> -->\n        </div>\n        <div class=\"u-canvas-wrapper\">\n            <canvas-timeline\n                :data=\"data\"\n                :time=\"time\"\n                :linetime=\"linetime\"\n                :max_width=\"max_width\"\n                :key=\"max_width\"\n            ></canvas-timeline>\n        </div>\n    </div>\n</template>\n<script setup>\n// import EntitySkillFilter from \"./entity_skill_filter.vue\";\nimport CanvasTimeline from \"../common/canvas_timeline.vue\";\n\nimport { computed, toRefs, ref } from \"vue\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { getResource } from \"@/utils/jcl/common\";\n\nconst store = useStore();\nconst { entity, selectedSkills } = toRefs(usePve());\nconst { end } = store.result;\nconst time = computed(() => end.sec + 10);\nconst linetime = ref(15);\n\nconst m_jcl_main = document.getElementsByClassName(\"p-pve-result\")[0];\nconst m_jcl_main_width = m_jcl_main ? m_jcl_main.clientWidth : 0;\n// 动态计算 max_width\nconst max_width = ref(m_jcl_main_width - 560); // 初始值为窗口宽度减去一定值\n\n// // 监听窗口大小变化\n// const updateMaxWidth = () => {\n//     max_width.value = document.body.clientWidth - 550; // 更新 max_width\n// };\n\n// onMounted(() => {\n//     window.addEventListener(\"resize\", updateMaxWidth);\n// });\n\n// onUnmounted(() => {\n//     window.removeEventListener(\"resize\", updateMaxWidth);\n// });\n\nconst data = computed(() => {\n    const source = store.result.skill?.[entity.value]?.logs;\n    if (!source) return [];\n    const result = [];\n    const idNameMap = {};\n    const typeDescMap = {\n        cast: \"读条\",\n        hit: \"命中\",\n        miss: \"偏离\",\n    };\n    for (let log of source) {\n        if (!idNameMap[log.id]) {\n            const name = getResource(\"skill:\" + log.id).name;\n            if (!name) continue;\n            idNameMap[log.id] = name;\n        }\n        let name = idNameMap[log.id];\n        const selectedSkill = selectedSkills.value[name];\n        if (!selectedSkill || !selectedSkill.stat.includes(log.skillType)) continue;\n        if (name.length > 5) name = name.charAt(0) + \"..\" + name.charAt(name.length - 1);\n        result.push({\n            content: name,\n            time: log.time,\n            extra: {\n                tooltip: {\n                    技能: selectedSkill.name,\n                    技能ID: log.id,\n                    施放时间: log.time.toFixed(2) + \"s\",\n                    施放类型: typeDescMap[log.type],\n                },\n                color: selectedSkill.color,\n            },\n        });\n    }\n    result.unshift({\n        extra: {\n            tooltip: {\n                事件: \"战斗开始\",\n            },\n            color: \"#ffffff\",\n        },\n        content: \"战斗开始\",\n        time: 0,\n    });\n    result.push({\n        extra: {\n            tooltip: {\n                事件: \"战斗结束\",\n            },\n            color: \"#ffffff\",\n        },\n        content: \"战斗结束\",\n        time: end.sec ?? result[result.length - 1].time + 2,\n    });\n\n    return result;\n});\n</script>\n\n<style lang=\"less\">\n.m-entity-skill-timeline {\n    .w-card-title {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n\n        .u-title {\n            .mr(20px);\n        }\n    }\n\n    .el-radio-button.is-active {\n        .el-radio-button__inner {\n            background-color: @light-purple;\n            border-radius: 4px;\n            color: #000;\n        }\n    }\n    .el-radio-button .el-radio-button__inner {\n        border: none;\n        background-color: transparent;\n    }\n\n    .u-setting-trigger {\n        .pr;\n        .flex-center;\n        .pointer;\n        gap: 4px;\n        color: #fff;\n        background-color: @dark-purple;\n        padding: 3px 8px;\n        .r(3px);\n    }\n\n    .u-setting-trigger:hover {\n        .u-setting-popper {\n            visibility: visible;\n            opacity: 1;\n        }\n    }\n\n    .u-setting-popper {\n        // 悬浮效果\n        visibility: hidden;\n        opacity: 0;\n        transition: visibility 0.15s, opacity 0.15s linear;\n\n        // 定位\n        .pa;\n        top: calc(100%);\n        right: -20px;\n\n        z-index: 20;\n    }\n\n    .u-canvas-wrapper {\n        overflow-y: auto;\n        overflow-x: hidden;\n        max-height: 520px;\n        min-height: 520px;\n        width: 100%;\n        .scrollbar(#718282, 10px);\n    }\n}\n</style>\n","import script from \"./entity_skill_timeline.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_skill_timeline.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_skill_timeline.vue?vue&type=style&index=0&id=28abdead&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import { createElementVNode as _createElementVNode, createVNode as _createVNode, unref as _unref, toDisplayString as _toDisplayString, resolveComponent as _resolveComponent, withCtx as _withCtx, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock, resolveDirective as _resolveDirective, withDirectives as _withDirectives, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-entity-skill\"\n};\nconst _hoisted_2 = {\n  class: \"u-left w-card\"\n};\nconst _hoisted_3 = {\n  class: \"u-center\"\n};\nconst _hoisted_4 = {\n  class: \"u-entity-name\"\n};\nconst _hoisted_5 = {\n  class: \"u-right\"\n};\nimport EntityCardPie from \"./entity_skill_pie.vue\";\nimport EntitySkillTimeline from \"./entity_skill_timeline.vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\n\n// import getWorkerResponse from \"@/utils/jcl/worker\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { displayPercent } from \"@/utils/jcl/commonNoStore\";\n// import { getResourceIcon } from \"@/utils/jcl/common\";\n\nimport { useStore } from \"@/pages/jcl/store\";\nimport { getResource } from \"@/utils/jcl/common\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nexport default {\n  __name: 'entity_view_skill',\n  setup(__props) {\n    const {\n      entity,\n      selectedSkills,\n      selectedSkill\n    } = toRefs(usePve());\n    const pageSize = ref(10);\n    const store = useStore();\n    const loading = ref(false);\n\n    // 获取可供选择的数据\n    const updateData = () => {\n      loading.value = true;\n      getWorkerResponse(\"get_pve_entity_skill\", {\n        entity: entity.value\n      }).then(result => {\n        const _selected = result.selectedSkills;\n        let i = 0;\n        for (let d of result.data) {\n          if (i == 0) {\n            _selected[d.name].stat = [\"cast\", \"hit\", \"miss\"];\n            // _selected[d.name].stat = [\"cast\"];\n          } else {\n            _selected[d.name].stat = [];\n          }\n          i++;\n        }\n        selectedSkills.value = _selected;\n        loading.value = false;\n      });\n    };\n    const click = row => {\n      const {\n        name\n      } = row;\n      if (selectedSkills.value[name].stat.length > 0) {\n        selectedSkills.value[name].stat = [];\n      } else {\n        selectedSkills.value[name].stat = [\"cast\", \"hit\", \"miss\"];\n      }\n      selectedSkill.value = row;\n    };\n\n    // 获取选中的用户表格数据\n    const tableData = computed(() => {\n      var _store$result$skill;\n      const source = (_store$result$skill = store.result.skill) === null || _store$result$skill === void 0 || (_store$result$skill = _store$result$skill[entity.value]) === null || _store$result$skill === void 0 ? void 0 : _store$result$skill.logs;\n      if (!source) return [];\n      const result = {};\n      const idNameMap = {};\n      for (let log of source) {\n        if (!idNameMap[log.id]) {\n          const name = getResource(\"skill:\" + log.id).name;\n          if (!name) continue;\n          idNameMap[log.id] = name;\n        }\n        const name = idNameMap[log.id];\n        const _selectedSkill = selectedSkills.value[name];\n        if (!_selectedSkill) continue;\n        if (!result[name]) {\n          result[name] = {\n            name: name,\n            cast: 0,\n            hit: 0,\n            miss: 0,\n            count: 0,\n            interval: 0,\n            _last: 0\n          };\n        }\n        result[name][log.skillType]++;\n        result[name].count++;\n        if (result[name].count != 0) {\n          result[name].interval = (result[name].interval * (result[name].count - 1) + (log.time - result[name]._last)) / result[name].count;\n          result[name]._last = log.time;\n        }\n      }\n      const res = Object.values(result);\n      selectedSkill.value = res[0];\n      return res;\n    });\n    const {\n      currentPage,\n      currentData,\n      total\n    } = usePaginate(tableData, pageSize);\n    watchPostEffect(updateData);\n    return (_ctx, _cache) => {\n      const _component_el_table_column = _resolveComponent(\"el-table-column\");\n      const _component_el_checkbox = _resolveComponent(\"el-checkbox\");\n      const _component_el_table = _resolveComponent(\"el-table\");\n      const _component_el_pagination = _resolveComponent(\"el-pagination\");\n      const _directive_loading = _resolveDirective(\"loading\");\n      return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[1] || (_cache[1] = _createElementVNode(\"div\", {\n        class: \"w-card-title\"\n      }, \"主动招式\", -1)), _createVNode(EntityCardPie), _withDirectives((_openBlock(), _createBlock(_component_el_table, {\n        class: \"u-table w-table\",\n        data: _unref(currentData),\n        border: false,\n        \"show-header\": false,\n        onSortChange: _ctx.sort,\n        onRowClick: click,\n        \"row-class-name\": _ctx.rowClass\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_table_column, {\n          label: \"招式\",\n          width: \"140\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"span\", _hoisted_4, _toDisplayString(row.name), 1)])]),\n          _: 1\n        }), _createVNode(_component_el_table_column, {\n          label: \"占比\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [_createTextVNode(_toDisplayString(_unref(displayPercent)(row.rate)), 1)]),\n          _: 1\n        }), _createVNode(_component_el_table_column, {\n          label: \"selection\",\n          width: \"35\",\n          aligin: \"right\"\n        }, {\n          default: _withCtx(({\n            row\n          }) => [(_openBlock(), _createBlock(_component_el_checkbox, {\n            key: _unref(selectedSkills)[row.name].stat,\n            checked: _unref(selectedSkills)[row.name].stat.length > 0\n          }, null, 8, [\"checked\"]))]),\n          _: 1\n        })]),\n        _: 1\n      }, 8, [\"data\", \"onSortChange\", \"row-class-name\"])), [[_directive_loading, _unref(loading)]]), _createVNode(_component_el_pagination, {\n        class: \"w-pagination\",\n        small: \"\",\n        background: \"\",\n        layout: \"pager\",\n        \"page-size\": _unref(pageSize),\n        total: _unref(total),\n        \"hide-on-single-page\": true,\n        \"current-page\": _unref(currentPage),\n        \"onUpdate:currentPage\": _cache[0] || (_cache[0] = $event => currentPage.value = $event)\n      }, null, 8, [\"page-size\", \"total\", \"current-page\"])]), _createElementVNode(\"div\", _hoisted_5, [_createVNode(EntitySkillTimeline)])])]);\n    };\n  }\n};","import script from \"./entity_view_skill.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_view_skill.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_view_skill.vue?vue&type=style&index=0&id=835d92a0&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-835d92a0\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-entity-buff-chart w-card\">\n        <div class=\"w-card-title\">\n            <span>时间轴</span>\n            <span class=\"u-entity-infos\">\n                <span class=\"u-entity-info\">{{ getEntityName(entity) }}</span>\n                <span class=\"u-entity-info\">ID {{ entity }}</span>\n                <span class=\"u-entity-info\">参战时长 {{ displayDuration(end.sec) }}</span>\n            </span>\n            <div class=\"u-buff-help\">\n                <el-icon :size=\"16\"><InfoFilled /></el-icon>\n                条形图上的数字表示层数变化，*号表示非自然消失，鼠标悬浮可查看详细信息\n            </div>\n        </div>\n        <div class=\"u-chart\" v-loading=\"loading\">\n            <v-chart v-if=\"items.length\" autoresize theme=\"dark\" :option=\"option\" class=\"u-chart\"></v-chart>\n            <span v-else class=\"u-empty\">上侧选择需要查看的BUFF</span>\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { graphic } from \"echarts/core\";\nimport VChart from \"vue-echarts\";\nimport { getEntityName } from \"@/utils/jcl/common\";\nimport { displayDuration } from \"@/utils/jcl/commonNoStore\";\nimport { toRefs, computed, ref, watchPostEffect } from \"vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nimport { cloneDeep } from \"lodash\";\n\nconst store = useStore();\nconst { entity, selectedBuffs } = toRefs(usePve());\nconst { end } = store.result;\n\nconst renderItem = (params, api) => {\n    let children = [];\n    // 绘制矩形\n    const categoryIndex = api.value(3);\n    const start = api.coord([api.value(1), categoryIndex]);\n    const end = api.coord([api.value(2), categoryIndex]);\n    const itemHeight = Math.min(api.size([0, 1])[1] * 0.6, 30);\n    const visibleRect = params.coordSys;\n    const rectShape = graphic.clipRectByRect(\n        {\n            x: start[0],\n            y: start[1] - itemHeight / 2,\n            width: end[0] - start[0],\n            height: itemHeight,\n        },\n        visibleRect\n    );\n    children.push({\n        type: \"rect\",\n        shape: rectShape,\n        style: {\n            fill: api.visual(\"color\"),\n        },\n    });\n    // 根据stackLogs在矩形上绘制层数变化\n    const stackLogs = JSON.parse(api.value(4));\n    let lastLeft = Number.MIN_SAFE_INTEGER;\n    for (let time in stackLogs) {\n        const stackNum = stackLogs[time];\n        if (stackNum === 1) continue;\n        const point = api.coord([time, categoryIndex]);\n        const showText = point[0] > visibleRect.x && point[0] < visibleRect.x + visibleRect.width;\n        if (showText && point[0] - lastLeft > 12) {\n            lastLeft = point[0];\n            children.push({\n                type: \"text\",\n                style: {\n                    text: stackNum,\n                    x: point[0] + 3.5,\n                    y: point[1] + 10,\n                    textAlign: \"center\",\n                    textVerticalAlign: \"middle\",\n                    textShadowColor: \"#000\",\n                    textShadowBlur: 2,\n                    fill: \"#fff\",\n                },\n            });\n        }\n    }\n    // 如果是被驱散的在矩形后面绘制icon\n    const isDelete = api.value(5);\n    const showDelete = end[0] > visibleRect.x && end[0] < visibleRect.x + visibleRect.width;\n    if (isDelete && showDelete) {\n        children.push({\n            type: \"text\",\n            style: {\n                text: \"*\",\n                x: end[0] + 3.5,\n                y: end[1],\n                textAlign: \"center\",\n                textVerticalAlign: \"middle\",\n                textShadowColor: \"#000\",\n                textShadowBlur: 2,\n                fill: \"#fff\",\n            },\n        });\n    }\n    return {\n        type: \"group\",\n        diffChildrenByName: true,\n        children,\n    };\n};\n\nconst option = computed(() => ({\n    backgroundColor: \"transparent\",\n    theme: \"dark\",\n    tooltip: {\n        formatter: function (params) {\n            let { detail } = params.data;\n            const duration = ((detail.end - detail.start) / 1000).toFixed(1);\n            const start = (detail.start / 1000).toFixed(1);\n            const end = (detail.end / 1000).toFixed(1);\n            return `${params.marker} ${params.name} <br />\n                            BUFF ID: ${detail.id} <br />\n                            BUFF来源: ${getEntityName(detail.source)} <br />\n                            ${detail.deleteBy ? `BUFF卸除者: ${getEntityName(detail.deleteBy)} <br />` : \"\"}\n                            开始时间: ${start} 秒 <br />\n                            结束时间: ${end} 秒 <br />\n                            BUFF持续时间: ${duration} 秒`;\n        },\n    },\n    dataZoom: [\n        {\n            type: \"slider\",\n            filterMode: \"weakFilter\",\n            showDataShadow: false,\n            labelFormatter: \"\",\n        },\n        {\n            type: \"inside\",\n            filterMode: \"weakFilter\",\n        },\n    ],\n    xAxis: {\n        min: end.sec,\n        scale: true,\n        position: \"top\",\n        axisLabel: {\n            formatter: function (val) {\n                return (val / 1000).toFixed(1) + \" s\";\n            },\n        },\n    },\n    yAxis: {\n        data: categories.value,\n        axisTick: {\n            show: false,\n        },\n        axisLabel: {\n            formatter: function (val, index) {\n                return `{paddingRight|${val}}{icon${index}|}`;\n            },\n            rich: iconStyles.value,\n        },\n    },\n    series: [\n        {\n            type: \"custom\",\n            renderItem,\n            itemStyle: {\n                opacity: 0.8,\n            },\n            encode: {\n                x: [1, 2],\n                y: 0,\n            },\n            data: items.value,\n        },\n    ],\n}));\n\n// 数据相关\nconst loading = ref(false);\nconst data = ref([]);\nconst iconStyles = ref({});\nconst categories = ref([]);\nconst items = ref([]);\nconst updateData = () => {\n    loading.value = true;\n    getWorkerResponse(\"get_pve_entity_buff_chart\", {\n        entity: entity.value,\n        selectedBuffs: cloneDeep(selectedBuffs.value),\n    }).then((result) => {\n        data.value = result.data;\n        iconStyles.value = result.iconStyles;\n        categories.value = result.categories;\n        items.value = result.items;\n        loading.value = false;\n    });\n};\nwatchPostEffect(updateData);\n</script>\n\n<style lang=\"less\" scoped>\n.m-entity-buff-chart {\n    .flex;\n    flex-direction: column;\n    height: 100%;\n    box-sizing: border-box;\n    .u-entity-infos {\n        .ml(8px);\n\n        .fz(14px, 18px);\n        .bold;\n        color: #8b96a2;\n\n        .u-entity-info {\n            .mr(24px);\n        }\n    }\n    .u-buff-help {\n        .flex-center;\n        gap: 12px;\n        flex: 1;\n        .fz(14px, 18px);\n        float: right;\n        color: #d3efff;\n    }\n\n    .u-chart {\n        flex-grow: 1;\n        .flex-center;\n    }\n\n    .u-empty {\n        color: #b3b3b3;\n        .fz(14px, 18px);\n        .bold;\n    }\n\n    :deep(.vue-echarts-inner) {\n        width: 100% !important;\n        height: 100% !important;\n    }\n}\n</style>\n","import script from \"./entity_buff_chart.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_buff_chart.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_buff_chart.vue?vue&type=style&index=0&id=6ec6f1dd&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6ec6f1dd\"]])\n\nexport default __exports__","/**\n * The base implementation of `_.sortBy` which uses `comparer` to define the\n * sort order of `array` and replaces criteria objects with their corresponding\n * values.\n *\n * @private\n * @param {Array} array The array to sort.\n * @param {Function} comparer The function to define sort order.\n * @returns {Array} Returns `array`.\n */\nfunction baseSortBy(array, comparer) {\n  var length = array.length;\n\n  array.sort(comparer);\n  while (length--) {\n    array[length] = array[length].value;\n  }\n  return array;\n}\n\nexport default baseSortBy;\n","import isSymbol from './isSymbol.js';\n\n/**\n * Compares values to sort them in ascending order.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {number} Returns the sort order indicator for `value`.\n */\nfunction compareAscending(value, other) {\n  if (value !== other) {\n    var valIsDefined = value !== undefined,\n        valIsNull = value === null,\n        valIsReflexive = value === value,\n        valIsSymbol = isSymbol(value);\n\n    var othIsDefined = other !== undefined,\n        othIsNull = other === null,\n        othIsReflexive = other === other,\n        othIsSymbol = isSymbol(other);\n\n    if ((!othIsNull && !othIsSymbol && !valIsSymbol && value > other) ||\n        (valIsSymbol && othIsDefined && othIsReflexive && !othIsNull && !othIsSymbol) ||\n        (valIsNull && othIsDefined && othIsReflexive) ||\n        (!valIsDefined && othIsReflexive) ||\n        !valIsReflexive) {\n      return 1;\n    }\n    if ((!valIsNull && !valIsSymbol && !othIsSymbol && value < other) ||\n        (othIsSymbol && valIsDefined && valIsReflexive && !valIsNull && !valIsSymbol) ||\n        (othIsNull && valIsDefined && valIsReflexive) ||\n        (!othIsDefined && valIsReflexive) ||\n        !othIsReflexive) {\n      return -1;\n    }\n  }\n  return 0;\n}\n\nexport default compareAscending;\n","import compareAscending from './_compareAscending.js';\n\n/**\n * Used by `_.orderBy` to compare multiple properties of a value to another\n * and stable sort them.\n *\n * If `orders` is unspecified, all values are sorted in ascending order. Otherwise,\n * specify an order of \"desc\" for descending or \"asc\" for ascending sort order\n * of corresponding values.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {boolean[]|string[]} orders The order to sort by for each property.\n * @returns {number} Returns the sort order indicator for `object`.\n */\nfunction compareMultiple(object, other, orders) {\n  var index = -1,\n      objCriteria = object.criteria,\n      othCriteria = other.criteria,\n      length = objCriteria.length,\n      ordersLength = orders.length;\n\n  while (++index < length) {\n    var result = compareAscending(objCriteria[index], othCriteria[index]);\n    if (result) {\n      if (index >= ordersLength) {\n        return result;\n      }\n      var order = orders[index];\n      return result * (order == 'desc' ? -1 : 1);\n    }\n  }\n  // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n  // that causes it, under certain circumstances, to provide the same value for\n  // `object` and `other`. See https://github.com/jashkenas/underscore/pull/1247\n  // for more details.\n  //\n  // This also ensures a stable sort in V8 and other engines.\n  // See https://bugs.chromium.org/p/v8/issues/detail?id=90 for more details.\n  return object.index - other.index;\n}\n\nexport default compareMultiple;\n","import arrayMap from './_arrayMap.js';\nimport baseGet from './_baseGet.js';\nimport baseIteratee from './_baseIteratee.js';\nimport baseMap from './_baseMap.js';\nimport baseSortBy from './_baseSortBy.js';\nimport baseUnary from './_baseUnary.js';\nimport compareMultiple from './_compareMultiple.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `_.orderBy` without param guards.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function[]|Object[]|string[]} iteratees The iteratees to sort by.\n * @param {string[]} orders The sort orders of `iteratees`.\n * @returns {Array} Returns the new sorted array.\n */\nfunction baseOrderBy(collection, iteratees, orders) {\n  if (iteratees.length) {\n    iteratees = arrayMap(iteratees, function(iteratee) {\n      if (isArray(iteratee)) {\n        return function(value) {\n          return baseGet(value, iteratee.length === 1 ? iteratee[0] : iteratee);\n        }\n      }\n      return iteratee;\n    });\n  } else {\n    iteratees = [identity];\n  }\n\n  var index = -1;\n  iteratees = arrayMap(iteratees, baseUnary(baseIteratee));\n\n  var result = baseMap(collection, function(value, key, collection) {\n    var criteria = arrayMap(iteratees, function(iteratee) {\n      return iteratee(value);\n    });\n    return { 'criteria': criteria, 'index': ++index, 'value': value };\n  });\n\n  return baseSortBy(result, function(object, other) {\n    return compareMultiple(object, other, orders);\n  });\n}\n\nexport default baseOrderBy;\n","import baseFlatten from './_baseFlatten.js';\nimport baseOrderBy from './_baseOrderBy.js';\nimport baseRest from './_baseRest.js';\nimport isIterateeCall from './_isIterateeCall.js';\n\n/**\n * Creates an array of elements, sorted in ascending order by the results of\n * running each element in a collection thru each iteratee. This method\n * performs a stable sort, that is, it preserves the original sort order of\n * equal elements. The iteratees are invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {...(Function|Function[])} [iteratees=[_.identity]]\n *  The iteratees to sort by.\n * @returns {Array} Returns the new sorted array.\n * @example\n *\n * var users = [\n *   { 'user': 'fred',   'age': 48 },\n *   { 'user': 'barney', 'age': 36 },\n *   { 'user': 'fred',   'age': 30 },\n *   { 'user': 'barney', 'age': 34 }\n * ];\n *\n * _.sortBy(users, [function(o) { return o.user; }]);\n * // => objects for [['barney', 36], ['barney', 34], ['fred', 48], ['fred', 30]]\n *\n * _.sortBy(users, ['user', 'age']);\n * // => objects for [['barney', 34], ['barney', 36], ['fred', 30], ['fred', 48]]\n */\nvar sortBy = baseRest(function(collection, iteratees) {\n  if (collection == null) {\n    return [];\n  }\n  var length = iteratees.length;\n  if (length > 1 && isIterateeCall(collection, iteratees[0], iteratees[1])) {\n    iteratees = [];\n  } else if (length > 2 && isIterateeCall(iteratees[0], iteratees[1], iteratees[2])) {\n    iteratees = [iteratees[0]];\n  }\n  return baseOrderBy(collection, baseFlatten(iteratees, 1), []);\n});\n\nexport default sortBy;\n","<template>\n    <div class=\"m-entity-buff-table\">\n        <!-- :row-class-name=\"rowClass\" -->\n        <el-table class=\"u-table w-table\" :data=\"currentData\" :border=\"false\" @sort-change=\"sort\" @row-click=\"click\">\n            <el-table-column prop=\"index\" label=\"#\" align=\"center\" :width=\"36\"></el-table-column>\n            <el-table-column label=\"BUFF\">\n                <template #default=\"{ row }\">\n                    <div class=\"u-center\">\n                        <img class=\"u-buff-icon\" :src=\"iconLink(row.icon)\" alt=\"\" />\n                        <span class=\"u-buff-name\">{{ getResourceName(\"buff:\" + row.id, { showID: false }) }}</span>\n                    </div>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"覆盖率\" sortable=\"custom\" prop=\"coverage\">\n                <template #default=\"{ row }\">\n                    <span>{{ displayPercent(row.coverage) }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"获得次数\" sortable=\"custom\" prop=\"getCount\">\n                <template #default=\"{ row }\">\n                    <span>{{ row.getCount }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"卸除次数\" sortable=\"custom\" prop=\"deleteCount\">\n                <template #default=\"{ row }\">\n                    <span>{{ row.deleteCount }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"最大层数\" sortable=\"custom\" prop=\"maxStack\">\n                <template #default=\"{ row }\">\n                    <span>{{ row.maxStack }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"最短持续\" sortable=\"custom\" prop=\"minDuration\">\n                <template #default=\"{ row }\">\n                    <span>{{ displayDigits(row.minDuration) }} s</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"最长持续\" sortable=\"custom\" prop=\"maxDuration\">\n                <template #default=\"{ row }\">\n                    <span>{{ displayDigits(row.maxDuration) }} s</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"平均持续\" sortable=\"custom\" prop=\"aveDuration\">\n                <template #default=\"{ row }\">\n                    <span>{{ displayDigits(row.aveDuration) }} s</span>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"\" width=\"35\">\n                <template #default=\"{ row }\">\n                    <div class=\"u-check-icon\">\n                        <el-checkbox :checked=\"selectedBuffs.includes(row.id)\" :key=\"selectedBuffs.length\" />\n                    </div>\n                </template>\n            </el-table-column>\n        </el-table>\n        <el-pagination\n            class=\"w-pagination\"\n            small\n            background\n            layout=\"pager\"\n            :page-size=\"pageSize\"\n            :total=\"total\"\n            :hide-on-single-page=\"true\"\n            :current-page=\"currentPage\"\n            @update:currentPage=\"currentPage = $event\"\n        ></el-pagination>\n    </div>\n</template>\n\n<script setup>\nimport { iconLink } from \"@jx3box/jx3box-common/js/utils\";\nimport { getResourceName } from \"@/utils/jcl/common\";\nimport { displayPercent, displayDigits } from \"@/utils/jcl/commonNoStore\";\nimport { ref, toRefs, watchPostEffect } from \"vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { sortBy } from \"lodash-es\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\n\nconst { entity, selectedBuffs } = toRefs(usePve());\n\n// 表格样式/交互\n// const rowClass = ({ row }) => {\n//     if (selectedBuffs.value.includes(row.id)) {\n//         return \"is-focus\";\n//     }\n//     return \"\";\n// };\nconst click = (row) => {\n    if (selectedBuffs.value.includes(row.id)) {\n        selectedBuffs.value = selectedBuffs.value.filter((id) => id !== row.id);\n    } else {\n        selectedBuffs.value.push(row.id);\n        const sortList = data.value.map((x) => x.id).reverse();\n        selectedBuffs.value = sortBy(selectedBuffs.value, (element) => sortList.indexOf(element));\n    }\n};\nconst sort = ({ prop, order }) => {\n    data.value = data.value.sort((a, b) => {\n        if (order === \"ascending\") {\n            return a[prop] - b[prop];\n        } else {\n            return b[prop] - a[prop];\n        }\n    });\n    let index = 1;\n    for (let item of data.value) {\n        item.index = index++;\n    }\n};\n\n// 数据处理相关\nconst loading = ref(false);\nconst data = ref([]);\nconst pageSize = ref(18);\nconst { currentPage, currentData, total } = usePaginate(data, pageSize);\nconst updateData = () => {\n    loading.value = true;\n    selectedBuffs.value = [];\n    getWorkerResponse(\"get_pve_entity_buff\", { entity: entity.value }).then((result) => {\n        data.value = result;\n        sort({ prop: \"icon\", order: \"descending\" });\n        if (selectedBuffs.value.length === 0) {\n            selectedBuffs.value = data.value.slice(0, 8).map((x) => x.id);\n        }\n        loading.value = false;\n    });\n};\n\nwatchPostEffect(updateData);\n</script>\n\n<style lang=\"less\">\n.m-entity-buff-table {\n    display: flex;\n    flex-direction: column;\n    flex-grow: 1;\n    .u-table {\n        flex-grow: 1;\n        .u-center {\n            display: flex;\n            align-items: center;\n        }\n        .u-buff-icon {\n            .size(18px, 18px);\n            margin-right: 10px;\n        }\n        .u-buff-name {\n            flex: 1;\n            .ellipsis;\n        }\n    }\n}\n</style>\n","import script from \"./entity_buff_table.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_buff_table.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_buff_table.vue?vue&type=style&index=0&id=58453004&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import script from \"./entity_view_buff.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_view_buff.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_view_buff.vue?vue&type=style&index=0&id=155fff43&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-155fff43\"]])\n\nexport default __exports__","// 因为在webworker里面发请求不能使用document\n// 而node.js引用了common库，里面的$node引用了element-ui的message组件\n// 所以会导致document is not defined\n// 所以这里直接用axios搓一个$node，api访问的方法。\n\nimport axios from \"axios\";\nimport jx3box from \"@jx3box/jx3box-common/data/jx3box.json\";\nconst { __node } = jx3box;\n// const $ = axios.create({\n//     baseURL: \"http://localhost:7002\",\n// });\n\nconst $ = axios.create({\n    baseURL: __node,\n});\n\n// 获取任意资源\nexport function getResource({ client = \"std\", type, ids, fields } = {}) {\n    return $.post(`/resource/${client}/${type}`, {\n        ids,\n        fields,\n    });\n}\n\nexport function getEnchantByItemID({ client = \"std\", id } = {}) {\n    return $.get(`/enchant/by-item`, {\n        params: {\n            id,\n            client,\n        },\n    });\n}\n","/**\n * 这个文件负责log到rows层，计划在解析完用户提交的文件使用\n */\nimport { SKILL_RESULT_TYPE } from \"./jclType\";\nimport xfid from \"@jx3box/jx3box-data/data/xf/xfid.json\";\nimport { getEnchantByItemID, getResource } from \"@/service/jcl/resource\";\n\nexport const defaultRow = {\n    frame: 0, //逻辑帧\n    sec: 0, //时间(秒)\n    micro: 0, //毫秒\n    type: 0, //事件类型，枚举整数\n    typeDesc: \"\", //事件类型，描述\n    subtype: \"\", //事件子类型\n    source: \"\", //事件来源\n    content: \"\", //事件内容\n    target: \"\", //事件目标\n    value: {}, //事件值\n    remark: \"\", //备注\n    __log: \"\", //原始log的detail\n};\n\n// 将一条log转换为一个用于表格展示的对象\nexport function formatLine(log) {\n    let { frame, sec, micro, type, typeDesc, detail } = log;\n    let subtype = formatSubtype(type, detail); //事件子类型的描述\n    let source = formatSource(type, detail); //事件来源\n    let content = formatContent(type, detail); //事件内容的描述\n    let target = formatTarget(type, detail); //事件目标\n    let value = formatValues(type, detail); //事件值\n    return {\n        frame,\n        sec,\n        micro,\n        type,\n        typeDesc,\n        subtype,\n        source,\n        content,\n        target,\n        value,\n        detail,\n    };\n}\n\n// 展示单位名字\nexport function entityName(entity, showMount = false) {\n    if (!entity) return \"天外来客\";\n    let appearOrder = entity.appearOrder;\n    let templateID = entity.templateID;\n    let mount = xfid?.[entity.mount];\n    let name = entity.name;\n    if (templateID) name += `#${templateID}`;\n    if (appearOrder) name += `@${appearOrder}`;\n    if (showMount && mount) name += `#${mount}`;\n    return name;\n}\n\n// 展示资源名称\nexport function resourceName(resource, showID = true) {\n    let name = resource.name || `(${resource.remark})`;\n    let { id, level } = resource;\n    let idKey = showID ? `#${id}_${level}` : \"\";\n    return `${name}${idKey}`;\n}\n\n// 角色信息 -> JBBB\nexport async function entityToJBBB(entityID, store) {\n    const WXS_LEVEL = {\n        \"5_24423\": 1,\n        \"5_24424\": 2,\n        \"5_24425\": 3,\n        \"5_24426\": 4,\n        \"5_24427\": 5,\n        \"5_24428\": 6,\n        \"5_24429\": 7,\n        \"5_24430\": 8,\n        \"5_24442\": 1,\n        \"5_24443\": 2,\n        \"5_24444\": 3,\n        \"5_24445\": 4,\n        \"5_24446\": 5,\n        \"5_24447\": 6,\n        \"5_24448\": 7,\n        \"5_24449\": 8,\n    };\n    const POSITION_MAP = {\n        0: \"PRIMARY_WEAPON\",\n        1: \"TERTIARY_WEAPON\",\n        2: \"SECONDARY_WEAPON\",\n        3: \"JACKET\",\n        4: \"HAT\",\n        5: \"NECKLACE\",\n        6: \"RING_1\",\n        7: \"RING_2\",\n        8: \"BELT\",\n        9: \"PENDANT\",\n        10: \"BOTTOMS\",\n        11: \"SHOES\",\n        12: \"WRIST\",\n    };\n\n    const entities = store.result.entities[entityID];\n    if (!entities) return \"{}\";\n    let { equips, talents, name, mount } = entities;\n    const singleTransform = async (equip) => {\n        if (!equip) return {};\n        let { embedding, id, position, strength, enhance, stone } = equip;\n        if (embedding) {\n            embedding = embedding.map((e) => WXS_LEVEL[e] ?? e);\n        }\n        if (stone) {\n            let res = await getEnchantByItemID({ id: stone, client: store.result.client });\n            let enchant = res.data;\n            stone = enchant.ID;\n        }\n        const position_name = POSITION_MAP[position];\n        return {\n            [position_name]: {\n                id,\n                stone,\n                enhance: enhance,\n                enchant: \"\",\n                strength,\n                embedding,\n            },\n        };\n    };\n    equips = await Promise.all(equips.filter((e) => e.position <= 12).map(singleTransform));\n    equips = equips.reduce((a, b) => ({ ...a, ...b }), {});\n    let talentSkills = talents.map((t) => t.skill);\n    let res = await getResource({\n        client: store.result.client,\n        type: \"skill\",\n        ids: talentSkills,\n        fields: [\"SkillID\", \"Level\", \"Name\"],\n    });\n    let skills = res.data;\n    if (skills.length) {\n        skills = skills.reduce((a, b) => ({ ...a, [b.SkillID]: b.Name }), {});\n    } else {\n        skills = {};\n    }\n    talents = talents\n        .map((t) => {\n            let [id, level] = t?.skill?.split(\"_\") ?? [];\n            level;\n            if (id) {\n                return {\n                    id,\n                    name: skills[id],\n                };\n            }\n            return {};\n        })\n        .filter((t) => ~~t.id);\n    return {\n        Title: `${name}`,\n        EquipList: equips,\n        TalentCode: talents,\n        Mount: mount,\n        Client: store.result.client,\n    };\n}\n\nfunction formatSubtype(type, d) {\n    if (type === 1) return d.start ? \"开始战斗\" : \"结束战斗\";\n\n    if (type === 13) {\n        //BUFF更新时间\n        if (d.isDelete) return \"卸除BUFF\";\n        else return \"添加BUFF\";\n    }\n    if (type === 17) {\n        //团队成员掉线/离线\n        if (d.online) return \"上线\";\n        else return \"离线\";\n    }\n    if (type === 21) {\n        //技能效果生效事件\n        return {\n            1: \"技能\",\n            2: \"Buff\",\n        }[d.eventType];\n    }\n    if ([5, 9].includes(type)) {\n        //技能效果生效事件\n        return d.isFight ? \"进战\" : \"脱战\";\n    }\n}\n\nfunction formatSource(type, d) {\n    if ([2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 27, 29].includes(type))\n        //玩家进入/离开, NPC进入/离开, 交互物品进入/离开\n        return {\n            t: \"entity\",\n            v: d.id,\n        };\n    if ([17].includes(type))\n        //source, BUFF来源\n        return {\n            t: \"entity\",\n            v: d.memberID,\n        };\n    if ([13].includes(type))\n        //source, BUFF来源\n        return {\n            t: \"entity\",\n            v: d.source,\n        };\n    if ([19, 20, 21, 22, 23, 24, 25, 26].includes(type))\n        //caster，技能释放者\n        return {\n            t: \"entity\",\n            v: d.caster,\n        };\n    if ([28].includes(type))\n        //killer，击杀者\n        return {\n            t: \"entity\",\n            v: d.killer,\n        };\n    return \"\";\n}\n\nfunction formatContent(type, d) {\n    if (type == 13)\n        //BUFF更新\n        return {\n            t: \"buff\",\n            v: `${d.id}_${d.level}`,\n            n: d.stack,\n        };\n    if ([14, 15, 18].includes(type))\n        //NPC喊话,系统警告,系统信息\n        return {\n            t: \"str\",\n            v: d.content,\n        };\n    if ([19, 20].includes(type))\n        //技能释放,技能释放结果\n        return {\n            t: \"skill\",\n            v: `${d.id}_${d.level}`,\n        };\n    if ([21, 22, 23, 24, 25, 26].includes(type))\n        if (d.eventType === 1)\n            //技能效果生效\n            return {\n                t: \"skill\",\n                v: `${d.id}_${d.level}`,\n            };\n        else\n            return {\n                t: \"buff\",\n                v: `${d.id}_${d.level}`,\n            };\n    if (type === 29) {\n        return {\n            t: \"str\",\n            v: `(${d.x}, ${d.y}, ${d.z})`,\n        };\n    }\n    return {};\n}\n\nfunction formatTarget(type, d) {\n    if ([13, 21, 22, 23, 24, 25, 26].includes(type))\n        //target, 技能目标\n        return {\n            t: \"entity\",\n            v: d.target,\n        };\n    if ([28].includes(type))\n        //id, 被击杀者ID\n        return {\n            t: \"entity\",\n            v: d.id,\n        };\n    return {};\n}\n\nfunction formatValues(type, d) {\n    if (type === 21) {\n        //value, 技能效果值\n        let values = {};\n        for (let i in d.values) {\n            values[SKILL_RESULT_TYPE[i]] = d.values[i];\n        }\n        return values;\n    }\n    return {};\n}\n","/**\n *  base64.ts\n *\n *  Licensed under the BSD 3-Clause License.\n *    http://opensource.org/licenses/BSD-3-Clause\n *\n *  References:\n *    http://en.wikipedia.org/wiki/Base64\n *\n * @author Dan Kogai (https://github.com/dankogai)\n */\nconst version = '3.7.7';\n/**\n * @deprecated use lowercase `version`.\n */\nconst VERSION = version;\nconst _hasBuffer = typeof Buffer === 'function';\nconst _TD = typeof TextDecoder === 'function' ? new TextDecoder() : undefined;\nconst _TE = typeof TextEncoder === 'function' ? new TextEncoder() : undefined;\nconst b64ch = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\nconst b64chs = Array.prototype.slice.call(b64ch);\nconst b64tab = ((a) => {\n    let tab = {};\n    a.forEach((c, i) => tab[c] = i);\n    return tab;\n})(b64chs);\nconst b64re = /^(?:[A-Za-z\\d+\\/]{4})*?(?:[A-Za-z\\d+\\/]{2}(?:==)?|[A-Za-z\\d+\\/]{3}=?)?$/;\nconst _fromCC = String.fromCharCode.bind(String);\nconst _U8Afrom = typeof Uint8Array.from === 'function'\n    ? Uint8Array.from.bind(Uint8Array)\n    : (it) => new Uint8Array(Array.prototype.slice.call(it, 0));\nconst _mkUriSafe = (src) => src\n    .replace(/=/g, '').replace(/[+\\/]/g, (m0) => m0 == '+' ? '-' : '_');\nconst _tidyB64 = (s) => s.replace(/[^A-Za-z0-9\\+\\/]/g, '');\n/**\n * polyfill version of `btoa`\n */\nconst btoaPolyfill = (bin) => {\n    // console.log('polyfilled');\n    let u32, c0, c1, c2, asc = '';\n    const pad = bin.length % 3;\n    for (let i = 0; i < bin.length;) {\n        if ((c0 = bin.charCodeAt(i++)) > 255 ||\n            (c1 = bin.charCodeAt(i++)) > 255 ||\n            (c2 = bin.charCodeAt(i++)) > 255)\n            throw new TypeError('invalid character found');\n        u32 = (c0 << 16) | (c1 << 8) | c2;\n        asc += b64chs[u32 >> 18 & 63]\n            + b64chs[u32 >> 12 & 63]\n            + b64chs[u32 >> 6 & 63]\n            + b64chs[u32 & 63];\n    }\n    return pad ? asc.slice(0, pad - 3) + \"===\".substring(pad) : asc;\n};\n/**\n * does what `window.btoa` of web browsers do.\n * @param {String} bin binary string\n * @returns {string} Base64-encoded string\n */\nconst _btoa = typeof btoa === 'function' ? (bin) => btoa(bin)\n    : _hasBuffer ? (bin) => Buffer.from(bin, 'binary').toString('base64')\n        : btoaPolyfill;\nconst _fromUint8Array = _hasBuffer\n    ? (u8a) => Buffer.from(u8a).toString('base64')\n    : (u8a) => {\n        // cf. https://stackoverflow.com/questions/12710001/how-to-convert-uint8-array-to-base64-encoded-string/12713326#12713326\n        const maxargs = 0x1000;\n        let strs = [];\n        for (let i = 0, l = u8a.length; i < l; i += maxargs) {\n            strs.push(_fromCC.apply(null, u8a.subarray(i, i + maxargs)));\n        }\n        return _btoa(strs.join(''));\n    };\n/**\n * converts a Uint8Array to a Base64 string.\n * @param {boolean} [urlsafe] URL-and-filename-safe a la RFC4648 §5\n * @returns {string} Base64 string\n */\nconst fromUint8Array = (u8a, urlsafe = false) => urlsafe ? _mkUriSafe(_fromUint8Array(u8a)) : _fromUint8Array(u8a);\n// This trick is found broken https://github.com/dankogai/js-base64/issues/130\n// const utob = (src: string) => unescape(encodeURIComponent(src));\n// reverting good old fationed regexp\nconst cb_utob = (c) => {\n    if (c.length < 2) {\n        var cc = c.charCodeAt(0);\n        return cc < 0x80 ? c\n            : cc < 0x800 ? (_fromCC(0xc0 | (cc >>> 6))\n                + _fromCC(0x80 | (cc & 0x3f)))\n                : (_fromCC(0xe0 | ((cc >>> 12) & 0x0f))\n                    + _fromCC(0x80 | ((cc >>> 6) & 0x3f))\n                    + _fromCC(0x80 | (cc & 0x3f)));\n    }\n    else {\n        var cc = 0x10000\n            + (c.charCodeAt(0) - 0xD800) * 0x400\n            + (c.charCodeAt(1) - 0xDC00);\n        return (_fromCC(0xf0 | ((cc >>> 18) & 0x07))\n            + _fromCC(0x80 | ((cc >>> 12) & 0x3f))\n            + _fromCC(0x80 | ((cc >>> 6) & 0x3f))\n            + _fromCC(0x80 | (cc & 0x3f)));\n    }\n};\nconst re_utob = /[\\uD800-\\uDBFF][\\uDC00-\\uDFFFF]|[^\\x00-\\x7F]/g;\n/**\n * @deprecated should have been internal use only.\n * @param {string} src UTF-8 string\n * @returns {string} UTF-16 string\n */\nconst utob = (u) => u.replace(re_utob, cb_utob);\n//\nconst _encode = _hasBuffer\n    ? (s) => Buffer.from(s, 'utf8').toString('base64')\n    : _TE\n        ? (s) => _fromUint8Array(_TE.encode(s))\n        : (s) => _btoa(utob(s));\n/**\n * converts a UTF-8-encoded string to a Base64 string.\n * @param {boolean} [urlsafe] if `true` make the result URL-safe\n * @returns {string} Base64 string\n */\nconst encode = (src, urlsafe = false) => urlsafe\n    ? _mkUriSafe(_encode(src))\n    : _encode(src);\n/**\n * converts a UTF-8-encoded string to URL-safe Base64 RFC4648 §5.\n * @returns {string} Base64 string\n */\nconst encodeURI = (src) => encode(src, true);\n// This trick is found broken https://github.com/dankogai/js-base64/issues/130\n// const btou = (src: string) => decodeURIComponent(escape(src));\n// reverting good old fationed regexp\nconst re_btou = /[\\xC0-\\xDF][\\x80-\\xBF]|[\\xE0-\\xEF][\\x80-\\xBF]{2}|[\\xF0-\\xF7][\\x80-\\xBF]{3}/g;\nconst cb_btou = (cccc) => {\n    switch (cccc.length) {\n        case 4:\n            var cp = ((0x07 & cccc.charCodeAt(0)) << 18)\n                | ((0x3f & cccc.charCodeAt(1)) << 12)\n                | ((0x3f & cccc.charCodeAt(2)) << 6)\n                | (0x3f & cccc.charCodeAt(3)), offset = cp - 0x10000;\n            return (_fromCC((offset >>> 10) + 0xD800)\n                + _fromCC((offset & 0x3FF) + 0xDC00));\n        case 3:\n            return _fromCC(((0x0f & cccc.charCodeAt(0)) << 12)\n                | ((0x3f & cccc.charCodeAt(1)) << 6)\n                | (0x3f & cccc.charCodeAt(2)));\n        default:\n            return _fromCC(((0x1f & cccc.charCodeAt(0)) << 6)\n                | (0x3f & cccc.charCodeAt(1)));\n    }\n};\n/**\n * @deprecated should have been internal use only.\n * @param {string} src UTF-16 string\n * @returns {string} UTF-8 string\n */\nconst btou = (b) => b.replace(re_btou, cb_btou);\n/**\n * polyfill version of `atob`\n */\nconst atobPolyfill = (asc) => {\n    // console.log('polyfilled');\n    asc = asc.replace(/\\s+/g, '');\n    if (!b64re.test(asc))\n        throw new TypeError('malformed base64.');\n    asc += '=='.slice(2 - (asc.length & 3));\n    let u24, bin = '', r1, r2;\n    for (let i = 0; i < asc.length;) {\n        u24 = b64tab[asc.charAt(i++)] << 18\n            | b64tab[asc.charAt(i++)] << 12\n            | (r1 = b64tab[asc.charAt(i++)]) << 6\n            | (r2 = b64tab[asc.charAt(i++)]);\n        bin += r1 === 64 ? _fromCC(u24 >> 16 & 255)\n            : r2 === 64 ? _fromCC(u24 >> 16 & 255, u24 >> 8 & 255)\n                : _fromCC(u24 >> 16 & 255, u24 >> 8 & 255, u24 & 255);\n    }\n    return bin;\n};\n/**\n * does what `window.atob` of web browsers do.\n * @param {String} asc Base64-encoded string\n * @returns {string} binary string\n */\nconst _atob = typeof atob === 'function' ? (asc) => atob(_tidyB64(asc))\n    : _hasBuffer ? (asc) => Buffer.from(asc, 'base64').toString('binary')\n        : atobPolyfill;\n//\nconst _toUint8Array = _hasBuffer\n    ? (a) => _U8Afrom(Buffer.from(a, 'base64'))\n    : (a) => _U8Afrom(_atob(a).split('').map(c => c.charCodeAt(0)));\n/**\n * converts a Base64 string to a Uint8Array.\n */\nconst toUint8Array = (a) => _toUint8Array(_unURI(a));\n//\nconst _decode = _hasBuffer\n    ? (a) => Buffer.from(a, 'base64').toString('utf8')\n    : _TD\n        ? (a) => _TD.decode(_toUint8Array(a))\n        : (a) => btou(_atob(a));\nconst _unURI = (a) => _tidyB64(a.replace(/[-_]/g, (m0) => m0 == '-' ? '+' : '/'));\n/**\n * converts a Base64 string to a UTF-8 string.\n * @param {String} src Base64 string.  Both normal and URL-safe are supported\n * @returns {string} UTF-8 string\n */\nconst decode = (src) => _decode(_unURI(src));\n/**\n * check if a value is a valid Base64 string\n * @param {String} src a value to check\n  */\nconst isValid = (src) => {\n    if (typeof src !== 'string')\n        return false;\n    const s = src.replace(/\\s+/g, '').replace(/={0,2}$/, '');\n    return !/[^\\s0-9a-zA-Z\\+/]/.test(s) || !/[^\\s0-9a-zA-Z\\-_]/.test(s);\n};\n//\nconst _noEnum = (v) => {\n    return {\n        value: v, enumerable: false, writable: true, configurable: true\n    };\n};\n/**\n * extend String.prototype with relevant methods\n */\nconst extendString = function () {\n    const _add = (name, body) => Object.defineProperty(String.prototype, name, _noEnum(body));\n    _add('fromBase64', function () { return decode(this); });\n    _add('toBase64', function (urlsafe) { return encode(this, urlsafe); });\n    _add('toBase64URI', function () { return encode(this, true); });\n    _add('toBase64URL', function () { return encode(this, true); });\n    _add('toUint8Array', function () { return toUint8Array(this); });\n};\n/**\n * extend Uint8Array.prototype with relevant methods\n */\nconst extendUint8Array = function () {\n    const _add = (name, body) => Object.defineProperty(Uint8Array.prototype, name, _noEnum(body));\n    _add('toBase64', function (urlsafe) { return fromUint8Array(this, urlsafe); });\n    _add('toBase64URI', function () { return fromUint8Array(this, true); });\n    _add('toBase64URL', function () { return fromUint8Array(this, true); });\n};\n/**\n * extend Builtin prototypes with relevant methods\n */\nconst extendBuiltins = () => {\n    extendString();\n    extendUint8Array();\n};\nconst gBase64 = {\n    version: version,\n    VERSION: VERSION,\n    atob: _atob,\n    atobPolyfill: atobPolyfill,\n    btoa: _btoa,\n    btoaPolyfill: btoaPolyfill,\n    fromBase64: decode,\n    toBase64: encode,\n    encode: encode,\n    encodeURI: encodeURI,\n    encodeURL: encodeURI,\n    utob: utob,\n    btou: btou,\n    decode: decode,\n    isValid: isValid,\n    fromUint8Array: fromUint8Array,\n    toUint8Array: toUint8Array,\n    extendString: extendString,\n    extendUint8Array: extendUint8Array,\n    extendBuiltins: extendBuiltins\n};\n// makecjs:CUT //\nexport { version };\nexport { VERSION };\nexport { _atob as atob };\nexport { atobPolyfill };\nexport { _btoa as btoa };\nexport { btoaPolyfill };\nexport { decode as fromBase64 };\nexport { encode as toBase64 };\nexport { utob };\nexport { encode };\nexport { encodeURI };\nexport { encodeURI as encodeURL };\nexport { btou };\nexport { decode };\nexport { isValid };\nexport { fromUint8Array };\nexport { toUint8Array };\nexport { extendString };\nexport { extendUint8Array };\nexport { extendBuiltins };\n// and finally,\nexport { gBase64 as Base64 };\n","<template>\n    <!-- 奇穴部分 -->\n    <div class=\"qixue\" style=\"margin: auto\"></div>\n    <!-- iframe部分(配装) -->\n    <div class=\"iframe-container\">\n        <div class=\"button-container\">\n            <button class=\"styled-button\" @click=\"toggleIframe\">显示/隐藏配装</button>\n        </div>\n        <iframe v-if=\"showIframe && iframeSrc\" :src=\"iframeSrc\" class=\"centered-iframe\" frameborder=\"0\"></iframe>\n    </div>\n</template>\n\n<script setup>\nimport { usePve } from \"@/pages/jcl/store_pve.js\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { toRefs, watchPostEffect, ref } from \"vue\";\nimport JX3_QIXUE from \"@jx3box/jx3box-talent\";\nimport \"@jx3box/jx3box-talent/talent.css\";\nimport xfId from \"@jx3box/jx3box-data/data/xf/xfid.json\";\nimport { entityToJBBB } from \"@/utils/jcl/format.js\";\nimport { Base64 } from \"js-base64\";\nimport axios from \"axios\";\n\nconst store = useStore();\nconst { entity } = toRefs(usePve());\nconst loading = ref(false);\nconst iframeSrc = ref(null); // 用于存储 iframe 的 URL\n\n// 控制显示/隐藏的变量\nconst showIframe = ref(false);\n\n// 切换 iframe 部分的显示/隐藏\nfunction toggleIframe() {\n    showIframe.value = !showIframe.value;\n}\n\nasync function updateData() {\n    const { entities, start } = store.result;\n    loading.value = true;\n    // 天外来客不配拥有奇穴\n    if (entity.value === null || entities[entity.value].type == \"npc\") {\n        return;\n    }\n    let talanet_pos = \"\";\n    for (let pos of entities[entity.value].talents) {\n        talanet_pos += pos.position.toString() + \",\";\n    }\n\n    talanet_pos = talanet_pos.substring(0, talanet_pos.length - 1);\n    //const name = PVP_constant.mountId2Name[entities[entity.value].mount];\n    const name = xfId[entities[entity.value].mount];\n\n    // 创建界面前先获取文件版本等信息\n    axios\n        .get(\"https://data.jx3box.com/talent/std/index.json\")\n        .then((response) => {\n            const data = response.data;\n            data.sort((a, b) => {\n                if (a.version < b.version) {\n                    return 1;\n                }\n                if (a.version > b.version) {\n                    return -1;\n                }\n                return 0;\n            });\n            const file_version =\n                \"v\" +\n                new Date(parseInt(start.sec * 1000))\n                    .toLocaleString()\n                    .replace(/:\\d{1,2}$/, \" \")\n                    .split(\" \")[0]\n                    .replaceAll(\"/\", \"\");\n            let version;\n            for (let date of data) {\n                if (file_version > date.version) {\n                    version = date.version;\n                    break;\n                }\n            }\n            new JX3_QIXUE({\n                container: \".qixue\",\n                xf: name,\n                sq: talanet_pos,\n                editable: false,\n                client: \"std\",\n                version: version,\n            });\n            loading.value = false;\n        })\n        .catch((error) => {\n            this.$message.error(error);\n            return;\n        });\n    let equip_obj = await entityToJBBB(entity.value, store);\n    console.log(equip_obj);\n\n    // 更新 iframe 的 src 地址\n    const code = encodeURIComponent(Base64.encode(JSON.stringify(equip_obj)));\n    iframeSrc.value = `https://www.jx3box.com/pz/iframe.html?code=${code}`;\n    console.log(iframeSrc.value);\n}\nwatchPostEffect(updateData);\n</script>\n<style scoped>\n.iframe-container {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    position: relative;\n    margin-top: 20px;\n    margin-bottom: 20px;\n}\n\n.button-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1000;\n}\n\n.styled-button {\n    background-color: #303133;\n    color: white;\n    padding: 10px 20px;\n    border: none;\n    border-radius: 5px;\n    cursor: pointer;\n    transition: background-color 0.3s ease;\n}\n\n.styled-button:hover {\n    background-color: #e4ece4;\n    color: black;\n}\n\n.styled-button:active {\n    background-color: #e4ece4;\n    transform: translateY(4px);\n}\n\n.centered-iframe {\n    width: 1280px;\n    height: 720px;\n}\n</style>\n","import script from \"./player_qixue.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./player_qixue.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./player_qixue.vue?vue&type=style&index=0&id=9966cd52&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-9966cd52\"]])\n\nexport default __exports__","import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, unref as _unref, createVNode as _createVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-entity-chart\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"u-empty-tip\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"u-chart\"\n};\nimport { graphic } from \"echarts/core\";\nimport VChart from \"vue-echarts\";\nimport { debounce } from \"lodash-es\";\nimport { computed, toRefs, ref } from \"vue\";\nimport { getEntityColor } from \"@/utils/jcl/common\";\n// import { displayDuration, displayDigits, displayPercent } from \"@/utils/jcl/commonNoStore\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nexport default {\n  __name: 'entity_view_chart',\n  setup(__props) {\n    const {\n      end: _end\n    } = useStore().result;\n    const {\n      entity,\n      entityTab,\n      entityTimeRange\n    } = toRefs(usePve());\n    const entityColor = computed(() => getEntityColor(entity.value));\n\n    // 缩放/时间范围逻辑\n    const endMicro = computed(() => (_end === null || _end === void 0 ? void 0 : _end.micro) || 0);\n    const handleDatazoom = debounce(e => {\n      const {\n        start,\n        end\n      } = e;\n      entityTimeRange.value[entity.value] = [start * endMicro.value / 100, end * endMicro.value / 100];\n    }, 500, {\n      leading: true\n    });\n\n    // 图表数据处理、更新\n    const loading = ref(false);\n    const xData = ref([]);\n    const yData = ref([]);\n    const option = computed(() => {\n      return {\n        grid: {\n          x: 60,\n          y: 20,\n          right: 0\n          // x2: 40,\n          // y2: 40,\n        },\n        backgroundColor: \"transparent\",\n        tooltip: {\n          trigger: \"axis\",\n          formatter: `每秒数值: {c}`,\n          position: function (pt) {\n            return [pt[0], 0.1];\n          }\n        },\n        xAxis: {\n          type: \"category\",\n          boundaryGap: [0.1, 0.1],\n          data: xData.value,\n          triggerEvent: true\n        },\n        yAxis: {\n          type: \"value\",\n          boundaryGap: [0, 0.2]\n        },\n        series: [{\n          type: \"line\",\n          showSymbol: false,\n          itemStyle: {\n            color: entityColor.value\n          },\n          areaStyle: {\n            color: new graphic.LinearGradient(0, 0, 0, 1, [{\n              offset: 0,\n              color: `${entityColor.value}66`\n            }, {\n              offset: 1,\n              color: `${entityColor.value}ff`\n            }])\n          },\n          data: yData.value\n        }],\n        dataZoom: [{\n          type: \"slider\",\n          filterMode: \"filter\",\n          bottom: 10\n        }]\n      };\n    });\n    const updateData = () => {\n      loading.value = true;\n      getWorkerResponse(\"get_pve_entity_stat_chart\", {\n        entity: entity.value,\n        entityTab: entityTab.value\n      }).then(data => {\n        xData.value = data.xData;\n        yData.value = data.yData;\n        loading.value = false;\n      });\n    };\n    watchPostEffect(updateData);\n    return (_ctx, _cache) => {\n      const _directive_loading = _resolveDirective(\"loading\");\n      return _withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_1, [xData.value.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, \"该单位没有相关数据\")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createVNode(_unref(VChart), {\n        ref: \"echart\",\n        theme: \"dark\",\n        option: option.value,\n        autoresize: \"\",\n        onDatazoom: _unref(handleDatazoom)\n      }, null, 8, [\"option\", \"onDatazoom\"])]))])), [[_directive_loading, loading.value]]);\n    };\n  }\n};","import script from \"./entity_view_chart.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_view_chart.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_view_chart.vue?vue&type=style&index=0&id=6a1671e1&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-6a1671e1\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-entity-chart\">\n        <div class=\"w-card m-chart-box\">\n            <!-- 切换伤害/治疗/BUFF分析 -->\n            <div class=\"u-filter-items\">\n                <div\n                    v-for=\"(tab, index) in tabs\"\n                    :key=\"index\"\n                    :class=\"{ 'is-active': entityTab == tab.name }\"\n                    @click=\"switchTab(tab.name)\"\n                    class=\"u-filter-item\"\n                >\n                    {{ tab.title }}\n                </div>\n            </div>\n            <template v-if=\"entityTab === 'buff'\">\n                <entity-buff-table></entity-buff-table>\n            </template>\n            <template v-else-if=\"entityTab === 'skill'\">\n                <entity-skill-chart></entity-skill-chart>\n            </template>\n            <template v-else>\n                <!-- 单位图表以及总览 -->\n                <entity-chart></entity-chart>\n            </template>\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { toRefs } from \"vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\n\nimport EntityChart from \"./entity_view_chart.vue\";\n\nimport EntityBuffTable from \"./entity_buff_table.vue\";\n\nconst { entityTab } = toRefs(usePve());\n\nconst tabs = [\n    {\n        name: \"damage\",\n        title: \"伤害\",\n    },\n    {\n        name: \"treat\",\n        title: \"治疗\",\n    },\n    {\n        name: \"beDamaged\",\n        title: \"承伤\",\n    },\n    {\n        name: \"beTreated\",\n        title: \"承疗\",\n    },\n];\nconst switchTab = (tab) => {\n    if (tab === entityTab.value) return;\n    entityTab.value = tab;\n};\n</script>\n\n<style lang=\"less\">\n.m-chart-box {\n    height: 390px;\n    padding: 20px;\n    border-radius: 16px;\n    background: #282828;\n    display: flex;\n    flex-direction: column;\n    .u-filter-items {\n        margin-bottom: 20px;\n        display: flex;\n        gap: 10px;\n        height: 26px;\n        .u-filter-item {\n            cursor: pointer;\n            .fz(20px,26px);\n            color: rgba(255, 255, 255, 0.3);\n            font-weight: bold;\n            &.is-active {\n                color: #fff;\n            }\n        }\n    }\n    .m-chart {\n        flex: 1;\n    }\n}\n</style>\n","import script from \"./detail_chart.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./detail_chart.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./detail_chart.vue?vue&type=style&index=0&id=f3933a04&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","import \"core-js/modules/es.array.push.js\";\nimport { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, unref as _unref, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-main\"\n};\nconst _hoisted_2 = {\n  class: \"m-setting-wrap\"\n};\nconst _hoisted_3 = {\n  class: \"w-card m-main-setting\"\n};\nconst _hoisted_4 = {\n  class: \"u-title\"\n};\nconst _hoisted_5 = {\n  class: \"u-seeting-action\"\n};\nconst _hoisted_6 = [\"onClick\"];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n  class: \"w-card m-main-player\"\n};\nconst _hoisted_9 = {\n  class: \"m-player-list\"\n};\nconst _hoisted_10 = [\"title\", \"onClick\"];\nconst _hoisted_11 = [\"src\"];\nconst _hoisted_12 = {\n  class: \"u-name\"\n};\nconst _hoisted_13 = {\n  class: \"u-timer\"\n};\nconst _hoisted_14 = {\n  class: \"u-timer\"\n};\nconst _hoisted_15 = {\n  class: \"w-card m-main-npc\"\n};\nconst _hoisted_16 = {\n  class: \"m-npc-list\"\n};\nconst _hoisted_17 = [\"onClick\"];\nconst _hoisted_18 = {\n  class: \"m-npc-item__left\"\n};\nconst _hoisted_19 = [\"src\"];\nconst _hoisted_20 = {\n  class: \"u-name\"\n};\nconst _hoisted_21 = {\n  class: \"u-timer\"\n};\nimport moment from \"moment\";\nimport { getMountIcon, getEntityName } from \"@/utils/jcl/common\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { ElMessage } from \"element-plus\";\nconst pageSize = 22;\nexport default {\n  __name: 'entity_select',\n  props: {\n    onSelected: Function,\n    onSelectEntity: Function,\n    entityList: {\n      tyep: Array,\n      default: () => []\n    },\n    max: Number,\n    isCompare: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(__props) {\n    const store = useStore();\n    const props = __props;\n    const {\n      entityList,\n      max,\n      isCompare\n    } = toRefs(props);\n    const npcList = ref([]);\n    const playerList = ref([]);\n    const filters = ref([\"hideBelong\", \"hideNoName\", \"hideSameTemplate\"]);\n    const filterList = [{\n      name: \"hideBelong\",\n      title: \"有归属的单位\"\n    }, {\n      name: \"hideNoName\",\n      title: \"无名的单位\"\n    }, {\n      name: \"hideSameTemplate\",\n      title: \"同模板的单位\"\n    }];\n\n    // 切换筛选\n    const switchFilter = filter => {\n      if (filters.value.includes(filter)) {\n        filters.value = filters.value.filter(f => f !== filter);\n      } else {\n        filters.value.push(filter);\n      }\n    };\n\n    // 选择单位事件\n    const selectEntity = row => {\n      if (entityList.value.includes(row.id)) {\n        entityList.value = entityList.value.filter(id => id !== row.id);\n        props.onSelectEntity && props.onSelectEntity(row, false);\n      } else {\n        const len = entityList.value.filter(item => item != null).length;\n        if (max.value && len >= max.value) {\n          ElMessage(\"最多选中\" + max.value + \"个实体\");\n          return;\n        }\n        entityList.value = [...entityList.value, row.id];\n        props.onSelectEntity && props.onSelectEntity(row, true);\n      }\n    };\n    // 点击分析\n    const click = () => {\n      props.onSelected && props.onSelected(entityList.value);\n    };\n\n    // 获取列表数据\n    const data = computed(() => {\n      const {\n        entities\n      } = store.result;\n      let _templateExist = {};\n      let index = 1;\n      let entitiesArr = Object.values(entities).filter(e => {\n        if (!e.id) return;\n        if (filters.value.includes(\"hideBelong\") && e.belongID) return false;\n        if (filters.value.includes(\"hideNoName\") && !e.name) return false;\n        if (filters.value.includes(\"hideSameTemplate\") && e.type === \"npc\") {\n          if (_templateExist[e.templateID] === true) return false;\n          _templateExist[e.templateID] = true;\n        }\n        e.index = index++;\n        return true;\n      });\n      const playerList = entitiesArr.filter(item => item.type === \"player\");\n      const npcList = entitiesArr.filter(item => item.type === \"npc\");\n      return {\n        playerList,\n        npcList\n      };\n    }, [store.result]);\n\n    // 监听 data 的变化\n    watch(data, newVal => {\n      npcList.value = newVal.npcList;\n      playerList.value = newVal.playerList;\n    }, {\n      deep: true,\n      immediate: true\n    });\n    const {\n      currentPage,\n      currentData,\n      total\n    } = usePaginate(npcList, ref(pageSize));\n    const formatTime = microseconds => {\n      if (!microseconds) {\n        return \"-\";\n      }\n      return moment.utc(microseconds).format(\"HH:mm:ss\");\n    };\n    return (_ctx, _cache) => {\n      const _component_el_pagination = _resolveComponent(\"el-pagination\");\n      return _openBlock(), _createElementBlock(\"div\", null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_cache[1] || (_cache[1] = _createElementVNode(\"p\", {\n        class: \"m-main-subtitle\"\n      }, \"设定\", -1)), (_openBlock(), _createElementBlock(_Fragment, null, _renderList(filterList, (filter, index) => {\n        return _createElementVNode(\"div\", {\n          class: \"m-seeting-item\",\n          key: index\n        }, [_createElementVNode(\"p\", _hoisted_4, _toDisplayString(filter.title), 1), _createElementVNode(\"p\", _hoisted_5, [_createElementVNode(\"span\", {\n          class: _normalizeClass({\n            'is-active': _unref(filters).includes(filter.name)\n          }),\n          onClick: $event => switchFilter(filter.name)\n        }, \" 隐藏 \", 10, _hoisted_6), _createElementVNode(\"span\", {\n          class: _normalizeClass({\n            'is-active': !_unref(filters).includes(filter.name)\n          }),\n          onClick: $event => switchFilter(filter.name)\n        }, \" 显示 \", 10, _hoisted_7)])]);\n      }), 64))]), _createElementVNode(\"div\", {\n        class: \"u-btn\",\n        onClick: click\n      }, \"分析\")]), _createElementVNode(\"div\", _hoisted_8, [_cache[2] || (_cache[2] = _createElementVNode(\"p\", {\n        class: \"m-main-subtitle\"\n      }, \"玩家\", -1)), _createElementVNode(\"div\", _hoisted_9, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(playerList), (item, index) => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          class: _normalizeClass([\"m-player-item\", {\n            // 'is-disabled': true,\n            'is-active': _unref(entityList).includes(item.id)\n          }]),\n          key: index,\n          title: _unref(getEntityName)(item.id, {\n            showRegion: true\n          }),\n          onClick: $event => selectEntity(item)\n        }, [_createElementVNode(\"img\", {\n          class: \"u-mount-icon\",\n          src: _unref(getMountIcon)(item.id),\n          alt: \"\"\n        }, null, 8, _hoisted_11), _createElementVNode(\"p\", _hoisted_12, _toDisplayString(_unref(getEntityName)(item.id)), 1), _createElementVNode(\"p\", _hoisted_13, _toDisplayString(item.timer), 1), _createElementVNode(\"p\", _hoisted_14, _toDisplayString(formatTime(item.firstAppear ? item.firstAppear.micro : null)), 1)], 10, _hoisted_10);\n      }), 128))])]), _createElementVNode(\"div\", _hoisted_15, [_cache[3] || (_cache[3] = _createElementVNode(\"p\", {\n        class: \"m-main-subtitle\"\n      }, \"NPC\", -1)), _createElementVNode(\"div\", null, [_createElementVNode(\"div\", _hoisted_16, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(currentData), (item, index) => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          class: _normalizeClass([\"m-npc-item\", {\n            'is-disabled': _unref(isCompare),\n            'is-active': !_unref(isCompare) && _unref(entityList).includes(item.id)\n          }]),\n          key: index,\n          onClick: $event => selectEntity(item)\n        }, [_createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"img\", {\n          class: \"u-mount-icon\",\n          src: _unref(getMountIcon)(item.id),\n          alt: \"\"\n        }, null, 8, _hoisted_19), _createElementVNode(\"p\", _hoisted_20, _toDisplayString(_unref(getEntityName)(item.id)), 1)]), _createElementVNode(\"p\", _hoisted_21, _toDisplayString(formatTime(item.firstAppear ? item.firstAppear.micro : null)), 1)], 10, _hoisted_17);\n      }), 128))]), _createVNode(_component_el_pagination, {\n        class: \"w-pagination\",\n        small: \"\",\n        background: \"\",\n        layout: \"pager\",\n        \"page-size\": pageSize,\n        total: _unref(total),\n        \"hide-on-single-page\": true,\n        \"current-page\": _unref(currentPage),\n        \"onUpdate:currentPage\": _cache[0] || (_cache[0] = $event => currentPage.value = $event)\n      }, null, 8, [\"total\", \"current-page\"])])])])]);\n    };\n  }\n};","import script from \"./entity_select.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./entity_select.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./entity_select.vue?vue&type=style&index=0&id=1c511010&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1c511010\"]])\n\nexport default __exports__","import \"core-js/modules/es.array.push.js\";\nimport { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  key: 1\n};\nconst _hoisted_2 = {\n  class: \"m-main\"\n};\nimport PveHeaderBar from \"@/components/jcl/pve/header_bar.vue\";\nimport DetailInfo from \"@/components/jcl/pve/detail_info.vue\";\nimport EntityViewEffect from \"./entity_view_effect.vue\";\nimport EntityViewSkill from \"./entity_view_skill.vue\";\nimport EntityViewBuff from \"./entity_view_buff.vue\";\nimport PlayerQixue from \"@/components/jcl/pve/player_qixue.vue\";\nimport DetailChart from \"@/components/jcl/pve/detail_chart.vue\";\nimport EntitySelect from \"@/components/jcl/pve/entity_select.vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nexport default {\n  __name: 'pve_detail',\n  setup(__props) {\n    const {\n      entityList,\n      entity,\n      entitySelectVisible\n    } = toRefs(usePve());\n    const onSelectEntity = (data, v) => {\n      if (v) {\n        entityList.value.push(data.id);\n        if (!entity.value) {\n          entity.value = entityList.value[0];\n        }\n      } else {\n        entityList.value = entityList.value.filter(item => item !== data.id);\n        if (entity.value === data.id) {\n          entity.value = entityList.value[0];\n        }\n      }\n    };\n    const onSelected = () => {\n      entitySelectVisible.value = false;\n    };\n    onBeforeMount(() => {\n      if (entityList.value.length <= 0) {\n        entitySelectVisible.value = true;\n      }\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", null, [_unref(entitySelectVisible) ? (_openBlock(), _createBlock(EntitySelect, {\n        key: 0,\n        entityList: _unref(entityList),\n        onSelected: onSelected,\n        onSelectEntity: onSelectEntity\n      }, null, 8, [\"entityList\"])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(PveHeaderBar), _createElementVNode(\"div\", _hoisted_2, [_createVNode(DetailInfo), _createVNode(PlayerQixue), _createVNode(DetailChart), _createVNode(EntityViewEffect), _createVNode(EntityViewSkill), _createVNode(EntityViewBuff)])]))]);\n    };\n  }\n};","import script from \"./pve_detail.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./pve_detail.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./pve_detail.vue?vue&type=style&index=0&id=bf156f58&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-bf156f58\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-compare-option\">\n        <div class=\"m-compare-mode\">\n            <div class=\"u-title\">对比模式</div>\n            <div class=\"u-tabs\">\n                <div\n                    v-for=\"(item, index) in tabs\"\n                    :key=\"index\"\n                    class=\"u-tab\"\n                    :class=\"{ 'is-active': compareMode === item.name }\"\n                    @click=\"compareMode = item.name\"\n                >\n                    <div class=\"u-icon\"><img :src=\"item.icon\" alt=\"\" /></div>\n                    <div class=\"u-title\">{{ item.title }}</div>\n                    <!-- <div class=\"u-subtitle\">对比</div> -->\n                </div>\n            </div>\n        </div>\n        <div class=\"m-compare-entity\">\n            <p class=\"u-title\">单位选择</p>\n            <ul>\n                <li\n                    v-for=\"(id, index) in compareEntity\"\n                    :key=\"index\"\n                    :class=\"{\n                        'is-active': id != null,\n                    }\"\n                    @click.stop=\"showSelectView(id)\"\n                >\n                    <div v-if=\"id == null\">\n                        <el-icon><Plus /></el-icon>\n                    </div>\n                    <div v-else>\n                        <div class=\"u-entity\">\n                            <div class=\"u-entity-icon\">\n                                <img :src=\"getMountIcon(id)\" alt=\"\" />\n                            </div>\n                            <div class=\"u-entity-name\">{{ getEntityName(id) }}</div>\n                        </div>\n                        <el-icon class=\"u-close\" @click.stop=\"removeEntity(id)\"><Close /></el-icon>\n                    </div>\n                </li>\n            </ul>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { getMountIcon, getEntityName } from \"@/utils/jcl/common\";\nimport { mapWritableState } from \"pinia\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store\";\n\nexport default {\n    name: \"CompareOption\",\n    data: () => ({\n        tabs: [\n            {\n                title: \"伤害\",\n                name: \"damage\",\n                icon: require(\"@/assets/img/jcl/stat/damage.svg\"),\n            },\n            {\n                title: \"治疗\",\n                name: \"treat\",\n                icon: require(\"@/assets/img/jcl/stat/treat.svg\"),\n            },\n            {\n                title: \"承伤\",\n                name: \"beDamaged\",\n                icon: require(\"@/assets/img/jcl/stat/beDamaged.svg\"),\n            },\n            {\n                title: \"承疗\",\n                name: \"beTreated\",\n                icon: require(\"@/assets/img/jcl/stat/beTreated.svg\"),\n            },\n            {\n                title: \"主动招式\",\n                name: \"skill\",\n                icon: require(\"@/assets/img/jcl/stat/swirl.svg\"),\n            },\n        ],\n    }),\n    computed: {\n        ...mapWritableState(usePve, [\"compareEntity\", \"compareSelectVisible\", \"compareMode\"]),\n        entities() {\n            const store = useStore();\n            return Object.values(store.result.entities)\n                .slice(1)\n                .filter((player) => player.type === \"player\");\n        },\n    },\n    methods: {\n        getMountIcon,\n        getEntityName,\n        removeEntity(id) {\n            this.compareEntity = this.compareEntity.map((item) => (item == id ? null : item));\n            const arr = this.compareEntity.filter((item) => item != null);\n            if (arr.length == 0) {\n                this.compareSelectVisible = true;\n            }\n        },\n        showSelectView(id) {\n            if (id == null) {\n                this.compareSelectVisible = true;\n            }\n        },\n    },\n};\n</script>\n\n<style lang=\"less\">\n.m-compare-option {\n    .w(400px);\n    display: flex;\n    flex-direction: column;\n    gap: 20px;\n    .u-title {\n        .fz(20px,26px);\n        .bold;\n        .mb(10px);\n    }\n    .m-compare-entity {\n        ul {\n            .flex;\n            gap: 10px;\n            li {\n                .flex;\n                .size(100px,100px);\n                box-sizing: border-box;\n                font-size: 24px;\n                padding: 10px;\n                cursor: pointer;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                position: relative;\n                background: #282828;\n                border-radius: 4px;\n                &.is-active {\n                    justify-content: start;\n                }\n                .u-close {\n                    position: absolute;\n                    top: 0;\n                    right: 0;\n                    cursor: pointer;\n                    font-size: 12px;\n                    padding: 4px;\n                }\n                .u-entity-icon {\n                    width: 18px;\n                    height: 18px;\n                    padding-bottom: 10px;\n                }\n                .u-entity-name {\n                    font-size: 14px;\n                }\n\n                &:nth-of-type(1):hover {\n                    background: rgba(255, 97, 97, 1);\n                }\n                &:nth-of-type(2):hover {\n                    background: rgba(40, 207, 90, 1);\n                }\n                &:nth-of-type(3):hover {\n                    background: rgba(65, 105, 225, 1);\n                }\n                &:nth-of-type(4):hover {\n                    background: rgba(232, 204, 58, 1);\n                }\n            }\n        }\n    }\n\n    .m-compare-mode {\n        .w(400px);\n\n        .u-tabs {\n            flex-grow: 1;\n            display: flex;\n            gap: 10px;\n        }\n\n        .u-tab {\n            .pointer;\n            .flex-center;\n            .bold;\n            box-sizing: border-box;\n            gap: 5px;\n            padding: 10px;\n            flex-shrink: 0;\n            flex-grow: 1;\n            background: #282828;\n            height: 100px;\n            border-radius: 10px;\n            color: #b3b3b3;\n            transition: all 0.3s ease-in-out;\n            .u-title {\n                .mb(0);\n                .fz(14px, 22px);\n            }\n            &:not(.is-active) .u-title {\n                .size(17px, auto);\n            }\n            &:not(.is-active) {\n                .u-subtitle,\n                .u-icon {\n                    display: none;\n                }\n            }\n\n            &.is-active {\n                transition: flex-grow 0.3s ease-in-out;\n                flex-grow: 1.4;\n                background: rgba(182, 196, 204, 1);\n                color: #000;\n                flex-direction: column;\n                justify-content: center;\n                align-items: flex-start;\n\n                .u-title {\n                    .fz(30px, 40px);\n                }\n\n                .u-subtitle {\n                    .fz(16px, 21px);\n                }\n            }\n        }\n\n        .u-icon {\n            .size(40px);\n        }\n    }\n}\n.m-select-popper {\n    .u-entity {\n        display: flex;\n        align-items: center;\n        gap: 10px;\n    }\n\n    .u-entity-icon {\n        .size(30px, 30px);\n    }\n\n    .u-entity-name {\n        display: block;\n        flex-grow: 1;\n    }\n}\n</style>\n","import { render } from \"./compare_option.vue?vue&type=template&id=761be8e0\"\nimport script from \"./compare_option.vue?vue&type=script&lang=js\"\nexport * from \"./compare_option.vue?vue&type=script&lang=js\"\n\nimport \"./compare_option.vue?vue&type=style&index=0&id=761be8e0&lang=less\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { unref as _unref, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createVNode as _createVNode, resolveDirective as _resolveDirective, createElementBlock as _createElementBlock, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  key: 1,\n  class: \"m-pie-card\"\n};\nconst _hoisted_2 = {\n  class: \"m-pie-info\"\n};\nconst _hoisted_3 = {\n  class: \"u-value\"\n};\nconst _hoisted_4 = {\n  class: \"u-pie-list\"\n};\nconst _hoisted_5 = {\n  class: \"u-pie\"\n};\nconst _hoisted_6 = {\n  class: \"u-pie\"\n};\nimport VChart from \"vue-echarts\";\nimport { use } from \"echarts/core\";\nimport { CanvasRenderer } from \"echarts/renderers\";\nimport { PieChart } from \"echarts/charts\";\nimport { TooltipComponent } from \"echarts/components\";\nimport \"echarts/lib/component/title\";\nimport EmptyGuide from \"@/components/jcl/common/empty_guide.vue\";\nimport { ref, watchPostEffect } from \"vue\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { displayDigits, displayPercent } from \"@/utils/jcl/commonNoStore\";\nexport default {\n  __name: 'compare_card_chart',\n  props: {\n    statType: {\n      type: String,\n      required: true\n    }\n  },\n  setup(__props) {\n    use([CanvasRenderer, PieChart, TooltipComponent]);\n    const {\n      compareEntity\n    } = toRefs(usePve());\n    // data\n    const loading = ref(false);\n    const total = ref(0);\n    const vps = ref(0);\n    const critRate = ref(0);\n    const echart = ref(null);\n    const show = computed(() => {\n      // 是否有选中的\n      return compareEntity.value.filter(item => item).length == 0;\n    });\n    const props = __props;\n    const entityOption = ref({\n      backgroundColor: \"#282828\",\n      title: {\n        text: \"\",\n        x: \"center\",\n        y: \"center\",\n        textStyle: {\n          fontSize: \"14px\",\n          fontWeight: \"normal\",\n          color: \"#fff\"\n        }\n      },\n      tooltip: {\n        trigger: \"item\",\n        formatter: \"{a} <br/>{b} : {c} ({d}%)\"\n      },\n      series: [{\n        name: \"数值占比\",\n        type: \"pie\",\n        radius: [\"50%\", \"90%\"],\n        center: [\"50%\", \"50%\"],\n        data: [],\n        // selectedMode: \"multiple\",\n        label: {\n          show: false\n        },\n        labelLine: {\n          show: false\n        },\n        itemStyle: {\n          borderRadius: 5,\n          borderWidth: 2,\n          borderColor: \"#282828\"\n        }\n      }]\n    });\n    const teamOption = ref({\n      backgroundColor: \"#282828\",\n      title: {\n        text: \"\",\n        x: \"center\",\n        y: \"center\",\n        textStyle: {\n          fontSize: \"14px\",\n          fontWeight: \"normal\",\n          color: \"#fff\"\n        }\n      },\n      tooltip: {\n        trigger: \"item\",\n        formatter: \"{a} <br/>{b} : {c} ({d}%)\"\n      },\n      series: [{\n        name: \"数值占比\",\n        type: \"pie\",\n        radius: [\"50%\", \"90%\"],\n        center: [\"50%\", \"50%\"],\n        data: [],\n        // selectedMode: \"multiple\",\n        label: {\n          show: false\n        },\n        labelLine: {\n          show: false\n        },\n        itemStyle: {\n          borderRadius: 5,\n          borderWidth: 2,\n          borderColor: \"#282828\"\n        }\n      }]\n    });\n    const tabs = [{\n      name: \"damage\",\n      title: \"伤害\"\n    }, {\n      name: \"treat\",\n      title: \"治疗\"\n    }, {\n      name: \"beDamaged\",\n      title: \"承伤\"\n    }, {\n      name: \"beTreated\",\n      title: \"承疗\"\n    }];\n    const title = computed(() => {\n      return tabs.find(tab => tab.name === props.statType).title || \"-\";\n    });\n    const getItemColor = id => {\n      const index = compareEntity.value.findIndex(item => item === id);\n      switch (index) {\n        case 0:\n          return \"rgba(255, 97, 97, 1)\";\n        case 1:\n          return \"rgba(40, 207, 90, 1)\";\n        case 2:\n          return \"rgba(65, 105, 225, 1)\";\n        case 3:\n          return \"rgba(232, 204, 58, 1)\";\n        default:\n          return \"rgba(28, 28, 28, 0.8)\";\n      }\n    };\n    const updateData = () => {\n      loading.value = true;\n      getWorkerResponse(\"get_pve_compare_pie\", {\n        statType: props.statType,\n        compareEntity: compareEntity.value.join(\",\")\n      }).then(({\n        result,\n        total: _total,\n        vps: _vps,\n        critRate: _critRate,\n        teamTotal\n      }) => {\n        total.value = _total;\n        vps.value = _vps;\n        critRate.value = _critRate;\n        const data = result.map(item => {\n          return {\n            ...item,\n            itemStyle: {\n              color: getItemColor(item.id)\n            }\n          };\n        });\n        if (data.length) {\n          entityOption.value.series[0].data = data;\n        } else {\n          entityOption.value.series[0].data = [{\n            itemStyle: {\n              color: \"rgba(28, 28, 28, 0.8)\"\n            },\n            name: \"暂无数据\",\n            value: 0\n          }];\n        }\n        const teamValue = teamTotal - data.reduce((acc, cur) => acc + cur.value, 0);\n        const teamData = [...data, {\n          id: \"team\",\n          itemStyle: {\n            color: \"rgba(28, 28, 28, 0.8)\"\n          },\n          name: \"团队\",\n          value: teamValue\n        }];\n        teamOption.value.series[0].data = teamData;\n        loading.value = false;\n      });\n    };\n    watchPostEffect(updateData);\n    return (_ctx, _cache) => {\n      const _directive_loading = _resolveDirective(\"loading\");\n      return _unref(show) ? (_openBlock(), _createBlock(EmptyGuide, {\n        key: 0,\n        rotate: -180,\n        tips: ['请选择单位'],\n        grow: false\n      })) : (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"p\", null, \"总\" + _toDisplayString(_unref(title)), 1), _createElementVNode(\"p\", _hoisted_3, _toDisplayString(total.value), 1), _createElementVNode(\"p\", null, \" 平均 \" + _toDisplayString(_unref(displayDigits)(vps.value)) + \"/s 会心 \" + _toDisplayString(_unref(displayPercent)(critRate.value)), 1)]), _withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createVNode(_unref(VChart), {\n        ref_key: \"echart\",\n        ref: echart,\n        theme: \"dark\",\n        option: teamOption.value,\n        autoresize: \"\"\n      }, null, 8, [\"option\"]), _cache[0] || (_cache[0] = _createElementVNode(\"p\", {\n        class: \"u-title\"\n      }, \"团队占比\", -1))]), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_unref(VChart), {\n        ref_key: \"echart\",\n        ref: echart,\n        theme: \"dark\",\n        option: entityOption.value,\n        autoresize: \"\"\n      }, null, 8, [\"option\"]), _cache[1] || (_cache[1] = _createElementVNode(\"p\", {\n        class: \"u-title\"\n      }, \"单位对比\", -1))])])), [[_directive_loading, loading.value]])]));\n    };\n  }\n};","import script from \"./compare_card_chart.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./compare_card_chart.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./compare_card_chart.vue?vue&type=style&index=0&id=b05b3662&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-b05b3662\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-compare-item w-card\">\n        <div class=\"u-title\">{{ getEntityName(entity) }}</div>\n        <el-table\n            class=\"w-table\"\n            height=\"370\"\n            :data=\"data\"\n            @sort-change=\"sortSkill\"\n            @row-click=\"selectSkill\"\n            :row-class-name=\"rowClass\"\n        >\n            <el-table-column prop=\"name\" label=\"\">\n                <template #default=\"{ row }\">\n                    <span :title=\"getResourceName(row.effect, { showID: true })\">{{\n                        getResourceName(row.effect, { showID: false })\n                    }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column prop=\"count\" label=\"次数\" sortable=\"custom\"></el-table-column>\n            <el-table-column prop=\"value\" label=\"伤害/治疗\" sortable=\"custom\">\n                <template #default=\"{ row }\">\n                    <span>{{ row.value }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column prop=\"avg\" label=\"比重\" sortable=\"custom\">\n                <template #default=\"{ row }\">\n                    <span> {{ displayPercent(row.valueRate) }}</span>\n                </template>\n            </el-table-column>\n        </el-table>\n    </div>\n</template>\n\n<script setup>\n// import EmptyGuide from \"@/components/jcl/common/empty_guide.vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { getResourceName, getEntityName } from \"@/utils/jcl/common\";\nimport { displayPercent } from \"@/utils/jcl/commonNoStore\";\nimport { toRefs, ref, computed, watchPostEffect } from \"vue\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nconst { compareEntity, compareMode, compareEffect, compareEffectList } = toRefs(usePve());\n// props\nconst props = defineProps({\n    index: {\n        type: Number,\n        default: 1,\n    },\n});\nconst { index } = toRefs(props);\nconst entity = computed(() => {\n    return compareEntity.value[index.value - 1];\n});\n// data\nconst loading = ref(false);\nconst logs = ref([]);\n\n// 技能列表\nconst overview = ref([]);\nconst data = ref([]);\n\nconst updateData = () => {\n    loading.value = true;\n    compareEffect.value = null;\n    logs.value = [];\n    getWorkerResponse(\"get_pve_compare\", {\n        compareMode: compareMode.value,\n        entity: entity.value,\n        timeRange: [0, 1000000000],\n    })\n        .then((res) => {\n            data.value = res.data;\n            overview.value = res.overview;\n            loading.value = false;\n        })\n        .catch((err) => {\n            console.log(err);\n        });\n};\n\nconst updateCompareEffectList = () => {\n    compareEffectList.value[index.value - 1] = data.value.find((item) => item.effect === compareEffect.value) || null;\n};\n\n// 各种表格交互/样式\nconst rowClass = ({ row }) => {\n    return row.effect === compareEffect.value ? \"is-focus\" : \"\";\n};\nconst selectSkill = (row) => {\n    if (compareEffect.value === row.effect) {\n        compareEffect.value = null;\n        logs.value = [];\n    } else {\n        compareEffect.value = row.effect;\n        logs.value = row.logs;\n        logs.value.forEach((item, index) => {\n            item.index = index + 1;\n        });\n    }\n};\nconst sortSkill = ({ prop, order }) => {\n    data.value = data.value.sort((a, b) => {\n        if (order === \"ascending\") {\n            return a[prop] - b[prop];\n        } else {\n            return b[prop] - a[prop];\n        }\n    });\n    let index = 1;\n    for (let item of data.value) {\n        item.index = index++;\n    }\n};\n//watch\nwatchPostEffect(updateData);\nwatchPostEffect(updateCompareEffectList);\n</script>\n\n<style lang=\"less\" scoped>\n.m-compare-item {\n    flex: 1;\n    overflow-y: auto;\n    .u-title {\n        .fz(14px,21px);\n        .mb(8px);\n        text-align: center;\n    }\n}\n</style>\n","import script from \"./compare_player_list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./compare_player_list.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./compare_player_list.vue?vue&type=style&index=0&id=17e7324e&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-17e7324e\"]])\n\nexport default __exports__","import { unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"m-sill-list w-card\"\n};\nconst _hoisted_2 = {\n  class: \"w-card-title\"\n};\nconst _hoisted_3 = {\n  class: \"m-player-list\"\n};\nconst _hoisted_4 = {\n  class: \"m-table-list\"\n};\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { getEntityName, getResourceName } from \"@/utils/jcl/common\";\nimport { toRefs } from \"vue\";\nimport { displayPercent } from \"@/utils/jcl/commonNoStore\";\n\n// 会心列表 会心的技能\n\nexport default {\n  __name: 'compare_effect_list',\n  setup(__props) {\n    const {\n      compareEntity,\n      compareEffect,\n      compareEffectList\n    } = toRefs(usePve());\n    const criticalList = computed(() => {\n      const data = compareEffectList.value;\n      // 会心列表\n      const arr1 = data[0] ? data[0].logs.filter(item => item.isCritical) : [];\n      const arr2 = data[1] ? data[1].logs.filter(item => item.isCritical) : [];\n      const arr3 = data[2] ? data[2].logs.filter(item => item.isCritical) : [];\n      const arr4 = data[3] ? data[3].logs.filter(item => item.isCritical) : [];\n      // 最低伤害\n      const min1 = arr1.length ? Math.min(...arr1.map(item => item.value)) : \"-\";\n      const min2 = arr2.length ? Math.min(...arr2.map(item => item.value)) : \"-\";\n      const min3 = arr3.length ? Math.min(...arr3.map(item => item.value)) : \"-\";\n      const min4 = arr4.length ? Math.min(...arr4.map(item => item.value)) : \"-\";\n      // 平均伤害\n      const avg1 = arr1.length ? (arr1.reduce((prev, curr) => prev + curr.value, 0) / arr1.length).toFixed(0) : \"-\";\n      const avg2 = arr2.length ? (arr2.reduce((prev, curr) => prev + curr.value, 0) / arr2.length).toFixed(0) : \"-\";\n      const avg3 = arr3.length ? (arr3.reduce((prev, curr) => prev + curr.value, 0) / arr3.length).toFixed(0) : \"-\";\n      const avg4 = arr4.length ? (arr4.reduce((prev, curr) => prev + curr.value, 0) / arr4.length).toFixed(0) : \"-\";\n\n      // 最高伤害\n      const max1 = arr1.length ? Math.max(...arr1.map(item => item.value)) : \"-\";\n      const max2 = arr2.length ? Math.max(...arr2.map(item => item.value)) : \"-\";\n      const max3 = arr3.length ? Math.max(...arr3.map(item => item.value)) : \"-\";\n      const max4 = arr4.length ? Math.max(...arr4.map(item => item.value)) : \"-\";\n\n      // 占比\n      const rate1 = data[0] ? arr1.length / data[0].logs.length * 100 : 0;\n      const rate2 = data[1] ? arr2.length / data[1].logs.length * 100 : 0;\n      const rate3 = data[2] ? arr3.length / data[2].logs.length * 100 : 0;\n      const rate4 = data[3] ? arr4.length / data[3].logs.length * 100 : 0;\n      return [{\n        title: \"次数\",\n        value1: arr1.length ? arr1.length : \"-\",\n        value2: arr2.length ? arr2.length : \"-\",\n        value3: arr3.length ? arr3.length : \"-\",\n        value4: arr4.length ? arr4.length : \"-\"\n      }, {\n        title: \"最低伤害\",\n        value1: min1,\n        value2: min2,\n        value3: min3,\n        value4: min4\n      }, {\n        title: \"平均伤害\",\n        value1: avg1,\n        value2: avg2,\n        value3: avg3,\n        value4: avg4\n      }, {\n        title: \"最高伤害\",\n        value1: max1,\n        value2: max2,\n        value3: max3,\n        value4: max4\n      }, {\n        title: \"占比\",\n        value1: displayPercent(rate1),\n        value2: displayPercent(rate2),\n        value3: displayPercent(rate3),\n        value4: displayPercent(rate4)\n      }];\n    });\n\n    // 命中列表 没会心的技能\n    const hitList = computed(() => {\n      const data = compareEffectList.value;\n      // 命中列表\n      const arr1 = data[0] ? data[0].logs.filter(item => !item.isCritical) : [];\n      const arr2 = data[1] ? data[1].logs.filter(item => !item.isCritical) : [];\n      const arr3 = data[2] ? data[2].logs.filter(item => !item.isCritical) : [];\n      const arr4 = data[3] ? data[3].logs.filter(item => !item.isCritical) : [];\n      // 最低伤害 防止arr 为空的情况\n      const min1 = arr1.length ? Math.min(...arr1.map(item => item.value)) : \"-\";\n      const min2 = arr2.length ? Math.min(...arr2.map(item => item.value)) : \"-\";\n      const min3 = arr3.length ? Math.min(...arr3.map(item => item.value)) : \"-\";\n      const min4 = arr4.length ? Math.min(...arr4.map(item => item.value)) : \"-\";\n\n      // 平均伤害\n      const avg1 = arr1.length ? (arr1.reduce((prev, curr) => prev + curr.value, 0) / arr1.length).toFixed(0) : \"-\";\n      const avg2 = arr2.length ? (arr2.reduce((prev, curr) => prev + curr.value, 0) / arr2.length).toFixed(0) : \"-\";\n      const avg3 = arr3.length ? (arr3.reduce((prev, curr) => prev + curr.value, 0) / arr3.length).toFixed(0) : \"-\";\n      const avg4 = arr4.length ? (arr4.reduce((prev, curr) => prev + curr.value, 0) / arr4.length).toFixed(0) : \"-\";\n\n      // 最高伤害\n      const max1 = arr1.length ? Math.max(...arr1.map(item => item.value)) : \"-\";\n      const max2 = arr2.length ? Math.max(...arr2.map(item => item.value)) : \"-\";\n      const max3 = arr3.length ? Math.max(...arr3.map(item => item.value)) : \"-\";\n      const max4 = arr4.length ? Math.max(...arr4.map(item => item.value)) : \"-\";\n\n      // 占比\n      const rate1 = data[0] ? arr1.length / data[0].logs.length * 100 : 0;\n      const rate2 = data[1] ? arr2.length / data[1].logs.length * 100 : 0;\n      const rate3 = data[2] ? arr3.length / data[2].logs.length * 100 : 0;\n      const rate4 = data[3] ? arr4.length / data[3].logs.length * 100 : 0;\n      return [{\n        title: \"次数\",\n        value1: arr1.length ? arr1.length : \"-\",\n        value2: arr2.length ? arr2.length : \"-\",\n        value3: arr3.length ? arr3.length : \"-\",\n        value4: arr4.length ? arr4.length : \"-\"\n      }, {\n        title: \"最低伤害\",\n        value1: min1,\n        value2: min2,\n        value3: min3,\n        value4: min4\n      }, {\n        title: \"平均伤害\",\n        value1: avg1,\n        value2: avg2,\n        value3: avg3,\n        value4: avg4\n      }, {\n        title: \"最高伤害\",\n        value1: max1,\n        value2: max2,\n        value3: max3,\n        value4: max4\n      }, {\n        title: \"占比\",\n        value1: displayPercent(rate1),\n        value2: displayPercent(rate2),\n        value3: displayPercent(rate3),\n        value4: displayPercent(rate4)\n      }];\n    });\n    return (_ctx, _cache) => {\n      const _component_el_table_column = _resolveComponent(\"el-table-column\");\n      const _component_el_table = _resolveComponent(\"el-table\");\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, _toDisplayString(_unref(compareEffect) ? _unref(getResourceName)(_unref(compareEffect), {\n        showID: false\n      }) : \"-\"), 1), _createElementVNode(\"ul\", _hoisted_3, [_createElementVNode(\"li\", null, _toDisplayString(_unref(getEntityName)(_unref(compareEntity)[0])), 1), _createElementVNode(\"li\", null, _toDisplayString(_unref(getEntityName)(_unref(compareEntity)[1])), 1), _createElementVNode(\"li\", null, _toDisplayString(_unref(getEntityName)(_unref(compareEntity)[2])), 1), _createElementVNode(\"li\", null, _toDisplayString(_unref(getEntityName)(_unref(compareEntity)[3])), 1)]), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"ul\", null, [_createElementVNode(\"li\", null, [_cache[0] || (_cache[0] = _createElementVNode(\"p\", {\n        class: \"u-title\"\n      }, \"会心\", -1)), _createVNode(_component_el_table, {\n        data: _unref(criticalList),\n        class: \"w-table\",\n        \"show-header\": false\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_table_column, {\n          prop: \"title\",\n          label: \"\",\n          width: \"180\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value1\",\n          align: \"center\",\n          label: \"\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value2\",\n          align: \"center\",\n          label: \"\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value3\",\n          align: \"center\",\n          label: \"\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value4\",\n          align: \"center\",\n          label: \"\"\n        })]),\n        _: 1\n      }, 8, [\"data\"])])]), _createElementVNode(\"ul\", null, [_createElementVNode(\"li\", null, [_cache[1] || (_cache[1] = _createElementVNode(\"p\", {\n        class: \"u-title\"\n      }, \"命中\", -1)), _createVNode(_component_el_table, {\n        data: _unref(hitList),\n        class: \"w-table\",\n        \"show-header\": false\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_table_column, {\n          prop: \"title\",\n          label: \"\",\n          width: \"180\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value1\",\n          align: \"center\",\n          label: \"\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value2\",\n          align: \"center\",\n          label: \"\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value3\",\n          align: \"center\",\n          label: \"\"\n        }), _createVNode(_component_el_table_column, {\n          prop: \"value4\",\n          align: \"center\",\n          label: \"\"\n        })]),\n        _: 1\n      }, 8, [\"data\"])])])])]);\n    };\n  }\n};","import script from \"./compare_effect_list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./compare_effect_list.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./compare_effect_list.vue?vue&type=style&index=0&id=026b57a9&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-026b57a9\"]])\n\nexport default __exports__","<template>\n    <div>\n        <div class=\"m-compare-header\">\n            <div>\n                <compare-option />\n            </div>\n            <div class=\"w-card\">\n                <compare-card-chart statType=\"damage\" />\n            </div>\n            <div class=\"w-card\">\n                <compare-card-chart statType=\"treat\" />\n            </div>\n            <div class=\"w-card\">\n                <compare-card-chart statType=\"beDamaged\" />\n            </div>\n            <div class=\"w-card\">\n                <compare-card-chart statType=\"beTreated\" />\n            </div>\n        </div>\n        <div v-if=\"!compareSelectVisible\" class=\"m-compare-main\">\n            <div class=\"m-compare-list\">\n                <compare-player-list :index=\"1\" />\n                <compare-player-list :index=\"2\" />\n                <compare-player-list :index=\"3\" />\n                <compare-player-list :index=\"4\" />\n            </div>\n            <compare-effect-list />\n        </div>\n        <div v-else>\n            <entity-select\n                :isCompare=\"true\"\n                :onSelected=\"onSelected\"\n                :onSelectEntity=\"onSelectEntity\"\n                :entityList=\"compareEntity\"\n                :max=\"4\"\n            />\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { toRefs, watchPostEffect } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store.js\";\n\nimport CompareOption from \"./compare_option.vue\";\nimport EntitySelect from \"./entity_select.vue\";\nimport CompareCardChart from \"./compare_card_chart.vue\";\nimport ComparePlayerList from \"./compare_player_list.vue\";\nimport CompareEffectList from \"./compare_effect_list.vue\";\n\n// import EntitySelect from \"./entity_select.vue\"\n// import CompareChart from \"./compare_chart.vue\";\n// import CompareView from \"./compare_view.vue\";\n\nconst router = useRouter();\nconst store = useStore();\n\nconst { compareMode, compareEntity, compareSelectVisible } = toRefs(usePve());\n\nwatchPostEffect(() => {\n    const id = store.info?.id;\n    if (!id) return;\n    const query = {\n        id,\n        tab: \"compare\",\n    };\n    if (compareMode.value) query.compareMode = compareMode.value;\n    if (compareEntity.value[0]) query.entity1 = compareEntity.value[0];\n    if (compareEntity.value[1]) query.entity2 = compareEntity.value[1];\n    if (compareEntity.value[2]) query.entity3 = compareEntity.value[2];\n    if (compareEntity.value[3]) query.entity4 = compareEntity.value[3];\n    router.replace({ query });\n});\n\nconst onSelectEntity = (data, value) => {\n    if (value) {\n        for (let i = 0; i < compareEntity.value.length; i++) {\n            const id = compareEntity.value[i];\n            if (id == null) {\n                compareEntity.value[i] = data.id;\n                return;\n            }\n        }\n    } else {\n        compareEntity.value = compareEntity.value.map((item) => (item !== data.id ? item : null));\n    }\n};\n\nconst onSelected = () => {\n    compareSelectVisible.value = false;\n};\n</script>\n\n<style lang=\"less\" scoped>\n.m-compare-header {\n    .flex;\n    gap: 30px;\n    margin-bottom: 30px;\n    > .w-card {\n        flex: 1;\n    }\n}\n.m-compare-main {\n    display: flex;\n    flex-direction: column;\n    gap: 30px;\n}\n.m-compare-list {\n    .flex;\n    gap: 30px;\n}\n</style>\n","import script from \"./pve_compare.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./pve_compare.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./pve_compare.vue?vue&type=style&index=0&id=08f0b13f&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-08f0b13f\"]])\n\nexport default __exports__","<template>\n    <div class=\"w-entity\" :title=\"title\">\n        <img class=\"w-entity-icon\" :src=\"imgSrc\" alt=\"\" />\n        <span class=\"w-entity-name\">{{ name }}</span>\n    </div>\n</template>\n\n<script setup>\nimport { toRefs, computed } from \"vue\";\nimport { getEntityName, getMountIcon } from \"@/utils/jcl/common\";\nconst props = defineProps({\n    entity: {\n        type: [Number, String],\n        required: true,\n    },\n});\nconst { entity } = toRefs(props);\nconst title = computed(() => getEntityName(entity.value, { showID: true, showOrder: true, showRegion: true }));\nconst imgSrc = computed(() => getMountIcon(entity.value));\nconst name = computed(() => getEntityName(entity.value));\n</script>\n\n<style lang=\"less\" scoped>\n.w-entity {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    padding-right: 4px;\n\n    .w-entity-icon {\n        .size(24px);\n    }\n\n    .w-entity-name {\n        .ellipsis;\n    }\n}\n</style>\n","import script from \"./jcl_entity.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./jcl_entity.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./jcl_entity.vue?vue&type=style&index=0&id=ca8dd484&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-ca8dd484\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-blame-filters\">\n        <!-- <div class=\"w-card u-filters\">\n            <div class=\"w-card-title\">筛选器</div>\n            <div class=\"w-tabs\">\n                <div\n                    class=\"u-tab\"\n                    v-for=\"(filter, index) in filterList\"\n                    :key=\"index\"\n                    :class=\"{ 'is-active': filters[filter.name] }\"\n                    @click=\"filters[filter.name] = !filters[filter.name]\"\n                >\n                    {{ filter.title }}\n                </div>\n            </div>\n        </div> -->\n        <div class=\"w-card u-menu\">\n            <div class=\"w-card-title\">\n                <div>事件列表</div>\n                <div class=\"u-filters\">\n                    <div\n                        class=\"u-tab\"\n                        :class=\"{ 'is-active': filters[filter.name] }\"\n                        v-for=\"(filter, index) in filterList\"\n                        :key=\"index\"\n                        @click=\"filters[filter.name] = !filters[filter.name]\"\n                    >\n                        {{ filter.title }}\n                    </div>\n                </div>\n            </div>\n            <el-table class=\"u-table w-table\" :data=\"currentData\" :border=\"false\">\n                <el-table-column label=\"时间\" width=\"100\">\n                    <template #default=\"{ row }\">\n                        <div v-if=\"row.time < 60\">\n                            <span>{{ ~~row.time }}秒</span>\n                        </div>\n                        <div v-else>\n                            <span>{{ ~~(row.time / 60) }}分{{ ~~(row.time % 60) }}秒</span>\n                        </div>\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"玩家\">\n                    <template #default=\"{ row }\">\n                        <jcl-entity :entity=\"row.playerId\"></jcl-entity>\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"事件\" width=\"80\">\n                    <template #default=\"{ row }\">\n                        <span>{{ row.event }}</span>\n                    </template>\n                </el-table-column>\n            </el-table>\n            <el-pagination\n                class=\"w-pagination\"\n                small\n                background\n                layout=\"pager\"\n                :page-size=\"pageSize\"\n                :total=\"total\"\n                :hide-on-single-page=\"true\"\n                :current-page=\"currentPage\"\n                @update:currentPage=\"currentPage = $event\"\n            ></el-pagination>\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { toRefs, onMounted, ref } from \"vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport JclEntity from \"../common/jcl_entity.vue\";\n\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\n\nconst props = defineProps({\n    data: Array,\n});\nconst { data } = toRefs(props);\nconst pageSize = ref(18);\nconst { currentPage, currentData, total } = usePaginate(data, pageSize);\n\n// 单位过滤器相关\nconst filters = toRefs(usePve()).blame_filters;\nconst filterList = [\n    {\n        name: \"death\",\n        title: \"重伤\",\n    },\n    {\n        name: \"buff\",\n        title: \"非正常BUFF\",\n    },\n];\n\n// 点击触发右侧跳转\nonMounted(() => {\n    filterList.forEach((filter) => {\n        filters[filter.name] = true;\n    });\n});\n</script>\n\n<style lang=\"less\" scoped>\n.w-card-title {\n    display: flex;\n    justify-content: space-between;\n    .u-filters {\n        .flex;\n        .fz(14px,18px);\n        font-weight: normal;\n        color: rgba(255, 255, 255, 0.3);\n        .u-tab {\n            cursor: pointer;\n            margin-left: 10px;\n            text-align: center;\n            &.is-active {\n                color: #fff;\n            }\n        }\n    }\n}\n.m-blame-filters {\n    display: flex;\n    flex-direction: column;\n    flex-shrink: 0;\n    gap: 20px;\n    .size(360px, 760px);\n    .w-card {\n        gap: 10px;\n        position: relative; /* Add this */\n    }\n\n    .w-tabs {\n        display: flex;\n        flex-wrap: wrap;\n        .mt(10px);\n        .mb(-10px);\n\n        .u-tab {\n            .mb(10px);\n            &.is-active {\n                background-color: #0c759e;\n            }\n        }\n    }\n\n    .u-menu {\n        position: relative; /* Add this */\n        flex-grow: 1;\n        flex-shrink: 0;\n    }\n    .w-pagination {\n        position: absolute;\n        right: 10px;\n        bottom: 10px;\n    }\n}\n</style>\n","import script from \"./blame_filters.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./blame_filters.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./blame_filters.vue?vue&type=style&index=0&id=540f7872&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-540f7872\"]])\n\nexport default __exports__","<template>\n    <div class=\"w-effect\" :title=\"title\">\n        <img class=\"w-effect-icon\" :src=\"iconSrc\" alt=\"\" />\n        <span class=\"w-effect-name\">{{ name }}</span>\n    </div>\n</template>\n\n<script setup>\nimport { toRefs, computed } from \"vue\";\nimport { getResourceName, getResourceIcon } from \"@/utils/jcl/common\";\nconst props = defineProps({\n    effect: {\n        type: String,\n        required: true,\n    },\n    type: {\n        type: String,\n        default: \"skill\",\n    },\n});\nconst { effect, type } = toRefs(props);\nconst key = computed(() => {\n    const sp = effect.value.split(\":\");\n    if (sp.length > 1) {\n        return effect.value;\n    } else {\n        return `${type.value}:${effect.value}`;\n    }\n});\nconst iconSrc = computed(() => getResourceIcon(key.value));\nconst name = computed(() => getResourceName(key.value));\nconst title = computed(() => getResourceName(key.value, { showID: true }));\n</script>\n\n<style lang=\"less\" scoped>\n.w-effect {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n\n    .w-effect-icon {\n        .size(24px);\n    }\n\n    .w-effect-name {\n        .ellipsis;\n    }\n}\n</style>\n","import script from \"./jcl_effect.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./jcl_effect.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./jcl_effect.vue?vue&type=style&index=0&id=a306d786&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-a306d786\"]])\n\nexport default __exports__","<template>\n    <div class=\"w-card m-blame-list\">\n        <template v-for=\"(event, index) in data\" :key=\"index\">\n            <div class=\"u-event\" @click=\"selectedEvent = event\">\n                <template v-if=\"event.event === 'BUFF'\">\n                    <div class=\"u-event__buff\">\n                        <div v-if=\"event.time < 60\" class=\"u-time\">{{ ~~event.time }}秒</div>\n                        <div v-else class=\"u-time\">{{ ~~(event.time / 60) }}分{{ ~~(event.time % 60) }}秒</div>\n                        <div class=\"u-meta\">\n                            <div class=\"u-type is-buff\">吃 Buff 吃饱了！</div>\n                        </div>\n                        <div class=\"u-detail\">\n                            <jcl-entity :entity=\"event.playerId\"></jcl-entity>\n                            <img class=\"u-eat-icon\" src=\"@/assets/img/jcl/pve/eat.svg\" alt=\"\" />\n                            <jcl-effect :effect=\"String(event.detail.buff_id)\" type=\"buff\"></jcl-effect>\n                            <span>{{ event.detail.stack }} 层</span>\n                        </div>\n                    </div>\n                </template>\n                <template v-else-if=\"event.event === '重伤'\">\n                    <div class=\"u-event__death\">\n                        <div v-if=\"event.time < 60\" class=\"u-time\">{{ ~~event.time }}秒</div>\n                        <div v-else class=\"u-time\">{{ ~~(event.time / 60) }}分{{ ~~(event.time % 60) }}秒</div>\n                        <div class=\"u-meta\">\n                            <div class=\"u-type is-death\">被嘎啦！</div>\n                        </div>\n                        <div class=\"u-detail\">\n                            <jcl-entity :entity=\"event.playerId\"></jcl-entity>\n                            <img class=\"u-grave-icon\" src=\"@/assets/img/jcl/pve/grave.svg\" alt=\"\" />\n                            <jcl-entity :entity=\"event.detail.killerId\"></jcl-entity>\n                        </div>\n                    </div>\n                </template>\n            </div>\n        </template>\n    </div>\n    <div class=\"w-card m-blame-detail\">\n        <div class=\"w-card-title\">事件详情</div>\n        <empty-guide v-if=\"!selectedEvent\" :rotate=\"-90\" :tips=\"['在左侧选择一条记录', '查看记录详情']\"></empty-guide>\n        <template v-else>\n            <template v-if=\"selectedEvent.event == 'BUFF'\">\n                <div class=\"u-detail-item\">\n                    <span class=\"u-detail-label\">时间：</span>\n                    <span>{{ selectedEvent.detail.time }}</span>\n                </div>\n                <div class=\"u-detail-item\">\n                    <span class=\"u-detail-label\">BUFF ID：</span>\n                    <span>{{ selectedEvent.detail.buff_id }}</span>\n                </div>\n                <div class=\"u-detail-item\">\n                    <span class=\"u-detail-label\">Buff：</span>\n                    <jcl-effect :effect=\"String(selectedEvent.detail.buff_id)\" type=\"buff\"></jcl-effect>\n                </div>\n                <div class=\"u-detail-item\">\n                    <span class=\"u-detail-label\">Buff 层数：</span>\n                    <span>{{ selectedEvent.detail.stack }}</span>\n                </div>\n                <div class=\"u-detail-item\">\n                    <span class=\"u-detail-label\">Buff 来源：</span>\n                    <jcl-entity :entity=\"selectedEvent.detail.source\"></jcl-entity>\n                </div>\n            </template>\n            <template v-if=\"selectedEvent.event == '重伤'\">\n                <div class=\"u-damage-detail\">\n                    <el-table class=\"u-table w-table\" :data=\"selectedEvent.detail.detail\" :border=\"false\">\n                        <el-table-column label=\"时间\">\n                            <template #default=\"{ row }\">\n                                <span>{{ displayDigits(row.micro / 1000) + \"s\" }}</span>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"来源\">\n                            <template #default=\"{ row }\">\n                                <span>{{ getEntityName(row.caster) }}</span>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"招式\">\n                            <template #default=\"{ row }\">\n                                <span>{{ getResourceName(row.effect) }}</span>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"数值\">\n                            <template #default=\"{ row }\">\n                                <span>{{ row.value }}</span>\n                            </template>\n                        </el-table-column>\n                        <el-table-column label=\"会心\">\n                            <template #default=\"{ row }\">\n                                <span>{{ row.isCritical ? \"会心\" : \"-\" }}</span>\n                            </template>\n                        </el-table-column>\n                    </el-table>\n                </div>\n                <div class=\"w-card-title\">携带BUFF列表</div>\n                <div class=\"u-buff-detail\">\n                    <div\n                        v-for=\"(buff, index) in selectedEvent.detail.buff\"\n                        :key=\"index\"\n                        class=\"u-buff\"\n                        :title=\"getResourceName('buff:' + buff.split('*')[0], { showID: true })\"\n                    >\n                        <img class=\"u-buff-icon\" :src=\"getResourceIcon('buff:' + buff.split('*')[0])\" />\n                        <span class=\"u-buff-stack\">{{ buff.split(\"*\")[1] }}</span>\n                        <span class=\"u-buff-name\">{{\n                            getResourceName(\"buff:\" + buff.split(\"*\")[0], { showID: true })\n                        }}</span>\n                    </div>\n                </div>\n            </template>\n        </template>\n    </div>\n</template>\n\n<script setup>\nimport { toRefs, ref } from \"vue\";\nimport JclEntity from \"../common/jcl_entity.vue\";\nimport JclEffect from \"../common/jcl_effect.vue\";\nimport EmptyGuide from \"@/components/jcl/common/empty_guide.vue\";\nimport { getResourceName, getResourceIcon, getEntityName } from \"@/utils/jcl/common\";\nimport { displayDigits } from \"@/utils/jcl/commonNoStore\";\n\nconst props = defineProps({\n    data: Array,\n});\nconst { data } = toRefs(props);\n\nconst selectedEvent = ref(null);\n</script>\n\n<style lang=\"less\" scoped>\n.m-blame-list {\n    gap: 0;\n    flex-grow: 1;\n    overflow: auto;\n    .scrollbar(#333, 10px);\n\n    .u-eat-icon {\n        .size(36px);\n        filter: invert(0.5) sepia(1) saturate(5) hue-rotate(175deg);\n    }\n    .u-grave-icon {\n        .size(36px);\n        filter: invert(0.5) sepia(1) saturate(5) hue-rotate(90deg);\n    }\n    .u-event {\n        border-bottom: 1px solid #ebeef522;\n        padding: 16px 0;\n        .pointer;\n        &:hover {\n            background-color: #ebeef522;\n        }\n    }\n    .u-meta,\n    .u-detail {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 10px;\n    }\n    .u-detail {\n        .mt(8px);\n    }\n    .u-type {\n        .bold;\n\n        &.is-buff {\n            color: #2294f6;\n        }\n        &.is-death {\n            color: #f56c6c;\n        }\n    }\n    .u-time {\n        float: left;\n    }\n}\n.m-blame-detail {\n    width: 360px;\n\n    gap: 20px;\n    .u-detail-item {\n        display: flex;\n        align-items: center;\n        margin-bottom: 4px;\n    }\n\n    .u-detail-label {\n        .fz(14px);\n        color: #999;\n    }\n\n    .u-damage-detail {\n        max-height: 300px;\n        flex-shrink: 0;\n        overflow-y: auto;\n        overflow-x: hidden;\n        margin-bottom: 20px;\n        .scrollbar(#333, 4px);\n    }\n\n    .u-buff-detail {\n        max-height: 360px;\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n        color: #fff;\n        gap: 8px;\n        .fz(12px, 16px);\n        .bold;\n        overflow-y: auto;\n        .scrollbar(#333, 4px);\n\n        .u-buff {\n            .size(120px, 24px);\n            display: flex;\n            align-items: center;\n            position: relative;\n            white-space: nowrap;\n\n            .u-buff-icon {\n                .size(24px);\n                .mr(4px);\n                display: block;\n            }\n\n            .u-buff-stack {\n                position: absolute;\n                left: 14px;\n                top: 10px;\n                color: white;\n            }\n\n            .u-buff-name {\n                .ellipsis;\n            }\n        }\n    }\n}\n</style>\n","import script from \"./blame_list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./blame_list.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./blame_list.vue?vue&type=style&index=0&id=832bcac0&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-832bcac0\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-pve-blame\">\n        <!-- 左上角筛选单位/将单位加入候选列表的部分 -->\n        <div class=\"u-left\">\n            <BlameFilters :data=\"data\"></BlameFilters>\n        </div>\n        <div class=\"u-right\">\n            <BlameList :data=\"data\"></BlameList>\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport { toRefs, computed } from \"vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store\";\n\nimport BlameFilters from \"./blame_filters.vue\";\nimport BlameList from \"./blame_list.vue\";\n\nconst store = useStore();\nconst { blame_filters } = toRefs(usePve());\n\n// 相关的数据（因为这个功能数据量不会很大\n// 所以不需要太复杂\nconst data = computed(() => {\n    const { buff_blame, player_death } = store.result;\n    const result = [];\n    if (blame_filters.value.death) {\n        for (const player_id in player_death) {\n            for (const death of player_death[player_id]) {\n                result.push({\n                    playerId: player_id,\n                    time: death.time,\n                    event: \"重伤\",\n                    detail: death,\n                });\n            }\n        }\n    }\n    if (blame_filters.value.buff) {\n        for (const player_id in buff_blame) {\n            for (const buff_id in buff_blame[player_id]) {\n                for (const buff of buff_blame[player_id][buff_id]) {\n                    result.push({\n                        playerId: player_id,\n                        time: buff.time,\n                        event: \"BUFF\",\n                        detail: buff,\n                    });\n                }\n            }\n        }\n    }\n\n    return result.sort((a, b) => a.time - b.time);\n}, [store.result]);\n</script>\n\n<style lang=\"less\" scoped>\n.m-pve-blame {\n    .mt(20px);\n    display: flex;\n    gap: 20px;\n\n    .u-right {\n        height: 760px;\n        flex-grow: 1;\n        display: flex;\n        gap: 20px;\n    }\n}\n</style>\n","import script from \"./blame_index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./blame_index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./blame_index.vue?vue&type=style&index=0&id=0f34d69e&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-0f34d69e\"]])\n\nexport default __exports__","<template>\n    <div class=\"m-timeline-selectors w-card\" v-loading=\"loading\">\n        <!-- <div class=\"w-card-title\">筛选器</div>\n        <div class=\"w-tabs\">\n            <div\n                class=\"u-tab\"\n                v-for=\"(filter, index) in filterList\"\n                :key=\"index\"\n                :class=\"{ 'is-active': filters.includes(filter.name) }\"\n                @click=\"switchFilter(filter.name)\"\n            >\n                {{ filter.title }}\n            </div>\n        </div> -->\n        <div class=\"w-card-title\">\n            <span>显示内容</span>\n            <div class=\"u-filters\">\n                <div\n                    class=\"u-tab\"\n                    :class=\"{ 'is-active': filters.includes(filter.name) }\"\n                    v-for=\"(filter, index) in filterList\"\n                    :key=\"index\"\n                    @click=\"switchFilter(filter.name)\"\n                >\n                    {{ filter.title }}\n                </div>\n            </div>\n        </div>\n        <el-table class=\"u-table w-table\" :data=\"currentData\" :border=\"false\" @cell-click=\"click\" :show-header=\"false\">\n            <el-table-column label=\"选择\" :width=\"35\">\n                <template #default=\"{ row }\">\n                    <div class=\"u-check-icon\">\n                        <el-checkbox\n                            :key=\"selectedTimeline[row.name].stat.includes('select')\"\n                            :checked=\"selectedTimeline[row.name].stat.includes('select')\"\n                        />\n                    </div>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"内容\">\n                <template #default=\"{ row }\">\n                    <span :title=\"`${row.name}`\">{{ row.name.split(\":\")[1] }}</span>\n                </template>\n            </el-table-column>\n        </el-table>\n        <el-pagination\n            class=\"w-pagination\"\n            small\n            background\n            layout=\"pager\"\n            :page-size=\"pageSize\"\n            :total=\"total\"\n            :hide-on-single-page=\"true\"\n            :current-page=\"currentPage\"\n            @update:currentPage=\"currentPage = $event\"\n        ></el-pagination>\n    </div>\n</template>\n\n<script setup>\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { toRefs, ref, toRaw, watch } from \"vue\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\nimport { useRoute } from \"vue-router\";\n\nconst { selectedTimeline, timeline_filters } = toRefs(usePve());\nconst filters = ref([\"skill\"]);\nconst loading = ref(false);\nconst data = ref([]);\nconst pageSize = ref(22);\nconst { currentPage, currentData, total } = usePaginate(data, pageSize);\n\n// 单位过滤器相关\n\nconst filterList = [\n    {\n        name: \"say\",\n        title: \"喊话\",\n    },\n    {\n        name: \"templates\",\n        title: \"模板\",\n    },\n    {\n        name: \"skill\",\n        title: \"招式\",\n    },\n];\nconst switchFilter = (filter) => {\n    if (filters.value.includes(filter)) {\n        filters.value = filters.value.filter((f) => f !== filter);\n        timeline_filters.value[filter] = false;\n    } else {\n        filters.value.push(filter);\n        timeline_filters.value[filter] = true;\n    }\n};\n\n// 获取可供选择的数据\nconst updateData = () => {\n    loading.value = true;\n\n    getWorkerResponse(\"timeline_selector\", { filter: toRaw(timeline_filters.value) }).then((result) => {\n        data.value = result.data;\n        const _selected = result.selectedTimeline;\n        console.log(result.data);\n        for (let d of data.value) _selected[d.name].stat = [\"select\"];\n        selectedTimeline.value = _selected;\n        loading.value = false;\n    });\n};\n\n// 处理用户选中/取消选中\nconst click = (row, column) => {\n    const skill = selectedTimeline.value[row.name];\n    const columnIndex = column.no;\n    if (columnIndex === 0) {\n        // 点名字全选/全取消\n        if (skill.stat.length) {\n            skill.stat = [];\n        } else {\n            skill.stat = [\"select\"];\n        }\n    } else {\n        const type = {\n            1: \"select\",\n        }[columnIndex];\n        if (skill.stat.includes(type)) {\n            skill.stat = skill.stat.filter((item) => item !== type);\n        } else {\n            skill.stat.push(type);\n        }\n    }\n};\nconst route = useRoute();\nwatch(\n    () => route.fullPath,\n    () => {\n        timeline_filters.value = { skill: true, template: false, say: false };\n        updateData();\n    }\n);\n\nwatch(\n    timeline_filters,\n    () => {\n        updateData();\n    },\n    { immediate: true, deep: true }\n);\n</script>\n\n<style lang=\"less\" scoped>\n.w-card-title {\n    display: flex;\n    justify-content: space-between;\n    .u-filters {\n        .flex;\n        .fz(14px,18px);\n        font-weight: normal;\n        color: rgba(255, 255, 255, 0.3);\n        .u-tab {\n            .w(40px);\n            text-align: center;\n            &.is-active {\n                color: #fff;\n            }\n        }\n    }\n}\n.m-timeline-selectors {\n    .size(280px, 882px);\n    border: 1px solid #2d3236;\n    flex-shrink: 0;\n\n    .u-tab {\n        display: flex-grow;\n        width: 50px;\n        cursor: pointer;\n        border-bottom: 2px solid transparent;\n        &.selected {\n            border-bottom-color: #409eff;\n            color: #409eff;\n        }\n    }\n\n    .u-table {\n        flex-grow: 1;\n        .el-table__row {\n            cursor: pointer;\n        }\n        .u-check-icon {\n            display: flex;\n            justify-content: center;\n            align-items: center;\n\n            img {\n                width: 24px;\n                height: 24px;\n            }\n        }\n    }\n}\n</style>\n","import script from \"./timeline_selector.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./timeline_selector.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./timeline_selector.vue?vue&type=style&index=0&id=f55c3b4a&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f55c3b4a\"]])\n\nexport default __exports__","<template>\n    <div class=\"timeline-container\">\n        <div class=\"timeline-selector\">\n            <timeline-selector class=\"u-setting-popper\"></timeline-selector>\n        </div>\n        <div class=\"m-timeline w-card\">\n            <div class=\"w-card-title\">\n                <span class=\"u-title\">技能释放时间轴</span>\n                <el-radio-group v-model.number=\"linetime\" size=\"small\">\n                    <el-radio-button :value=\"15\">每行15s</el-radio-button>\n                    <el-radio-button :value=\"30\">每行30s</el-radio-button>\n                    <el-radio-button :value=\"45\">每行45s</el-radio-button>\n                    <el-radio-button :value=\"60\">每行60s</el-radio-button>\n                </el-radio-group>\n            </div>\n            <div class=\"u-canvas-wrapper\">\n                <canvas-timeline\n                    :data=\"data\"\n                    :time=\"time\"\n                    :linetime=\"linetime\"\n                    :max_width=\"max_width\"\n                ></canvas-timeline>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script setup>\nimport TimelineSelector from \"../pve/timeline_selector\";\nimport CanvasTimeline from \"../common/canvas_timeline.vue\";\n\nimport { computed, toRefs, ref } from \"vue\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { getResource } from \"@/utils/jcl/common\";\nconst m_jcl_main = document.getElementsByClassName(\"p-pve-result\")[0];\nconst m_jcl_main_width = m_jcl_main ? m_jcl_main.clientWidth : 0;\n// 动态计算 max_width\nconst max_width = ref(m_jcl_main_width - 500); // 初始值为窗口宽度减去一定值\nconsole.log(m_jcl_main_width);\nconst store = useStore();\nconst { end } = store.result;\nconst { selectedTimeline } = toRefs(usePve());\nconst time = computed(() => end.sec + 10);\nconst linetime = ref(15);\nconst data = computed(() => {\n    const source = store.result.time_line_result;\n    if (!source) return [];\n    const result = [];\n    const idNameMap = {};\n    for (let log of source.skills) {\n        const key = `${log.skill_id}_${log.skill_level}`;\n        if (!idNameMap[key]) {\n            const name = getResource(\"skill:\" + key).name;\n            if (!name) continue;\n            idNameMap[key] = name;\n        }\n        let name = idNameMap[key];\n        let short_name = name;\n        // 是否显示\n        const skill_key = \"skill:\" + name;\n        const current_timeline = selectedTimeline.value[skill_key];\n        if (!current_timeline || !current_timeline.stat.includes(\"select\")) continue;\n        if (name.length > 5) short_name = name.charAt(0) + \"..\" + name.charAt(name.length - 1);\n        result.push({\n            content: short_name,\n            time: log.time,\n            extra: {\n                tooltip: {\n                    技能: name,\n                    释放者模板ID: log.templateID,\n                    释放者名称: log.name,\n                    技能ID: log.skill_id,\n                    等级: log.skill_level,\n                    施放时间: log.time.toFixed(2) + \"s\",\n                },\n                color: current_timeline.color,\n            },\n        });\n    }\n    // 喊话部分\n    for (let [k, v] of Object.entries(store.result.say)) {\n        // 仅处理非系统喊话\n        if (k != \"_system\") {\n            // 需要建议：是否保留来自不明实体的喊话\n            const name = store.result.entities[k] == undefined ? \"天外来客\" : store.result.entities[k].name;\n            const templateID = store.result.entities[k] == undefined ? 0 : store.result.entities[k].templateID;\n            for (let value of v) {\n                const say_key = \"say:\" + value.content;\n                const current_timeline = selectedTimeline.value[say_key];\n                if (!current_timeline || !current_timeline.stat.includes(\"select\")) continue;\n                result.push({\n                    content: name + \"喊话\",\n                    time: value.time,\n                    extra: {\n                        tooltip: {\n                            内容: value.content,\n                            释放者模板ID: templateID,\n                            释放者名称: name,\n                            施放时间: value.time.toFixed(2) + \"s\",\n                        },\n                        color: current_timeline.color,\n                    },\n                });\n            }\n        }\n    }\n\n    // 模板类部分\n    for (let [k, v] of Object.entries(source.templates)) {\n        for (let value of v) {\n            const template_key = \"template:\" + value.name;\n            const current_timeline = selectedTimeline.value[template_key];\n            if (!current_timeline || !current_timeline.stat.includes(\"select\")) continue;\n            result.push({\n                content: value.name,\n                time: value.time,\n                extra: {\n                    tooltip: {\n                        名称: value.name,\n                        模板ID: k,\n                        数量: value.count,\n                        出现时间: value.time.toFixed(2) + \"s\",\n                    },\n                    color: current_timeline.color,\n                },\n            });\n        }\n    }\n\n    result.unshift({\n        extra: {\n            tooltip: {\n                事件: \"战斗开始\",\n            },\n            color: \"#ffffff\",\n        },\n        content: \"战斗开始\",\n        time: 0,\n    });\n    result.push({\n        extra: {\n            tooltip: {\n                事件: \"战斗结束\",\n            },\n            color: \"#ffffff\",\n        },\n        content: \"战斗结束\",\n        time: end.sec ?? result[result.length - 1].time + 2,\n    });\n\n    return result;\n});\n</script>\n\n<style lang=\"less\">\n.timeline-container {\n    display: flex;\n    .mt(20px);\n}\n.timeline-selector {\n    display: flex;\n    flex-direction: column;\n    flex-shrink: 0;\n    gap: 20px;\n    width: 360px; /* 确保左侧的宽度固定 */\n}\n\n.m-timeline {\n    flex: 1;\n    .w-card-title {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n\n        .u-title {\n            .mr(20px);\n        }\n    }\n\n    .el-radio-button.is-active {\n        .el-radio-button__inner {\n            background-color: @light-purple;\n            border-radius: 4px;\n            color: #000;\n        }\n    }\n    .el-radio-button .el-radio-button__inner {\n        border: none;\n        background-color: transparent;\n    }\n\n    .u-setting-trigger {\n        .pr;\n        .flex-center;\n        .pointer;\n        gap: 4px;\n        color: #fff;\n        background-color: @dark-purple;\n        padding: 3px 8px;\n        .r(3px);\n    }\n\n    .u-setting-trigger:hover {\n        .u-setting-popper {\n            visibility: visible;\n            opacity: 1;\n        }\n    }\n\n    .u-setting-popper {\n        // 悬浮效果\n        visibility: hidden;\n        opacity: 0;\n        transition: visibility 0.15s, opacity 0.15s linear;\n\n        // 定位\n        .pa;\n        top: calc(100%);\n        right: -20px;\n\n        z-index: 20;\n    }\n\n    .u-canvas-wrapper {\n        overflow-y: auto;\n        overflow-x: hidden;\n        max-height: 800px;\n        height: auto;\n        .scrollbar(#718282, 10px);\n    }\n}\n</style>\n","import script from \"./boss_timeline_selector.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./boss_timeline_selector.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./boss_timeline_selector.vue?vue&type=style&index=0&id=fbf4f702&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    <el-dialog\n        v-model=\"dialogVisible\"\n        :append-to-body=\"true\"\n        :show-close=\"false\"\n        :close-on-click-modal=\"false\"\n        :align-center=\"true\"\n        :lock-scroll=\"false\"\n        :destroy-on-close=\"true\"\n        class=\"m-export-dialog\"\n    >\n        <div class=\"m-dialog-body\">\n            <el-button class=\"u-close\" link @click=\"dialogVisible = false\">×</el-button>\n            <!-- 标题 -->\n            <div class=\"u-title\">导出为CSV</div>\n            <!-- 进度条 -->\n            <el-progress :show-text=\"false\" :percentage=\"progress\" :stroke-width=\"10\" />\n            <div class=\"u-progress-desc\" v-for=\"(item, key) in statusMap\" :key=\"key\">\n                <el-icon><component :is=\"statusIcon[item.status]\"></component></el-icon>\n                {{ item.desc }}\n            </div>\n        </div>\n    </el-dialog>\n</template>\n\n<script setup>\nimport { Loading, CircleCheckFilled, CircleCloseFilled, Checked } from \"@element-plus/icons-vue\";\nimport { ref, toRefs } from \"vue\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { saveAs } from \"file-saver\";\nimport { cloneDeep } from \"lodash\";\n\nconst store = useStore();\nconst { logFilter } = toRefs(usePve());\n\nconst dialogVisible = ref(false);\nconst statusMap = ref([]);\nconst progress = ref(0);\nconst statusIcon = {\n    0: Loading,\n    1: CircleCheckFilled,\n    2: CircleCloseFilled,\n    3: Checked,\n};\n\n// methods\nconst clearProgress = () => {\n    statusMap.value = [];\n    progress.value = 0;\n};\nconst updateStatus = (desc, status, processing) => {\n    let ready = statusMap.value.find((item) => item.desc === desc);\n    if (processing) progress.value = Math.floor(processing);\n    if (ready) ready.status = status;\n    else statusMap.value.push({ desc, status });\n};\nconst start = () => {\n    clearProgress();\n    const filename = (store.file ? store.file.name : store.info?.title) + \"-JX3BOX-Export.csv\";\n    const worker = store.worker;\n    worker.onmessage = (e) => {\n        const { msg, type, data } = e.data;\n        if (type === \"statusUpdated\") {\n            const { desc, status, processing } = data;\n            updateStatus(desc, status, processing);\n        } else if (msg === \"exportResult\") {\n            updateStatus(\"构建完成，下载马上开始\", 1, 99);\n            const blob = new Blob([data], { type: \"application/octet-stream\" });\n            saveAs(blob, filename);\n            updateStatus(\"导出成功\", 3, 100);\n        }\n    };\n    worker.postMessage({ action: \"export\", data: { logFilter: cloneDeep(logFilter.value) } });\n    updateStatus(\"整理原始数据\", 0, 0);\n};\n\nconst open = () => {\n    dialogVisible.value = true;\n    start();\n};\ndefineExpose({\n    open,\n});\n</script>\n\n<style lang=\"less\">\n.m-export-dialog {\n    .size(1000px, 400px);\n    border-radius: 8px;\n    overflow: hidden;\n    background: #303133;\n    --el-text-color-regular: #fff;\n    --el-color-primary: #d3efff;\n    --el-border-color-lighter: #000;\n    .el-dialog__body {\n        padding: 0;\n    }\n    .m-dialog-body {\n        .pr;\n        .flex-center;\n        flex-direction: column;\n        padding-top: 24px;\n\n        .u-close {\n            .flex-center;\n            .pa;\n            .size(45px, 45px);\n            .fz(32px);\n            right: 30px;\n            top: 4px;\n            background: #535353;\n            color: #fff;\n            border-radius: 100%;\n            &:hover,\n            &:active,\n            &:focus {\n                background: #d3efff;\n                border-color: #d3efff;\n                color: #000;\n            }\n        }\n\n        .u-title {\n            .fz(24px, 32px);\n            .mb(43px);\n            .bold;\n        }\n\n        .el-progress {\n            .mb(40px);\n            .mt(10px);\n            width: 100%;\n            height: 10px;\n            .el-progress-bar__outer,\n            .el-progress-bar__inner {\n                border-radius: 0;\n            }\n        }\n\n        .u-progress-desc {\n            .flex-center;\n            .fz(18, 22px);\n            .bold;\n            .mb(8px);\n            gap: 8px;\n        }\n    }\n}\n</style>\n","import script from \"./export_dialog.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./export_dialog.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./export_dialog.vue?vue&type=style&index=0&id=9a265154&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    <div class=\"m-logs-filter w-card\">\n        <div class=\"w-card-title\">\n            <div>过滤</div>\n            <div>\n                <el-button @click=\"exportBox.open()\">\n                    <img src=\"@/assets/img/jcl/pve/excel.svg\" alt=\"\" />\n                </el-button>\n                <el-button\n                    @click=\"\n                        updateKeyword();\n                        emits('apply');\n                    \"\n                    style=\"color: #939393\"\n                >\n                    <svg width=\"18\" height=\"18\" viewBox=\"0 0 18 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" v-bind:svg-inline=\"''\" v-bind:role=\"'presentation'\" v-bind:focusable=\"'false'\" v-bind:tabindex=\"'-1'\"><path d=\"M15.75 5.25v9c0 .412-.147.766-.44 1.06a1.44 1.44 0 01-1.06.44H3.75c-.413 0-.765-.147-1.059-.44a1.447 1.447 0 01-.441-1.06V3.75c0-.413.147-.765.441-1.059.294-.293.647-.44 1.059-.441h9l3 3zM9 13.5a2.17 2.17 0 001.594-.656 2.17 2.17 0 00.656-1.594 2.17 2.17 0 00-.656-1.594A2.17 2.17 0 009 9a2.17 2.17 0 00-1.594.656 2.17 2.17 0 00-.656 1.594c0 .625.219 1.156.656 1.594A2.17 2.17 0 009 13.5zm-4.5-6h6.75v-3H4.5v3z\" fill=\"currentColor\"/></svg>\n                </el-button>\n            </div>\n        </div>\n        <!-- 常规 -->\n        <div class=\"m-filter-items\">\n            <div class=\"m-filter-title\">\n                <div>常规</div>\n                <div class=\"u-button\" @click=\"isExpansion1 = !isExpansion1\">\n                    <el-icon v-if=\"isExpansion1\"><Minus /></el-icon>\n                    <el-icon v-if=\"!isExpansion1\"><Plus /></el-icon>\n                </div>\n            </div>\n            <template v-if=\"isExpansion1\">\n                <div class=\"m-filter-item\">\n                    <div class=\"u-text\">反击事件</div>\n                    <div class=\"u-options\">\n                        <div\n                            class=\"u-option\"\n                            @click=\"logFilter.hideReact = false\"\n                            :class=\"{ 'is-active': !logFilter.hideReact }\"\n                        >\n                            显示\n                        </div>\n                        <div\n                            class=\"u-option\"\n                            @click=\"logFilter.hideReact = true\"\n                            :class=\"{ 'is-active': logFilter.hideReact }\"\n                        >\n                            隐藏\n                        </div>\n                    </div>\n                </div>\n                <div class=\"m-filter-item\">\n                    <div class=\"u-text\">无数值技能效果</div>\n                    <div class=\"u-options\">\n                        <div\n                            class=\"u-option\"\n                            @click=\"logFilter.hideNoValue = false\"\n                            :class=\"{ 'is-active': !logFilter.hideNoValue }\"\n                        >\n                            显示\n                        </div>\n                        <div\n                            class=\"u-option\"\n                            @click=\"logFilter.hideNoValue = true\"\n                            :class=\"{ 'is-active': logFilter.hideNoValue }\"\n                        >\n                            隐藏\n                        </div>\n                    </div>\n                </div>\n            </template>\n        </div>\n        <!-- 时间筛选 -->\n        <div class=\"m-filter-items\">\n            <div class=\"m-filter-title\">\n                <div>时间筛选</div>\n                <div class=\"u-button\" @click=\"isExpansion2 = !isExpansion2\">\n                    <el-icon v-if=\"isExpansion2\"><Minus /></el-icon>\n                    <el-icon v-if=\"!isExpansion2\"><Plus /></el-icon>\n                </div>\n            </div>\n            <div v-if=\"isExpansion2\" class=\"u-filters\">\n                <div class=\"u-time-range\">\n                    <el-input type=\"number\" v-model.number=\"logFilter.timeRange[0]\" size=\"large\"></el-input>\n                    <span>~</span>\n                    <el-input type=\"number\" v-model.number=\"logFilter.timeRange[1]\" size=\"large\"></el-input>\n                </div>\n                <div class=\"u-time-slider\">\n                    <el-slider v-model=\"logFilter.timeRange\" range :max=\"maxTime\" :min=\"-5\" :show-tooltip=\"false\" />\n                </div>\n            </div>\n        </div>\n        <!-- 单位 -->\n        <div class=\"m-filter-items\">\n            <div class=\"m-filter-title\">\n                <div>单位</div>\n                <div class=\"u-button\" @click=\"isExpansion3 = !isExpansion3\">\n                    <el-icon v-if=\"isExpansion3\"><Minus /></el-icon>\n                    <el-icon v-if=\"!isExpansion3\"><Plus /></el-icon>\n                </div>\n            </div>\n            <template v-if=\"isExpansion3\">\n                <div class=\"m-filter-item\">\n                    <div class=\"u-text\">指定单位</div>\n                    <div class=\"u-select\">\n                        <el-select\n                            v-model=\"logFilter.entities\"\n                            multiple\n                            collapse-tags\n                            filterable\n                            clearable\n                            placeholder=\"请选择单位\"\n                            popper-class=\"m-select-popper\"\n                            effect=\"dark\"\n                            size=\"small\"\n                        >\n                            <el-option\n                                v-for=\"entity in entities\"\n                                :key=\"entity.id\"\n                                :value=\"entity.id\"\n                                :label=\"getEntityName(entity.id)\"\n                            >\n                                <div class=\"u-entity\">\n                                    <img class=\"u-entity-icon\" :src=\"getMountIcon(entity.id)\" />\n                                    <span class=\"u-entity-name\">{{ getEntityName(entity.id) }}</span>\n                                </div>\n                            </el-option>\n                        </el-select>\n                    </div>\n                </div>\n                <div v-for=\"(item, index) in filterOptions2\" :key=\"index\" class=\"m-filter-item\">\n                    <div class=\"u-text\">{{ item.text }}</div>\n                    <div class=\"u-options\">\n                        <div\n                            class=\"u-option\"\n                            @click=\"logFilter[item.model] = true\"\n                            :class=\"{ 'is-active': logFilter[item.model] }\"\n                        >\n                            显示\n                        </div>\n                        <div\n                            class=\"u-option\"\n                            @click=\"logFilter[item.model] = false\"\n                            :class=\"{ 'is-active': !logFilter[item.model] }\"\n                        >\n                            隐藏\n                        </div>\n                    </div>\n                </div>\n            </template>\n        </div>\n        <!-- 事件 -->\n        <div class=\"m-filter-items\">\n            <div class=\"m-filter-title\">\n                <div>事件</div>\n                <div class=\"u-button\" @click=\"isExpansion4 = !isExpansion4\">\n                    <el-icon v-if=\"isExpansion4\"><Minus /></el-icon>\n                    <el-icon v-if=\"!isExpansion4\"><Plus /></el-icon>\n                </div>\n            </div>\n            <template v-if=\"isExpansion4\">\n                <div v-for=\"(item, index) in filterOptions3\" :key=\"index\" class=\"m-filter-item\">\n                    <div class=\"u-text\">{{ item.text }}</div>\n                    <div class=\"u-options\">\n                        <div\n                            class=\"u-option\"\n                            @click=\"onShowTypesChange(item.model)\"\n                            :class=\"{ 'is-active': logFilter.showTypes.includes(item.model) }\"\n                        >\n                            显示\n                        </div>\n                        <div\n                            class=\"u-option\"\n                            @click=\"onShowTypesChange(item.model)\"\n                            :class=\"{ 'is-active': !logFilter.showTypes.includes(item.model) }\"\n                        >\n                            隐藏\n                        </div>\n                    </div>\n                </div>\n            </template>\n        </div>\n        <!-- 关键词 -->\n        <div class=\"m-filter-items\">\n            <div class=\"m-filter-title\">\n                <div>关键词</div>\n                <div class=\"u-button\" @click=\"isExpansion5 = !isExpansion5\">\n                    <el-icon v-if=\"isExpansion5\"><Minus /></el-icon>\n                    <el-icon v-if=\"!isExpansion5\"><Plus /></el-icon>\n                </div>\n            </div>\n            <template v-if=\"isExpansion5\">\n                <div class=\"m-filter-item u-column\">\n                    <div class=\"u-text\">搜索</div>\n                    <div class=\"u-filter-input\">\n                        <el-input\n                            v-model=\"keywordStr\"\n                            size=\"large\"\n                            placeholder=\"输入关键词，多个关键词使用空格分隔\"\n                            @change=\"inputChange\"\n                            :class=\"{ 'is-fill': keywordStr }\"\n                        ></el-input>\n                    </div>\n                </div>\n                <div class=\"m-filter-item u-column\">\n                    <div class=\"u-text\">过滤</div>\n                    <div class=\"u-filter-input\">\n                        <el-input\n                            v-model=\"hideKeywordStr\"\n                            size=\"large\"\n                            placeholder=\"输入关键词，多个关键词使用空格分隔\"\n                            @change=\"inputChange\"\n                            :class=\"{ 'is-fill': hideKeywordStr }\"\n                        ></el-input>\n                    </div>\n                </div>\n            </template>\n        </div>\n        <!-- 按钮 -->\n        <div class=\"m-fillter-apply\">\n            <el-button\n                block\n                @click=\"\n                    updateKeyword();\n                    emits('apply');\n                \"\n            >\n                <svg width=\"18\" height=\"18\" viewBox=\"0 0 18 18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" v-bind:svg-inline=\"''\" v-bind:class=\"'u-apply-icon'\" v-bind:role=\"'presentation'\" v-bind:focusable=\"'false'\" v-bind:tabindex=\"'-1'\"><path d=\"M15.75 5.25v9c0 .412-.147.766-.44 1.06a1.44 1.44 0 01-1.06.44H3.75c-.413 0-.765-.147-1.059-.44a1.447 1.447 0 01-.441-1.06V3.75c0-.413.147-.765.441-1.059.294-.293.647-.44 1.059-.441h9l3 3zM9 13.5a2.17 2.17 0 001.594-.656 2.17 2.17 0 00.656-1.594 2.17 2.17 0 00-.656-1.594A2.17 2.17 0 009 9a2.17 2.17 0 00-1.594.656 2.17 2.17 0 00-.656 1.594c0 .625.219 1.156.656 1.594A2.17 2.17 0 009 13.5zm-4.5-6h6.75v-3H4.5v3z\" fill=\"currentColor\"/></svg>\n                应用筛选</el-button\n            >\n\n            <!-- 自动应用 -->\n            <div class=\"m-fillter-auto\" @click.stop=\"autoSearchCheck = !autoSearchCheck\">\n                <div class=\"u-box\" @click=\"logAutoApply = !logAutoApply\">\n                    <img\n                        v-if=\"logAutoApply\"\n                        width=\"18\"\n                        style=\"margin-right: -1.5px\"\n                        src=\"@/assets/img/jcl/pve/checkbox_circle.svg\"\n                        alt=\"\"\n                    />\n                    <div v-else class=\"u-circle\"></div>\n                    <p class=\"u-text\">自动应用筛选</p>\n                </div>\n            </div>\n        </div>\n\n        <export-dialog ref=\"exportBox\"></export-dialog>\n    </div>\n</template>\n\n<script setup>\nimport ExportDialog from \"@/components/jcl/export_dialog.vue\";\nimport { getMountIcon, getEntityName } from \"@/utils/jcl/common\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { toRefs, computed, onMounted, ref } from \"vue\";\nimport { throttle } from \"lodash-es\";\n\n// emit\nconst emits = defineEmits([\"apply\"]);\n\n// data\nconst store = useStore();\nconst { logFilter, logAutoApply } = toRefs(usePve());\n\nconst isExpansion1 = ref(false);\nconst isExpansion2 = ref(false);\nconst isExpansion3 = ref(true);\nconst isExpansion4 = ref(true);\nconst isExpansion5 = ref(true);\n\nconst autoSearchCheck = ref(true);\n\nconst filterOptions2 = [\n    { text: \"有名字的实体\", model: \"selectOnlyName\" },\n    { text: \"无归属的实体\", model: \"selectOnlyNoSon\" },\n    { text: \"只出现过一次的实体\", model: \"selectOnlyNoRepeat\" },\n    { text: \"所选实体为事件来源的事件\", model: \"onlySource\" },\n];\n\nconst filterOptions3 = [\n    { text: \"单位的出现与消失\", model: \"scene\" },\n    { text: \"系统信息和NPC喊话\", model: \"say\" },\n    { text: \"技能产生效果\", model: \"skill\" },\n    { text: \"技能释放和释放结果\", model: \"skillCast\" },\n    { text: \"BUFF更新\", model: \"buff\" },\n    { text: \"击杀与死亡\", model: \"kill\" },\n    { text: \"单位状态更新\", model: \"entityStatus\" },\n];\n\n// computed\nconst entities = computed(() => {\n    return Object.values(store.result?.entities).filter((e) => {\n        if (logFilter.value.selectOnlyName && !e.name) return false;\n        if (logFilter.value.selectOnlyNoSon && e.belongID) return false;\n        if (logFilter.value.selectOnlyNoRepeat && e.appearOrder > 1) return false;\n        return true;\n    });\n});\nconst maxTime = computed(() => store?.result?.end?.sec + 5 || 120);\nconst keywordStr = ref(\"\");\nconst hideKeywordStr = ref(\"\");\nconst exportBox = ref(null);\n\n// methods\n\nconst onShowTypesChange = (val) => {\n    if (logFilter.value.showTypes.includes(val)) {\n        logFilter.value.showTypes = logFilter.value.showTypes.filter((v) => v !== val);\n    } else {\n        logFilter.value.showTypes.push(val);\n    }\n};\nconst getKeywords = (type) => {\n    let target = type === \"hide\" ? hideKeywordStr.value : keywordStr.value;\n    if (!target) return null;\n    let keywords = [];\n    let resources = store.result.resources;\n    let ks = target.split(/\\s/);\n    for (let k of ks) {\n        if (!k) continue;\n        const resourceMatch = (resource, k) => {\n            if (resource.name && resource.name.includes(k)) return true;\n            if (resource.desc && resource.desc.includes(k)) return true;\n            if (resource.remark && resource.remark.includes(k)) return true;\n            return false;\n        };\n        let includes = Object.keys(resources).filter((r) => resourceMatch(resources[r], k));\n        for (let include of includes) {\n            let type = include.split(\":\")[0];\n            let id = include.split(\":\")[1];\n            if (id.split(\"_\").length > 1) id = id.split(\"_\")[0];\n            keywords.push({ type, id });\n        }\n        keywords.push({ type: \"str\", text: k });\n    }\n    return keywords;\n};\nconst updateKeyword = () => {\n    logFilter.value.keyword = getKeywords();\n    logFilter.value.hideKeyword = getKeywords(\"hide\");\n};\nconst inputChange = throttle(() => {\n    updateKeyword();\n}, 1000);\n\nonMounted(() => {\n    logFilter.value.timeRange[1] = maxTime.value;\n});\n</script>\n\n<style lang=\"less\">\n.m-logs-filter {\n    .pr;\n    .flex;\n    flex-direction: column;\n    gap: 20px;\n    width: 360px;\n    min-width: 360px;\n    .w-card-title {\n        display: flex;\n        justify-content: space-between;\n    }\n\n    .m-filter-items {\n        .flex;\n        flex-direction: column;\n        gap: 20px;\n        .m-filter-title {\n            .fz(14px,18px);\n            .bold;\n            border-left: 2px solid rgba(255, 105, 180, 1);\n            padding-left: 4px;\n\n            display: flex;\n            justify-content: space-between;\n            .u-button {\n                cursor: pointer;\n                width: 18px;\n                height: 18px;\n            }\n        }\n        .m-filter-item {\n            .flex;\n            justify-content: space-between;\n            align-items: center;\n            margin-left: 10px;\n            &.u-column {\n                align-items: start;\n                flex-direction: column;\n                gap: 10px;\n            }\n            .u-text {\n                .fz(14px,18px);\n                .bold;\n                border-left: 2px solid rgba(255, 105, 180, 1);\n                padding-left: 4px;\n            }\n            .u-options {\n                .flex;\n                gap: 20px;\n                .u-option {\n                    .fz(14px,18px);\n                    .bold;\n                    color: #939393;\n                    cursor: pointer;\n                    .fz(14px,18px);\n                    &.is-active {\n                        color: #fff;\n                    }\n                }\n            }\n            .u-filter-input {\n                width: 100%;\n                .el-input {\n                    width: 100%;\n                    .el-input__wrapper {\n                        box-shadow: none;\n                        background: #1c1c1c;\n                    }\n                }\n            }\n            .u-select {\n                .el-select__wrapper {\n                    min-width: 118px;\n                }\n            }\n        }\n    }\n    .m-fillter-apply {\n        width: 100%;\n        .el-button {\n            .bold;\n            font-size: 20px;\n            width: 100%;\n            height: 52px;\n            line-height: 52px;\n            .u-apply-icon {\n                width: 30px;\n                height: 30px;\n                // color: #fff;x\n                margin-bottom: 2px;\n                margin-right: 5px;\n            }\n        }\n    }\n\n    .m-fillter-auto {\n        .u-box {\n            display: flex;\n            gap: 10px;\n            align-items: center;\n            justify-content: center;\n            margin-top: 10px;\n            cursor: pointer;\n            .u-circle {\n                width: 15px;\n                height: 15px;\n                border-radius: 50%;\n                background-color: rgba(147, 147, 147, 1);\n                position: relative;\n                img {\n                    position: absolute;\n                    z-index: 99;\n                }\n            }\n            .u-text {\n                .fz(14px,18px);\n                .bold;\n                color: #939393;\n            }\n        }\n    }\n    .u-time-range {\n        .flex;\n        align-items: center;\n        justify-content: space-between;\n        .el-input {\n            flex: 1;\n            border-radius: 5px;\n            .el-input__inner {\n                text-align: center;\n            }\n        }\n\n        span {\n            .bold;\n            font-size: 14px;\n            color: white;\n            margin: 0 8px;\n        }\n    }\n    .u-time-slider {\n        // 滑动条轨道\n        .el-slider__runway {\n            background-color: #000;\n        }\n        // 滑动条覆盖部分\n        .el-slider__bar {\n            background-color: #535353;\n        }\n        // 滑动条按钮\n        .el-slider__button {\n            border: none;\n            background-color: #535353;\n        }\n    }\n}\n\n.m-select-popper {\n    .el-select-dropdown__item {\n        height: 32px;\n    }\n    .u-entity {\n        display: flex;\n        align-items: center;\n        gap: 10px;\n    }\n\n    .u-entity-icon {\n        .size(20px, 20px);\n    }\n\n    .u-entity-name {\n        color: #fff;\n        display: block;\n        flex-grow: 1;\n    }\n}\n</style>\n","import script from \"./logs_filter.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./logs_filter.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./logs_filter.vue?vue&type=style&index=0&id=f807fa2e&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    <div class=\"m-logs-list w-card\" v-loading=\"loading\">\n        <div class=\"w-card-title\">列表</div>\n        <el-table class=\"u-table w-table\" :data=\"currentData\" :border=\"false\">\n            <el-table-column prop=\"index\" label=\"#\" width=\"60\"> </el-table-column>\n            <el-table-column label=\"时间\" width=\"60\">\n                <template #default=\"{ row }\">\n                    <span>{{ displayDigits(row.micro / 1000) }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column prop=\"typeDesc\" label=\"事件类型\" width=\"120\"></el-table-column>\n            <el-table-column prop=\"subtype\" label=\"子类型\" width=\"80\"> </el-table-column>\n            <el-table-column label=\"事件来源\">\n                <template #default=\"{ row }\">\n                    <jcl-entity v-if=\"row.source.t === 'entity'\" :entity=\"row.source.v\"></jcl-entity>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"事件内容\">\n                <template #default=\"{ row }\">\n                    <jcl-effect\n                        v-if=\"['skill', 'buff'].includes(row.content.t)\"\n                        :type=\"row.content.t\"\n                        :effect=\"row.content.v\"\n                    ></jcl-effect>\n                    <div v-else-if=\"row.content.t === 'str'\" :title=\"row.content.v\">\n                        {{ row.content.v }}\n                    </div>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"事件目标\">\n                <template #default=\"{ row }\">\n                    <jcl-entity v-if=\"row.target.t === 'entity'\" :entity=\"row.target.v\"></jcl-entity>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"数值\">\n                <template #default=\"{ row }\">\n                    <el-tooltip v-if=\"showEventValue(row)\" placement=\"top\">\n                        <template #content>\n                            <div>\n                                <span v-for=\"(value, type) in row.value\" :key=\"type\">\n                                    {{ type }}: {{ value }}<br />\n                                </span>\n                            </div>\n                        </template>\n                        <span>{{ Object.values(row.value)[0] }}</span>\n                    </el-tooltip>\n                </template>\n            </el-table-column>\n            <el-table-column label=\"备注\">\n                <template #default=\"{ row }\">\n                    {{ row.remark }}\n                </template>\n            </el-table-column>\n            <el-table-column width=\"24\">\n                <template #default=\"{ row }\">\n                    <el-button\n                        v-show=\"logDebug\"\n                        @click=\"consoleLog(row)\"\n                        size=\"small\"\n                        link\n                        :icon=\"InfoFilled\"\n                    ></el-button>\n                </template>\n            </el-table-column>\n        </el-table>\n        <el-pagination\n            class=\"w-pagination\"\n            small\n            background\n            layout=\"pager\"\n            :page-size=\"pageSize\"\n            :total=\"total\"\n            :hide-on-single-page=\"true\"\n            :current-page=\"currentPage\"\n            @update:currentPage=\"currentPage = $event\"\n        ></el-pagination>\n    </div>\n</template>\n\n<script setup>\nimport JclEntity from \"@/components/jcl/common/jcl_entity.vue\";\nimport JclEffect from \"@/components/jcl/common/jcl_effect.vue\";\n\nimport { InfoFilled } from \"@element-plus/icons-vue\";\n\nimport { displayDigits } from \"@/utils/jcl/commonNoStore\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { ref, toRefs, watchPostEffect, onMounted } from \"vue\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { cloneDeep, throttle } from \"lodash\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\n\n// 数据相关\nconst { logs, logFilter, logAutoApply, logDebug } = toRefs(usePve());\nconst loading = ref(false);\nconst pageSize = ref(30);\nconst { currentPage, total, currentData } = usePaginate(logs, pageSize);\nconst updateData = () => {\n    loading.value = true;\n    getWorkerResponse(\"get_pve_logs\", { logFilter: cloneDeep(logFilter.value) })\n        .then((res) => {\n            logs.value = res;\n        })\n        .finally(() => {\n            loading.value = false;\n        });\n};\nconst throttleUpdateData = throttle(updateData, 1000);\n\ndefineExpose({ updateData });\n\n// 组件方法\nconst consoleLog = (row) => console.log(cloneDeep(row));\nconst showEventValue = (row) => {\n    if (row.type != 21) return false;\n    if (Object.values(row.value).every((x) => !x)) return false;\n    return true;\n};\n\n// 监听logFilter变化自动更新\nwatchPostEffect(() => {\n    if (logAutoApply.value) {\n        throttleUpdateData();\n    }\n});\nonMounted(() => {\n    if (logs.value.length === 0) {\n        updateData();\n    }\n});\n</script>\n\n<style lang=\"less\">\n.m-logs-list {\n    // height: 1060px;\n    flex-grow: 1;\n\n    .u-table {\n        flex-grow: 1;\n\n        .el-table__row {\n            transition: all 0.2s ease-in-out;\n        }\n        .el-table__row:hover {\n            background-color: #7650f8aa;\n        }\n    }\n}\n</style>\n","import script from \"./logs_list.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./logs_list.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./logs_list.vue?vue&type=style&index=0&id=f28ba9a6&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    <div class=\"m-pve-logs\">\n        <logs-filter @apply=\"list.updateData()\"></logs-filter>\n        <logs-list ref=\"list\"></logs-list>\n    </div>\n</template>\n\n<script setup>\nimport LogsFilter from \"./logs_filter.vue\";\nimport LogsList from \"./logs_list.vue\";\nimport { ref } from \"vue\";\n\nconst list = ref(null);\n</script>\n\n<style lang=\"less\">\n.m-pve-logs {\n    .mt(20px);\n    // width: 1440px;\n    display: flex;\n    gap: 20px;\n}\n</style>\n","import script from \"./pve_logs.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./pve_logs.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./pve_logs.vue?vue&type=style&index=0&id=dff2cbbe&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","export const buffs_coverage_constants = {\n    team_buffs: {\n        20938: 1,\n        23543: 1,\n        10031: 1,\n        8504: 1,\n        4246: 1,\n        23107: 1,\n        24742: 1,\n        29294: 1,\n    },\n    individual_buffs: {\n        10208: 1,\n        23573: 1,\n        16259: 0,\n        16328: 1,\n    },\n};\n","<template>\n    <div class=\"m-team-buff-coverage w-card\">\n        <p class=\"w-card-title\">团队增益详情</p>\n        <div>\n            <el-select\n                v-model=\"selectedBuff\"\n                placeholder=\"选择一个增益\"\n                filterable\n                style=\"width: 400px; margin-bottom: 5px\"\n                value-key=\"key\"\n            >\n                <el-option\n                    v-for=\"buff in filteredBuffs\"\n                    :key=\"buff.id\"\n                    :label=\"`${buff.id} : ${buff.level} - ${buff.name}`\"\n                    :value=\"buff\"\n                >\n                    <img\n                        :src=\"getResourceIcon(buff.key)\"\n                        alt=\"\"\n                        style=\"width: 24px; vertical-align: middle; margin-right: 8px\"\n                    />\n                    {{ `${buff.id} - ${buff.level} - ${buff.name}` }}\n                </el-option>\n            </el-select>\n            <el-button @click=\"submitBuff\" style=\"margin-left: 10px; height: 28px; margin-bottom: 5px\">提交</el-button>\n        </div>\n\n        <el-table v-loading=\"loading\" class=\"u-table w-table\" :data=\"currentData\" :border=\"false\" @sort-change=\"sort\">\n            <el-table-column label=\"\" width=\"48\" :align=\"'right'\">\n                <template #default=\"{ row }\">\n                    <img class=\"u-buff-icon\" :src=\"getResourceIcon(row.query_key)\" alt=\"\" />\n                </template>\n            </el-table-column>\n            <el-table-column label=\"增益名称\">\n                <template #default=\"{ row }\">\n                    <span>{{ row.name }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column prop=\"average_stack\" label=\"平均层数\" sortable=\"true\"></el-table-column>\n            <el-table-column prop=\"average_times_per_player\" label=\"平均作用次数\" sortable=\"true\"></el-table-column>\n            <el-table-column prop=\"min_stack\" label=\"单次最小层数\" sortable=\"true\"></el-table-column>\n            <el-table-column prop=\"max_stack\" label=\"单次最大层数\" sortable=\"custom\"></el-table-column>\n            <el-table-column prop=\"average_coverage\" label=\"覆盖率\" sortable=\"custom\"></el-table-column>\n            <el-table-column label=\"覆盖率(百分比)\">\n                <template #default=\"{ row }\">\n                    <div class=\"u-rate-wrapper\">\n                        <div class=\"u-rate-value\">{{ displayPercent(row.average_coverage * 100) }}</div>\n                    </div>\n                </template>\n            </el-table-column>\n        </el-table>\n        <el-pagination\n            class=\"w-pagination\"\n            small\n            background\n            layout=\"pager\"\n            :page-size=\"10\"\n            :total=\"total\"\n            :hide-on-single-page=\"true\"\n            :current-page=\"currentPage\"\n            @update:currentPage=\"currentPage = $event\"\n        />\n    </div>\n</template>\n\n<script setup>\nimport { displayPercent } from \"@/utils/jcl/commonNoStore\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { getResourceIcon } from \"@/utils/jcl/common\";\nimport { ref, computed, watchPostEffect } from \"vue\";\nimport { buffs_coverage_constants } from \"@/assets/data/jcl/buff_coverage_constant\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\n\nconst store = useStore();\n// 定义字典\nlet resource = store.result.resources;\nif (resource == undefined) {\n    resource = {};\n}\n\n// 数据\nconst loading = ref(false);\nconst final_data = ref([]);\nconst selectedBuff = ref(null); // 定义 selectedBuff\nconst query_buff_list = buffs_coverage_constants.team_buffs;\n\nconst { currentPage, currentData, total } = usePaginate(final_data, ref(13));\n\n// 过滤符合条件的增益\nconst filteredBuffs = computed(() => {\n    return Object.keys(resource)\n        .filter((key) => key.startsWith(\"buff\") && resource[key].name !== null)\n        .map((key) => ({ ...resource[key], key: key }));\n});\n\n// methods\nconst sort = ({ prop, order }) => {\n    final_data.value = final_data.value.sort((a, b) => {\n        if (order === \"ascending\") {\n            return a[prop] - b[prop];\n        } else {\n            return b[prop] - a[prop];\n        }\n    });\n};\n\nconst updateData = () => {\n    loading.value = true;\n    getWorkerResponse(\"get_team_buff_coverage\", { query_buff_list }).then((result) => {\n        loading.value = false;\n        final_data.value = result;\n        sort({ prop: \"average_coverage\", order: \"descending\" });\n        currentPage.value = 1;\n    });\n};\n\n// 监控 selectedBuff 的变化\nconst submitBuff = () => {\n    if (selectedBuff.value) {\n        query_buff_list[selectedBuff.value.id] = selectedBuff.value.level;\n        updateData();\n    }\n};\n\nwatchPostEffect(updateData);\n</script>\n\n<style lang=\"less\">\n.m-team-buff-coverage {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    height: 520px;\n    flex: 1;\n    .u-table {\n        flex-grow: 1;\n        .mb(4px);\n        width: 100%;\n        .u-buff-icon {\n            .size(24px);\n            .mr(4px);\n            display: block;\n            margin-top: 5px;\n        }\n\n        .el-table__row {\n            // cursor: pointer;\n        }\n    }\n}\n</style>\n","import script from \"./team_buff_coverage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./team_buff_coverage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./team_buff_coverage.vue?vue&type=style&index=0&id=388f25a0&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    <div class=\"w-card m-individual-buff-coverage\">\n        <p class=\"w-card-title\">个人增益详情</p>\n        <div>\n            <el-select\n                v-model=\"selectedBuff\"\n                placeholder=\"选择一个增益\"\n                filterable\n                style=\"width: 400px; margin-bottom: 5px\"\n                value-key=\"key\"\n            >\n                <el-option\n                    v-for=\"buff in filteredBuffs\"\n                    :key=\"buff.id\"\n                    :label=\"`${buff.id} : ${buff.level} - ${buff.name}`\"\n                    :value=\"buff\"\n                >\n                    <img\n                        :src=\"getResourceIcon(buff.key)\"\n                        alt=\"\"\n                        style=\"width: 24px; vertical-align: middle; margin-right: 8px\"\n                    />\n                    {{ `${buff.id} - ${buff.level} - ${buff.name}` }}\n                </el-option>\n            </el-select>\n            <el-button @click=\"submitBuff\" style=\"margin-left: 10px; margin-bottom: 5px\">提交</el-button>\n        </div>\n\n        <el-table\n            v-loading=\"loading\"\n            class=\"u-table w-table\"\n            :data=\"currentData\"\n            :border=\"false\"\n            @sort-change=\"sort\"\n            @row-click=\"click\"\n            :row-class-name=\"rowClass\"\n        >\n            <el-table-column label=\"\" width=\"48\" :align=\"'center'\">\n                <template #default=\"{ row }\">\n                    <img class=\"u-buff-icon\" :src=\"getResourceIcon(row.query_key)\" alt=\"\" />\n                </template>\n            </el-table-column>\n            <el-table-column label=\"增益名称\" width=\"120\">\n                <template #default=\"{ row }\">\n                    <span>{{ row.name }}</span>\n                </template>\n            </el-table-column>\n            <el-table-column prop=\"average_stack\" label=\"平均层数\" width=\"90\" sortable=\"true\"></el-table-column>\n            <el-table-column prop=\"average_times_per_player\" label=\"平均作用次数\" sortable=\"true\"></el-table-column>\n            <el-table-column prop=\"min_stack\" label=\"单次最小层数\" width=\"130\" sortable=\"true\"></el-table-column>\n            <el-table-column prop=\"max_stack\" label=\"单次最大层数\" width=\"130\" sortable=\"custom\"></el-table-column>\n            <el-table-column prop=\"average_coverage\" label=\"覆盖率\" sortable=\"custom\"></el-table-column>\n            <el-table-column label=\"覆盖率(百分比)\">\n                <template #default=\"{ row }\">\n                    <div class=\"u-rate-wrapper\">\n                        <div class=\"u-rate-value\">{{ displayPercent(row.average_coverage * 100) }}</div>\n                    </div>\n                </template>\n            </el-table-column>\n        </el-table>\n        <el-pagination\n            class=\"w-pagination\"\n            small\n            background\n            layout=\"pager\"\n            :page-size=\"10\"\n            :total=\"total\"\n            :hide-on-single-page=\"true\"\n            :current-page=\"currentPage\"\n            @update:currentPage=\"currentPage = $event\"\n        />\n    </div>\n</template>\n\n<script setup>\nimport { displayPercent } from \"@/utils/jcl/commonNoStore\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { getResourceIcon } from \"@/utils/jcl/common\";\nimport { ref, watchPostEffect, toRefs, computed } from \"vue\";\nimport { buffs_coverage_constants } from \"@/assets/data/jcl/buff_coverage_constant\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport getWorkerResponse from \"@/utils/jcl/worker\";\n\n// 数据\nconst loading = ref(false);\nconst final_data = ref([]);\nconst selectedBuff = ref(null); // 定义 selectedBuff\nconst query_buff_list = buffs_coverage_constants.individual_buffs;\nconst store = useStore();\n// 定义字典\nlet resource = store.result.resources;\nif (resource == undefined) {\n    resource = {};\n}\n\nconst { currentPage, currentData, total } = usePaginate(final_data, ref(10));\n\n// 注入的属性\nconst { individual_selected_buff, individual_selected_buff_log } = toRefs(usePve());\n\n// 行点击事件\nconst click = (row) => {\n    if (individual_selected_buff.value === row.query_key) {\n        return;\n    }\n\n    individual_selected_buff.value = row.query_key;\n    individual_selected_buff_log.value = row;\n};\n// 行样式\nconst rowClass = ({ row }) => {\n    return individual_selected_buff.value === row.query_key ? \"is-focus\" : \"\";\n};\n// 过滤符合条件的增益\nconst filteredBuffs = computed(() => {\n    return Object.keys(resource)\n        .filter((key) => key.startsWith(\"buff\") && resource[key].name !== null)\n        .map((key) => ({ ...resource[key], key: key }));\n});\n\n// methods\nconst sort = ({ prop, order }) => {\n    final_data.value = final_data.value.sort((a, b) => {\n        if (order === \"ascending\") {\n            return a[prop] - b[prop];\n        } else {\n            return b[prop] - a[prop];\n        }\n    });\n};\n\nconst updateData = () => {\n    loading.value = true;\n    getWorkerResponse(\"get_individual_buff_coverage\", { query_buff_list }).then((result) => {\n        loading.value = false;\n        final_data.value = result;\n        sort({ prop: \"average_coverage\", order: \"descending\" });\n        currentPage.value = 1;\n    });\n};\n// watch\nwatchPostEffect(updateData);\n// 监控 selectedBuff 的变化\nconst submitBuff = () => {\n    if (selectedBuff.value) {\n        query_buff_list[selectedBuff.value.id] = selectedBuff.value.level;\n        updateData();\n    }\n};\n</script>\n\n<style lang=\"less\">\n.m-individual-buff-coverage {\n    display: flex;\n    flex-direction: column;\n    gap: 10px;\n    height: 520px;\n    flex: 1;\n\n    .u-table {\n        flex-grow: 1;\n        .mb(4px);\n        width: 100%;\n        .u-buff-icon {\n            .size(24px);\n            .mr(4px);\n            margin-top: 5px;\n        }\n        .el-table__row {\n            cursor: pointer;\n        }\n    }\n}\n</style>\n","import script from \"./individual_buff_coverage.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./individual_buff_coverage.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./individual_buff_coverage.vue?vue&type=style&index=0&id=7603b6f2&lang=less\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n    <div class=\"m-entity-skill-log w-card\">\n        <template v-if=\"currentData.length === 0\">\n            <empty-guide\n                text-align=\"left\"\n                position=\"flex-start\"\n                :rotate=\"-90\"\n                to=\"row\"\n                :grow=\"false\"\n                :tips=\"['在左侧选择一个增益后', '此处会展示该增益作用的所有玩家']\"\n            ></empty-guide>\n        </template>\n        <template v-else>\n            <div class=\"w-card-title\">\n                增益 <span class=\"u-light\">{{ titleName }}</span> 的结算记录\n            </div>\n            <el-table class=\"u-table w-table\" :data=\"currentData\" :border=\"false\">\n                <el-table-column prop=\"index\" label=\"#\" align=\"center\" :width=\"columnWidth[0]\"></el-table-column>\n                <el-table-column label=\"玩家名\" :width=\"columnWidth[1]\">\n                    <template #default=\"{ row }\">\n                        <span>{{ row.playerName }}</span>\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"作用次数\" :width=\"columnWidth[3]\">\n                    <template #default=\"{ row }\">\n                        <span>{{ row.times }}</span>\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"平局作用层数\" :width=\"columnWidth[4]\">\n                    <template #default=\"{ row }\">\n                        <span>{{ row.stack }}</span>\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"覆盖率\" :width=\"columnWidth[5]\">\n                    <template #default=\"{ row }\">\n                        <span>{{ displayPercent(row.coverage * 100) }}</span>\n                    </template>\n                </el-table-column>\n            </el-table>\n            <el-pagination\n                class=\"w-pagination\"\n                small\n                background\n                layout=\"pager\"\n                :page-size=\"pageSize\"\n                :total=\"total\"\n                :hide-on-single-page=\"true\"\n                :current-page=\"currentPage\"\n                @update:currentPage=\"currentPage = $event\"\n            ></el-pagination>\n        </template>\n    </div>\n</template>\n\n<script setup>\nimport EmptyGuide from \"@/components/jcl/common/empty_guide.vue\";\nimport { computed, toRefs } from \"vue\";\nimport { usePaginate } from \"@/utils/jcl/uses/usePaginate\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { displayPercent } from \"@/utils/jcl/commonNoStore\";\n// data\nconst { individual_selected_buff_log } = toRefs(usePve());\nconst store = useStore();\n\n// computed\nconst titleName = computed(() => {\n    return individual_selected_buff_log.value.name;\n});\nconst data = computed(() => {\n    const source = [];\n\n    const { average_coverage_per_player, average_stack_per_player, buffed_player, times_per_player } =\n        individual_selected_buff_log.value;\n    if (buffed_player == undefined) {\n        return [];\n    }\n    for (let i = 0; i < buffed_player.length; ++i) {\n        let this_res = {\n            playerName: store.result.entities[buffed_player[i]].name,\n            times: times_per_player[i].toFixed(0),\n            stack: average_stack_per_player[i].toFixed(1),\n            coverage: average_coverage_per_player[i].toFixed(4),\n        };\n        source.push(this_res);\n    }\n    if (!source.length) return [];\n    let index = 0;\n    for (let log of source) {\n        log.index = ++index;\n    }\n    return source;\n});\nconst pageSize = computed(() => {\n    return 13;\n});\nconst columnWidth = computed(() => {\n    return [42, 120, 80, 80, 110, 90];\n});\nconst { total, currentPage, currentData } = usePaginate(data, pageSize);\n</script>\n\n<style lang=\"less\" scoped>\n.m-entity-skill-log {\n    flex: 1;\n    // flex-shrink: 0;\n\n    .u-light {\n        color: white;\n    }\n    .u-effect-icon {\n        .size(18px);\n        .db;\n        margin: auto;\n    }\n}\n</style>\n","import script from \"./individual_buff_coverage_log.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./individual_buff_coverage_log.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./individual_buff_coverage_log.vue?vue&type=style&index=0&id=5f15ea7c&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-5f15ea7c\"]])\n\nexport default __exports__","import script from \"./buff_coverage_main.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./buff_coverage_main.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","import \"core-js/modules/es.array.push.js\";\nimport { createVNode as _createVNode, withCtx as _withCtx, unref as _unref, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"p-pve-result\"\n};\nconst _hoisted_2 = {\n  class: \"u-title\"\n};\nconst _hoisted_3 = {\n  class: \"m-pve-main\"\n};\nconst _hoisted_4 = {\n  class: \"m-pve-content\"\n};\nimport { toRefs, onMounted, defineComponent, watchPostEffect } from \"vue\";\nimport { useStore } from \"@/pages/jcl/store\";\nimport { usePve } from \"@/pages/jcl/store_pve\";\nimport { useRouter } from \"vue-router\";\nimport JclHeader from \"@/components/jcl/common/jcl_header.vue\";\nimport PveHeaderTabs from \"@/components/jcl/pve/header_tabs.vue\";\nimport PveOverview from \"@/components/jcl/pve/pve_overview.vue\";\nimport PevDeatil from \"@/components/jcl/pve/pve_detail.vue\";\nimport PveCompare from \"@/components/jcl/pve/pve_compare.vue\";\nimport BlameIndex from \"@/components/jcl/pve/blame_index.vue\";\nimport BossTimeLine from \"@/components/jcl/pve/boss_timeline_selector.vue\";\nimport PveLogs from \"@/components/jcl/pve/pve_logs.vue\";\nimport BuffCoverageMain from \"@/components/jcl/pve/buff_coverage_main.vue\";\nexport default {\n  __name: 'Pve',\n  setup(__props) {\n    const mainComponents = {\n      overview: PveOverview,\n      detail: PevDeatil,\n      compare: PveCompare,\n      blame: BlameIndex,\n      time_line: BossTimeLine,\n      buff_coverage_main: BuffCoverageMain,\n      logs: PveLogs\n    };\n    const store = useStore();\n    const router = useRouter();\n    const {\n      mainTab,\n      statType,\n      entityTab,\n      viewType,\n      entityList,\n      entity,\n      compareMode,\n      compareEntity\n    } = toRefs(usePve());\n    const displayTitle = computed(() => {\n      const {\n        info,\n        file\n      } = store;\n      const title = info.title || file.name || \"这是一个标题！这是一个标题！这是一个标题！这是一个标题！\";\n      return title.replace(/\\.jcl$/, \"\");\n    });\n    onMounted(() => {\n      const query = router.currentRoute.value.query;\n      // 初始化，带着结果来的，如果有路由\n      if (store.result) {\n        if (query.tab) mainTab.value = query.tab;\n        if (query.statType) statType.value = query.statType;\n        if (query.entityTab) entityTab.value = query.entityTab;\n        if (query.viewType) viewType.value = query.viewType;\n        if (query.entity) {\n          if (!entityList.value.includes(query.entity)) entityList.value.push(Number(query.entity));\n          entity.value = Number(query.entity);\n        }\n        if (query.compareMode) compareMode.value = query.compareMode;\n        if (compareEntity.value[0]) query.entity1 = compareEntity.value[0];\n        if (compareEntity.value[1]) query.entity2 = compareEntity.value[1];\n        if (compareEntity.value[2]) query.entity3 = compareEntity.value[2];\n        if (compareEntity.value[3]) query.entity4 = compareEntity.value[3];\n        return;\n      }\n      // 初始化的时候，没有结果，但是带了ID，带着query跳去view\n      if (query.id) {\n        router.push({\n          name: \"view\",\n          query\n        });\n        return;\n      }\n      // 没有id，跳回home\n      router.push({\n        name: \"home\"\n      });\n    });\n    // 用户切换各种tab、选择玩家的时候修改路由\n    watchPostEffect(() => {\n      var _store$info;\n      const id = (_store$info = store.info) === null || _store$info === void 0 ? void 0 : _store$info.id;\n      if (!id) return;\n      const query = {\n        id,\n        tab: mainTab.value\n      };\n      if (mainTab.value === \"overview\") {\n        if (statType.value) query.statType = statType.value;\n      }\n      if (mainTab.value === \"detail\") {\n        if (entityTab.value) query.entityTab = entityTab.value;\n        if (viewType.value) query.viewType = viewType.value;\n        if (statType.value) query.statType = statType.value;\n      }\n      if (mainTab.value === \"compare\") {\n        if (compareMode.value) query.compareMode = compareMode.value;\n        if (compareEntity.value[0]) query.entity1 = compareEntity.value[0];\n        if (compareEntity.value[1]) query.entity2 = compareEntity.value[1];\n      }\n      router.replace({\n        query\n      });\n    });\n    defineComponent({\n      name: \"PveIndex\"\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(JclHeader, null, {\n        default: _withCtx(() => [_createVNode(PveHeaderTabs)]),\n        _: 1\n      }), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"h1\", null, _toDisplayString(_unref(displayTitle)), 1)]), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [(_openBlock(), _createBlock(_resolveDynamicComponent(mainComponents[_unref(mainTab)])))])])]);\n    };\n  }\n};","import script from \"./Pve.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./Pve.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./Pve.vue?vue&type=style&index=0&id=cbb8bba2&lang=less&scoped=true\"\n\nimport exportComponent from \"/home/runner/work/pvp/pvp/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-cbb8bba2\"]])\n\nexport default __exports__"],"names":["tryToString","$TypeError","TypeError","module","exports","O","P","$","toObject","lengthOfArrayLike","setArrayLength","deletePropertyOrThrow","doesNotExceedSafeInteger","INCORRECT_RESULT","unshift","properErrorOnNonWritableLength","Object","defineProperty","writable","error","FORCED","target","proto","arity","forced","item","this","len","argCount","arguments","length","k","to","j","fabric","version","document","window","HTMLDocument","Document","implementation","createHTMLDocument","jsdom","virtualWindow","JSDOM","decodeURIComponent","features","FetchExternalResources","resources","jsdomImplForWrapper","nodeCanvas","DOMParser","resizeCanvasIfNeeded","pipelineState","targetCanvas","width","height","dWidth","destinationWidth","dHeight","destinationHeight","copyGLTo2DDrawImage","gl","glCanvas","canvas","ctx","getContext","translate","scale","sourceY","drawImage","copyGLTo2DPutImageData","numBytes","u8","Uint8Array","imageBuffer","u8Clamped","Uint8ClampedArray","readPixels","RGBA","UNSIGNED_BYTE","imgData","ImageData","putImageData","isTouchSupported","navigator","maxTouchPoints","isLikelyNode","Buffer","SHARED_ATTRIBUTES","DPI","reNum","commaWsp","rePathCommand","reNonWord","fontPaths","iMatrix","svgNS","perfLimitSizeTotal","maxCacheSideLimit","minCacheSideLimit","charWidthsCache","textureSize","disableStyleCopyPaste","enableGLFiltering","devicePixelRatio","webkitDevicePixelRatio","mozDevicePixelRatio","browserShadowBlurConstant","arcToSegmentsCache","boundsOfCurveCache","cachesBoundsOfCurve","forceGLPutImageData","initFilterBackend","isWebglSupported","console","log","maxTextureSize","WebglFilterBackend","tileSize","Canvas2dFilterBackend","_removeEventListener","eventName","handler","__eventListeners","eventListener","indexOf","util","array","fill","on","prop","push","_once","_handler","apply","off","bind","once","call","fire","options","listenersForEvent","i","filter","value","Observable","Collection","_objects","add","_onObjectAdded","renderOnAddRemove","requestRenderAll","insertAt","object","index","nonSplicing","objects","splice","remove","somethingRemoved","_onObjectRemoved","forEachObject","callback","context","getObjects","type","concat","o","isEmpty","size","contains","deep","some","obj","complexity","reduce","memo","current","CommonMethods","_setOptions","set","_initGradient","filler","property","colorStops","Gradient","_initPattern","source","Pattern","_setObject","_set","key","toggle","get","global","sqrt","Math","atan2","pow","PiBy180","PI","PiBy2","cos","angle","angleSlice","sin","sign","removeFromArray","idx","getRandomInt","min","max","floor","random","degreesToRadians","degrees","radiansToDegrees","radians","rotatePoint","point","origin","newPoint","Point","x","y","v","rotateVector","addEquals","vector","rx","ry","createVector","from","calcAngleBetweenVectors","a","b","acos","hypot","getHatVector","multiply","getBisector","A","B","C","AB","AC","alpha","ro","phi","projectStrokeOnPoints","points","openPath","coords","s","strokeWidth","strokeUniformScalar","strokeUniform","scaleX","scaleY","getStrokeHatVector","scalar","forEach","p","miterVector","bisector","bisectorVector","strokeLineJoin","strokeMiterLimit","subtract","SQRT2","transformPoint","t","ignoreOffset","makeBoundingBoxFromPoints","transform","xPoints","minX","maxX","yPoints","minY","maxY","left","top","invertTransform","r","toFixed","number","fractionDigits","parseFloat","Number","parseUnit","fontSize","unit","exec","Text","DEFAULT_SVG_FONT_SIZE","falseFunction","getKlass","namespace","string","camelize","charAt","toUpperCase","slice","resolveNamespace","getSvgAttributes","attributes","parts","split","loadImage","url","crossOrigin","img","createImage","onLoadCallback","onload","onerror","src","undefined","substring","loadImageInDom","div","createElement","style","position","appendChild","querySelector","parentNode","removeChild","enlivenObjects","reviver","enlivenedObjects","numLoadedObjects","numTotalObjects","onLoaded","klass","fromObject","enlivenObjectEnlivables","enlivenProps","ENLIVEN_PROPS","map","enlivedProps","enlivenPatterns","patterns","numLoadedPatterns","numPatterns","enlivenedPatterns","pattern","groupSVGElements","elements","path","sourcePath","centerPoint","Group","populateWithProperties","destination","properties","Array","isArray","createCanvasElement","copyCanvasElement","newCanvas","toDataURL","canvasEl","format","quality","multiplyTransformMatrices","is2x2","qrDecompose","denom","skewX","skewY","translateX","translateY","calcRotateMatrix","theta","calcDimensionsMatrix","scaleMatrix","flipX","flipY","tan","composeMatrix","matrix","resetObjectTransform","rotate","saveObjectTransform","isTransparent","tolerance","temp","_isTransparent","imageData","getImageData","l","data","parsePreserveAspectRatioAttribute","attribute","align","meetOrSlice","alignX","alignY","aspectRatioAttrs","pop","clearFabricFontCache","fontFamily","toLowerCase","limitDimsByArea","ar","maximumArea","roughWidth","perfLimitSizeY","capValue","findScaleToFit","findScaleToCover","matrixToSVG","NUM_FRACTION_DIGITS","join","removeTransformFromObject","inverted","finalTransform","calcOwnMatrix","applyTransformToObject","addTransformToObject","center","setPositionByOrigin","sizeAfterTransform","dimX","dimY","transformMatrix","bbox","mergeClipPaths","c1","c2","calcTransformMatrix","clipPath","hasStyleChanged","prevStyle","thisStyle","forTextSpans","stroke","fontWeight","fontStyle","textBackgroundColor","deltaY","overline","underline","linethrough","stylesToArray","styles","text","clone","textLines","charIndex","stylesArray","c","keys","styleChanged","start","end","stylesFromArray","styleIndex","stylesObject","assign","_join","prototype","commandLengths","m","h","q","repeatedCommands","M","segmentToBezier","th2","th3","cosTh","sinTh","cx1","cy1","mT","fromX","fromY","costh2","sinth2","costh3","sinth3","toX","toY","cp1X","cp1Y","cp2X","cp2Y","arcToSegments","large","sweep","rotateX","th","abs","px","py","rx2","ry2","py2","px2","pl","root","cx","cy","mTheta","calcVectorAngle","dtheta","segments","ceil","result","mDelta","ux","uy","vx","vy","ta","tb","getBoundsOfCurve","x0","y0","x1","y1","x2","y2","x3","y3","argsString","t1","t2","b2ac","sqrtb2ac","tvalues","bounds","mt","jlen","fromArcToBeziers","fx","fy","rot","tx","ty","segsNorm","makePathSimpler","converted","previous","controlX","controlY","destinationPath","calcLineLength","CB1","CB2","CB3","CB4","getPointOnCubicBezierIterator","p1x","p1y","p2x","p2y","p3x","p3y","p4x","p4y","pct","c3","c4","getTangentCubicIterator","invT","tangentX","tangentY","QB1","QB2","QB3","getPointOnQuadraticBezierIterator","getTangentQuadraticIterator","pathIterator","iterator","perc","tempP","tmpLen","findPercentageForDistance","segInfo","distance","nextLen","lastPerc","nextStep","angleFinder","getPathSegmentsInfo","tempInfo","totalLength","info","command","destX","destY","getPointOnPath","infos","segPercent","segment","lerp","parsePath","pathString","currentPath","parsed","match","coordsStr","re","rNumber","rNumberCommaWsp","rFlagCommaWsp","rArcSeq","regArcArgumentSequence","RegExp","coordsParsed","trim","args","isNaN","commandLength","repeatedCommand","klen","getSmoothPathFromPoints","correction","p1","p2","multSignX","multSignY","manyPoints","eq","midPoint","midPointFrom","transformPath","pathOffset","pathSegment","newSegment","joinPath","pathData","invoke","method","byProperty","find","value1","value2","condition","extend","Element","hasOwnProperty","replace","character","capitalize","firstLetterOnly","escapeXml","graphemeSplit","textstring","chr","graphemes","getWholeChar","str","code","charCodeAt","next","prev","emptyFunction","IS_DONTENUM_BUGGY","toString","addMethods","parent","superclass","constructor","returnValue","valueOf","Subclass","callSuper","methodName","parentMethod","_this","superClassMethod","createClass","initialize","shift","subclasses","couldUseAttachEvent","attachEvent","touchEvents","getTouchInfo","event","touchProp","changedTouches","addListener","element","addEventListener","removeListener","removeEventListener","getPointer","scroll","getScrollLeftTop","_evt","clientX","clientY","isTouchEvent","pointerType","setStyle","elementStyle","cssText","setOpacity","normalizedProperty","styleFloat","setProperty","parseEl","supportsOpacity","opacity","supportsFilters","reOpacity","es","currentStyle","hasLayout","zoom","test","_slice","getById","id","getElementById","sliceCanConvertNodelists","getElementStyle","toArray","arrayLike","childNodes","err","makeElement","tagName","el","className","htmlFor","setAttribute","addClass","wrapElement","wrapper","replaceChild","docElement","documentElement","body","scrollLeft","scrollTop","host","nodeType","getElementOffset","docElem","scrollLeftTop","doc","ownerDocument","box","offset","offsetAttributes","borderLeftWidth","borderTopWidth","paddingLeft","paddingTop","attr","parseInt","getBoundingClientRect","clientLeft","clientTop","getNodeCanvas","impl","_canvas","_image","cleanUpJsdomNode","_currentSrc","_attributes","_classList","setImageSmoothing","imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","oImageSmoothingEnabled","arr","defaultView","getComputedStyle","selectProp","makeElementUnselectable","onselectstart","unselectable","makeElementSelectable","addParamToUrl","param","emptyFn","request","onComplete","xhr","XMLHttpRequest","parameters","onreadystatechange","readyState","open","setRequestHeader","send","warn","RUNNING_ANIMATIONS","noop","defaultEasing","d","animate","cancel","removeFromRegistry","runningAnimations","currentValue","startValue","completionRate","durationRate","requestAnimFrame","timestamp","time","Date","duration","finish","onChange","abort","easing","isMany","endValue","byValue","onStart","tick","ticktime","currentTime","timePerc","_value","valuePerc","cancelAll","animations","animation","cancelByCanvas","cancelled","cancelByTarget","findAnimationsByTarget","findAnimationIndex","cancelFunc","findAnimation","_requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","setTimeout","_cancelAnimFrame","cancelAnimationFrame","clearTimeout","cancelAnimFrame","calculateColor","begin","pos","color","animateColor","fromColor","toColor","startColor","Color","getSource","endColor","originalOnComplete","originalOnChange","posValue","colorEasing","normalize","asin","elastic","opts","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInBounce","easeOutBounce","easeInOutBounce","ease","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","svgValidTagNames","svgViewBoxElements","svgInvalidAncestors","svgValidParents","attributesMap","display","visibility","colorAttributes","fSize","cPath","normalizeAttr","normalizeValue","parentAttributes","parseTransformAttribute","visible","fillIndex","strokeIndex","getSvgRegex","_setStrokeFillOpacity","setAlpha","getAlpha","toRgba","_getMultipleNodes","nodeNames","nodeName","nodeList","nodeArray","getElementsByTagName","parseStyleString","oStyle","chunk","pair","parseStyleObject","getGlobalStylesForElement","svgUid","rule","cssRules","elementMatchesRule","selectors","firstMatching","parentMatching","selectorMatches","doesSomeParentMatch","selector","matcher","classNames","getAttribute","elementById","node","nodelist","parseUseDirectives","xlinkAttribute","attrs","xlink","el2","cloneNode","currentTrans","oldLength","applyViewboxTransform","el3","createElementNS","setAttributeNS","nodeValue","firstChild","removeAttribute","svgValidTagNamesRegEx","svgViewBoxElementsRegEx","svgInvalidAncestorsRegEx","svgValidParentsRegEx","gradientDefs","clipPaths","rotateMatrix","multiplierX","multiplierY","skewMatrix","translateMatrix","transforms","transformList","reTransformList","reTransform","attributeValue","matrices","operation","combinedMatrix","reViewBoxAttrValue","viewBoxWidth","viewBoxHeight","viewBoxAttr","widthAttr","heightAttr","preserveAspectRatio","missingViewBox","missingDimAttr","toBeParsed","parsedDim","widthDiff","heightDiff","hasAncestorWithNodeName","recursivelyParseGradientsXlink","gradient","gradientsAttrs","xlinkAttr","xLink","referencedGradient","hasAttribute","children","referenceClone","parseSVGDocument","parsingOptions","__uid","descendants","selectNodes","getGradientDefs","getCSSRules","parseElements","instances","reFontDeclaration","parseFontDeclaration","lineHeight","tagArray","elList","parseAttributes","parentFontSize","ownAttributes","cssAttrs","parseStyleAttribute","normalizedAttr","normalizedValue","normalizedStyle","font","mergedAttrs","ElementsParser","parse","parsePointsAttribute","parsedPoints","rules","allRules","styleContents","textContent","ruleObj","declaration","propertyValuePairs","_rule","loadSVGFromURL","xml","responseXML","results","_options","allElements","loadSVGFromString","parser","parseFromString","regexUrl","numElements","createObjects","createObject","findTag","fromElement","createCallback","checkIfDone","resolveGradient","Image","_originalElement","_removeTransformMatrix","resolveClipPath","extractPropertyDefinition","storage","regex","lastIndex","gradientDef","opacityAttr","createClipPathCallback","container","_newObj","fillRule","clipRule","usingElement","objTransformInv","gTransform","clipPathTag","clipPathOwner","that","scalarAdd","scalarAddEquals","subtractEquals","scalarSubtract","scalarSubtractEquals","multiplyEquals","divide","divideEquals","lt","lte","gt","gte","distanceFrom","dx","dy","setXY","setX","setY","setFromPoint","swap","Intersection","status","appendPoint","appendPoints","intersectLineLine","a1","a2","b1","b2","uaT","ubT","uB","ua","ub","intersectLinePolygon","inter","intersectPolygonPolygon","points1","points2","intersectPolygonRectangle","r1","r2","topRight","bottomLeft","inter1","inter2","inter3","inter4","_tryParsingColor","setSource","hue2rgb","colorNameMap","sourceFromHex","sourceFromRgb","sourceFromHsl","_rgbToHsl","g","round","_source","toRgb","toHsl","hsl","toHsla","toHex","toHexa","toGrayscale","average","currentAlpha","toBlackWhite","threshold","overlayWith","otherColor","otherAlpha","otherSource","reRGBa","reHSLa","reHex","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgrey","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgrey","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","fromRgb","fromSource","fromRgba","fromHsl","fromHsla","fromHex","isShortNotation","isRGBa","oColor","scaleMap","skewMap","controls","LEFT","TOP","RIGHT","BOTTOM","CENTER","opposite","bottom","right","findCornerQuadrant","fabricObject","control","cornerAngle","fireEvent","canvasOptions","scaleIsProportional","eventData","uniScaleKey","uniformIsToggled","uniformScaling","isTransformCentered","originX","originY","scalingIsForbidden","by","scaleProportionally","lockX","lockScalingX","lockY","lockScalingY","scaleCursorStyleHandler","notAllowed","n","skewCursorStyleHandler","lockSkewingY","lockSkewingX","scaleSkewCursorStyleHandler","altActionKey","scaleOrSkewActionName","isAlternative","rotationStyleHandler","lockRotation","cursorStyle","commonEventInfo","e","pointer","wrapWithFixedAnchor","actionHandler","getCenterPoint","constraint","translateToOriginPoint","actionPerformed","wrapWithFireEvent","getLocalPoint","corner","getZoom","padding","localPoint","toLocalPoint","offsetX","offsetY","targetHasOneFlip","compensateScaleForSkew","oppositeSkew","scaleToCompensate","axis","reference","newDim","_getTransformedDimensions","newValue","skewObjectX","newSkew","dimNoSkew","totalSkewSize","currentSkew","hasSkewed","dimBeforeSkewing","skewObjectY","skewHandlerX","localPointFromCenter","finalHandler","skewHandlerY","rotationWithSnapping","pivotPoint","lastAngle","ey","ex","curAngle","hasRotated","snapAngle","snapThreshold","rightAngleLocked","leftAngleLocked","scaleObject","dim","signX","signY","forbidScaling","gestureScale","lockScalingFlip","original","originalDistance","oldScaleX","oldScaleY","scaleObjectFromCorner","scaleObjectX","scaleObjectY","scalingYOrSkewingX","scalingY","scalingXOrSkewingY","scalingX","changeWidth","strokePadding","multiplier","oldWidth","newWidth","dragHandler","newLeft","newTop","moveX","moveY","scalingEqually","controlsUtils","renderCircleControl","styleOverride","xSize","sizeX","cornerSize","ySize","sizeY","transparentCorners","cornerStrokeColor","myLeft","myTop","save","fillStyle","cornerColor","strokeStyle","lineWidth","beginPath","arc","restore","renderSquareControl","xSizeBy2","ySizeBy2","strokeRect","Control","actionName","touchSizeX","touchSizeY","withConnection","mouseDownHandler","mouseUpHandler","getActionHandler","getMouseDownHandler","getMouseUpHandler","cursorStyleHandler","getActionName","getVisibility","controlKey","objectVisibility","_controlsVisibility","setVisibility","positionHandler","finalMatrix","calcCornerCoords","objectAngle","objectCornerSize","centerX","centerY","isTouch","cosHalfOffset","sinHalfOffset","cosHalfOffsetComp","sinHalfOffsetComp","controlTriangleAngle","cornerHypotenuse","newTheta","newThetaComp","tl","tr","bl","br","render","cornerStyle","getColorStop","colorAlpha","keyValuePairs","getLinearCoords","getRadialCoords","__convertPercentUnitsToValues","instance","svgOptions","gradientUnits","propValue","finalValue","gradientTransform","option","addColorStop","propertiesToInclude","toSVG","markup","commonAttributes","needsSwap","withViewport","additionalTransform","sort","reverse","minRadius","maxRadius","percentageShift","colorStop","toLive","createLinearGradient","createRadialGradient","colorStopEls","repeat","patternTransform","setOptions","isError","patternSource","patternWidth","patternHeight","patternOffsetX","patternOffsetY","patternImgSrc","complete","naturalWidth","naturalHeight","createPattern","Shadow","blur","affectStroke","includeDefaultValues","nonScaling","_parseShadow","shadow","shadowStr","offsetsAndBlur","reOffsetsAndBlur","fBoxX","fBoxY","BLUR_BOX","StaticCanvas","CANVAS_INIT_ERROR","Error","renderAndResetBound","renderAndReset","requestRenderAllBound","_initStatic","backgroundColor","backgroundImage","overlayColor","overlayImage","stateful","controlsAboveOverlay","allowTouchScrolling","viewportTransform","backgroundVpt","overlayVpt","enableRetinaScaling","vptCoords","skipOffscreen","cb","_createLowerCanvas","_initOptions","interactive","_initRetinaScaling","setOverlayImage","setBackgroundImage","setBackgroundColor","setOverlayColor","calcOffset","_isRetinaScaling","getRetinaScaling","scaleRatio","__initRetinaScaling","lowerCanvasEl","contextContainer","upperCanvasEl","contextTop","_offset","image","__setBgOverlayImage","__setBgOverlayColor","_createCanvasElement","_originalCanvasStyle","_applyCanvasStyle","getWidth","getHeight","setWidth","setDimensions","setHeight","dimensions","cssValue","cssOnly","_setBackstoreDimension","hasLostContext","backstoreOnly","_setCssDimension","_isCurrentlyDrawing","freeDrawingBrush","_setBrushStyles","cacheCanvasEl","wrapperEl","setViewportTransform","vpt","activeObject","_activeObject","backgroundObject","overlayObject","group","setCoords","calcViewportBoundaries","zoomToPoint","before","after","setZoom","absolutePan","relativePan","getElement","setupState","clearContext","clearRect","clear","_hasITextHandlers","_mouseUpITextHandler","_iTextInstances","renderAll","canvasToDrawOn","renderCanvas","isRendering","iVpt","cancelRequestedRender","_renderBackground","_renderObjects","drawControls","shouldCache","_transformDone","renderCache","forClipping","drawClipPathOnCanvas","_renderOverlay","globalCompositeOperation","zoomX","zoomY","_cacheCanvas","cacheTranslationX","cacheTranslationY","_renderBackgroundOrOverlay","needsVpt","moveTo","lineTo","closePath","getCenter","centerObjectH","_centerObject","centerObjectV","centerObject","viewportCenterObject","vpCenter","getVpCenter","viewportCenterObjectH","viewportCenterObjectV","toDatalessJSON","toDatalessObject","_toObjectMethod","_toObjects","excludeFromExport","_toObject","__serializeBgOverlay","originalValue","bgImage","bgColor","background","overlay","svgViewportTransformation","_setSVGPreamble","_setSVGHeader","clipPathId","_setSVGBgOverlayColor","_setSVGBgOverlayImage","_setSVGObjects","suppressPreamble","encoding","viewBox","createSVGFontFacesMarkup","createSVGRefElementsMarkup","createSVGClipPathMarkup","toClipPathSVG","shouldTransform","row","rowIndex","_char","fontList","_setSVGObject","finalWidth","finalHeight","shouldInvert","sendToBack","objs","activeSelection","bringToFront","sendBackwards","intersecting","newIdx","objsMoved","_findNewLowerIndex","isIntersecting","intersectsWithObject","isContainedWithinObject","bringForward","_findNewUpperIndex","dispose","classList","DataURLExporter","EMPTY_JSON","supports","setLineDash","toJSON","createPNGStream","createJPEGStream","BaseBrush","strokeLineCap","strokeDashArray","limitedToCanvasSize","lineCap","miterLimit","lineJoin","_saveAndTransform","_setShadow","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","needsFullRender","_resetShadow","_isOutSideCanvas","PencilBrush","decimate","drawStraightLine","straightLineKey","_points","_hasStraightLine","_drawSegment","quadraticCurveTo","onMouseDown","_isMainEvent","_prepareForDrawing","_captureDrawingPath","_render","onMouseMove","oldEnd","onMouseUp","_finalizeAndAddPath","_reset","_addPoint","pointerPoint","convertPointsToSVGPath","_isEmptySVGPath","createPath","Path","decimatePoints","cDistance","adjustedDistance","lastPoint","newPoints","CircleBrush","drawDot","addPoint","dot","radius","originalRenderOnAddRemove","circles","circle","Circle","circleRadius","circleColor","SprayBrush","density","dotWidth","dotWidthVariance","randomOpacity","optimizeOverlapping","sprayChunks","addSprayChunk","sprayChunkPoints","rects","ilen","sprayChunk","rect","Rect","_getOptimizedRects","uniqueRects","uniqueRectsArray","globalAlpha","fillRect","PatternBrush","getPatternSrc","dotDistance","patternCanvas","patternCtx","getPatternSrcFunction","String","getPattern","topLeft","_getLeftTopCoords","Canvas","_initInteractive","_createCacheCanvas","centeredScaling","centeredRotation","centeredKey","selection","selectionKey","altSelectionKey","selectionColor","selectionDashArray","selectionBorderColor","selectionLineWidth","selectionFullyContained","hoverCursor","moveCursor","defaultCursor","freeDrawingCursor","notAllowedCursor","containerClass","perPixelTargetFind","targetFindTolerance","skipTargetFind","isDrawingMode","preserveObjectStacking","stopContextMenu","fireRightClick","fireMiddleClick","targets","enablePointerEvents","_hoveredTarget","_hoveredTargets","_currentTransform","_groupSelector","_initWrapperElement","_createUpperCanvas","_initEventListeners","_chooseObjectsToRender","objsToRender","activeGroupObjects","activeObjects","getActiveObjects","contextTopDirty","renderTopLayer","_drawSelection","renderTop","_normalizePointer","invertedM","vptPointer","restorePointerVpt","isTargetTransparent","normalizedPointer","targetRelativeX","targetRelativeY","_cacheContext","contextCache","originalColor","selectionBackgroundColor","_isSelectionKeyPressed","selectionKeyPressed","_shouldClearSelection","evented","selectable","_shouldCenterTransform","action","altKey","centerTransform","_getOriginFromCorner","_getActionFromCorner","alreadySelected","_setupCurrentTransform","__corner","lastX","lastY","shiftKey","_beforeTransform","setCursor","cursor","viewportStart","viewportExtent","extent","strokeOffset","_setLineDash","findTarget","skipGroup","activeTarget","activeTargetSubs","ignoreZoom","aObjects","shouldLookForActive","_findTargetCorner","_searchPossibleTargets","_checkTarget","globalPointer","containsPoint","isEditing","subTarget","objToCheck","pointerToUse","subTargetCheck","_absolutePointer","_pointer","cssScale","boundsWidth","boundsHeight","retinaScaling","lowerCanvasClass","_copyCanvasStyle","getTopContext","fromEl","toEl","getSelectionContext","getSelectionElement","getActiveObject","active","_discardActiveObject","_fireSelectionEvents","oldObjects","somethingChanged","added","removed","oldObject","selected","deselected","setActiveObject","currentActives","_setActiveObject","onSelect","onDeselect","discardActiveObject","removeListeners","_renderControls","originalProperties","_realizeGroupTransformOnObject","_unwindGroupTransformOnObject","layoutProps","originalValues","clearContextTop","RIGHT_CLICK","MIDDLE_CLICK","LEFT_CLICK","addEventOptions","passive","checkClick","button","mainTouchId","_bindEvents","addOrRemove","_getEventPrefix","functor","eventjsFunctor","canvasElement","eventTypePrefix","_onResize","_onMouseDown","_onMouseMove","_onMouseOut","_onMouseEnter","_onMouseWheel","_onContextMenu","_onDoubleClick","_onDragOver","_onDragEnter","_onDragLeave","_onDrop","_onTouchStart","eventjs","_onGesture","_onDrag","_onOrientationChange","_onShake","_onLongPress","_onMouseUp","_onTouchEnd","eventsBound","_simpleEventHandler","self","__onTransformGesture","__onDrag","__onMouseWheel","_target","__onOrientationChange","__onShake","__onLongPress","preventDefault","_fireEnterLeaveEvents","stopPropagation","_cacheTransformEventData","_handleEvent","_resetTransformEventData","getPointerId","evt","identifier","pointerId","isPrimary","touches","__onMouseDown","__onMouseUp","_willAddMouseDown","__onMouseMove","_shouldRender","groupSelector","shouldRender","isClick","_onMouseUpInDrawingMode","_finalizeCurrentTransform","targetWasActive","_maybeGroupObjects","activeOn","isMoving","originalControl","originalMouseUpHandler","_setCursorFromEvent","eventType","subTargets","absolutePointer","currentTarget","currentSubTargets","_scaling","hasStateChanged","_fire","_onMouseDownInDrawingMode","_onMouseMoveInDrawingMode","_previousPointer","shouldGroup","_shouldGroup","_handleGrouping","saveState","_transformObject","_fireOverOutEvents","fireSyntheticInOutEvents","oldTarget","evtOut","canvasEvtOut","evtIn","canvasEvtIn","_draggedoverTarget","config","inOpt","outOpt","outFires","inFires","targetChanged","previousTarget","nextTarget","reset","_performTransformAction","getCornerCursor","_updateActiveSelection","_createActiveSelection","currentActiveObjects","removeWithUpdate","addWithUpdate","_createGroup","isActiveLower","groupObjects","exitEditing","ActiveSelection","_groupSelectedObjects","aGroup","_collectObjects","currentObject","selectionX1Y1","selectionX2Y2","allowIntersect","intersectsWithRect","isContainedWithinRect","toCanvasElement","cropping","scaledWidth","scaledHeight","originalWidth","originalHeight","newZoom","vp","originalInteractive","newVp","originalRetina","originalContextTop","loadFromJSON","json","serialized","JSON","_enlivenObjects","_setBgOverlay","enlivenedCanvasClip","__setupCanvas","loaded","cbIfLoaded","__setBgOverlay","enlivedObject","_toDataURL","_toDataURLWithMultiplier","toDataURLWithMultiplier","stringify","cloneWithoutData","backgroundImageOpacity","backgroundImageStretch","objectCaching","ALIASING_LIMIT","touchCornerSize","borderColor","borderDashArray","cornerDashArray","strokeDashOffset","borderOpacityWhenMoving","borderScaleFactor","minScaleLimit","hasControls","hasBorders","lockMovementX","lockMovementY","statefullCache","noScaleCache","dirty","paintFirst","stateProperties","cacheProperties","colorProperties","absolutePositioned","_cacheProperties","_updateCacheCanvas","_limitCacheSize","dims","limitedDims","capped","_getCacheCanvasDimensions","objectScale","getTotalObjectScaling","neededX","neededY","drawingWidth","drawingHeight","dimensionsChanged","cacheWidth","cacheHeight","zoomChanged","shouldRedraw","setTransform","needFullTransform","_removeDefaultValues","getObjectScaling","retina","getObjectOpacity","shouldConstrainValue","isChanged","groupNeedsUpdate","_constrainScale","isOnACache","setOnGroup","getViewportTransform","isNotVisible","isOnScreen","_setupCompositeOperation","drawSelectionBackground","_setOpacity","drawCacheOnCanvas","_removeCacheCanvas","drawObject","propertySet","isCacheDirty","hasStroke","hasFill","needsItsOwnCache","ownCaching","willDrawShadow","drawClipPathOnCache","originalFill","originalStroke","_setClippingProperties","_drawClipPath","skipCanvas","_getNonTransformedDimensions","_removeShadow","_setStrokeStyles","decl","lineDashOffset","_applyPatternForTransformedGradient","_applyPatternGradientTransform","_setFillStyles","dashArray","drawBorders","forActiveSelection","drawBordersInGroup","scaling","multX","multY","_renderPaintInOrder","_renderStroke","_renderFill","pCtx","pCanvas","_findCenterFromElement","_assignTransformMatrixProps","preserveAspectRatioOptions","cropX","cropY","offsetLeft","offsetTop","objectForm","_fromObject","cloneAsImage","utils","origParams","originalGroup","originalShadow","withoutTransform","withoutShadow","boundingRect","getBoundingRect","shadowOffset","originalCanvas","isType","includes","shouldCenterOrigin","_setOriginToCenter","_resetOrigin","centerH","viewportCenterH","centerV","viewportCenterV","viewportCenter","getLocalPointer","pClicked","objectLeftTop","createAccessors","extraParam","originXOffset","originYOffset","translateToGivenOrigin","fromOriginX","fromOriginY","toOriginX","toOriginY","translateToCenterPoint","leftTop","getPointByOrigin","adjustPosition","offsetFrom","offsetTo","hypotFull","getScaledWidth","xFull","yFull","_originalOriginX","_originalOriginY","originPoint","arrayFromCoords","multiplyMatrices","oCoords","aCoords","lineCoords","ownMatrixCache","matrixCache","_getCoords","absolute","calculate","calcACoords","calcLineCoords","getCoords","pointTL","pointBR","intersection","other","otherCoords","lines","_getImageLines","_findCrossPoints","_containsCenterOfCanvas","isPartiallyOnScreen","allPointsAreOutside","every","topline","rightline","bottomline","leftline","xi","iLine","xcount","lineKey","getScaledHeight","scaleToWidth","boundingRectFactor","scaleToHeight","cosP","sinP","cosPSinP","cosPMinusSinP","calcOCoords","_calcRotateMatrix","_calcTranslateMatrix","startMatrix","_calculateCurrentDimensions","forEachControl","w","skipCorners","_setCornerCoords","transformMatrixKey","sep","prefix","cache","tMatrix","noSkew","_finalizeDimensions","getSvgColorString","getSvgStyles","skipShadow","getSvgFilter","getSvgSpanStyles","useWhiteSpace","term","textDecoration","getSvgTextDecoration","decoration","getSvgCommons","getSvgTransform","full","svgTransform","_setSVGBg","textBgRects","_getFillAttributes","_createBaseSVGMarkup","_toSVG","_createBaseClipPathSVGMarkup","objectMarkup","commonPieces","clipPathMarkup","noStyle","styleInfo","shadowInfo","withShadow","vectorEffect","absoluteClipPath","addPaintOrder","originalSet","saveProps","props","tmpObj","_isEqual","origValue","firstPass","dashedPropertySet","forTouch","isControlVisible","touchCorner","fn","controlObject","wh","shouldStroke","setControlVisible","setControlsVisibility","FX_DURATION","fxCenterObjectH","callbacks","empty","fxCenterObjectV","fxRemove","skipCallbacks","propsToAnimate","out","_animate","propPair","propIsColor","valueProgress","timeProgress","coordProps","makeEdgeToOriginGetter","propertyNames","originValues","axis1","axis2","dimension","nearest","farthest","Line","_setWidthHeight","_getLeftToOriginX","_getTopToOriginY","calcLinePoints","origStrokeStyle","xMult","yMult","ATTRIBUTE_NAMES","parsedAttributes","_callback","isValidRadius","startAngle","endAngle","setRadius","svgString","startX","startY","endX","endY","largeFlag","getRadiusX","getRadiusY","Triangle","widthBy2","heightBy2","piBy2","Ellipse","getRx","getRy","_initRxRy","isRounded","bezierCurveTo","Polyline","exactBoundingBox","_setPositionDimensions","_projectStrokeOnPoints","correctLeftTop","calcDim","_calcDimensions","correctSize","fromSVG","diffX","diffY","commonRender","fromElementGenerator","_class","Polygon","_setPath","_renderPathCommands","subpathStartX","subpathStartY","_getOffsetTransform","digits","aX","aY","deltaX","pathUrl","elivenedObjects","useSetOnGroup","isAlreadyGrouped","_updateObjectsACoords","_calcBounds","_updateObjectsCoords","skipControls","_updateObjectCoords","objectLeft","objectTop","nested","_restoreObjectsState","_includeDefaultValues","objsToObject","originalDefaults","_obj","ownCache","groupMatrix","destroy","toActiveSelection","ungroupOnCanvas","setObjectsCoords","onlyWidthHeight","iLen","jLen","_getBounds","minXY","maxXY","toGroup","newGroup","childrenOverride","srcFromAttribute","_lastScaleX","_lastScaleY","_filterScalingX","_filterScalingY","minimumScaleTrigger","cacheKey","imageSmoothing","filters","_initElement","_element","setElement","removeTexture","_initConfig","applyFilters","resizeFilter","applyResizeFilters","backend","filterBackend","evictCachesForKey","getCrossOrigin","getOriginalSize","_stroke","filterObj","getSrc","hasCrop","strokeSvg","imageMarkup","imageRendering","getSvgSrc","origFill","filtered","setSrc","minimumScale","elementToFilter","_filteredEl","sourceWidth","sourceHeight","isNeutralState","imgElement","_needsResize","elementToDraw","elWidth","elHeight","sX","sY","sW","sH","maxDestW","maxDestH","_resetWidthHeight","CSS_CANVAS","_initFilters","pAR","rWidth","rHeight","pWidth","pHeight","_object","resizeFilters","fromURL","imgOptions","_getAngleValueForStraighten","straighten","fxStraighten","straightenObject","fxStraightenObject","testPrecision","precision","fragmentSource","fragmentShader","createShader","FRAGMENT_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","setupGLContext","captureGPUInfo","isSupported","getParameter","MAX_TEXTURE_SIZE","precisions","webGlPrecision","createWebGLCanvas","aPosition","Float32Array","chooseFastestCopyGLTo2DMethod","canUseImageData","canMeasurePerf","performance","canUseArrayBuffer","ArrayBuffer","canUseUint8Clamped","copyGLTo2D","startTime","drawImageTime","putImageDataTime","testContext","now","glOptions","premultipliedAlpha","depth","stencil","antialias","clearColor","cachedTexture","getCachedTexture","sourceTexture","createTexture","targetTexture","originalTexture","passes","webgl","programCache","pass","tempFbo","createFramebuffer","bindFramebuffer","FRAMEBUFFER","applyTo","bindTexture","TEXTURE_2D","deleteTexture","deleteFramebuffer","clearWebGLCaches","textureCache","textureImageSource","filterType","texture","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","uniqueId","gpuInfo","renderer","vendor","ext","getExtension","UNMASKED_RENDERER_WEBGL","UNMASKED_VENDOR_WEBGL","sourceElement","originalImageData","originalEl","BaseFilter","vertexSource","createProgram","vertexShader","VERTEX_SHADER","getShaderInfoLog","program","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","attributeLocations","getAttributeLocations","uniformLocations","getUniformLocations","uStepW","getUniformLocation","uStepH","getAttribLocation","sendAttributeData","aPositionData","attributeLocation","buffer","createBuffer","bindBuffer","ARRAY_BUFFER","enableVertexAttribArray","vertexAttribPointer","FLOAT","bufferData","STATIC_DRAW","_setupFrameBuffer","framebufferTexture2D","COLOR_ATTACHMENT0","_swapTextures","main","mainParameter","applyToWebGL","applyTo2d","retrieveShader","shader","useProgram","uniform1f","sendUniformData","viewport","drawArrays","TRIANGLE_STRIP","bindAdditionalTexture","textureUnit","activeTexture","TEXTURE0","unbindAdditionalTexture","getMainParameter","setMainParameter","createHelpLayer","helpLayer","mainP","ColorMatrix","colorsOnly","uColorMatrix","uConstants","constants","uniformMatrix4fv","uniform4fv","Brightness","brightness","uBrightness","Convolute","opaque","Convolute_3_1","Convolute_3_0","Convolute_5_1","Convolute_5_0","Convolute_7_1","Convolute_7_0","Convolute_9_1","Convolute_9_0","dstOff","scx","scy","srcOff","wt","weights","side","halfSide","sw","sh","output","createImageData","dst","alphaFac","uMatrix","uOpaque","uHalfSize","uSize","uniform1fv","Grayscale","lightness","luminosity","mode","uMode","uniform1i","Invert","invert","uInvert","Noise","noise","rand","uNoise","uSeed","Pixelate","blocksize","_i","_j","_iLen","_jLen","uBlocksize","RemoveColor","useAlpha","lowC","highC","uLow","uHigh","Brownie","Vintage","Kodachrome","Technicolor","Polaroid","Sepia","BlackWhite","BlendColor","screen","diff","lighten","darken","exclusion","tint","buildSource","tg","alpha1","uColor","BlendImage","mask","TEXTURE1","calculateMatrix","canvas1","blendData","blendImage","uTransformMatrix","uImage","uniformMatrix3fv","Resize","resizeType","lanczosLobes","uDelta","uTaps","uniform2fv","horizontal","taps","filterWindow","getFilterWindow","generateShader","tempScale","getTaps","lobeFunction","lanczosCreate","offsets","fragmentSourceTOP","dW","dH","lobes","xx","rcpScaleX","rcpScaleY","newData","oW","oH","sliceByTwo","hermiteFastResize","bilinearFiltering","lanczosResize","tmpCanvas","mult","doneW","doneH","stepW","stepH","dX","dY","process","u","weight","fX","fY","ratioX","icenter","ratioY","range2X","cacheLanc","range2Y","lanczos","rcpRatioX","rcpRatioY","srcData","destData","destImg","xDiff","yDiff","chnl","origPix","w4","pixels","destImage","destPixels","ratioW","ratioH","ratioWHalf","ratioHHalf","img2","data2","weightsAlpha","gxR","gxG","gxB","gxA","yy","w0","Contrast","contrast","contrastF","uContrast","Saturation","saturation","adjust","uSaturation","Vibrance","vibrance","avg","amt","uVibrance","Blur","aspectRatio","simpleBlur","canvas2","blurLayer1","blurLayer2","percent","ctx1","ctx2","nSamples","newImageData","delta","chooseRightDelta","blurScale","Gamma","gamma","rInv","gInv","bInv","rVals","gVals","bVals","uGamma","uniform3fv","Composed","subFilters","HueRotation","rotation","rad","aThird","aThirdSqtSin","OneMinusCos","additionalProps","_dimensionAffectingProps","_reNewline","_reSpacesAndTabs","_reSpaceAndTab","_reWords","textAlign","superscript","baseline","subscript","pathStartOffset","pathSide","pathAlign","_fontSizeFraction","_fontSizeMult","charSpacing","_measuringContext","direction","_styleProperties","__charBounds","CACHE_FONT_SIZE","MIN_TEXT_WIDTH","__skipDimension","setPathInfo","initDimensions","segmentsInfo","getMeasuringContext","_splitText","newLines","_splitTextIntoLines","_textLines","graphemeLines","_unwrappedTextLines","_unwrappedLines","_text","graphemeText","_clearCache","additionalWidth","getHeightOfLine","calcTextWidth","cursorWidth","calcTextHeight","enlargeSpaces","diffSpace","currentLineWidth","numberOfSpaces","accumulatedSpace","line","charBound","spaces","isEndOfWrapping","getLineWidth","kernedWidth","lineIndex","missingNewlineOffset","_setTextStyles","_renderTextLinesBackground","_renderTextDecoration","_renderText","_renderTextStroke","_renderTextFill","charStyle","forMeasuring","textBaseline","_getFontDeclaration","maxWidth","_renderTextLine","_renderChars","styleHas","heightOfLine","lineLeftOffset","lastColor","charBox","currentColor","drawStart","leftOffset","_getLeftOffset","lineTopOffset","_getTopOffset","boxStart","boxWidth","_getLineLeftOffset","getValueOfPropertyAt","renderLeft","getFontCache","cacheProp","_measureChar","previousChar","prevCharStyle","coupleWidth","previousWidth","fontCache","fontDeclaration","previousFontDeclaration","couple","stylesAreEqual","fontMultiplier","measureText","getHeightOfChar","measureLine","lineInfo","_measureLine","_getWidthOfCharSpacing","grapheme","prevGrapheme","graphemeInfo","startingPoint","totalPathLength","numOfSpaces","lineBounds","positionInPath","_getGraphemeBox","_setGraphemeOnPath","centerPosition","skipLeft","getCompleteStyleDeclaration","previousBox","__lineHeights","maxHeight","_renderTextCommon","lineHeights","isEmptyStyles","actualStyle","nextStyle","timeToRender","drawingLeft","isJustify","charsToRender","shortCut","isLtr","currentDirection","_renderChar","_applyPatternGradientTransformText","handleFiller","fillOffsets","strokeOffsets","_getStyleDeclaration","fullDecl","shouldFill","fillText","strokeText","setSuperscript","_setScript","setSubscript","schema","loc","get2DCursorLocation","setSelectionStyles","lineDiff","__lineWidths","_shouldClearDimensionCache","shouldClear","_forceClearCache","_size","_dy","lastDecoration","currentDecoration","currentFill","lastFill","topOffset","styleObject","family","fontIsGeneric","genericFonts","newLine","newText","allProperties","needsDims","isAddingPath","_key","parsedAnchor","textAnchor","originalStrokeWidth","textHeightScaleFactor","lineHeightDiff","scaledDiff","textHeight","offX","objectCopy","textInstance","pathInstance","p3","cleanStyle","letterCount","stylePropertyValue","stylesCount","allStyleObjectPropertiesMatch","graphemeCount","stylePropertyHasBeenSet","removeStyle","lineNum","charNum","_extendStyles","_getLineStyle","_setLineStyle","_setStyleDeclaration","selectionStart","skipWrapping","getSelectionStyles","startIndex","endIndex","selectionEnd","getStyleAtPosition","lineStyle","_deleteStyleDeclaration","_deleteLineStyle","parseDecoration","IText","editable","editingBorderColor","cursorColor","cursorDelay","cursorDuration","caching","hiddenTextareaContainer","_reSpace","_currentCursorOpacity","_selectionDirection","_abortCursorAnimation","__widthOfSpace","inCompositionMode","initBehavior","setSelectionStart","_updateAndFire","setSelectionEnd","_fireSelectionChanged","_updateTextarea","initDelayedCursor","cursorOffsetCache","renderCursorOrSelection","skipRestore","_clearTextArea","boundaries","_getCursorBoundaries","renderCursor","renderSelection","_getCursorBoundariesOffsets","cursorPosition","bound","cursorLocation","charHeight","__isMousedown","hiddenTextarea","startLine","endLine","startChar","endChar","lineOffset","realLineHeight","boxEnd","drawWidth","drawHeight","extraTop","compositionColor","getCurrentCharFontSize","cp","_getCurrentCharIndex","getCurrentCharColor","objCopy","initAddedHandler","initRemovedHandler","initCursorSelectionHandlers","initDoubleClickSimulation","mouseMoveHandler","_initCanvasHandlers","_removeCanvasHandlers","_tick","_currentTickState","_animateCursor","targetOpacity","completeMethod","tickState","isAborted","_onTickComplete","_cursorTimeout1","_currentTickCompleteState","restart","delay","abortCursorAnimation","_cursorTimeout2","selectAll","getSelectedText","findWordBoundaryLeft","startFrom","findWordBoundaryRight","findLineBoundaryLeft","findLineBoundaryRight","searchWordBoundary","selectWord","newSelectionStart","newSelectionEnd","selectLine","enterEditing","exitEditingOnOthers","initHiddenTextarea","focus","_saveEditingProps","_setEditingProps","_textBeforeEdit","initMouseMoveHandler","activeElement","getSelectionStartFromPointer","currentStart","currentEnd","__selectionStartOnMouseDown","restartCursorIfNeeded","fromStringToGraphemeSelection","smallerTextStart","graphemeStart","smallerTextEnd","graphemeEnd","fromGraphemeToStringSelection","newSelection","updateTextareaPosition","updateFromTextArea","_calcTextareaPosition","desiredPosition","compositionStart","upperCanvas","upperCanvasWidth","upperCanvasHeight","clientWidth","clientHeight","_savedProps","_restoreEditingProps","isTextChanged","_removeExtraneousStyles","removeStyleFromTo","styleObj","cursorStart","cursorEnd","lineStart","charStart","lineEnd","charEnd","shiftLineStyles","numericChar","clonedStyles","numericLine","insertNewlineStyleObject","qty","copiedStyle","currentCharStyle","newLineStyles","someStyleIsCarryingOver","originalLineLength","isEndOfLine","numIndex","styleCarriedOver","insertCharStyleObject","quantity","currentLineStyles","currentLineStylesCloned","numericIndex","newStyle","insertNewStyleBlock","insertedText","cursorLoc","addedLines","linesLength","setSelectionStartEndWithShift","setSelectionInBoundaries","__lastClickTime","__lastLastClickTime","__lastPointer","__newClickTime","newPointer","isTripleClick","_stopEvent","__lastIsEditing","__lastSelected","initMousedownHandler","initMouseupHandler","initClicks","doubleClickHandler","tripleClickHandler","_mouseDownHandler","setCursorByClick","_mouseDownHandlerBefore","currentActive","mouseOffset","prevWidth","_getNewSelectionStartFromOffset","distanceBtwLastCharAndCursor","distanceBtwNextCharAndCursor","onKeyDown","onKeyUp","onInput","copy","paste","onCompositionStart","onCompositionUpdate","onCompositionEnd","_clickHandlerInitialized","onClick","keysMap","keysMapRtl","ctrlKeysMapUp","ctrlKeysMapDown","keyMap","keyCode","ctrlKey","metaKey","stopImmediatePropagation","_copyDone","fromPaste","removedText","removeFrom","removeTo","nextText","charCount","nextCharCount","charDiff","textareaSelection","backDelete","copiedText","copiedTextStyle","compositionEnd","_getClipboardData","clipboardData","_getWidthBeforeCursor","widthBeforeCursor","getDownCursorOffset","isRight","selectionProp","_getSelectionForOffset","indexOnOtherLine","_getIndexOnLine","textAfterCursor","getUpCursorOffset","textBeforeCursor","charWidth","foundMatch","widthOfCharsOnLine","indexOnLine","leftEdge","rightEdge","offsetFromLeftEdge","offsetFromRightEdge","moveCursorDown","_moveCursorUpOrDown","moveCursorUp","moveCursorWithShift","moveCursorWithoutShift","moveCursorLeft","_moveCursorLeftOrRight","_move","_moveLeft","_moveRight","moveCursorLeftWithoutShift","change","moveCursorLeftWithShift","moveCursorRight","moveCursorRightWithShift","moveCursorRightWithoutShift","changed","removeChars","insertChars","multipleSpacesRegex","_getSVGLeftTopOffsets","textAndBg","_getSVGTextAndBg","textTop","textLeft","_wrapSVGTextAndBg","textSvg","lineTop","noShadow","textSpans","textTopOffset","textLeftOffset","_setSVGTextLineBg","_setSVGTextLineText","_createTextCharSpan","styleDecl","shouldUseWhitespace","styleProps","fillStyles","dySpan","angleAttr","wBy2","renderPoint","_pushTextBgRect","fillColor","_getSVGLineTopOffset","lastHeight","svgStyle","Textbox","minWidth","dynamicMinWidth","__cachedLines","_wordJoiners","splitByGrapheme","_styleMap","_generateStyleMap","textInfo","realLineCount","realLineCharCount","isWrapping","nextOffset","nextLineIndex","shouldLimit","mapNextLine","_wrapText","desiredWidth","wrapped","_wrapLine","_measureWord","word","charOffset","_line","reservedSpace","words","infix","wordWidth","infixWidth","largestWordWidth","lineJustStarted","additionalSpace","getMinWidth","linesToKeep","scaleSkewStyleHandler","scaleStyleHandler","objectControls","ml","mr","mb","mtr","textBoxControls","autoBom","Blob","responseType","response","dispatchEvent","MouseEvent","createEvent","initMouseEvent","f","userAgent","saveAs","HTMLAnchorElement","URL","webkitURL","name","download","rel","href","location","createObjectURL","revokeObjectURL","msSaveOrOpenBlob","title","innerText","HTMLElement","safari","FileReader","onloadend","readAsDataURL","factory","hookCallback","hooks","setHookCallback","input","isObject","hasOwnProp","isObjectEmpty","getOwnPropertyNames","isUndefined","isNumber","isDate","res","arrLen","createUTC","locale","strict","createLocalOrUTC","utc","defaultParsingFlags","unusedTokens","unusedInput","overflow","charsLeftOver","nullInput","invalidEra","invalidMonth","invalidFormat","userInvalidated","iso","parsedDateParts","era","meridiem","rfc2822","weekdayMismatch","getParsingFlags","_pf","isValid","_isValid","flags","parsedParts","isNowValid","_d","getTime","invalidWeekday","_strict","bigHour","isFrozen","createInvalid","NaN","fun","momentProperties","updateInProgress","copyConfig","val","momentPropertiesLen","_isAMomentObject","_f","_l","_tzm","_isUTC","_locale","Moment","updateOffset","isMoment","msg","suppressDeprecationWarnings","deprecate","firstTime","deprecationHandler","arg","argLen","stack","deprecations","deprecateSimple","isFunction","Function","_config","_dayOfMonthOrdinalParseLenient","_dayOfMonthOrdinalParse","_ordinalParse","mergeConfigs","parentConfig","childConfig","Locale","defaultCalendar","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","calendar","mom","_calendar","zeroFill","targetLength","forceSign","absNumber","zerosToFill","substr","formattingTokens","localFormattingTokens","formatFunctions","formatTokenFunctions","addFormatToken","token","padded","ordinal","func","localeData","removeFormattingTokens","makeFormatFunction","formatMoment","expandFormat","invalidDate","replaceLongDateFormatTokens","longDateFormat","defaultLongDateFormat","LTS","LT","L","LL","LLL","LLLL","_longDateFormat","formatUpper","tok","defaultInvalidDate","_invalidDate","defaultOrdinal","defaultDayOfMonthOrdinalParse","_ordinal","defaultRelativeTime","future","past","ss","mm","hh","dd","ww","MM","relativeTime","withoutSuffix","isFuture","_relativeTime","pastFuture","aliases","addUnitAlias","shorthand","lowerCase","normalizeUnits","units","normalizeObjectUnits","inputObject","normalizedProp","normalizedInput","priorities","addUnitPriority","priority","getPrioritizedUnits","unitsObj","isLeapYear","year","absFloor","toInt","argumentForCoercion","coercedNumber","isFinite","makeGetSet","keepTime","set$1","month","date","daysInMonth","stringGet","stringSet","prioritized","prioritizedLen","regexes","match1","match2","match3","match4","match6","match1to2","match3to4","match5to6","match1to3","match1to4","match1to6","matchUnsigned","matchSigned","matchOffset","matchShortOffset","matchTimestamp","matchWord","addRegexToken","strictRegex","isStrict","getParseRegexForToken","unescapeFormat","regexEscape","matched","p4","tokens","addParseToken","tokenLen","addWeekParseToken","_w","addTimeToArrayFromToken","_a","YEAR","MONTH","DATE","HOUR","MINUTE","SECOND","MILLISECOND","WEEK","WEEKDAY","mod","modMonth","monthsShort","months","monthsShortRegex","monthsRegex","monthsParse","defaultLocaleMonths","defaultLocaleMonthsShort","MONTHS_IN_FORMAT","defaultMonthsShortRegex","defaultMonthsRegex","localeMonths","_months","isFormat","localeMonthsShort","_monthsShort","handleStrictParse","monthName","ii","llc","toLocaleLowerCase","_monthsParse","_longMonthsParse","_shortMonthsParse","localeMonthsParse","_monthsParseExact","setMonth","dayOfMonth","getSetMonth","getDaysInMonth","computeMonthsParse","_monthsShortStrictRegex","_monthsShortRegex","_monthsStrictRegex","_monthsRegex","cmpLenRev","shortPieces","longPieces","mixedPieces","daysInYear","parseTwoDigitYear","getSetYear","getIsLeapYear","createDate","ms","getFullYear","setFullYear","createUTCDate","UTC","getUTCFullYear","setUTCFullYear","firstWeekOffset","dow","doy","fwd","fwdlw","getUTCDay","dayOfYearFromWeeks","week","weekday","resYear","resDayOfYear","localWeekday","weekOffset","dayOfYear","weekOfYear","resWeek","weeksInYear","weekOffsetNext","localeWeek","_week","defaultLocaleWeek","localeFirstDayOfWeek","localeFirstDayOfYear","getSetWeek","getSetISOWeek","parseWeekday","weekdaysParse","parseIsoWeekday","shiftWeekdays","ws","weekdaysMin","weekdaysShort","weekdays","weekdaysMinRegex","weekdaysShortRegex","weekdaysRegex","defaultLocaleWeekdays","defaultLocaleWeekdaysShort","defaultLocaleWeekdaysMin","defaultWeekdaysRegex","defaultWeekdaysShortRegex","defaultWeekdaysMinRegex","localeWeekdays","_weekdays","day","localeWeekdaysShort","_weekdaysShort","localeWeekdaysMin","_weekdaysMin","handleStrictParse$1","weekdayName","_weekdaysParse","_shortWeekdaysParse","_minWeekdaysParse","localeWeekdaysParse","_weekdaysParseExact","_fullWeekdaysParse","getSetDayOfWeek","getDay","getSetLocaleDayOfWeek","getSetISODayOfWeek","computeWeekdaysParse","_weekdaysStrictRegex","_weekdaysRegex","_weekdaysShortStrictRegex","_weekdaysShortRegex","_weekdaysMinStrictRegex","_weekdaysMinRegex","minp","shortp","longp","minPieces","hFormat","hours","kFormat","lowercase","minutes","matchMeridiem","_meridiemParse","localeIsPM","seconds","kInput","_isPm","isPM","_meridiem","pos1","pos2","defaultLocaleMeridiemParse","getSetHour","localeMeridiem","isLower","globalLocale","baseConfig","dayOfMonthOrdinalParse","meridiemParse","locales","localeFamilies","commonPrefix","arr1","arr2","minl","normalizeLocale","chooseLocale","names","loadLocale","isLocaleNameSane","oldLocale","_abbr","getSetGlobalLocale","values","getLocale","defineLocale","abbr","parentLocale","updateLocale","tmpLocale","listLocales","checkOverflow","_overflowDayOfYear","_overflowWeeks","_overflowWeekday","extendedIsoRegex","basicIsoRegex","tzRegex","isoDates","isoTimes","aspNetJsonRegex","obsOffsets","UT","GMT","EDT","EST","CDT","CST","MDT","MST","PDT","PST","configFromISO","allowTime","dateFormat","timeFormat","tzFormat","isoDatesLen","isoTimesLen","configFromStringAndFormat","extractFromRFC2822Strings","yearStr","monthStr","dayStr","hourStr","minuteStr","secondStr","untruncateYear","preprocessRFC2822","checkWeekday","weekdayStr","parsedInput","weekdayProvided","weekdayActual","calculateOffset","obsOffset","militaryOffset","numOffset","hm","configFromRFC2822","parsedArray","setUTCMinutes","getUTCMinutes","configFromString","createFromInputFallback","defaults","currentDateArray","nowValue","_useUTC","getUTCMonth","getUTCDate","getMonth","getDate","configFromArray","currentDate","expectedWeekday","yearToUse","dayOfYearFromWeekInfo","_dayOfYear","_nextDay","weekYear","weekdayOverflow","curWeek","GG","W","E","createLocal","gg","ISO_8601","RFC_2822","skipped","stringLength","totalParsedInputLength","meridiemFixWrap","erasConvertYear","hour","isPm","meridiemHour","configFromStringAndArray","tempConfig","bestMoment","scoreToBeat","currentScore","validFormatFound","bestFormatIsValid","configfLen","score","configFromObject","dayOrDate","minute","second","millisecond","createFromConfig","prepareConfig","preparse","configFromInput","isUTC","prototypeMin","prototypeMax","pickBy","moments","ordering","isDurationValid","unitHasDecimal","orderLen","isValid$1","createInvalid$1","createDuration","Duration","years","quarters","quarter","weeks","isoWeek","days","milliseconds","_milliseconds","_days","_data","_bubble","isDuration","absRound","compareArrays","array1","array2","dontConvert","lengthDiff","diffs","separator","utcOffset","offsetFromString","chunkOffset","matches","cloneWithOffset","model","setTime","local","getDateOffset","getTimezoneOffset","getSetOffset","keepLocalTime","keepMinutes","localAdjust","_changeInProgress","addSubtract","getSetZone","setOffsetToUTC","setOffsetToLocal","setOffsetToParsedOffset","tZone","hasAlignedHourOffset","isDaylightSavingTime","isDaylightSavingTimeShifted","_isDSTShifted","isLocal","isUtcOffset","isUtc","aspNetRegex","isoRegex","ret","diffRes","parseIso","momentsDifference","inp","positiveMomentsDifference","base","isAfter","isBefore","createAdder","period","dur","tmp","isAdding","invalid","isString","isMomentInput","isNumberOrStringArray","isMomentInputObject","objectTest","propertyTest","propertyLen","arrayTest","dataTypeTest","isCalendarSpec","getCalendarFormat","myMoment","calendar$1","formats","sod","startOf","calendarFormat","localInput","endOf","isBetween","inclusivity","localFrom","localTo","isSame","inputMs","isSameOrAfter","isSameOrBefore","asFloat","zoneDelta","monthDiff","anchor2","wholeMonthDiff","anchor","toISOString","keepOffset","toDate","inspect","datetime","suffix","zone","inputString","defaultFormatUtc","defaultFormat","postformat","humanize","fromNow","toNow","newLocaleData","lang","MS_PER_SECOND","MS_PER_MINUTE","MS_PER_HOUR","MS_PER_400_YEARS","mod$1","dividend","divisor","localStartOfDate","utcStartOfDate","startOfDate","isoWeekday","unix","isValid$2","parsingFlags","invalidAt","creationData","localeEras","eras","_eras","since","until","Infinity","localeErasParse","eraName","narrow","localeErasConvertYear","dir","getEraName","getEraNarrow","getEraAbbr","getEraYear","erasNameRegex","computeErasParse","_erasNameRegex","_erasRegex","erasAbbrRegex","_erasAbbrRegex","erasNarrowRegex","_erasNarrowRegex","matchEraAbbr","matchEraName","matchEraNarrow","matchEraYearOrdinal","_eraYearOrdinalRegex","abbrPieces","namePieces","narrowPieces","addWeekYearFormatToken","getter","getSetWeekYear","getSetWeekYearHelper","getSetISOWeekYear","getISOWeeksInYear","getISOWeeksInISOWeekYear","isoWeekYear","getWeeksInYear","weekInfo","getWeeksInWeekYear","weeksTarget","setWeekAll","dayOfYearData","getSetQuarter","erasParse","eraYearOrdinalParse","getSetDayOfMonth","getSetDayOfYear","getSetMinute","getSetMillisecond","getSetSecond","parseMs","getZoneAbbr","getZoneName","createUnix","createInZone","parseZone","preParsePostFormat","Symbol","for","eraNarrow","eraAbbr","eraYear","isoWeeks","weeksInWeekYear","isoWeeksInYear","isoWeeksInISOWeekYear","isDST","zoneAbbr","zoneName","dates","isDSTShifted","proto$1","get$1","field","setter","listMonthsImpl","listWeekdaysImpl","localeSorted","listMonths","listMonthsShort","listWeekdays","listWeekdaysShort","listWeekdaysMin","firstDayOfYear","firstDayOfWeek","langData","mathAbs","addSubtract$1","add$1","subtract$1","absCeil","bubble","monthsFromDays","monthsToDays","daysToMonths","as","valueOf$1","makeAs","alias","asMilliseconds","asSeconds","asMinutes","asHours","asDays","asWeeks","asMonths","asQuarters","asYears","clone$1","get$2","makeGetter","thresholds","substituteTimeAgo","relativeTime$1","posNegDuration","getSetRelativeTimeRounding","roundingFunction","getSetRelativeTimeThreshold","limit","argWithSuffix","argThresholds","withSuffix","abs$1","toISOString$1","totalSign","ymSign","daysSign","hmsSign","total","proto$2","toIsoString","relativeTimeRounding","relativeTimeThreshold","HTML5_FMT","DATETIME_LOCAL","DATETIME_LOCAL_SECONDS","DATETIME_LOCAL_MS","TIME","TIME_SECONDS","TIME_MS","fileSelectRef","ref","toggleFullscreen","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","msExitFullscreen","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","__exports__","raid_analysis_constant","timeline_enable_mapId","bossName","noChannel_skillId","templateTable","blame_enable_mapId","buffTable","buff2name","store","useStore","workerTaskQueue","busy","async","processQueue","worker","resolve","Promise","onmessage","postMessage","getWorkerResponse","workerBusy","class","_hoisted_4","__name","setup","__props","mainTab","tabList","icon","activedIcon","showTab","tab","video_identifier","client","switchTab","_ctx","_cache","$event","_","draggable","displayOverview","computed","stats","entities","maxBeDamaged","entity","beDamaged","beDamagedValue","totalDamage","totalTreat","totalBeDamaged","totalBeTreat","damage","treat","beTreated","_stats$beTreated$enti","displayBigNumberAndUnit","teamDps","sec","teamHps","teamDeDps","teamBeHps","totalDuration","displayDuration","Vue2","METHOD_NAMES","usePublicAPI","chart","makePublicMethod","makePublicMethods","methods","create","useAutoresize","autoresize","root2","chart2","autoresize2","onCleanup","offsetWidth","offsetHeight","autoresizeOptions","throttle","wait","onResize","initialResizeTriggered","resize","resizeCallback","ResizeObserver","observe","disconnect","autoresizeProps","Boolean","onRE","isOn","omitOn","unwrapInjected","injection","defaultValue","LOADING_OPTIONS_KEY","useLoading","loading","loadingOptions","defaultLoadingOptions","realLoadingOptions","showLoading","hideLoading","loadingProps","registered","TAG_NAME","register","customElements","reg","head","wcRegistered","ignoredElements","THEME_KEY","INIT_OPTIONS_KEY","UPDATE_OPTIONS_KEY","NATIVE_EVENT_RE","ECharts","theme","initOptions","updateOptions","manualUpdate","emits","inheritAttrs","manualOption","defaultTheme","defaultInitOptions","defaultUpdateOptions","realOption","realTheme","realInitOptions","realUpdateOptions","nonEventAttrs","nativeListeners","listeners","proxy","$listeners","realListeners","init$1","isDisposed","commit","opt","setOption","__once__","getZr","raw","cleanup","nativeKey","unwatchOption","manualUpdate2","oldOption","notMerge","immediate","publicApi","__dispose","getResource","_getResource","getResourceIcon","_getResourceIcon","getResourceName","showID","_getResourceName","getMountIcon","iconLink","mount","showMountIcon","require","getEntityColor","entityID","_getEntityColor","getEntity","_getEntity","getEntityName","showOrder","showRegion","_getEntityName","_end","statType","timeRange","focusEntitieName","toRefs","usePve","tabs","switchType","player_death","buff_blame","buffObj","player_id","buff_id","count","sp","buffs","deathTotal","buffTotal","xData","yData","legendNames","_yData$value","tooltip","trigger","order","legend","show","orient","xAxis","boundaryGap","triggerEvent","yAxis","dataZoom","filterMode","series","grid","handleSelect","endMicro","micro","handleDatazoom","debounce","leading","updateData","then","watchPostEffect","usePaginate","pageSize","currentPage","currentData","focusEntitie","click","rowClass","toRaw","tips","grow","innerStyle","alignItems","justifyContent","flexDirection","flexGrow","iconStyle","tipsStyle","_focusEntitie$value","_focusEntitie$value2","entityList","entitySelectVisible","delEntity","list","selectEntity","showSelectEntityView","_component_el_icon","_component_Plus","alt","default","Close","TitleModel","_super","layoutMode","ignoreSize","defaultOption","z","subtext","subtarget","borderWidth","itemGap","textStyle","subtextStyle","Component","TitleView","titleModel","ecModel","api","removeAll","textStyleModel","getModel","subtextStyleModel","textVerticalAlign","textEl","getTextColor","disableBox","z2","textRect","subText","subTextEl","verticalAlign","link","sublink","silent","componentType","componentIndex","groupRect","layoutOption","getBoxLayoutParams","layoutRect","markRedraw","alignStyle","margin","getItemStyle","shape","subPixelOptimize","registers","registerComponentModel","registerComponentView","PI2","RADIAN","getViewRect","seriesModel","layout","getBasicPieLayout","viewRect","r0","coordSys","coordinateSystem","dataToPoint","pieLayout","seriesType","eachSeriesByType","getData","valueDim","mapDimension","padAngle","minAngle","minAndPadAngle","validDataCount","each","sum","getSum","unitRadian","clockwise","roseType","stillShowZeroSum","getDataExtent","angles","halfPadAngle","layoutData","getSeriesLayoutData","angleRange","restAngle","valueSumLargerThanMinAngle","currentAngle","setLayout","setItemLayout","actualStartAngle","actualEndAngle","angle_1","layout_1","getItemLayout","layout_2","dataFilter","legendModels","findComponents","mainType","filterSelf","getName","isSelected","PathProxy","projectPointToLine","limitToEnds","dx1","dy1","lineLen","projectedLen","ox","oy","pt0","pt1","pt2","dir2","tmpArr","tmpProjPoint","limitTurnAngle","linePoints","minTurnAngle","fromArray","len1","len2","angleCos","minTurnAngleCos","scaleAndAdd","limitSurfaceAngle","surfaceNormal","maxSurfaceAngle","maxSurfaceAngleCos","HALF_PI","angle2","newAngle","setLabelLineState","labelLine","ignore","stateName","stateModel","isNormal","stateObj","ensureState","smooth","getLineStyle","useStyle","buildLabelLinePath","moveLen","midPoint0","midPoint2","midPoint1","setLabelLineStyle","targetEl","statesModels","defaultStyle","getTextGuideLine","label","getTextContent","normalModel","normal","showNormal","labelIgnoreNormal","stateShow","isLabelIgnored","states","setTextGuideLine","stateProxy","showAbove","labelLineConfig","textGuideLineConfig","buildPath","removeTextGuideLine","getLabelLineStatesModels","itemModel","labelLineName","adjustSingleSide","viewWidth","viewHeight","viewLeft","viewTop","farthestX","labelAlignTo","recalculateX","recalculateXOnSemiToAlignOnEllipseCurve","semi","rB","rB2","rA","rA2","newX","newTargetWidth","targetTextWidth","constrainTextWidth","items","topSemi","bottomSemi","avoidOverlap","labelLayoutList","leftList","rightList","leftmostX","MAX_VALUE","rightmostX","isPositionCenter","labelStyleWidth","labelDistance","edgeDistance","bleedMargin","isAlignToEdge","paddingH","extraPaddingH","realTextWidth","dist","availableWidth","forceRecalculate","oldOuterWidth","oldHeight","innerRect","availableInnerWidth","unconstrainedWidth","newRect","sectorShape","pieLabelLayout","hasLabelRotate","minShowLabelRadian","getLayout","setNotShow","isLabelShown","sector","getItemGraphicEl","getItemModel","labelModel","labelPosition","labelLineModel","labelLineLen","labelLineLen2","textX","textY","midAngle","nx","ny","isLabelInside","labelRotate","radialAngle","isDown","selectState","select","applyTransform","getComputedTransform","setTextConfig","inside","notShowLabel","setShape","__hostTarget","PiePiece","setTextContent","firstCreate","hostModel","emphasisModel","animationType","getShallow","ssr","dataIndex","isFrom","getItemVisual","_updateLabel","labelText","visualColor","visualOpacity","labelFetcher","labelDataIndex","inheritColor","defaultOpacity","defaultText","getFormattedLabel","polyline","PieView","ignoreLabelLineUpdate","payload","oldData","_emptyCircleSector","piePiece","setItemGraphicEl","update","oldIdx","execute","containPoint","itemLayout","Chart","createSeriesDataSimply","nameList","coordDimensions","encodeDefine","getEncode","SeriesData","initData","LegendVisualProvider","getDataWithEncodedVisual","getRawData","_getDataWithEncodedVisual","_getRawData","getAllNames","rawData","mapArray","containName","indexOfName","dataWithEncodedVisual","innerData","PieSeriesModel","init","legendVisualProvider","_defaultLabelLine","mergeOption","getInitialData","encodeDefaulter","getDataParams","dataInner","seats","valueList_1","params","$vars","labelLineNormalOpt","labelLineEmphasisOpt","emphasis","legendHoverLink","colorBy","minShowLabelAngle","selectedOffset","percentPrecision","alignTo","distanceToLabelLine","length2","itemStyle","borderJoin","showEmptyCircle","emptyCircleStyle","labelLayout","hideOverlap","scaleSize","avoidLabelOverlap","animationDuration","animationTypeUpdate","animationEasingUpdate","animationDurationUpdate","animationEasing","Series","negativeDataFilter","curValue","registerChartView","registerSeriesModel","PieSeries","registerAction","registerLayout","registerProcessor","required","overviewValue","overview","totalValue","percentage","formatter","borderRadius","echart","entityTab","_directive_loading","ref_key","vps","critRate","entityInfo","fightDuration","viewType","effect","targetLogs","targetLog","effectLogs","effectLog","titleName","resource","remark","selectLog","_targetLog$value","_effectLog$value","_component_el_table_column","_component_el_table","_component_el_pagination","border","onRowClick","small","_hoisted_25","detail","caster","isCritical","buff","tue","entityTimeRange","logs","targetLabel","skipNoNameTarget","newEntity","oldEntity","clearLogs","flush","onSortChange","flase","sortable","valueRate","criticalCount","criticalRate","selectedSkill","_selectedSkill$value","_selectedSkill$value2","_selectedSkill$value3","miss","hit","cast","_unref2","_unref3","_unref4","_unref5","_unref6","_unref7","interval","_createElementBlock","_normalizeStyle","$options","dynamicStyles","_createElementVNode","_hoisted_1","_Fragment","_renderList","$data","tooltipData","_toDisplayString","RECT_HEIGHT","linetime","max_width","lastItem","itemCache","layoutCache","displayingItemGroup","created","mounted","$nextTick","initCanvas","renderLines","axisText","renderItems","cloneDeep","_item$extra","item_group","itemPosition","extra","lastLeft","lastTop","nameText","content","timeText","showTooltip","closeTooltip","_item$extra2","moveTooltip","patch","_item$extra3","isDragging","lastPosX","lastPosY","minXOffset","maxXOffset","minYOffset","maxYOffset","$refs","watch","selectedSkills","m_jcl_main","getElementsByClassName","m_jcl_main_width","_store$result$skill","skill","idNameMap","typeDescMap","stat","skillType","技能","技能ID","施放时间","施放类型","事件","_selected","tableData","_selectedSkill","_last","_component_el_checkbox","rate","aligin","checked","selectedBuffs","renderItem","categoryIndex","coord","itemHeight","visibleRect","rectShape","graphic","clipRectByRect","visual","stackLogs","MIN_SAFE_INTEGER","stackNum","showText","textShadowColor","textShadowBlur","isDelete","showDelete","diffChildrenByName","marker","deleteBy","showDataShadow","labelFormatter","axisLabel","categories","axisTick","rich","iconStyles","encode","baseSortBy","comparer","compareAscending","valIsDefined","valIsNull","valIsReflexive","valIsSymbol","isSymbol","othIsDefined","othIsNull","othIsReflexive","othIsSymbol","compareMultiple","orders","objCriteria","criteria","othCriteria","ordersLength","baseOrderBy","collection","iteratees","iteratee","identity","sortBy","sortList","__node","jx3box","axios","baseURL","ids","fields","post","getEnchantByItemID","entityToJBBB","WXS_LEVEL","POSITION_MAP","equips","talents","singleTransform","equip","embedding","strength","enhance","stone","enchant","ID","position_name","all","talentSkills","skills","SkillID","Name","_t$skill","level","Title","EquipList","TalentCode","Mount","Client","VERSION","_hasBuffer","_TD","TextDecoder","_TE","TextEncoder","b64ch","b64chs","b64tab","b64re","_fromCC","fromCharCode","_U8Afrom","it","_mkUriSafe","m0","_tidyB64","btoaPolyfill","bin","u32","c0","asc","pad","_btoa","btoa","_fromUint8Array","u8a","maxargs","strs","subarray","fromUint8Array","urlsafe","cb_utob","cc","re_utob","utob","_encode","re_btou","cb_btou","cccc","btou","atobPolyfill","u24","_atob","atob","_toUint8Array","toUint8Array","_unURI","_decode","decode","_noEnum","enumerable","configurable","extendString","_add","extendUint8Array","extendBuiltins","gBase64","fromBase64","toBase64","encodeURI","encodeURL","iframeSrc","showIframe","toggleIframe","talanet_pos","xfId","file_version","toLocaleString","replaceAll","JX3_QIXUE","xf","sq","catch","$message","equip_obj","encodeURIComponent","Base64","entityColor","pt","showSymbol","areaStyle","onDatazoom","onSelected","onSelectEntity","tyep","isCompare","npcList","playerList","filterList","switchFilter","_templateExist","entitiesArr","belongID","templateID","newVal","formatTime","microseconds","timer","firstAppear","_hoisted_2","_hoisted_3","_normalizeClass","compareMode","_hoisted_5","_hoisted_7","_hoisted_8","compareEntity","_withModifiers","showSelectView","_hoisted_10","_createVNode","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_15","removeEntity","_component_Close","mapWritableState","player","compareSelectVisible","entityOption","teamOption","getItemColor","findIndex","_total","_vps","_critRate","teamTotal","teamValue","acc","cur","teamData","compareEffect","compareEffectList","updateCompareEffectList","selectSkill","sortSkill","criticalList","arr3","arr4","min1","min2","min3","min4","avg1","curr","avg2","avg3","avg4","max1","max2","max3","max4","rate1","rate2","rate3","rate4","value3","value4","hitList","router","useRouter","_store$info","query","entity1","entity2","entity3","entity4","imgSrc","blame_filters","onMounted","iconSrc","selectedEvent","death","playerId","selectedTimeline","timeline_filters","column","columnIndex","no","route","useRoute","fullPath","template","say","time_line_result","skill_id","skill_level","short_name","skill_key","current_timeline","释放者模板ID","释放者名称","等级","entries","say_key","内容","templates","template_key","名称","模板ID","数量","出现时间","logFilter","dialogVisible","statusMap","progress","statusIcon","Loading","CircleCheckFilled","CircleCloseFilled","Checked","clearProgress","updateStatus","desc","processing","ready","filename","file","blob","__expose","__emit","logAutoApply","isExpansion1","isExpansion2","isExpansion3","isExpansion4","isExpansion5","autoSearchCheck","filterOptions2","filterOptions3","_store$result","selectOnlyName","selectOnlyNoSon","selectOnlyNoRepeat","appearOrder","maxTime","_store$result2","keywordStr","hideKeywordStr","exportBox","onShowTypesChange","showTypes","getKeywords","keywords","ks","resourceMatch","include","updateKeyword","keyword","hideKeyword","inputChange","logDebug","finally","throttleUpdateData","consoleLog","showEventValue","buffs_coverage_constants","team_buffs","individual_buffs","final_data","selectedBuff","query_buff_list","filteredBuffs","startsWith","submitBuff","individual_selected_buff","individual_selected_buff_log","query_key","average_coverage_per_player","average_stack_per_player","buffed_player","times_per_player","this_res","playerName","times","coverage","columnWidth","mainComponents","compare","blame","time_line","buff_coverage_main","displayTitle","currentRoute"],"sourceRoot":""}